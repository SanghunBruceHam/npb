<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KBO 2025 ì¢…í•© ë¶„ì„ ëŒ€ì‹œë³´ë“œ</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans KR', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            line-height: 1.6;
            min-height: 100vh;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            color: #2c3e50;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header .subtitle {
            font-size: 1.1rem;
            color: #7f8c8d;
            margin-bottom: 20px;
        }

        .update-info {
            display: inline-block;
            background: #e8f4fd;
            color: #2980b9;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 500;
        }

        .full-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(800px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .wide-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
        }

        .card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            margin-bottom: 25px;
        }

        .card-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #ecf0f1;
        }

        .card-icon {
            font-size: 2rem;
            margin-right: 15px;
        }

        .card-title {
            font-size: 1.4rem;
            font-weight: 600;
            color: #2c3e50;
        }

        /* ì „ì²´ ìˆœìœ„í‘œ - ê°€ë¡œ ìŠ¤í¬ë¡¤ */
        .full-standings-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
            font-size: 0.85rem;
        }

        .full-standings-table th,
        .full-standings-table td {
            padding: 10px 6px;
            text-align: center;
            border: 1px solid #ecf0f1;
            white-space: nowrap;
        }

        .full-standings-table th {
            background: #34495e;
            color: white;
            font-weight: 600;
            position: sticky;
            top: 0;
        }

        .full-standings-table .team-name {
            text-align: center !important;
            font-weight: 600;
            min-width: 60px;
        }

        .full-standings-table .rank-1 { background: #fff3cd; }
        .full-standings-table .rank-2 { background: #f8f9fa; }
        .full-standings-table .rank-3 { background: #f8f9fa; }

        /* ì§€í‘œ ê·¸ë¦¬ë“œ */
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .metric-card {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            border-left: 4px solid #3498db;
        }

        .metric-card.positive {
            border-left-color: #27ae60;
            background: #f0f9f4;
        }

        .metric-card.negative {
            border-left-color: #e74c3c;
            background: #fdf2f2;
        }

        .metric-card.neutral {
            border-left-color: #f39c12;
            background: #fffbf0;
        }

        .metric-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 5px;
        }

        .metric-label {
            font-size: 0.8rem;
            color: #7f8c8d;
            font-weight: 500;
        }

        .metric-team {
            font-size: 0.9rem;
            font-weight: 600;
            color: #2980b9;
            margin-bottom: 5px;
        }

        /* ìƒì„¸ í…Œì´ë¸” */
        .detail-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
            font-size: 0.85rem;
        }

        .detail-table th,
        .detail-table td {
            padding: 8px 6px;
            text-align: center;
            border: 1px solid #ecf0f1;
        }

        .detail-table th {
            background: #34495e;
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.2s ease;
            user-select: none;
            position: relative;
        }
        
        .detail-table th:hover {
            background: #2c3e50;
        }
        
        .detail-table th.sortable::after {
            content: ' â†•ï¸';
            font-size: 0.8rem;
            margin-left: 5px;
            opacity: 0.7;
        }
        
        .detail-table th.sort-asc::after {
            content: ' â¬†ï¸';
            opacity: 1;
        }
        
        .detail-table th.sort-desc::after {
            content: ' â¬‡ï¸';
            opacity: 1;
        }

        .detail-table .team-name {
            text-align: center !important;
            font-weight: 600;
        }

        .positive { color: #27ae60; font-weight: 600; }
        .negative { color: #e74c3c; font-weight: 600; }
        .neutral { color: #f39c12; font-weight: 600; }
        
        /* ìŠ¹-íŒ¨-ìŠ¹ë¥  ì…€ ìŠ¤íƒ€ì¼ ê°œì„  */
        .record-cell {
            text-align: center;
            padding: 8px 4px;
            font-size: 0.85rem;
            line-height: 1.3;
            border-radius: 4px;
            transition: all 0.2s ease;
        }
        
        .record-cell:hover {
            transform: scale(1.02);
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .record-cell .record {
            font-weight: 700;
            font-size: 0.9rem;
            margin-bottom: 2px;
            display: block;
        }
        
        .record-cell .rate {
            font-size: 0.8rem;
            font-weight: 600;
            opacity: 0.9;
            display: block;
            padding: 1px 4px;
            border-radius: 8px;
            background: rgba(255,255,255,0.7);
        }
        
        .record-cell .games {
            font-size: 0.7rem;
            color: #666;
            margin-top: 2px;
            display: block;
            opacity: 0.8;
        }

        /* ë§¤íŠ¸ë¦­ìŠ¤ í…Œì´ë¸” */
        .matrix-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.85rem;
            margin-top: 15px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .matrix-table th,
        .matrix-table td {
            padding: 10px 8px;
            text-align: center;
            border: 1px solid #e2e8f0;
            position: relative;
            min-width: 90px;
        }

        .matrix-table th {
            background: #34495e;
            color: white;
            font-weight: 600;
            font-size: 0.9rem;
            padding: 12px 8px;
        }

        .matrix-table td {
            background: white;
            transition: background-color 0.2s ease;
        }

        .matrix-table td:hover {
            background-color: #f8f9fa;
            transform: scale(1.02);
        }

        .matrix-record {
            font-weight: 600;
            font-size: 0.9rem;
            display: block;
            margin-bottom: 2px;
        }
        
        .matrix-cell-detailed {
            text-align: center;
            font-size: 0.85rem;
        }
        
        .matrix-details {
            margin-top: 4px;
            padding-top: 4px;
            border-top: 1px solid #eee;
        }
        
        .home-away-split {
            display: flex;
            justify-content: space-between;
            gap: 4px;
        }
        
        .home-record, .away-record {
            font-size: 0.75rem;
            padding: 1px 3px;
            border-radius: 3px;
            background: #f8f9fa;
            color: #666;
        }
        
        .home-record:hover, .away-record:hover {
            background: #e9ecef;
            color: #333;
        }

        .matrix-rate {
            font-size: 0.75rem;
            opacity: 0.8;
        }

        /* ì›”ë³„/ìš”ì¼ë³„ ê·¸ë¦¬ë“œ */
        .performance-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 20px;
            margin-top: 20px;
        }
        
        @media (max-width: 1400px) {
            .performance-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }
        
        @media (max-width: 900px) {
            .performance-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        @media (max-width: 600px) {
            .performance-grid {
                grid-template-columns: 1fr;
            }
        }

        .performance-item {
            background: white;
            border-radius: 15px;
        }
        
        .stadium-analysis-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            border: 1px solid #e1e8ed;
        }
        
        .stadium-team-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #f8f9fa;
        }
        
        .team-rank {
            background: #3498db;
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.85rem;
            font-weight: 600;
            margin-right: 10px;
        }
        
        .team-name-large {
            font-size: 1.2rem;
            font-weight: 700;
            color: #2c3e50;
        }

        .team-logo {
            width: 24px;
            height: 24px;
            margin-right: 8px;
            vertical-align: middle;
            border-radius: 3px;
        }

        .team-logo-small {
            width: 18px;
            height: 18px;
            margin-right: 5px;
            vertical-align: middle;
            border-radius: 2px;
        }
        
        #monthlyTable .team-logo-small {
            width: 16px;
            height: 16px;
            margin-right: 3px;
        }

        .team-name-with-logo {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .matrix-table .team-name-with-logo {
            gap: 3px;
            font-size: 0.85rem;
        }

        .weekly-table .team-name-with-logo, 
        .all-teams-table .team-name-with-logo {
            gap: 6px;
        }

        /* ì›”ë³„ í…Œì´ë¸” ìŠ¤íƒ€ì¼ ê°œì„  */
        #monthlyTable {
            border-collapse: collapse;
            font-size: 0.8rem;
            width: 100%;
        }

        #monthlyTable th,
        #monthlyTable td {
            border: 1px solid #e2e8f0;
            padding: 10px 8px;
            text-align: center;
        }
        
        #monthlyTable .stats-row {
            border-top: 2px solid #d1d5db;
        }
        
        #monthlyTable .stats-row:first-of-type {
            border-top: 3px solid #6b7280;
        }

        #monthlyTable th {
            background: #34495e;
            color: white;
            font-weight: 600;
            font-size: 0.9rem;
            white-space: nowrap;
        }

        #monthlyTable th:first-child {
            position: sticky;
            left: 0;
            z-index: 10;
            background: #34495e;
        }

        #monthlyTable td:first-child {
            position: sticky;
            left: 0;
            z-index: 9;
            background: inherit;
        }

        #monthlyTable .team-name-with-logo {
            gap: 2px;
            font-size: 0.75rem;
            white-space: nowrap;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }
        
        #monthlyTable th {
            white-space: nowrap;
            vertical-align: middle;
        }

        /* ì›”ë³„ í…Œì´ë¸” í†µê³„ í–‰ë“¤ ìŠ¤íƒ€ì¼ */
        #monthlyTable .stats-row {
            border-top: 2px solid #34495e;
        }

        #monthlyTable .stats-row td {
            border-color: #d1d5db;
            font-weight: 500;
            padding: 10px 8px;
            font-size: 0.85rem;
            text-align: center;
        }

        /* ì›”ë³„ í…Œì´ë¸” ë¼ë²¨ ì…€ (ì›”, í†µê³„ ë¼ë²¨) */
        #monthlyTable .month-label,
        #monthlyTable .stats-label {
            font-weight: 600;
            color: white;
            padding: 10px 8px;
            text-align: center;
        }

        #monthlyTable .month-label {
            background: #f8f9fa;
            color: #2d3748;
            font-size: 0.9rem;
            padding: 8px 6px;
        }

        #monthlyTable .stats-label {
            font-size: 0.85rem;
            padding: 8px 6px;
        }

        /* ì›”ë³„ í…Œì´ë¸” ë°ì´í„° ì…€ */
        #monthlyTable .month-data {
            font-size: 0.85rem;
            line-height: 1.3;
            padding: 8px 6px;
            text-align: center;
        }

        #monthlyTable .month-data .record {
            margin-bottom: 2px;
        }

        #monthlyTable .month-data .rate {
            font-weight: 600;
            font-size: 0.85rem;
        }
        
        /* ìƒˆë¡œìš´ ë¶„ë¦¬ëœ ì…€ ìŠ¤íƒ€ì¼ */
        #monthlyTable .month-record-cell {
            font-size: 0.85rem;
            font-weight: 600;
            text-align: center;
            padding: 8px 4px;
            background: rgba(248, 249, 250, 0.5);
            line-height: 1.3;
        }
        
        #monthlyTable .month-rate-cell {
            font-size: 0.9rem;
            font-weight: 700;
            text-align: center;
            padding: 8px 4px;
            line-height: 1.3;
        }

        /* ìš”ì¼ë³„ í…Œì´ë¸” ìŠ¤íƒ€ì¼ ê°œì„  */
        #weekdayTable th,
        #weekdayTable td {
            padding: 8px 6px;
            text-align: center;
            vertical-align: middle;
        }

        #weekdayTable .positive {
            background-color: rgba(34, 197, 94, 0.1);
            color: #059669;
            font-weight: 600;
        }

        #weekdayTable .negative {
            background-color: rgba(239, 68, 68, 0.1);
            color: #dc2626;
            font-weight: 600;
        }

        #weekdayTable .neutral {
            background-color: rgba(251, 191, 36, 0.1);
            color: #d97706;
            font-weight: 500;
        }

        /* ì›”ë³„ í…Œì´ë¸” ì¼ë°˜ ë°ì´í„° í–‰ */
        #monthlyTable tbody tr:not(.stats-row) td {
            background: white;
        }

        #monthlyTable tbody tr:not(.stats-row):hover td {
            background-color: #f8f9fa;
        }
        
        .home-away-summary {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .home-summary, .away-summary {
            flex: 1;
            text-align: center;
            padding: 12px;
            border-radius: 10px;
            background: #f8f9fa;
        }
        
        .location-label {
            font-size: 0.85rem;
            font-weight: 600;
            color: #666;
            margin-bottom: 5px;
        }
        
        .record-large {
            font-size: 1.1rem;
            font-weight: 700;
            margin-bottom: 3px;
        }
        
        .rate-large {
            font-size: 1rem;
            font-weight: 600;
            opacity: 0.8;
        }
        
        .stadium-highlights {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .best-stadium, .worst-stadium {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 0.9rem;
        }
        
        .best-stadium {
            background: #e8f5e8;
            border-left: 4px solid #27ae60;
        }
        
        .worst-stadium {
            background: #fdf2f2;
            border-left: 4px solid #e74c3c;
        }
        
        .highlight-label {
            font-weight: 600;
            min-width: 35px;
        }
        
        .stadium-name {
            font-weight: 600;
            color: #2c3e50;
            min-width: 50px;
        }
        
        .highlight-record {
            font-weight: 700;
            margin-left: auto;
        }
            padding: 25px;
            border: 1px solid #e0e0e0;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .performance-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(0,0,0,0.12);
        }

        .performance-team {
            font-size: 1.3rem;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 20px;
            text-align: center;
            padding-bottom: 10px;
            border-bottom: 3px solid #3498db;
        }

        .performance-detail {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid #f8f8f8;
            font-size: 0.9rem;
            line-height: 1.4;
            transition: all 0.2s ease;
        }

        .performance-detail:last-child {
            border-bottom: none;
        }
        
        .performance-detail:hover {
            background-color: #fafafa;
            border-radius: 6px;
            padding: 8px 6px;
        }

        .performance-period {
            font-weight: 600;
            color: #2c3e50;
            min-width: 80px;
            line-height: 1.3;
        }

        .performance-result {
            font-weight: 600;
            text-align: right;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .performance-wins {
            color: #2ecc71;
            font-size: 1rem;
        }

        .performance-losses {
            color: #e67e22;
            font-size: 1rem;
        }

        .performance-rate {
            background: #ecf0f1;
            padding: 3px 8px;
            border-radius: 10px;
            font-size: 0.8rem;
            font-weight: 700;
            margin-left: 6px;
        }

        .table-container {
            overflow-x: auto;
            margin-top: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .full-grid {
                grid-template-columns: 1fr;
            }
            
            .metrics-grid {
                grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            }
            
            .performance-grid {
                grid-template-columns: 1fr;
            }
            
            .detailed-game-table {
                font-size: 0.75rem;
            }
            
            .detailed-game-table th,
            .detailed-game-table td {
                padding: 6px 4px;
                border-left: none;
                border-right: none;
            }
            
            .detailed-game-table tr {
                border-bottom: 1px solid #e2e8f0;
            }
            
        }

        .section-divider {
            height: 4px;
            background: linear-gradient(90deg, #3498db, #2ecc71);
            border-radius: 2px;
            margin: 40px 0 20px 0;
        }

        .footer {
            text-align: center;
            padding: 30px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            margin-top: 30px;
            color: #7f8c8d;
        }

        .highlight {
            background: linear-gradient(120deg, #a8e6cf 0%, #dcedc8 100%);
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: 600;
        }

        /* í†µì¼ëœ í…Œì´ë¸” ìŠ¤íƒ€ì¼ - ê¸°ì¡´ í…Œì´ë¸”ê³¼ ë™ì¼í•œ ìŠ¤íƒ€ì¼ ì ìš© */

        .weekly-table, .game-record-table, .all-teams-table, .detailed-game-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.85rem;
            margin-top: 15px;
        }

        .weekly-table th, .weekly-table td,
        .game-record-table th, .game-record-table td,
        .all-teams-table th, .all-teams-table td,
        .detailed-game-table th, .detailed-game-table td {
            border: 1px solid #ecf0f1;
            padding: 8px 6px;
            text-align: center;
        }

        .weekly-table th, .game-record-table th, .detailed-game-table th {
            background: #34495e;
            color: white;
            font-weight: 600;
            position: sticky;
            top: 0;
        }

        .team-header, .team-header-column {
            background: #34495e !important;
            color: white !important;
            font-weight: bold;
        }

        .week-cell, .game-number-cell, .game-num-cell {
            font-weight: bold;
            background: #f8f9fa;
            color: #2c3e50;
            font-size: 0.85rem;
        }

        .date-cell {
            font-size: 0.8rem;
            white-space: nowrap;
            color: #2c3e50;
            padding: 8px 12px;
            text-align: center;
            background: #f8f9fa;
        }

        .team-stats {
            padding: 8px 6px;
        }

        .record {
            font-weight: bold;
            font-size: 0.85rem;
        }

        .win-rate {
            font-size: 0.75rem;
            color: #718096;
            margin-top: 3px;
        }

        .team-selector {
            text-align: center;
            margin: 15px 0;
        }

        .team-selector select {
            padding: 8px 16px;
            font-size: 14px;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            background: white;
        }

        .streak-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            background: #f8fafc;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }

        .streak-item {
            text-align: center;
        }

        .streak-label {
            display: block;
            font-size: 0.8rem;
            color: #718096;
            margin-bottom: 5px;
        }

        .streak-value {
            display: block;
            font-size: 1.1rem;
            font-weight: 600;
        }

        .win-streak {
            color: #38a169;
        }

        .lose-streak {
            color: #e53e3e;
        }


        .result-badge {
            padding: 4px 8px;
            border-radius: 8px;
            font-size: 0.75rem;
            font-weight: 600;
            color: white;
            box-shadow: 0 1px 3px rgba(0,0,0,0.2);
        }

        .result-badge.w {
            background: #27ae60;
        }

        .result-badge.l {
            background: #e74c3c;
        }

        .result-badge.d {
            background: #f39c12;
        }

        /* ëª¨ë“  íŒ€ ê²Œì„ í…Œì´ë¸” ìŠ¤íƒ€ì¼ */
        .all-teams-game-table {
            background: #f8fafc;
            border-radius: 12px;
            padding: 20px;
        }

        .all-teams-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.8rem;
        }

        .all-teams-table th,
        .all-teams-table td {
            border: 1px solid #e2e8f0;
            padding: 6px;
            text-align: center;
            min-width: 40px;
        }

        .all-teams-table th {
            background: #2c3e50;
            font-weight: 700;
            color: white;
            position: sticky;
            top: 0;
            z-index: 5;
            text-shadow: 0 1px 2px rgba(0,0,0,0.3);
        }

        .team-header-column {
            background: #1a365d !important;
            color: white !important;
            font-weight: 900;
            font-size: 0.9rem;
            text-shadow: 0 1px 2px rgba(0,0,0,0.4);
        }

        .game-number-cell {
            font-weight: bold;
            background: #fff3e0;
            font-size: 0.75rem;
        }

        .game-result-cell {
            position: relative;
            padding: 4px;
            font-weight: 600;
            font-size: 0.75rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .game-result-cell:hover {
            transform: scale(1.1);
            z-index: 2;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }

        .cell-win, .win-row {
            background: #d5fdd5;
            color: #27ae60;
        }

        .cell-loss, .loss-row {
            background: #f8d7da;
            color: #e74c3c;
        }

        .cell-draw, .draw-row {
            background: #fff3cd;
            color: #856404;
        }

        .cell-empty {
            background: #f8fafc;
            color: #9ca3af;
        }

        .result-display {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1px;
        }

        .streak-number {
            font-size: 1.1rem;
            font-weight: 900;
            line-height: 1;
        }

        .result-letter {
            font-size: 0.6rem;
            font-weight: 500;
            opacity: 0.7;
        }

        .legend {
            background: white;
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        .legend-item {
            display: flex;
            align-items: center;
            font-size: 0.9rem;
            color: #4a5568;
        }

        /* íŒ€ë³„ ìƒì„¸ ê¸°ë¡ ìŠ¤íƒ€ì¼ */
        .team-detailed-records {
            background: #f8fafc;
            border-radius: 12px;
            padding: 20px;
        }

        .team-stats-summary {
            background: white;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
        }

        .stat-card {
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            border: 1px solid #e2e8f0;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .stat-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 16px rgba(0,0,0,0.1);
        }

        .stat-title {
            font-size: 0.8rem;
            color: #718096;
            margin-bottom: 8px;
            font-weight: 500;
        }

        .stat-number {
            font-size: 1.4rem;
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 4px;
        }

        .stat-subtitle {
            font-size: 0.75rem;
            color: #a0aec0;
            font-weight: 400;
        }

        .win-color {
            color: #38a169 !important;
        }

        .loss-color {
            color: #e53e3e !important;
        }

        .detailed-game-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            font-size: 0.85rem;
        }

        .detailed-game-table th,
        .detailed-game-table td {
            border: 1px solid #e2e8f0;
            padding: 10px 8px;
            text-align: center;
            vertical-align: middle;
            white-space: nowrap;
        }

        .detailed-game-table th {
            background: #f8fafc;
            font-weight: 600;
            color: #2d3748;
            position: sticky;
            top: 0;
            z-index: 5;
        }

        .detailed-game-table th.sortable {
            cursor: pointer;
            user-select: none;
            transition: all 0.2s ease;
        }

        .detailed-game-table th.sortable:hover {
            background: #e2e8f0;
            transform: translateY(-1px);
        }

        .game-num-cell {
            font-weight: bold;
            background: #fff3e0;
            color: #d97706;
        }

        .date-cell {
            font-size: 0.75rem;
            color: #4a5568;
        }

        .opponent-cell {
            font-weight: 600;
            color: #2d3748;
        }

        .venue-cell {
            font-size: 0.8rem;
            color: #718096;
        }

        .score-cell {
            font-family: 'Monaco', 'Consolas', monospace;
            font-weight: bold;
            font-size: 0.9rem;
        }

        .runs-cell {
            font-weight: 600;
        }

        .diff-cell {
            font-weight: 700;
            font-size: 0.9rem;
        }

        .diff-cell.positive {
            color: #27ae60;
            font-weight: 600;
        }

        .diff-cell.negative {
            color: #e74c3c;
            font-weight: 600;
        }

        .diff-cell.neutral {
            color: #34495e;
        }

    </style>
</head>
<body>
    <div class="container">
        <!-- í—¤ë” -->
        <div class="header">
            <h1>ğŸ† KBO 2025 ì¢…í•© ë¶„ì„ ëŒ€ì‹œë³´ë“œ</h1>
            <p class="subtitle">í”¼íƒ€ê³ ë¦¬ì•ˆ ê¸°ëŒ€ìŠ¹ë¥ , í´ëŸ¬ì¹˜ ìƒí™©, í™ˆ ì–´ë“œë°´í‹°ì§€ ë“± 15ê°€ì§€ í™•ì¥ ì§€í‘œ ì™„ì „ ë¶„ì„</p>
            <div class="update-info" id="updateInfo">
                ğŸ“… ë°ì´í„° ì—…ë°ì´íŠ¸ ì¤‘...
            </div>
        </div>

        <!-- 1. ì¢…í•© ìˆœìœ„í‘œ (ì „ì²´ ì§€í‘œ) -->
        <div class="card">
            <div class="card-header">
                <span class="card-icon">ğŸ†</span>
                <h2 class="card-title">ì¢…í•© ìˆœìœ„ - ì „ì²´ ì§€í‘œ</h2>
            </div>
            <div class="table-container">
                <table class="full-standings-table" id="fullStandingsTable">
                    <thead>
                        <tr>
                            <th>ìˆœìœ„</th>
                            <th>íŒ€</th>
                            <th>ê²½ê¸°</th>
                            <th>ìŠ¹</th>
                            <th>ë¬´</th>
                            <th>íŒ¨</th>
                            <th>ìŠ¹ë¥ </th>
                            <th>ê²Œì„ì°¨</th>
                            <th>ë“ì </th>
                            <th>ì‹¤ì </th>
                            <th>ë“ì‹¤ì°¨</th>
                            <th>PìŠ¹ë¥ </th>
                            <th>ìš´ì§€ìˆ˜</th>
                            <th>1ì ì°¨ìŠ¹ë¥ </th>
                            <th>í™ˆìŠ¹ë¥ </th>
                            <th>ì›ì •ìŠ¹ë¥ </th>
                            <th>í™ˆìš°ìœ„</th>
                            <th>ì—°ìŠ¹íŒ¨</th>
                            <th>ìµœëŒ€ì—°ìŠ¹</th>
                            <th>ìµœëŒ€ì—°íŒ¨</th>
                        </tr>
                    </thead>
                    <tbody id="fullStandingsBody">
                        <!-- ë™ì ìœ¼ë¡œ ìƒì„± -->
                    </tbody>
                </table>
            </div>
        </div>

        <div class="section-divider"></div>

        <!-- 2. í”¼íƒ€ê³ ë¦¬ì•ˆ & ìš´ ë¶„ì„ -->
        <div class="card">
            <div class="card-header">
                <span class="card-icon">âš¡</span>
                <h2 class="card-title">í”¼íƒ€ê³ ë¦¬ì•ˆ ê¸°ëŒ€ìŠ¹ë¥  & ìš´ ì§€ìˆ˜ ë¶„ì„</h2>
            </div>
            <div class="table-container">
                <table class="detail-table" id="pythagoreanTable">
                    <thead>
                        <tr>
                            <th>íŒ€</th>
                            <th>ì‹¤ì œìŠ¹ë¥ </th>
                            <th>í”¼íƒ€ê³ ë¦¬ì•ˆ ê¸°ëŒ€ìŠ¹ë¥ </th>
                            <th>ìš´ ì§€ìˆ˜</th>
                            <th>ìš´ ìƒíƒœ</th>
                            <th>ë“ì </th>
                            <th>ì‹¤ì </th>
                            <th>ê²½ê¸°ë‹¹ ë“ì </th>
                            <th>ê²½ê¸°ë‹¹ ì‹¤ì </th>
                        </tr>
                    </thead>
                    <tbody id="pythagoreanBody">
                        <!-- ë™ì ìœ¼ë¡œ ìƒì„± -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- 3. í´ëŸ¬ì¹˜ ìƒí™© ë¶„ì„ -->
        <div class="card">
            <div class="card-header">
                <span class="card-icon">ğŸ¯</span>
                <h2 class="card-title">í´ëŸ¬ì¹˜ ìƒí™© ì™„ì „ ë¶„ì„</h2>
            </div>
            <div class="table-container">
                <table class="detail-table" id="clutchTable">
                    <thead>
                        <tr>
                            <th>íŒ€</th>
                            <th>1ì ì°¨ ìŠ¹</th>
                            <th>1ì ì°¨ íŒ¨</th>
                            <th>1ì ì°¨ ìŠ¹ë¥ </th>
                            <th>ëŒ€ëŸ‰ë“ì ìŠ¹</th>
                            <th>ëŒ€ëŸ‰ì‹¤ì íŒ¨</th>
                            <th>ì™„ë´‰ìŠ¹</th>
                            <th>ì™„ë´‰íŒ¨</th>
                            <th>ì ‘ì „ê²½ê¸° ë¹„ì¤‘</th>
                        </tr>
                    </thead>
                    <tbody id="clutchBody">
                        <!-- ë™ì ìœ¼ë¡œ ìƒì„± -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- 4. í™ˆ/ì›ì • ìƒì„¸ ë¶„ì„ -->
        <div class="card">
            <div class="card-header">
                <span class="card-icon">ğŸŸï¸</span>
                <h2 class="card-title">í™ˆ/ì›ì • ìƒì„¸ ë¶„ì„</h2>
            </div>
            <div class="table-container">
                <table class="detail-table" id="homeAwayTable">
                    <thead>
                        <tr>
                            <th>íŒ€</th>
                            <th>í™ˆ ê²½ê¸°</th>
                            <th>í™ˆ ìŠ¹</th>
                            <th>í™ˆ íŒ¨</th>
                            <th>í™ˆ ìŠ¹ë¥ </th>
                            <th>ì›ì • ê²½ê¸°</th>
                            <th>ì›ì • ìŠ¹</th>
                            <th>ì›ì • íŒ¨</th>
                            <th>ì›ì • ìŠ¹ë¥ </th>
                            <th>í™ˆ ì–´ë“œë°´í‹°ì§€</th>
                            <th>í™ˆêµ¬ì¥</th>
                        </tr>
                    </thead>
                    <tbody id="homeAwayBody">
                        <!-- ë™ì ìœ¼ë¡œ ìƒì„± -->
                    </tbody>
                </table>
            </div>
        </div>

        <div class="section-divider"></div>

        <!-- 5. ìƒëŒ€ì „ì  ë§¤íŠ¸ë¦­ìŠ¤ -->
        <div class="card">
            <div class="card-header">
                <span class="card-icon">âš”ï¸</span>
                <h2 class="card-title">íŒ€ê°„ ìƒëŒ€ì „ì  ë§¤íŠ¸ë¦­ìŠ¤</h2>
            </div>
            <div class="table-container">
                <div id="matrixContent">
                    <!-- ë™ì ìœ¼ë¡œ ìƒì„± -->
                </div>
            </div>
        </div>

        <!-- 6. ì›”ë³„ ì„±ì  ì™„ì „ ë¶„ì„ -->
        <div class="card">
            <div class="card-header">
                <span class="card-icon">ğŸ“Š</span>
                <h2 class="card-title">ì›”ë³„ ì„±ì  ì™„ì „ ë¶„ì„</h2>
            </div>
            <div class="table-container">
                <table class="detail-table" id="monthlyTable">
                    <thead id="monthlyTableHead">
                        <!-- ë™ì ìœ¼ë¡œ ìƒì„± -->
                    </thead>
                    <tbody id="monthlyBody">
                        <!-- ë™ì ìœ¼ë¡œ ìƒì„± -->
                    </tbody>
                </table>
            </div>
            
            <!-- ì›”ë³„ ì„±ì  ë¶„ì„ ë²”ë¡€ -->
            <div style="margin-top: 15px; padding: 15px; background: rgba(248, 249, 250, 0.8); border-radius: 8px; border: 1px solid #e2e8f0;">
                <div style="font-size: 0.9rem; font-weight: 600; margin-bottom: 10px; color: #374151;">ğŸ“‹ ë²”ë¡€</div>
                <div style="display: flex; gap: 25px; flex-wrap: wrap; font-size: 0.8rem;">
                    <div style="display: flex; align-items: center; gap: 8px;">
                        <div style="width: 20px; height: 16px; border: 2px solid #059669; background: white; border-radius: 3px;"></div>
                        <span style="color: #059669; font-weight: 600;">ìµœê³  ì„±ì  ì›”</span>
                        <span style="color: #6b7280;">(íŒ€ë³„ ìµœê³  ìŠ¹ë¥ )</span>
                    </div>
                    <div style="display: flex; align-items: center; gap: 8px;">
                        <div style="width: 20px; height: 16px; border: 2px solid #dc2626; background: white; border-radius: 3px;"></div>
                        <span style="color: #dc2626; font-weight: 600;">ìµœì € ì„±ì  ì›”</span>
                        <span style="color: #6b7280;">(íŒ€ë³„ ìµœì € ìŠ¹ë¥ )</span>
                    </div>
                </div>
                <div style="margin-top: 8px; font-size: 0.75rem; color: #6b7280;">
                    ğŸ’¡ ê° íŒ€ì˜ ì›”ë³„ ì„±ì  ì¤‘ ê°€ì¥ ì¢‹ì•˜ë˜ ë‹¬ê³¼ ê°€ì¥ ì•„ì‰¬ì› ë˜ ë‹¬ì´ í…Œë‘ë¦¬ë¡œ í‘œì‹œë©ë‹ˆë‹¤.
                </div>
            </div>
        </div>

        <!-- 7. ìš”ì¼ë³„ ì„±ì  ì™„ì „ ë¶„ì„ -->
        <div class="card">
            <div class="card-header">
                <span class="card-icon">ğŸ“…</span>
                <h2 class="card-title">ìš”ì¼ë³„ ì„±ì  ì™„ì „ ë¶„ì„</h2>
            </div>
            <div class="table-container">
                <table class="detail-table" id="weekdayTable">
                    <thead>
                        <tr>
                            <th>ìˆœìœ„</th>
                            <th>íŒ€</th>
                            <th>ì›”ìš”ì¼</th>
                            <th>í™”ìš”ì¼</th>
                            <th>ìˆ˜ìš”ì¼</th>
                            <th>ëª©ìš”ì¼</th>
                            <th>ê¸ˆìš”ì¼</th>
                            <th>í† ìš”ì¼</th>
                            <th>ì¼ìš”ì¼</th>
                            <th>ì£¼ë§ìŠ¹ë¥ </th>
                            <th>í‰ì¼ìŠ¹ë¥ </th>
                        </tr>
                    </thead>
                    <tbody id="weekdayBody">
                        <!-- ë™ì ìœ¼ë¡œ ìƒì„± -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- 8. ì£¼ì°¨ë³„ ì„±ì  ë¶„ì„ -->
        <div class="card">
            <div class="card-header">
                <span class="card-icon">ğŸ“…</span>
                <h2 class="card-title">ì£¼ì°¨ë³„ ì„±ì  ë¶„ì„</h2>
            </div>
            <div id="weeklyStatsContent">
                <div style="text-align: center; padding: 40px; color: #666;">
                    ë°ì´í„°ë¥¼ ë¡œë“œí•˜ê³  ìˆìŠµë‹ˆë‹¤...
                </div>
            </div>
        </div>

        <!-- 9. ê²Œì„ë³„ ê¸°ë¡ ë¶„ì„ -->
        <div class="card">
            <div class="card-header">
                <span class="card-icon">ğŸ†</span>
                <h2 class="card-title">ê²Œì„ë³„ ê¸°ë¡ & ì—°ìŠ¹/ì—°íŒ¨ ë¶„ì„</h2>
            </div>
            <div id="gameRecordsContent">
                <div style="text-align: center; padding: 40px; color: #666;">
                    ë°ì´í„°ë¥¼ ë¡œë“œí•˜ê³  ìˆìŠµë‹ˆë‹¤...
                </div>
            </div>
        </div>

        <!-- 10. íŒ€ë³„ ìƒì„¸ ê²Œì„ ê¸°ë¡ -->
        <div class="card">
            <div class="card-header">
                <span class="card-icon">ğŸ“‹</span>
                <h2 class="card-title">íŒ€ë³„ ìƒì„¸ ê²Œì„ ê¸°ë¡</h2>
            </div>
            <div id="teamDetailedRecordsContent">
                <div style="text-align: center; padding: 40px; color: #666;">
                    ë°ì´í„°ë¥¼ ë¡œë“œí•˜ê³  ìˆìŠµë‹ˆë‹¤...
                </div>
            </div>
        </div>

        <!-- 11. ê²½ê¸°ì¥ë³„ ì„±ì  ì™„ì „ ë¶„ì„ -->
        <div class="card">
            <div class="card-header">
                <span class="card-icon">ğŸŸï¸</span>
                <h2 class="card-title">ê²½ê¸°ì¥ë³„ ì„±ì  ì™„ì „ ë¶„ì„</h2>
            </div>
            <div class="table-container">
                <table class="detail-table" id="stadiumTable">
                    <thead id="stadiumTableHead">
                        <!-- ë™ì ìœ¼ë¡œ ìƒì„± -->
                    </thead>
                    <tbody id="stadiumTableBody">
                        <!-- ë™ì ìœ¼ë¡œ ìƒì„± -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- í‘¸í„° -->
        <div class="footer">
            <p>ğŸ¤– <span class="highlight">KBO 2025 ì¢…í•© ë¶„ì„ ëŒ€ì‹œë³´ë“œ</span></p>
            <p style="margin-top: 10px; font-size: 0.9rem;">í”¼íƒ€ê³ ë¦¬ì•ˆ ê¸°ëŒ€ìŠ¹ë¥  | í´ëŸ¬ì¹˜ ì§€ìˆ˜ | í™ˆ ì–´ë“œë°´í‹°ì§€ | ìƒëŒ€ì „ì  ë§¤íŠ¸ë¦­ìŠ¤ | ì›”ë³„/ìš”ì¼ë³„/ê²½ê¸°ì¥ë³„ ì„±ì  | 15ê°€ì§€ ê³ ê¸‰ ì§€í‘œ</p>
        </div>
    </div>

    <script>
        let dashboardData = null;
        let weeklyAnalysisData = null;
        let gameRecordsData = null;
        let currentSelectedTeam = 'LG';

        // íŒ€ ë¡œê³  ë§¤í•‘ (í†µí•©)
        const teamLogos = {
            'LG': 'magic-number/images/lg.png',
            'KIA': 'magic-number/images/kia.png',
            'SSG': 'magic-number/images/ssg.png',
            'ë‘ì‚°': 'magic-number/images/doosan.png',
            'ì‚¼ì„±': 'magic-number/images/samsung.png',
            'KT': 'magic-number/images/kt.png',
            'NC': 'magic-number/images/nc.png',
            'ë¡¯ë°': 'magic-number/images/lotte.png',
            'í‚¤ì›€': 'magic-number/images/kiwoom.png',
            'í•œí™”': 'magic-number/images/hanwha.png'
        };

        // íŒ€ëª…ê³¼ ë¡œê³ ë¥¼ í•¨ê»˜ í‘œì‹œí•˜ëŠ” í•¨ìˆ˜ (í†µí•©)
        function getTeamWithLogo(teamName, className = 'team-logo-small') {
            const logoPath = teamLogos[teamName];
            if (logoPath) {
                return `<span class="team-name-with-logo">
                    <img src="${logoPath}" 
                         alt="${teamName}" 
                         class="${className}" 
                         style="width: 20px; height: 20px; margin-right: 5px; vertical-align: middle;"
                         onerror="this.style.display='none'; console.warn('ë¡œê³  ë¡œë“œ ì‹¤íŒ¨:', '${teamName}', '${logoPath}');">
                    ${teamName}
                </span>`;
            }
            console.warn('íŒ€ ë¡œê³  ë§¤í•‘ ì—†ìŒ:', teamName);
            return `<span>${teamName}</span>`;
        }

        // ë°ì´í„° ë¡œë“œ
        async function loadDashboardData() {
            try {
                console.log('ğŸ”„ ë°ì´í„° ë¡œë“œ ì‹œì‘...');
                const response = await fetch('magic-number/data/enhanced-dashboard.json');
                console.log('ğŸ“¡ Fetch ì‘ë‹µ:', response.status, response.ok);
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                dashboardData = await response.json();
                console.log('ğŸ“Š ëŒ€ì‹œë³´ë“œ ë°ì´í„° ë¡œë“œ ì™„ë£Œ:', {
                    standings: dashboardData.standings?.length || 0,
                    weekdayPerformance: Object.keys(dashboardData.weekdayPerformance || {}).length,
                    stadiumRecords: Object.keys(dashboardData.stadiumRecords || {}).length
                });
                
                console.log('ğŸ¯ renderDashboard í˜¸ì¶œ ì‹œì‘');
                renderDashboard();
                console.log('âœ… ëª¨ë“  ë°ì´í„° ë¡œë“œ ë° ë Œë”ë§ ì™„ë£Œ');
                return Promise.resolve();
            } catch (error) {
                console.error('âŒ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:', error);
                document.getElementById('updateInfo').textContent = 'âŒ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨: ' + error.message;
                return Promise.reject(error);
            }
        }

        // ì£¼ì°¨ë³„ ë¶„ì„ ë°ì´í„° ë¡œë“œ
        async function loadWeeklyAnalysisData() {
            try {
                console.log('ğŸ”„ ì£¼ì°¨ë³„/ê²Œì„ë³„/íŒ€ë³„ ë°ì´í„° ë¡œë“œ ì‹œì‘...');
                
                const [weeklyResponse, recordsResponse] = await Promise.all([
                    fetch('magic-number/data/weekly-analysis.json'),
                    fetch('magic-number/data/game-by-game-records.json')
                ]);
                
                console.log('ğŸ“¡ ì£¼ì°¨ë³„ ë°ì´í„° ì‘ë‹µ:', weeklyResponse.status, weeklyResponse.ok);
                console.log('ğŸ“¡ ê²Œì„ë³„ ë°ì´í„° ì‘ë‹µ:', recordsResponse.status, recordsResponse.ok);
                
                if (!weeklyResponse.ok) {
                    throw new Error(`ì£¼ì°¨ë³„ ë°ì´í„° HTTP ${weeklyResponse.status}: ${weeklyResponse.statusText}`);
                }
                if (!recordsResponse.ok) {
                    throw new Error(`ê²Œì„ë³„ ë°ì´í„° HTTP ${recordsResponse.status}: ${recordsResponse.statusText}`);
                }
                
                weeklyAnalysisData = await weeklyResponse.json();
                gameRecordsData = await recordsResponse.json();
                
                console.log('ğŸ“Š ì£¼ì°¨ë³„ ë°ì´í„° í‚¤:', Object.keys(weeklyAnalysisData));
                console.log('ğŸ“Š ê²Œì„ë³„ ë°ì´í„° í‚¤:', Object.keys(gameRecordsData));
                
                // ê°ê° ê°œë³„ ë Œë”ë§
                console.log('ğŸ¯ renderWeeklyTable í˜¸ì¶œ');
                renderWeeklyTable();
                
                console.log('ğŸ¯ renderGameByGameTable í˜¸ì¶œ');
                renderGameByGameTable();
                
                console.log('ğŸ¯ renderTeamDetailedRecords í˜¸ì¶œ');
                renderTeamDetailedRecords();
                
                console.log('âœ… ëª¨ë“  ì£¼ì°¨ë³„/ê²Œì„ë³„/íŒ€ë³„ ë°ì´í„° ë Œë”ë§ ì™„ë£Œ');
                
            } catch (error) {
                console.error('âŒ ì£¼ì°¨ë³„ ë¶„ì„ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:', error);
                document.getElementById('weeklyStatsContent').innerHTML = 
                    `<div style="text-align: center; padding: 40px; color: #e53e3e;">âŒ ì£¼ì°¨ë³„ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨: ${error.message}</div>`;
                document.getElementById('gameRecordsContent').innerHTML = 
                    `<div style="text-align: center; padding: 40px; color: #e53e3e;">âŒ ê²Œì„ë³„ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨: ${error.message}</div>`;
                document.getElementById('teamDetailedRecordsContent').innerHTML = 
                    `<div style="text-align: center; padding: 40px; color: #e53e3e;">âŒ íŒ€ë³„ ìƒì„¸ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨: ${error.message}</div>`;
            }
        }

        // ëŒ€ì‹œë³´ë“œ ë Œë”ë§
        function renderDashboard() {
            if (!dashboardData) {
                console.error('âŒ dashboardDataê°€ ì—†ìŠµë‹ˆë‹¤');
                return;
            }

            console.log('ğŸ“Š ëŒ€ì‹œë³´ë“œ ë Œë”ë§ ì‹œì‘');
            
            // ì—…ë°ì´íŠ¸ ì •ë³´
            document.getElementById('updateInfo').textContent = 
                `ğŸ“… ${dashboardData.updateDate} ì—…ë°ì´íŠ¸`;

            console.log('1ï¸âƒ£ renderFullStandings í˜¸ì¶œ');
            try { renderFullStandings(); } catch(e) { console.error('renderFullStandings ì˜¤ë¥˜:', e); }
            
            console.log('2ï¸âƒ£ renderPythagoreanFullAnalysis í˜¸ì¶œ');
            try { renderPythagoreanFullAnalysis(); } catch(e) { console.error('renderPythagoreanFullAnalysis ì˜¤ë¥˜:', e); }
            
            console.log('3ï¸âƒ£ renderClutchFullAnalysis í˜¸ì¶œ');
            try { renderClutchFullAnalysis(); } catch(e) { console.error('renderClutchFullAnalysis ì˜¤ë¥˜:', e); }
            
            console.log('4ï¸âƒ£ renderHomeAwayFullAnalysis í˜¸ì¶œ');
            try { renderHomeAwayFullAnalysis(); } catch(e) { console.error('renderHomeAwayFullAnalysis ì˜¤ë¥˜:', e); }
            
            console.log('5ï¸âƒ£ renderHeadToHeadMatrix í˜¸ì¶œ');
            try { renderHeadToHeadMatrix(); } catch(e) { console.error('renderHeadToHeadMatrix ì˜¤ë¥˜:', e); }
            
            console.log('6ï¸âƒ£ renderMonthlyFullAnalysis í˜¸ì¶œ');
            try { renderMonthlyFullAnalysis(); } catch(e) { console.error('renderMonthlyFullAnalysis ì˜¤ë¥˜:', e); }
            
            console.log('7ï¸âƒ£ renderWeekdayFullAnalysis í˜¸ì¶œ');
            try { renderWeekdayFullAnalysis(); } catch(e) { console.error('renderWeekdayFullAnalysis ì˜¤ë¥˜:', e); }
            
            console.log('8ï¸âƒ£ renderStadiumFullAnalysis í˜¸ì¶œ');
            try { renderStadiumFullAnalysis(); } catch(e) { console.error('renderStadiumFullAnalysis ì˜¤ë¥˜:', e); }
            
            console.log('âœ… ëŒ€ì‹œë³´ë“œ ë Œë”ë§ ì™„ë£Œ');
        }

        // íŒ€ ë³€ê²½
        function changeSelectedTeam(team) {
            currentSelectedTeam = team;
            renderTeamDetailedRecords();
        }

        // ì£¼ì°¨ë³„ ì„±ì  í…Œì´ë¸” ë Œë”ë§
        function renderWeeklyTable() {
            if (!weeklyAnalysisData) return;

            const weeks = Object.keys(weeklyAnalysisData).sort();
            const teams = ['LG', 'í•œí™”', 'KIA', 'ì‚¼ì„±', 'KT', 'SSG', 'ë¡¯ë°', 'ë‘ì‚°', 'NC', 'í‚¤ì›€'];

            // ì‹œì¦Œ ì‹œì‘ ì£¼ì°¨ ê³„ì‚° (3ì›” ë§ˆì§€ë§‰ ì£¼ë¥¼ 1ì£¼ì°¨ë¡œ)
            const seasonStartWeek = Math.min(...weeks.map(w => parseInt(w.split('-W')[1])));

            let html = `
            <div class="table-container" style="overflow-x: auto;">
                <table class="weekly-table">
                    <thead>
                        <tr>
                            <th rowspan="2" style="min-width: 60px;">ì£¼ì°¨</th>
                            <th rowspan="2" style="min-width: 120px;">ê¸°ê°„</th>
                            <th colspan="${teams.length}">íŒ€ë³„ ì„±ì  (ìŠ¹-íŒ¨-ë¬´ / ìŠ¹ë¥ )</th>
                        </tr>
                        <tr>
                            ${teams.map(team => `<th class="team-header">${getTeamWithLogo(team, 'team-logo-small')}</th>`).join('')}
                        </tr>
                    </thead>
                    <tbody>`;

            weeks.forEach((week, index) => {
                const weekData = weeklyAnalysisData[week];
                const weekNumber = index + 1; // 1ì£¼ì°¨ë¶€í„° ì‹œì‘
                
                // ë‚ ì§œë¥¼ ìš”ì¼ê³¼ í•¨ê»˜ í¬ë§·
                const startDate = new Date(weekData.startDate);
                const endDate = new Date(weekData.endDate);
                const startDayName = ['ì¼', 'ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ', 'í† '][startDate.getDay()];
                const endDayName = ['ì¼', 'ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ', 'í† '][endDate.getDay()];
                
                const dateRange = `${weekData.startDate}(${startDayName}) ~ ${weekData.endDate}(${endDayName})`;
                
                html += `
                    <tr>
                        <td class="week-cell">${weekNumber}ì£¼ì°¨</td>
                        <td class="date-cell">${dateRange}</td>
                        ${teams.map(team => {
                            const stats = weekData.teams[team];
                            const winRate = stats.games > 0 ? (stats.wins / (stats.wins + stats.losses) * 100).toFixed(1) : '0.0';
                            const bgColor = getWinRateColor(parseFloat(winRate));
                            return `
                                <td class="team-stats" style="background-color: ${bgColor};">
                                    <div class="record">${stats.wins}-${stats.losses}-${stats.draws}</div>
                                    <div class="win-rate">${winRate}%</div>
                                </td>
                            `;
                        }).join('')}
                    </tr>`;
            });

            html += `</tbody></table></div>`;
            document.getElementById('weeklyStatsContent').innerHTML = html;
        }

        // ê²Œì„ë³„ ê¸°ë¡ í…Œì´ë¸” ë Œë”ë§ (ëª¨ë“  íŒ€ ë™ì‹œ í‘œì‹œ)
        function renderGameByGameTable() {
            if (!gameRecordsData) return;

            const teams = ['LG', 'í•œí™”', 'KIA', 'ì‚¼ì„±', 'KT', 'SSG', 'ë¡¯ë°', 'ë‘ì‚°', 'NC', 'í‚¤ì›€'];
            
            // ìµœëŒ€ ê²½ê¸° ìˆ˜ ê³„ì‚°
            const maxGames = Math.max(...teams.map(team => gameRecordsData[team]?.games.length || 0));
            
            let html = `
            <div class="all-teams-game-table">
                <h3 style="text-align: center; margin-bottom: 20px; color: #2d3748;">ğŸ† ì „ì²´ íŒ€ ê²Œì„ë³„ ìŠ¹íŒ¨ ê¸°ë¡</h3>
                <div style="text-align: center; margin-bottom: 15px; font-size: 0.9rem; color: #666;">
                    ğŸ’¡ ì—°ìŠ¹/ì—°íŒ¨ê°€ ì´ì–´ì§ˆ ë•Œë§ˆë‹¤ ìˆ«ìë¡œ í‘œì‹œë©ë‹ˆë‹¤ (ì˜ˆ: 1ìŠ¹â†’2ìŠ¹â†’3ìŠ¹ ë˜ëŠ” 1íŒ¨â†’2íŒ¨â†’3íŒ¨)
                </div>
                <div class="table-container" style="overflow-x: auto; max-height: 700px; overflow-y: auto;">
                    <table class="all-teams-table">
                        <thead>
                            <tr>
                                <th style="position: sticky; left: 0; z-index: 15; background: #2c3e50; top: 0;">ê²½ê¸°#</th>
                                ${teams.map(team => `<th class="team-header-column" style="position: sticky; top: 0; z-index: 10;">${getTeamWithLogo(team, 'team-logo-small')}</th>`).join('')}
                            </tr>
                        </thead>
                        <tbody>`;

            // ê° ê²½ê¸°ë³„ë¡œ í–‰ ìƒì„±
            for (let gameNum = 1; gameNum <= maxGames; gameNum++) {
                html += `<tr>
                    <td class="game-number-cell" style="position: sticky; left: 0; z-index: 5; background: #f8f9fa; font-weight: bold;">${gameNum}</td>`;
                
                teams.forEach(team => {
                    const teamRecord = gameRecordsData[team];
                    const game = teamRecord?.games[gameNum - 1];
                    
                    if (game) {
                        // í˜„ì¬ ê²Œì„ì—ì„œì˜ ì—°ìŠ¹/ì—°íŒ¨ ì¹´ìš´íŠ¸ ê³„ì‚°
                        const streakInfo = calculateStreakAtGame(teamRecord.games, gameNum - 1);
                        const streakNumber = streakInfo.count > 0 ? streakInfo.count : '';
                        
                        html += `
                        <td class="game-result-cell ${game.result === 'W' ? 'cell-win' : game.result === 'L' ? 'cell-loss' : 'cell-draw'}" 
                            title="${team} vs ${game.opponent} (${game.score}) - ${game.date}">
                            <div class="result-display">
                                ${streakNumber ? `<span class="streak-number">${streakNumber}</span>` : ''}
                                <span class="result-letter">${game.result}</span>
                            </div>
                        </td>`;
                    } else {
                        html += `<td class="game-result-cell cell-empty">-</td>`;
                    }
                });
                
                html += `</tr>`;
            }

            html += `
                        </tbody>
                    </table>
                </div>
                
                <div class="legend" style="margin-top: 20px; text-align: center;">
                    <h4 style="margin-bottom: 10px; color: #2d3748;">ë²”ë¡€</h4>
                    <div style="display: flex; justify-content: center; gap: 20px; flex-wrap: wrap;">
                        <div class="legend-item">
                            <span class="legend-color cell-win" style="display: inline-block; width: 20px; height: 20px; border-radius: 4px; margin-right: 5px; vertical-align: middle;"></span>
                            <span>ìŠ¹ë¦¬ (W)</span>
                        </div>
                        <div class="legend-item">
                            <span class="legend-color cell-loss" style="display: inline-block; width: 20px; height: 20px; border-radius: 4px; margin-right: 5px; vertical-align: middle;"></span>
                            <span>íŒ¨ë°° (L)</span>
                        </div>
                        <div class="legend-item">
                            <span class="legend-color cell-draw" style="display: inline-block; width: 20px; height: 20px; border-radius: 4px; margin-right: 5px; vertical-align: middle;"></span>
                            <span>ë¬´ìŠ¹ë¶€ (D)</span>
                        </div>
                    </div>
                </div>
            </div>`;

            document.getElementById('gameRecordsContent').innerHTML = html;
        }

        // íŠ¹ì • ê²Œì„ì—ì„œì˜ ì—°ìŠ¹/ì—°íŒ¨ ì¹´ìš´íŠ¸ ê³„ì‚°
        function calculateStreakAtGame(games, gameIndex) {
            if (gameIndex < 0 || gameIndex >= games.length) {
                return { type: null, count: 0 };
            }
            
            const currentGame = games[gameIndex];
            if (currentGame.result === 'D') {
                return { type: null, count: 0 };
            }
            
            let count = 1;
            let streakType = currentGame.result;
            
            // ì´ì „ ê²Œì„ë“¤ì„ ê±°ìŠ¬ëŸ¬ ì˜¬ë¼ê°€ë©° ì—°ì† ê¸°ë¡ ê³„ì‚°
            for (let i = gameIndex - 1; i >= 0; i--) {
                const prevGame = games[i];
                if (prevGame.result === streakType) {
                    count++;
                } else {
                    break;
                }
            }
            
            return { type: streakType, count: count };
        }

        // íŒ€ë³„ ìƒì„¸ ê²Œì„ ê¸°ë¡ ë Œë”ë§
        function renderTeamDetailedRecords() {
            if (!gameRecordsData) return;

            const teams = ['LG', 'í•œí™”', 'KIA', 'ì‚¼ì„±', 'KT', 'SSG', 'ë¡¯ë°', 'ë‘ì‚°', 'NC', 'í‚¤ì›€'];
            
            let html = `
            <div class="team-detailed-records">
                <div class="team-selector" style="text-align: center; margin-bottom: 30px;">
                    <h3 style="margin-bottom: 15px; color: #2d3748;">ğŸ“‹ íŒ€ ì„ íƒ</h3>
                    <select onchange="changeSelectedTeam(this.value)" style="padding: 10px 20px; font-size: 16px; border: 2px solid #e2e8f0; border-radius: 8px; background: white;">
                        ${teams.map(team => 
                            `<option value="${team}" ${team === currentSelectedTeam ? 'selected' : ''}>${team}</option>`
                        ).join('')}
                    </select>
                </div>`;

            const teamRecord = gameRecordsData[currentSelectedTeam];
            if (teamRecord) {
                // ìµœê·¼ 10ê²½ê¸° ê¸°ë¡
                const recentGames = teamRecord.games.slice(-10);
                const recent10Record = recentGames.reduce((acc, game) => {
                    if (game.result === 'W') acc.wins++;
                    else if (game.result === 'L') acc.losses++;
                    else acc.draws++;
                    return acc;
                }, { wins: 0, losses: 0, draws: 0 });

                // ì „ì²´ ê¸°ë¡
                const totalRecord = teamRecord.games.reduce((acc, game) => {
                    if (game.result === 'W') acc.wins++;
                    else if (game.result === 'L') acc.losses++;
                    else acc.draws++;
                    return acc;
                }, { wins: 0, losses: 0, draws: 0 });

                const winRate = totalRecord.wins > 0 ? ((totalRecord.wins / (totalRecord.wins + totalRecord.losses)) * 100).toFixed(1) : '0.0';

                html += `
                <div class="selected-team-details">
                    <h4 style="text-align: center; margin-bottom: 25px; color: #2d3748; font-size: 1.4rem;">${currentSelectedTeam} ìƒì„¸ ê¸°ë¡</h4>
                    
                    <!-- íŒ€ í†µê³„ ìš”ì•½ -->
                    <div class="team-stats-summary">
                        <div class="stats-grid">
                            <div class="stat-card">
                                <div class="stat-title">ì´ ê²½ê¸°</div>
                                <div class="stat-number">${teamRecord.games.length}</div>
                                <div class="stat-subtitle">ê²½ê¸°</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-title">ì „ì²´ ì„±ì </div>
                                <div class="stat-number">${totalRecord.wins}-${totalRecord.losses}-${totalRecord.draws}</div>
                                <div class="stat-subtitle">ìŠ¹ë¥  ${winRate}%</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-title">ìµœê·¼ 10ê²½ê¸°</div>
                                <div class="stat-number">${recent10Record.wins}-${recent10Record.losses}-${recent10Record.draws}</div>
                                <div class="stat-subtitle">ìµœê·¼ ì„±ì </div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-title">í˜„ì¬ ì—°ì†</div>
                                <div class="stat-number ${teamRecord.currentStreak.type === 'W' ? 'win-color' : teamRecord.currentStreak.type === 'L' ? 'loss-color' : ''}">
                                    ${teamRecord.currentStreak.type === 'W' ? `${teamRecord.currentStreak.count}ì—°ìŠ¹` : 
                                      teamRecord.currentStreak.type === 'L' ? `${teamRecord.currentStreak.count}ì—°íŒ¨` : 'ì—†ìŒ'}
                                </div>
                                <div class="stat-subtitle">í˜„ì¬ ìƒíƒœ</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-title">ìµœì¥ ì—°ìŠ¹</div>
                                <div class="stat-number win-color">${teamRecord.longestWinStreak}</div>
                                <div class="stat-subtitle">ì—°ìŠ¹</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-title">ìµœì¥ ì—°íŒ¨</div>
                                <div class="stat-number loss-color">${teamRecord.longestLoseStreak}</div>
                                <div class="stat-subtitle">ì—°íŒ¨</div>
                            </div>
                        </div>
                    </div>

                    <!-- ìƒì„¸ ê²Œì„ ê¸°ë¡ í…Œì´ë¸” -->
                    <div class="detailed-games-section">
                        <h5 style="text-align: center; margin: 30px 0 20px 0; color: #2d3748;">ğŸ® ì „ì²´ ê²Œì„ ê¸°ë¡</h5>
                        <div class="table-container" style="overflow-x: auto; max-height: 600px; overflow-y: auto; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
                            <table class="detailed-game-table" id="detailedGameTable">
                                <thead>
                                    <tr>
                                        <th class="sortable" data-column="gameNumber">ê²½ê¸°# â†•ï¸</th>
                                        <th class="sortable" data-column="date">ë‚ ì§œ â†•ï¸</th>
                                        <th class="sortable" data-column="opponent">ìƒëŒ€íŒ€ â†•ï¸</th>
                                        <th class="sortable" data-column="venue">í™ˆ/ì›ì • â†•ï¸</th>
                                        <th>ìŠ¤ì½”ì–´</th>
                                        <th class="sortable" data-column="result">ê²°ê³¼ â†•ï¸</th>
                                        <th class="sortable" data-column="runs_scored">ë“ì  â†•ï¸</th>
                                        <th class="sortable" data-column="runs_allowed">ì‹¤ì  â†•ï¸</th>
                                        <th class="sortable" data-column="scoreDiff">ë“ì‹¤ì°¨ â†•ï¸</th>
                                    </tr>
                                </thead>
                                <tbody id="detailedGameTableBody">`;

                teamRecord.games.forEach((game, index) => {
                    const scoreDiff = game.runs_scored - game.runs_allowed;
                    const scoreDiffText = scoreDiff > 0 ? `+${scoreDiff}` : scoreDiff.toString();
                    
                    html += `
                        <tr class="${game.result === 'W' ? 'win-row' : game.result === 'L' ? 'loss-row' : 'draw-row'}">
                            <td class="game-num-cell">${game.gameNumber}</td>
                            <td class="date-cell">${game.date}</td>
                            <td class="opponent-cell">${game.opponent}</td>
                            <td class="venue-cell">${game.isHome ? 'í™ˆ' : 'ì›ì •'}</td>
                            <td class="score-cell">${game.score}</td>
                            <td class="result-cell">
                                <span class="result-badge ${game.result.toLowerCase()}">${
                                    game.result === 'W' ? 'ìŠ¹' : game.result === 'L' ? 'íŒ¨' : 'ë¬´'
                                }</span>
                            </td>
                            <td class="runs-cell">${game.runs_scored}</td>
                            <td class="runs-cell">${game.runs_allowed}</td>
                            <td class="diff-cell ${scoreDiff > 0 ? 'positive' : scoreDiff < 0 ? 'negative' : 'neutral'}">${scoreDiffText}</td>
                        </tr>`;
                });

                html += `
                                </tbody>
                            </table>
                        </div>
                        <div style="text-align: center; margin-top: 15px; font-size: 0.85rem; color: #666;">
                            ğŸ”„ ì»¬ëŸ¼ í—¤ë”ë¥¼ í´ë¦­í•˜ë©´ í•´ë‹¹ í•­ëª©ìœ¼ë¡œ ì •ë ¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤
                        </div>
                    </div>
                </div>`;
            }

            html += `</div>`;
            document.getElementById('teamDetailedRecordsContent').innerHTML = html;
            
            // ì •ë ¬ ê¸°ëŠ¥ ì´ˆê¸°í™”
            if (teamRecord) {
                initializeDetailedTableSorting();
            }
        }

        // íŒ€ë³„ ìƒì„¸ í…Œì´ë¸” ì •ë ¬ ê¸°ëŠ¥ ì´ˆê¸°í™”
        function initializeDetailedTableSorting() {
            const table = document.getElementById('detailedGameTable');
            const headers = table.querySelectorAll('th.sortable');
            
            headers.forEach(header => {
                header.addEventListener('click', () => {
                    const column = header.dataset.column;
                    sortDetailedTable(column);
                });
            });
        }

        // íŒ€ë³„ ìƒì„¸ í…Œì´ë¸” ì •ë ¬ í•¨ìˆ˜
        function sortDetailedTable(column) {
            const table = document.getElementById('detailedGameTable');
            const tbody = table.querySelector('tbody');
            const rows = Array.from(tbody.querySelectorAll('tr'));
            
            // í˜„ì¬ ì •ë ¬ ë°©í–¥ í™•ì¸
            const isAscending = table.dataset.sortDirection !== 'asc';
            table.dataset.sortDirection = isAscending ? 'asc' : 'desc';
            
            // í—¤ë” ì—…ë°ì´íŠ¸
            table.querySelectorAll('th.sortable').forEach(th => {
                th.textContent = th.textContent.replace(/\s[â†‘â†“â†•ï¸]/g, '') + ' â†•ï¸';
            });
            const currentHeader = table.querySelector(`th[data-column="${column}"]`);
            currentHeader.textContent = currentHeader.textContent.replace(/\s[â†‘â†“â†•ï¸]/g, '') + (isAscending ? ' â†‘' : ' â†“');
            
            // í–‰ ì •ë ¬
            rows.sort((a, b) => {
                let aVal, bVal;
                
                switch(column) {
                    case 'gameNumber':
                        aVal = parseInt(a.querySelector('.game-num-cell').textContent);
                        bVal = parseInt(b.querySelector('.game-num-cell').textContent);
                        break;
                    case 'date':
                        aVal = new Date(a.querySelector('.date-cell').textContent);
                        bVal = new Date(b.querySelector('.date-cell').textContent);
                        break;
                    case 'opponent':
                        aVal = a.querySelector('.opponent-cell').textContent;
                        bVal = b.querySelector('.opponent-cell').textContent;
                        break;
                    case 'venue':
                        aVal = a.querySelector('.venue-cell').textContent;
                        bVal = b.querySelector('.venue-cell').textContent;
                        break;
                    case 'result':
                        aVal = a.querySelector('.result-badge').textContent;
                        bVal = b.querySelector('.result-badge').textContent;
                        // ìŠ¹ > ë¬´ > íŒ¨ ìˆœì„œë¡œ ì •ë ¬
                        const resultOrder = {'ìŠ¹': 3, 'ë¬´': 2, 'íŒ¨': 1};
                        aVal = resultOrder[aVal] || 0;
                        bVal = resultOrder[bVal] || 0;
                        break;
                    case 'runs_scored':
                        aVal = parseInt(a.querySelectorAll('.runs-cell')[0].textContent);
                        bVal = parseInt(b.querySelectorAll('.runs-cell')[0].textContent);
                        break;
                    case 'runs_allowed':
                        aVal = parseInt(a.querySelectorAll('.runs-cell')[1].textContent);
                        bVal = parseInt(b.querySelectorAll('.runs-cell')[1].textContent);
                        break;
                    case 'scoreDiff':
                        const aDiff = a.querySelector('.diff-cell').textContent.replace('+', '');
                        const bDiff = b.querySelector('.diff-cell').textContent.replace('+', '');
                        aVal = parseInt(aDiff);
                        bVal = parseInt(bDiff);
                        break;
                    default:
                        aVal = a.cells[0].textContent;
                        bVal = b.cells[0].textContent;
                }
                
                if (aVal < bVal) return isAscending ? -1 : 1;
                if (aVal > bVal) return isAscending ? 1 : -1;
                return 0;
            });
            
            // ì •ë ¬ëœ í–‰ë“¤ì„ í…Œì´ë¸”ì— ë‹¤ì‹œ ì¶”ê°€
            rows.forEach(row => tbody.appendChild(row));
        }

        // ìŠ¹ë¥ ì— ë”°ë¥¸ ë°°ê²½ìƒ‰ ê³„ì‚°
        function getWinRateColor(winRate) {
            if (winRate >= 70) return '#d5fdd5';     // ë§¤ìš° ë†’ì€ ìŠ¹ë¥  - ì—°í•œ ì´ˆë¡
            if (winRate >= 60) return '#e8f5e8';     // ë†’ì€ ìŠ¹ë¥  - ë” ì—°í•œ ì´ˆë¡
            if (winRate >= 50) return '#fff3cd';     // ë³´í†µ ìŠ¹ë¥  - ì—°í•œ ë…¸ë‘
            if (winRate >= 40) return '#fde2e4';     // ë‚®ì€ ìŠ¹ë¥  - ì—°í•œ ë¶„í™
            return '#f8d7da';                        // ë§¤ìš° ë‚®ì€ ìŠ¹ë¥  - ì—°í•œ ë¹¨ê°•
        }

        // ì „ì²´ ìˆœìœ„í‘œ (ëª¨ë“  ì§€í‘œ í¬í•¨)
        function renderFullStandings() {
            const tbody = document.getElementById('fullStandingsBody');
            tbody.innerHTML = '';

            dashboardData.standings.forEach((team, index) => {
                // í•´ë‹¹ íŒ€ì˜ ìƒì„¸ ë°ì´í„° ì°¾ê¸°
                const teamSummary = dashboardData.teamSummaries.find(t => t.team_name === team.team_name);
                const pythagorean = dashboardData.pythagoreanAnalysis.find(t => t.team_name === team.team_name);
                const oneRun = dashboardData.oneRunGames.find(t => t.team_name === team.team_name);
                const homeAway = dashboardData.homeAwayStats.find(t => t.team_name === team.team_name);
                const streak = dashboardData.streakAnalysis.find(t => t.team_name === team.team_name);

                const row = document.createElement('tr');
                row.className = index < 3 ? `rank-${index + 1}` : '';
                
                row.innerHTML = `
                    <td><strong>${team.rank}</strong></td>
                    <td class="team-name">${getTeamWithLogo(team.team_name)}</td>
                    <td>${team.games_played}</td>
                    <td>${team.wins}</td>
                    <td>${team.draws}</td>
                    <td>${team.losses}</td>
                    <td><strong>${team.win_rate}</strong></td>
                    <td>${team.games_behind}</td>
                    <td>${team.runs_scored}</td>
                    <td>${team.runs_allowed}</td>
                    <td class="${team.run_differential > 0 ? 'positive' : team.run_differential < 0 ? 'negative' : 'neutral'}">${team.run_differential}</td>
                    <td>${pythagorean ? pythagorean.expected_win_rate : '-'}</td>
                    <td class="${pythagorean && parseFloat(pythagorean.luck_factor) > 0.02 ? 'positive' : pythagorean && parseFloat(pythagorean.luck_factor) < -0.02 ? 'negative' : 'neutral'}">${pythagorean ? pythagorean.luck_factor : '-'}</td>
                    <td class="${oneRun && parseFloat(oneRun.win_rate) > 0.55 ? 'positive' : oneRun && parseFloat(oneRun.win_rate) < 0.45 ? 'negative' : 'neutral'}">${oneRun ? oneRun.win_rate : '-'}</td>
                    <td>${homeAway ? homeAway.home_win_rate : '-'}</td>
                    <td>${homeAway ? homeAway.away_win_rate : '-'}</td>
                    <td class="${homeAway && parseFloat(homeAway.home_advantage) > 0.05 ? 'positive' : homeAway && parseFloat(homeAway.home_advantage) < -0.05 ? 'negative' : 'neutral'}">${homeAway ? homeAway.home_advantage : '-'}</td>
                    <td>${team.current_streak}</td>
                    <td>${streak ? streak.max_win_streak : '-'}</td>
                    <td>${streak ? streak.max_lose_streak : '-'}</td>
                `;
                tbody.appendChild(row);
            });
        }

        // í”¼íƒ€ê³ ë¦¬ì•ˆ ì „ì²´ ë¶„ì„
        function renderPythagoreanFullAnalysis() {
            const tbody = document.getElementById('pythagoreanBody');
            tbody.innerHTML = '';

            dashboardData.pythagoreanAnalysis.forEach(team => {
                const teamData = dashboardData.standings.find(t => t.team_name === team.team_name);
                const avgScored = teamData ? (teamData.runs_scored / teamData.games_played).toFixed(2) : '-';
                const avgAllowed = teamData ? (teamData.runs_allowed / teamData.games_played).toFixed(2) : '-';

                const row = document.createElement('tr');
                const luckClass = parseFloat(team.luck_factor) > 0.02 ? 'positive' : 
                                 parseFloat(team.luck_factor) < -0.02 ? 'negative' : 'neutral';
                
                row.innerHTML = `
                    <td class="team-name">${getTeamWithLogo(team.team_name)}</td>
                    <td><strong>${team.actual_win_rate}</strong></td>
                    <td>${team.expected_win_rate}</td>
                    <td class="${luckClass}"><strong>${team.luck_factor}</strong></td>
                    <td class="${luckClass}">${team.luck_status}</td>
                    <td>${teamData ? teamData.runs_scored : '-'}</td>
                    <td>${teamData ? teamData.runs_allowed : '-'}</td>
                    <td>${avgScored}</td>
                    <td>${avgAllowed}</td>
                `;
                tbody.appendChild(row);
            });
        }

        // í´ëŸ¬ì¹˜ ìƒí™© ì „ì²´ ë¶„ì„
        function renderClutchFullAnalysis() {
            const tbody = document.getElementById('clutchBody');
            tbody.innerHTML = '';

            dashboardData.oneRunGames.forEach(team => {
                const specialSit = dashboardData.specialSituations.find(t => t.team_name === team.team_name);
                const totalGames = dashboardData.standings.find(t => t.team_name === team.team_name)?.games_played || 0;
                const closeGameRatio = totalGames > 0 ? ((team.total_games / totalGames) * 100).toFixed(1) : '0';

                const row = document.createElement('tr');
                const winRateClass = parseFloat(team.win_rate) > 0.55 ? 'positive' : 
                                   parseFloat(team.win_rate) < 0.45 ? 'negative' : 'neutral';
                
                row.innerHTML = `
                    <td class="team-name">${getTeamWithLogo(team.team_name)}</td>
                    <td>${team.wins}</td>
                    <td>${team.losses}</td>
                    <td class="${winRateClass}"><strong>${team.win_rate}</strong></td>
                    <td>${specialSit ? specialSit.blowout_wins : '-'}</td>
                    <td>${specialSit ? specialSit.blowout_losses : '-'}</td>
                    <td>${specialSit ? specialSit.shutout_wins : '-'}</td>
                    <td>${specialSit ? specialSit.shutout_losses : '-'}</td>
                    <td>${closeGameRatio}%</td>
                `;
                tbody.appendChild(row);
            });
        }

        // í™ˆ/ì›ì • ì „ì²´ ë¶„ì„
        function renderHomeAwayFullAnalysis() {
            const tbody = document.getElementById('homeAwayBody');
            tbody.innerHTML = '';

            const stadiumMap = {
                'KIA': 'ê´‘ì£¼ ì±”í”¼ì–¸ìŠ¤í•„ë“œ',
                'LG': 'ì„œìš¸ ì ì‹¤ì•¼êµ¬ì¥',
                'ë‘ì‚°': 'ì„œìš¸ ì ì‹¤ì•¼êµ¬ì¥',
                'ì‚¼ì„±': 'ëŒ€êµ¬ ì‚¼ì„±ë¼ì´ì˜¨ì¦ˆíŒŒí¬',
                'SSG': 'ì¸ì²œ SSGëœë”ìŠ¤í•„ë“œ',
                'KT': 'ìˆ˜ì› KTìœ„ì¦ˆíŒŒí¬',
                'NC': 'ì°½ì› NCíŒŒí¬',
                'ë¡¯ë°': 'ë¶€ì‚° ì‚¬ì§ì•¼êµ¬ì¥',
                'í•œí™”': 'ëŒ€ì „ í•œí™”ìƒëª…ì´ê¸€ìŠ¤íŒŒí¬',
                'í‚¤ì›€': 'ì„œìš¸ ê³ ì²™ìŠ¤ì¹´ì´ë”'
            };

            dashboardData.homeAwayStats.forEach(team => {
                const homeGames = team.home_wins + team.home_losses;
                const awayGames = team.away_wins + team.away_losses;

                const row = document.createElement('tr');
                const advantageClass = parseFloat(team.home_advantage) > 0.05 ? 'positive' : 
                                     parseFloat(team.home_advantage) < -0.05 ? 'negative' : 'neutral';
                
                row.innerHTML = `
                    <td class="team-name">${getTeamWithLogo(team.team_name)}</td>
                    <td>${homeGames}</td>
                    <td>${team.home_wins}</td>
                    <td>${team.home_losses}</td>
                    <td><strong>${team.home_win_rate}</strong></td>
                    <td>${awayGames}</td>
                    <td>${team.away_wins}</td>
                    <td>${team.away_losses}</td>
                    <td><strong>${team.away_win_rate}</strong></td>
                    <td class="${advantageClass}"><strong>${team.home_advantage}</strong></td>
                    <td style="font-size: 0.8rem;">${stadiumMap[team.team_name] || '-'}</td>
                `;
                tbody.appendChild(row);
            });
        }

        // ìƒëŒ€ì „ì  ë§¤íŠ¸ë¦­ìŠ¤
        function renderHeadToHeadMatrix() {
            const container = document.getElementById('matrixContent');
            
            // ìˆœìœ„ ìˆœì„œëŒ€ë¡œ íŒ€ ì •ë ¬
            const rankedTeams = dashboardData.standings.map(team => team.team_name);
            
            let html = '<div>';
            
            // ì „ì²´ ë§¤íŠ¸ë¦­ìŠ¤ë§Œ í‘œì‹œ
            html += '<table class="matrix-table"><thead><tr><th style="min-width: 70px;">vs</th>';
            rankedTeams.forEach(team => {
                html += `<th style="min-width: 75px;"><strong>${getTeamWithLogo(team, 'team-logo-small')}</strong></th>`;
            });
            html += '</tr></thead><tbody>';
            
            rankedTeams.forEach(team1 => {
                html += `<tr><th style="text-align: center; font-weight: 700; background: #2c3e50;"><strong>${getTeamWithLogo(team1, 'team-logo-small')}</strong></th>`;
                rankedTeams.forEach(team2 => {
                    html += renderMatrixCell(team1, team2);
                });
                html += '</tr>';
            });
            html += '</tbody></table>';
            
            html += '</div>';
            container.innerHTML = html;
        }
        
        // ë§¤íŠ¸ë¦­ìŠ¤ ì…€ ë Œë”ë§ í•¨ìˆ˜ (ë¬´ìŠ¹ë¶€ ë° í™ˆ/ì›ì • ë¶„ë¦¬ í¬í•¨)
        function renderMatrixCell(team1, team2) {
            if (team1 === team2) {
                return '<td style="background: #ecf0f1; color: #999; font-weight: 600; font-size: 1.2rem;">-</td>';
            }
            
            if (dashboardData.headToHeadMatrix[team1] && dashboardData.headToHeadMatrix[team1][team2]) {
                const record = dashboardData.headToHeadMatrix[team1][team2];
                
                // ì‹¤ì œ ë°ì´í„°ì—ì„œ íŒŒì‹±
                const recordParts = record.record.split('-');
                const wins = parseInt(recordParts[0]);
                const losses = parseInt(recordParts[1]);
                const draws = recordParts.length > 2 ? parseInt(recordParts[2]) : 0;
                
                const winRateClass = parseFloat(record.win_rate) > 0.55 ? 'positive' : 
                                   parseFloat(record.win_rate) < 0.45 ? 'negative' : 'neutral';
                
                // ì‹¤ì œ í™ˆ/ì›ì • ë°ì´í„° ì‚¬ìš©
                const homeRecordParts = record.home_record.split('-');
                const homeWins = parseInt(homeRecordParts[0]);
                const homeLosses = parseInt(homeRecordParts[1]);
                const homeDraws = homeRecordParts.length > 2 ? parseInt(homeRecordParts[2]) : 0;
                
                const awayRecordParts = record.away_record.split('-');
                const awayWins = parseInt(awayRecordParts[0]);
                const awayLosses = parseInt(awayRecordParts[1]);
                const awayDraws = awayRecordParts.length > 2 ? parseInt(awayRecordParts[2]) : 0;
                
                // í™ˆ/ì›ì • ìŠ¹ë¥  ê³„ì‚°
                const homeWinRate = (homeWins + homeLosses) > 0 ? (homeWins / (homeWins + homeLosses)) : 0;
                const awayWinRate = (awayWins + awayLosses) > 0 ? (awayWins / (awayWins + awayLosses)) : 0;
                
                // ìŠ¹ë¥ ì— ë”°ë¥¸ ë°°ê²½ìƒ‰ ì„¤ì •
                const winRate = parseFloat(record.win_rate);
                let backgroundColor = '#f8f9fa';
                let textColor = '#333';
                
                if (winRate > 0.6) {
                    backgroundColor = 'rgba(22, 163, 74, 0.2)';
                } else if (winRate > 0.5) {
                    backgroundColor = 'rgba(22, 163, 74, 0.1)';
                } else if (winRate < 0.4) {
                    backgroundColor = 'rgba(220, 38, 38, 0.2)';
                } else if (winRate < 0.5) {
                    backgroundColor = 'rgba(220, 38, 38, 0.1)';
                }

                return `<td style="background: ${backgroundColor}; color: ${textColor}; padding: 8px;">
                    <div style="font-size: 0.85rem; line-height: 1.3; text-align: center;">
                        <div style="font-weight: 600; margin-bottom: 2px;">${wins}-${losses}-${draws} (${(winRate * 100).toFixed(1)}%)</div>
                        <div style="font-size: 0.8rem; color: #555; margin-bottom: 1px;">ğŸ  ${homeWins}-${homeLosses}-${homeDraws} (${(homeWinRate * 100).toFixed(1)}%)</div>
                        <div style="font-size: 0.8rem; color: #555;">âœˆï¸ ${awayWins}-${awayLosses}-${awayDraws} (${(awayWinRate * 100).toFixed(1)}%)</div>
                    </div>
                </td>`;
            } else {
                return '<td style="color: #999; font-weight: 500;">0ìŠ¹ 0íŒ¨<br><span style="font-size: 0.7rem;">(0.0%)</span></td>';
            }
        }

        // ì›”ë³„ ì„±ì  ì „ì²´ ë¶„ì„ (í–‰/ì—´ ë°˜ì „)
        function renderMonthlyFullAnalysis() {
            const thead = document.getElementById('monthlyTableHead');
            const tbody = document.getElementById('monthlyBody');
            thead.innerHTML = '';
            tbody.innerHTML = '';
            
            // ìˆœìœ„ ìˆœì„œëŒ€ë¡œ íŒ€ ì •ë ¬
            const rankedTeams = dashboardData.standings.map(team => team.team_name);
            
            // í—¤ë” ìƒì„±: ì›” + ê° íŒ€ (ë¡œê³ ì™€ í•¨ê»˜) - ìŠ¹íŒ¨ì™€ ìŠ¹ë¥  ë¶„ë¦¬
            const headerRow1 = document.createElement('tr');
            const headerRow2 = document.createElement('tr');
            
            headerRow1.innerHTML = `
                <th rowspan="2" style="min-width: 50px; vertical-align: middle; font-size: 0.85rem; white-space: nowrap;">ì›”</th>
                ${rankedTeams.map(team => `<th colspan="2" style="min-width: 120px; font-size: 0.8rem; white-space: nowrap; padding: 8px 4px;">${getTeamWithLogo(team, 'team-logo-small')}</th>`).join('')}
            `;
            
            headerRow2.innerHTML = `
                ${rankedTeams.map(team => `<th style="min-width: 60px; font-size: 0.75rem; white-space: nowrap; padding: 6px 2px;">ì„±ì </th><th style="min-width: 50px; font-size: 0.75rem; white-space: nowrap; padding: 6px 2px;">ìŠ¹ë¥ </th>`).join('')}
            `;
            
            thead.appendChild(headerRow1);
            thead.appendChild(headerRow2);
            
            // ì›”ë³„ ë°ì´í„° (3ì›”~8ì›”)
            const months = [3, 4, 5, 6, 7, 8];
            const monthNames = ['3ì›”', '4ì›”', '5ì›”', '6ì›”', '7ì›”', '8ì›”'];
            
            // ë¨¼ì € íŒ€ë³„ ë°ì´í„°ë¥¼ ë¯¸ë¦¬ ê³„ì‚° (ìµœê³ ì›”/ìµœì €ì›” íŒë‹¨ìš©)
            const teamStats = {};
            rankedTeams.forEach(team => {
                const monthlyData = dashboardData.monthlyPerformance[team];
                const validMonths = monthlyData.filter(month => month.wins + month.losses > 0);
                
                if (validMonths.length > 0) {
                    const teamRates = validMonths.map(month => ({
                        rate: parseFloat(month.win_rate),
                        month: month.month,
                        record: `${month.wins}-${month.losses}${month.draws ? '-' + month.draws : ''}`,
                        wins: month.wins,
                        losses: month.losses,
                        draws: month.draws || 0
                    }));
                    
                    const bestMonth = teamRates.reduce((best, current) => current.rate > best.rate ? current : best);
                    const worstMonth = teamRates.reduce((worst, current) => current.rate < worst.rate ? current : worst);
                    
                    teamStats[team] = {
                        bestMonth: bestMonth,
                        worstMonth: worstMonth
                    };
                }
            });

            months.forEach((monthNum, index) => {
                const row = document.createElement('tr');
                let html = `<td class="month-label"><strong>${monthNames[index]}</strong></td>`;
                
                let monthRates = []; // í•´ë‹¹ ì›”ì˜ ëª¨ë“  íŒ€ ìŠ¹ë¥ 
                
                // ê° íŒ€ì˜ í•´ë‹¹ ì›” ë°ì´í„° - ìŠ¹íŒ¨ì™€ ìŠ¹ë¥  ë¶„ë¦¬
                rankedTeams.forEach(team => {
                    const monthlyData = dashboardData.monthlyPerformance[team];
                    const monthData = monthlyData?.find(month => month.month === monthNum);
                    
                    if (monthData && monthData.wins + monthData.losses > 0) {
                        const winRate = parseFloat(monthData.win_rate);
                        monthRates.push(winRate);
                        const winRateClass = winRate > 0.55 ? 'positive' : winRate < 0.45 ? 'negative' : 'neutral';
                        
                        const record = monthData.draws > 0 ? 
                            `${monthData.wins}-${monthData.losses}-${monthData.draws}` : 
                            `${monthData.wins}-${monthData.losses}`;
                        
                        // ìµœê³ ì›”/ìµœì €ì›” í™•ì¸
                        const isBestMonth = teamStats[team] && teamStats[team].bestMonth.month === monthNum;
                        const isWorstMonth = teamStats[team] && teamStats[team].worstMonth.month === monthNum;
                        
                        let recordStyle = '';
                        let rateStyle = '';
                        
                        if (isBestMonth) {
                            recordStyle = 'border-top: 2px solid #059669; border-left: 2px solid #059669; border-bottom: 2px solid #059669; border-right: 1px solid #e2e8f0;';
                            rateStyle = 'border-top: 2px solid #059669; border-right: 2px solid #059669; border-bottom: 2px solid #059669; border-left: 1px solid #e2e8f0;';
                        } else if (isWorstMonth) {
                            recordStyle = 'border-top: 2px solid #dc2626; border-left: 2px solid #dc2626; border-bottom: 2px solid #dc2626; border-right: 1px solid #e2e8f0;';
                            rateStyle = 'border-top: 2px solid #dc2626; border-right: 2px solid #dc2626; border-bottom: 2px solid #dc2626; border-left: 1px solid #e2e8f0;';
                        }
                        
                        html += `
                            <td class="month-record-cell" style="${recordStyle}">${record}</td>
                            <td class="${winRateClass} month-rate-cell" style="${rateStyle}">${(winRate * 100).toFixed(1)}%</td>
                        `;
                    } else {
                        html += '<td class="month-data" style="color: #999;">-</td><td class="month-data" style="color: #999;">-</td>';
                    }
                });
                
                
                row.innerHTML = html;
                tbody.appendChild(row);
            });
            
            // í‰ê·  ìŠ¹ë¥  ê³„ì‚° ì¶”ê°€
            rankedTeams.forEach(team => {
                if (teamStats[team]) {
                    const monthlyData = dashboardData.monthlyPerformance[team];
                    const validMonths = monthlyData.filter(month => month.wins + month.losses > 0);
                    const teamRates = validMonths.map(month => parseFloat(month.win_rate));
                    const teamAverage = (teamRates.reduce((a, b) => a + b, 0) / teamRates.length);
                    teamStats[team].average = (teamAverage * 100).toFixed(1) + '%';
                    teamStats[team].averageNum = teamAverage; // ë¹„êµìš© ìˆ«ìê°’
                }
            });
            
            // ì „ì²´ í‰ê·  ê³„ì‚°
            let allRates = [];
            rankedTeams.forEach(team => {
                const monthlyData = dashboardData.monthlyPerformance[team];
                monthlyData.forEach(month => {
                    if (month.wins + month.losses > 0) {
                        allRates.push(parseFloat(month.win_rate));
                    }
                });
            });
            const totalAverage = allRates.length > 0 ? 
                (allRates.reduce((a, b) => a + b, 0) / allRates.length).toFixed(3) : '-';

            // 1. íŒ€ë³„ í‰ê·  ìŠ¹ë¥  í–‰
            const avgRow = document.createElement('tr');
            avgRow.className = 'stats-row';
            let avgHtml = `<td class="stats-label" style="background: #6b7280; color: white; border: 1px solid #4b5563;"><strong>í‰ê·  ìŠ¹ë¥ </strong></td>`;
            
            rankedTeams.forEach(team => {
                if (teamStats[team]) {
                    const avgClass = teamStats[team].averageNum > 0.55 ? 'positive' : 
                                   teamStats[team].averageNum < 0.45 ? 'negative' : 'neutral';
                    avgHtml += `<td colspan="2" class="${avgClass}" style="background: rgba(107, 114, 128, 0.1); text-align: center; border: 1px solid #d1d5db;"><strong>${teamStats[team].average}</strong></td>`;
                } else {
                    avgHtml += '<td colspan="2" style="background: rgba(107, 114, 128, 0.1); color: #999; text-align: center; border: 1px solid #d1d5db;">-</td>';
                }
            });
            avgRow.innerHTML = avgHtml;
            tbody.appendChild(avgRow);

            // ì›”ë³„ í…Œì´ë¸” ì •ë ¬ ê¸°ëŠ¥ ì´ˆê¸°í™”
            const monthlyTable = document.getElementById('monthlyTable');
            initializeSorting(monthlyTable);

        }

        // ìš”ì¼ë³„ ì„±ì  ì „ì²´ ë¶„ì„
        function renderWeekdayFullAnalysis() {
            console.log('ğŸ” renderWeekdayFullAnalysis í˜¸ì¶œë¨');
            const tbody = document.getElementById('weekdayBody');
            console.log('weekdayBody ìš”ì†Œ:', tbody);
            
            if (!tbody) {
                console.error('âŒ weekdayBody ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
                return;
            }
            
            if (!dashboardData || !dashboardData.standings) {
                console.error('âŒ dashboardData.standingsê°€ ì—†ìŠµë‹ˆë‹¤');
                return;
            }
            
            const days = ['ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ', 'í† ', 'ì¼'];
            
            // ìˆœìœ„ ìˆœì„œëŒ€ë¡œ íŒ€ ì •ë ¬
            const rankedTeams = dashboardData.standings.map(team => team.team_name);
            console.log('rankedTeams:', rankedTeams);
            
            let html = '';
            
            rankedTeams.forEach(team => {
                const weekdayData = dashboardData.weekdayPerformance[team];
                const rank = dashboardData.standings.find(t => t.team_name === team).rank;
                
                html += `<tr>
                    <td><strong>${rank}</strong></td>
                    <td class="team-name"><strong>${getTeamWithLogo(team, 'team-logo-small')}</strong></td>
                `;
                
                // ê° ìš”ì¼ë³„ ë°ì´í„°
                days.forEach(day => {
                    if (weekdayData && weekdayData[day]) {
                        const winRate = (parseFloat(weekdayData[day].win_rate) * 100).toFixed(1);
                        const winRateClass = parseFloat(weekdayData[day].win_rate) > 0.55 ? 'positive' : 
                                           parseFloat(weekdayData[day].win_rate) < 0.45 ? 'negative' : 'neutral';
                        const totalGames = weekdayData[day].wins + weekdayData[day].losses;
                        html += `<td class="${winRateClass}" style="font-size: 0.8rem; padding: 8px; line-height: 1.3;">
                            <div>${weekdayData[day].wins}-${weekdayData[day].losses} (${winRate}%)</div>
                            <div style="font-size: 0.75rem; color: #666; margin-top: 2px;">${totalGames}ê²½ê¸°</div>
                        </td>`;
                    } else {
                        html += `<td style="color: #999; font-size: 0.85rem; padding: 8px;">0-0 (0.0%)</td>`;
                    }
                });
                
                // ì£¼ë§ìŠ¹ë¥  (í† ìš”ì¼, ì¼ìš”ì¼)
                let weekendWins = 0, weekendLosses = 0;
                ['í† ', 'ì¼'].forEach(day => {
                    if (weekdayData && weekdayData[day]) {
                        weekendWins += weekdayData[day].wins;
                        weekendLosses += weekdayData[day].losses;
                    }
                });
                const weekendRate = (weekendWins + weekendLosses > 0) ? (weekendWins / (weekendWins + weekendLosses) * 100).toFixed(1) : '0.0';
                const weekendClass = parseFloat(weekendRate) > 55 ? 'positive' : parseFloat(weekendRate) < 45 ? 'negative' : 'neutral';
                
                // í‰ì¼ìŠ¹ë¥  (ì›”~ê¸ˆ)
                let weekdayWins = 0, weekdayLosses = 0;
                ['ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ'].forEach(day => {
                    if (weekdayData && weekdayData[day]) {
                        weekdayWins += weekdayData[day].wins;
                        weekdayLosses += weekdayData[day].losses;
                    }
                });
                const weekdayRate = (weekdayWins + weekdayLosses > 0) ? (weekdayWins / (weekdayWins + weekdayLosses) * 100).toFixed(1) : '0.0';
                const weekdayClass = parseFloat(weekdayRate) > 55 ? 'positive' : parseFloat(weekdayRate) < 45 ? 'negative' : 'neutral';
                
                html += `
                    <td class="${weekendClass}" style="font-size: 0.8rem; padding: 8px; line-height: 1.3;">
                        <div>${weekendWins}-${weekendLosses} (${weekendRate}%)</div>
                        <div style="font-size: 0.75rem; color: #666; margin-top: 2px;">${weekendWins + weekendLosses}ê²½ê¸°</div>
                    </td>
                    <td class="${weekdayClass}" style="font-size: 0.8rem; padding: 8px; line-height: 1.3;">
                        <div>${weekdayWins}-${weekdayLosses} (${weekdayRate}%)</div>
                        <div style="font-size: 0.75rem; color: #666; margin-top: 2px;">${weekdayWins + weekdayLosses}ê²½ê¸°</div>
                    </td>
                </tr>`;
            });
            
            console.log('ìƒì„±ëœ HTML ê¸¸ì´:', html.length);
            console.log('HTML ë¯¸ë¦¬ë³´ê¸°:', html.substring(0, 200) + '...');
            tbody.innerHTML = html;
            console.log('âœ… renderWeekdayFullAnalysis ì™„ë£Œ');
        }

        // ê²½ê¸°ì¥ë³„ ì„±ì  í‘œ ë¶„ì„
        function renderStadiumFullAnalysis() {
            console.log('ğŸ” renderStadiumFullAnalysis í˜¸ì¶œë¨');
            const thead = document.getElementById('stadiumTableHead');
            const tbody = document.getElementById('stadiumTableBody');
            console.log('stadiumTableHead:', thead, 'stadiumTableBody:', tbody);
            
            if (!thead || !tbody) {
                console.error('âŒ stadiumTableHead ë˜ëŠ” stadiumTableBody ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
                return;
            }
            
            if (!dashboardData || !dashboardData.standings) {
                console.error('âŒ dashboardData.standingsê°€ ì—†ìŠµë‹ˆë‹¤');
                return;
            }
            
            // ìˆœìœ„ ìˆœìœ¼ë¡œ íŒ€ ì •ë ¬
            const rankedTeams = dashboardData.standings.map(team => team.team_name);
            console.log('rankedTeams:', rankedTeams);
            
            // í—¤ë” ìƒì„± (ìˆœìœ„ ìˆœìœ¼ë¡œ íŒ€ëª…ë§Œ)
            let headerHtml = '<tr><th>ê²½ê¸°ì¥</th>';
            rankedTeams.forEach(team => {
                headerHtml += `<th><strong>${team}</strong></th>`;
            });
            headerHtml += '</tr>';
            thead.innerHTML = headerHtml;
            
            // ëª¨ë“  ê²½ê¸°ì¥ ìˆ˜ì§‘
            const stadiums = new Set();
            rankedTeams.forEach(team => {
                const stadiumData = dashboardData.stadiumRecords[team];
                if (stadiumData) {
                    stadiumData.forEach(record => stadiums.add(record.stadium));
                }
            });
            
            const stadiumList = Array.from(stadiums).sort();
            let html = '';
            
            stadiumList.forEach(stadium => {
                // ê²½ê¸°ì¥ ì´ë¦„ ë‹¨ìˆœí™”
                let stadiumName = stadium;
                if (stadium.includes('ì„œìš¸')) {
                    stadiumName = stadium.includes('ì ì‹¤') ? 'ì„œìš¸ ì ì‹¤ì•¼êµ¬ì¥' : 'ì„œìš¸ ê³ ì²™ìŠ¤ì¹´ì´ë”';
                } else {
                    const parts = stadium.split(' ');
                    stadiumName = parts[0] + ' ' + parts[1];
                }
                
                // í™ˆíŒ€ í™•ì¸
                const homeTeam = 
                    stadium.includes('ê´‘ì£¼') ? 'KIA' :
                    stadium.includes('ì ì‹¤') ? 'LG/ë‘ì‚°' :
                    stadium.includes('ëŒ€êµ¬') ? 'ì‚¼ì„±' :
                    stadium.includes('ì¸ì²œ') ? 'SSG' :
                    stadium.includes('ìˆ˜ì›') ? 'KT' :
                    stadium.includes('ì°½ì›') ? 'NC' :
                    stadium.includes('ë¶€ì‚°') ? 'ë¡¯ë°' :
                    stadium.includes('ëŒ€ì „') ? 'í•œí™”' :
                    stadium.includes('ê³ ì²™') ? 'í‚¤ì›€' : '';
                
                html += `<tr>
                    <td><strong>${stadiumName}</strong><br><span style="font-size: 0.8rem; color: #666;">ğŸ  ${homeTeam}</span></td>
                `;
                
                // ê° íŒ€ë³„ í•´ë‹¹ ê²½ê¸°ì¥ ì„±ì  (ìˆœìœ„ìˆœ)
                rankedTeams.forEach(team => {
                    const stadiumData = dashboardData.stadiumRecords[team];
                    const teamRecord = stadiumData ? stadiumData.find(r => r.stadium === stadium) : null;
                    
                    if (teamRecord) {
                        const winRate = (parseFloat(teamRecord.win_rate) * 100).toFixed(1);
                        const winRateClass = parseFloat(teamRecord.win_rate) > 0.55 ? 'positive' : 
                                           parseFloat(teamRecord.win_rate) < 0.45 ? 'negative' : 'neutral';
                        const totalGames = teamRecord.wins + teamRecord.losses;
                        
                        // í™ˆíŒ€ì¸ì§€ í™•ì¸
                        const isHome = 
                            (team === 'KIA' && stadium.includes('ê´‘ì£¼')) ||
                            ((team === 'LG' || team === 'ë‘ì‚°') && stadium.includes('ì ì‹¤')) ||
                            (team === 'ì‚¼ì„±' && stadium.includes('ëŒ€êµ¬')) ||
                            (team === 'SSG' && stadium.includes('ì¸ì²œ')) ||
                            (team === 'KT' && stadium.includes('ìˆ˜ì›')) ||
                            (team === 'NC' && stadium.includes('ì°½ì›')) ||
                            (team === 'ë¡¯ë°' && stadium.includes('ë¶€ì‚°')) ||
                            (team === 'í•œí™”' && stadium.includes('ëŒ€ì „')) ||
                            (team === 'í‚¤ì›€' && stadium.includes('ê³ ì²™'));
                        
                        html += `<td>
                            <div class="record-cell ${winRateClass}" ${isHome ? 'style="background: #e8f4fd; border: 2px solid #3498db;"' : ''}>
                                <div class="record">${teamRecord.wins}ìŠ¹ ${teamRecord.losses}íŒ¨</div>
                                <div class="rate">${winRate}%</div>
                                <div class="games">${totalGames}ê²½ê¸°${isHome ? ' ğŸ ' : ''}</div>
                            </div>
                        </td>`;
                    } else {
                        html += `<td>
                            <div class="record-cell neutral">
                                <div class="record">-</div>
                                <div class="rate">-</div>
                            </div>
                        </td>`;
                    }
                });
                
                html += '</tr>';
            });
            
            console.log('ê²½ê¸°ì¥ë³„ í—¤ë” HTML:', headerHtml.substring(0, 100));
            console.log('ê²½ê¸°ì¥ë³„ ë°”ë”” HTML ê¸¸ì´:', html.length);
            console.log('ê²½ê¸°ì¥ë³„ HTML ë¯¸ë¦¬ë³´ê¸°:', html.substring(0, 200) + '...');
            tbody.innerHTML = html;
            console.log('âœ… renderStadiumFullAnalysis ì™„ë£Œ');
        }

        // í…Œì´ë¸” ì •ë ¬ ê¸°ëŠ¥
        function makeTableSortable(tableId) {
            const table = document.getElementById(tableId);
            if (!table) return;
            
            const headers = table.querySelectorAll('th');
            headers.forEach((header, index) => {
                header.classList.add('sortable');
                header.addEventListener('click', () => {
                    sortTable(table, index, header);
                });
            });
        }
        
        function sortTable(table, columnIndex, header) {
            const tbody = table.querySelector('tbody');
            const allRows = Array.from(tbody.querySelectorAll('tr'));
            
            // ì¼ë°˜ ë°ì´í„° í–‰ê³¼ í†µê³„ í–‰(ì›”í‰ê·  ë“±) ë¶„ë¦¬
            const dataRows = allRows.filter(row => !row.classList.contains('stats-row'));
            const statsRows = allRows.filter(row => row.classList.contains('stats-row'));
            
            // í˜„ì¬ ì •ë ¬ ìƒíƒœ í™•ì¸
            const currentSort = header.classList.contains('sort-asc') ? 'asc' : 
                               header.classList.contains('sort-desc') ? 'desc' : 'none';
            
            // ëª¨ë“  í—¤ë”ì˜ ì •ë ¬ í´ë˜ìŠ¤ ì œê±°
            table.querySelectorAll('th').forEach(h => {
                h.classList.remove('sort-asc', 'sort-desc');
            });
            
            // ë‹¤ìŒ ì •ë ¬ ë°©í–¥ ê²°ì •
            const nextSort = currentSort === 'none' ? 'desc' : 
                            currentSort === 'desc' ? 'asc' : 'desc';
            
            // ì¼ë°˜ ë°ì´í„° í–‰ë§Œ ì •ë ¬
            dataRows.sort((a, b) => {
                const aCell = a.cells[columnIndex];
                const bCell = b.cells[columnIndex];
                
                // í…ìŠ¤íŠ¸ ì¶”ì¶œ (HTML íƒœê·¸ ì œê±°)
                let aValue = aCell.textContent || aCell.innerText;
                let bValue = bCell.textContent || bCell.innerText;
                
                // ìˆ«ìì¸ì§€ í™•ì¸ (ìŠ¹ë¥ , ë“ì  ë“±)
                const aNum = parseFloat(aValue.replace(/[^\d.-]/g, ''));
                const bNum = parseFloat(bValue.replace(/[^\d.-]/g, ''));
                
                if (!isNaN(aNum) && !isNaN(bNum)) {
                    return nextSort === 'asc' ? aNum - bNum : bNum - aNum;
                }
                
                // ìŠ¹-íŒ¨ ê¸°ë¡ ì •ë ¬ (ìŠ¹ìˆ˜ ê¸°ì¤€)
                if (aValue.includes('-') && bValue.includes('-')) {
                    const aWins = parseInt(aValue.split('-')[0]);
                    const bWins = parseInt(bValue.split('-')[0]);
                    if (!isNaN(aWins) && !isNaN(bWins)) {
                        return nextSort === 'asc' ? aWins - bWins : bWins - aWins;
                    }
                }
                
                // ë¬¸ìì—´ ì •ë ¬
                return nextSort === 'asc' ? aValue.localeCompare(bValue) : bValue.localeCompare(aValue);
            });
            
            // tbody ì´ˆê¸°í™” í›„ ë°ì´í„° í–‰ë“¤ ë¨¼ì € ì¶”ê°€
            tbody.innerHTML = '';
            dataRows.forEach(row => tbody.appendChild(row));
            
            // í†µê³„ í–‰ë“¤ì„ ë§¨ ë§ˆì§€ë§‰ì— ì¶”ê°€ (ê³ ì • ìœ„ì¹˜)
            statsRows.forEach(row => tbody.appendChild(row));
            
            // í—¤ë”ì— ì •ë ¬ ìƒíƒœ í‘œì‹œ
            header.classList.add(nextSort === 'asc' ? 'sort-asc' : 'sort-desc');
        }
        
        // ëª¨ë“  í…Œì´ë¸”ì— ì •ë ¬ ê¸°ëŠ¥ ì ìš©
        function initializeTableSorting() {
            const tableIds = [
                'fullStandingsTable',
                'pythagoreanTable', 
                'clutchTable',
                'homeAwayTable',
                'monthlyTable',
                'weekdayTable',
                'stadiumTable'
            ];
            
            tableIds.forEach(id => makeTableSortable(id));
        }


        // í˜ì´ì§€ ë¡œë“œ ì‹œ ë°ì´í„° ë¡œë“œ ë° ì •ë ¬ ê¸°ëŠ¥ ì´ˆê¸°í™”
        window.addEventListener('DOMContentLoaded', () => {
            // ëŒ€ì‹œë³´ë“œ ë°ì´í„° ë¡œë“œ
            loadDashboardData().then(() => {
                // ëŒ€ì‹œë³´ë“œ ë¡œë“œ ì™„ë£Œ í›„ ì •ë ¬ ê¸°ëŠ¥ ì´ˆê¸°í™”
                setTimeout(() => {
                    initializeTableSorting();
                }, 100);
            }).catch(error => {
                console.error('ëŒ€ì‹œë³´ë“œ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:', error);
            });
            
            // ì£¼ì°¨ë³„/ê²Œì„ë³„/íŒ€ë³„ ë°ì´í„° ë¡œë“œ (ë³‘ë ¬)
            loadWeeklyAnalysisData().catch(error => {
                console.error('ì£¼ì°¨ë³„ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:', error);
            });
        });
    </script>
</body>
</html>