<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="2025Âπ¥„Ç∑„Éº„Ç∫„É≥ÊúÄÊñ∞„ÅÆNPBÈ†Ü‰ΩçË°®„ÄÇ„Çª„Éª„Éë‰∏°„É™„Éº„Ç∞„ÅÆÂãùÁéá„Éª„Ç≤„Éº„É†Â∑Æ„ÉªÊÆã„ÇäË©¶Âêà„ÉªÂÑ™Âãù„Éû„Ç∏„ÉÉ„ÇØ„Éä„É≥„Éê„Éº„ÉªCSÈÄ≤Âá∫Áä∂Ê≥Å„Çí„É™„Ç¢„É´„Çø„Ç§„É†Êõ¥Êñ∞„ÄÇ">
    <meta name="keywords" content="NPB, NPB È†Ü‰ΩçË°®, „Éó„É≠ÈáéÁêÉ, „Éû„Ç∏„ÉÉ„ÇØ„Éä„É≥„Éê„Éº, ÂãùÁéá, „Ç≤„Éº„É†Â∑Æ, CSÈÄ≤Âá∫, „Éù„Çπ„Éà„Ç∑„Éº„Ç∫„É≥, „É™„Ç¢„É´„Çø„Ç§„É†">
    <meta name="author" content="NPB Statistics">
    <meta name="robots" content="index, follow">
    <meta name="language" content="ja">
    <link id="canonical-link" rel="canonical" href="https://npb-dashboard.com/">
    <link rel="alternate" hreflang="ja" data-hreflang="ja" href="https://npb-dashboard.com/">
    <link rel="alternate" hreflang="ko" data-hreflang="ko" href="https://npb-dashboard.com/?lang=ko">
    <link rel="alternate" hreflang="en" data-hreflang="en" href="https://npb-dashboard.com/?lang=en">
    <link rel="alternate" hreflang="x-default" data-hreflang="x-default" href="https://npb-dashboard.com/">
    <link rel="sitemap" type="application/xml" href="https://npb-dashboard.com/sitemap.xml">
    <meta name="theme-color" content="#333">
    <meta name="application-name" content="NPB Dashboard">
    <meta name="msapplication-TileColor" content="#333">
    <meta name="google-site-verification" content="placeholder-verification-code">
    <meta name="google-adsense-account" content="ca-pub-5508768187151867">
    
    <title>NPB È†Ü‰ΩçË°® 2025ÔΩú„Éó„É≠ÈáéÁêÉ ÂãùÁéá„Éª„Ç≤„Éº„É†Â∑Æ„Éª„Éû„Ç∏„ÉÉ„ÇØ„Éä„É≥„Éê„Éº„ÉªCSÈÄ≤Âá∫Áä∂Ê≥Å</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" sizes="32x32" href="favicon.png">
    <link rel="icon" type="image/png" sizes="16x16" href="favicon.png">
    <link rel="apple-touch-icon" href="favicon.png">
    <link rel="shortcut icon" href="favicon.png">
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://npb-dashboard.com/">
    <meta property="og:title" content="NPBÈ†Ü‰ΩçË°® 2025ÔΩúÂãùÁéá„Éª„Ç≤„Éº„É†Â∑Æ„Éª„Éû„Ç∏„ÉÉ„ÇØ„Éä„É≥„Éê„Éº„ÉªCSÈÄ≤Âá∫Áä∂Ê≥Å">
    <meta property="og:description" content="2025Âπ¥„Ç∑„Éº„Ç∫„É≥ÊúÄÊñ∞„ÅÆNPBÈ†Ü‰ΩçË°®„ÄÇ„Çª„Éª„Éë‰∏°„É™„Éº„Ç∞„ÅÆÂãùÁéá„Éª„Ç≤„Éº„É†Â∑Æ„ÉªÊÆã„ÇäË©¶Âêà„ÉªÂÑ™Âãù„Éû„Ç∏„ÉÉ„ÇØ„Éä„É≥„Éê„Éº„ÉªCSÈÄ≤Âá∫Áä∂Ê≥Å„Çí„É™„Ç¢„É´„Çø„Ç§„É†Êõ¥Êñ∞„ÄÇ">
    <meta property="og:image" content="https://npb-dashboard.com/images/npb-og-image.jpg">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:site_name" content="NPB Statistics">
    <meta property="og:locale" content="ja_JP">
    <meta property="article:publisher" content="https://npb-dashboard.com">
    <meta property="article:section" content="Sports">
    
    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:url" content="https://npb-dashboard.com/">
    <meta name="twitter:title" content="NPB È†Ü‰ΩçË°® 2025ÔΩú„Éû„Ç∏„ÉÉ„ÇØ„ÉªCSÈÄ≤Âá∫Áä∂Ê≥Å">
    <meta name="twitter:description" content="2025Âπ¥„Ç∑„Éº„Ç∫„É≥ÊúÄÊñ∞„ÅÆNPBÈ†Ü‰ΩçË°®„ÄÇ„Çª„Éª„Éë‰∏°„É™„Éº„Ç∞„ÅÆÂãùÁéá„Éª„Ç≤„Éº„É†Â∑Æ„ÉªÊÆã„ÇäË©¶Âêà„ÉªÂÑ™Âãù„Éû„Ç∏„ÉÉ„ÇØ„Éä„É≥„Éê„Éº„ÉªCSÈÄ≤Âá∫Áä∂Ê≥Å„Çí„É™„Ç¢„É´„Çø„Ç§„É†Êõ¥Êñ∞„ÄÇ">
    <meta name="twitter:image" content="https://npb-dashboard.com/images/npb-og-image.jpg">
    <meta name="twitter:site" content="@npb_dashboard">
    <meta name="twitter:creator" content="@npb_dashboard">
    
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-LFKN46L0P6"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);} 
      gtag('js', new Date());
      gtag('config', 'G-LFKN46L0P6');
    </script>

    <!-- Preload AdSense for faster loading -->
    <link rel="preload" as="script" href="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5508768187151867" crossorigin="anonymous">

    <!-- Google AdSense -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5508768187151867" crossorigin="anonymous"></script>

    <!-- Disable verbose console output in production -->
    <script>
      (function() {
        const noop = () => {};
        ['debug'].forEach(method => {
          try {
            console[method] = noop;
          } catch (err) {
            // ignore assignment failures
          }
        });
      })();
    </script>

    <!-- ApexCharts ÎùºÏù¥Î∏åÎü¨Î¶¨ -->
    <script src="https://cdn.jsdelivr.net/npm/apexcharts@latest"></script>
    <script>
        // ApexCharts Î°úÎìú ÌôïÏù∏
        function checkApexChartsLoad() {
            if (typeof ApexCharts !== 'undefined') {
                return true;
            }
            console.warn('ApexCharts Î°úÎìú Ïã§Ìå®');
            return false;
        }

        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(checkApexChartsLoad, 100);
        });
    </script>
    
    <!-- Structured Data -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@graph": [
        {
          "@type": "WebSite",
          "@id": "https://npb-dashboard.com/#website",
          "url": "https://npb-dashboard.com/",
          "name": "NPB Dashboard",
          "description": "2025Âπ¥„Ç∑„Éº„Ç∫„É≥ÊúÄÊñ∞„ÅÆNPBÈ†Ü‰ΩçË°®„ÄÇ„Çª„Éª„Éë‰∏°„É™„Éº„Ç∞„ÅÆÂãùÁéá„Éª„Ç≤„Éº„É†Â∑Æ„ÉªÊÆã„ÇäË©¶Âêà„ÉªÂÑ™Âãù„Éû„Ç∏„ÉÉ„ÇØ„Éä„É≥„Éê„Éº„ÉªCSÈÄ≤Âá∫Áä∂Ê≥Å„Çí„É™„Ç¢„É´„Çø„Ç§„É†Êõ¥Êñ∞„ÄÇ",
          "inLanguage": "ja",
          "publisher": {
            "@id": "https://npb-dashboard.com/#organization"
          }
        },
        {
          "@type": "WebApplication",
          "@id": "https://npb-dashboard.com/#webapp",
          "name": "NPB Statistics Dashboard",
          "description": "NPB(Êó•Êú¨„Éó„É≠ÈáéÁêÉ)2025Âπ¥„Ç∑„Éº„Ç∫„É≥„ÅÆÈ†Ü‰ΩçË°®„Å®„Éû„Ç∏„ÉÉ„ÇØ„Éä„É≥„Éê„ÉºÊÉÖÂ†±„Çí„É™„Ç¢„É´„Çø„Ç§„É†„ÅßËøΩË∑°„Åô„Çã„ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„Éâ",
          "url": "https://npb-dashboard.com/",
          "applicationCategory": "Sports Statistics Application",
          "operatingSystem": "Any",
          "browserRequirements": "Modern web browser",
          "isAccessibleForFree": true,
          "featureList": [
            "„É™„Ç¢„É´„Çø„Ç§„É†È†Ü‰ΩçË°®",
            "„Éû„Ç∏„ÉÉ„ÇØ„Éä„É≥„Éê„ÉºË®àÁÆó",
            "„Éó„É¨„Éº„Ç™„ÉïÈÄ≤Âá∫Áä∂Ê≥Å",
            "ÂãùÁéá„Ç∑„Éä„É™„Ç™ÂàÜÊûê",
            "ÊÆã„ÇäË©¶ÂêàÊï∞Áµ±Ë®à"
          ],
          "keywords": "Êó•Êú¨„Éó„É≠ÈáéÁêÉ,NPB,È†Ü‰ΩçË°®,„Éû„Ç∏„ÉÉ„ÇØ,ÂÑ™Âãù,„Éó„É¨„Éº„Ç™„Éï,CS,ÈáéÁêÉÁµ±Ë®à",
          "inLanguage": "ja",
          "audience": {
            "@type": "Audience",
            "audienceType": "Baseball fans",
            "geographicArea": {
              "@type": "Country",
              "name": "Japan"
            }
          },
          "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "JPY"
          },
          "publisher": {
            "@id": "https://npb-dashboard.com/#organization"
          }
        },
        {
          "@type": "SportsOrganization",
          "@id": "https://npb-dashboard.com/#organization",
          "name": "NPB Dashboard",
          "sport": "Baseball",
          "url": "https://npb-dashboard.com/",
          "logo": "https://npb-dashboard.com/favicon.png",
          "image": "https://npb-dashboard.com/favicon.png",
          "foundingDate": "2025",
          "memberOf": {
            "@type": "SportsOrganization",
            "name": "Nippon Professional Baseball",
            "url": "https://npb.jp"
          }
        }
      ]
    }
    </script>
    
    <style>
        :root {
            --header-height: 64px;
            --nav-height: 50px;
            --ticker-height: 44px;
            --max-width: 1200px;
            --content-padding: 20px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: Arial, sans-serif;
            background: white;
            color: black;
            font-size: 14px;
            line-height: 1.4;
            min-width: 320px;
            margin: 0;
            padding: 0;
        }
        
        .header {
            background: #333;
            color: white;
            padding: 0;
            height: var(--header-height);
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
        }

        .header-content {
            max-width: var(--max-width);
            margin: 0 auto;
            padding: 0 var(--content-padding);
            display: flex;
            align-items: center;
            justify-content: space-between;
            height: 100%;
            gap: var(--content-padding);
        }

        .site-name {
            font-size: 16px;
            font-weight: bold;
            color: white;
            text-decoration: none;
        }
        
        .language-selector {
            display: flex;
            gap: 5px;
            align-items: center;
            flex-shrink: 0;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 16px;
            min-width: 0;
            flex: 1;
        }

        .header-left h1 {
            font-size: 18px;
            line-height: 1.2;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .lang-btn {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 3px;
            padding: 4px 8px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s ease;
        }
        
        .lang-btn:hover {
            background: rgba(255, 255, 255, 0.3);
        }
        
        .lang-btn.active {
            background: #fff;
            color: #333;
            font-weight: bold;
        }
        
        h1 { 
            font-size: 18px; 
            margin: 0; 
            font-weight: bold;
        }
        
        .nav {
            background: #f5f5f5;
            border-bottom: 2px solid #ddd;
            width: 100%;
            position: fixed;
            top: var(--header-height);
            left: 0;
            right: 0;
            z-index: 999;
            height: var(--nav-height);
            display: flex;
            align-items: center;
        }

        .nav-tabs {
            display: flex;
            max-width: var(--max-width);
            margin: 0 auto;
            justify-content: center;
            flex-wrap: wrap;
            width: 100%;
            padding: 0 var(--content-padding);
        }

        .nav-tab {
            cursor: pointer;
            font-size: 13px;
            background: transparent;
            border: none;
            font-family: inherit;
            flex: 1;
            min-width: 120px;
            text-align: center;
            white-space: nowrap;
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100%;
            position: relative;
            color: #333;
            transition: color 0.2s ease;
        }

        .nav-tab::before {
            content: '';
            position: absolute;
            left: 0;
            right: 0;
            bottom: -2px;
            height: 4px;
            background: transparent;
            transition: background 0.2s ease;
        }

        .nav-tab:hover {
            color: #0066cc;
        }

        .nav-tab.active {
            color: #0066cc;
            font-weight: 700;
        }

        .nav-tab.active::before {
            background: #0066cc;
        }

        .nav-tab + .nav-tab {
            border-left: 1px solid #ddd;
        }

        .game-ticker {
            position: fixed;
            top: calc(var(--header-height) + var(--nav-height));
            left: 0;
            right: 0;
            background-color: #fff;
            border-bottom: 1px solid #ddd;
            height: 40px;
            z-index: 998;
            overflow: hidden;
            display: flex;
            align-items: center;
        }

        .game-ticker {
            height: 44px;
            background-color: #fff;
            border-bottom: 1px solid #ddd;
            position: fixed;
            top: calc(var(--header-height) + var(--nav-height));
            left: 0;
            right: 0;
            z-index: 998;
            display: flex;
            justify-content: center;
        }

        .ticker-content {
            display: flex;
            align-items: center;
            max-width: var(--max-width);
            width: 100%;
            margin: 0 auto;
            padding: 0 var(--content-padding);
        }

        .ticker-date-controls {
            display: flex;
            align-items: center;
            gap: 8px;
            flex-shrink: 0;
            padding: 4px 12px;
            margin-left: 15px;
            white-space: nowrap;
        }

        .ticker-date-nav {
            cursor: pointer;
            font-size: 18px;
            font-weight: bold;
            user-select: none;
            color: #0066cc; /* Highlight navigation buttons */
        }

        .ticker-date-nav.disabled {
            color: #b0b0b0;
            cursor: not-allowed;
            opacity: 0.5;
            pointer-events: none;
        }

        .ticker-date {
            font-weight: bold;
            font-size: 13px;
            color: #333;
            white-space: nowrap;
            text-align: center;
            line-height: 1.2;
            cursor: pointer;
            user-select: none;
        }

        .ticker-games-container {
            flex: 1;
            overflow-x: auto;
            white-space: nowrap;
            -webkit-overflow-scrolling: touch;
            scrollbar-width: none;
            -ms-overflow-style: none;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .ticker-games-container::-webkit-scrollbar {
            display: none;
        }

        .ticker-games {
            display: inline-flex;
            gap: 15px;
            align-items: center;
            white-space: nowrap;
        }
        .ticker-game {
            position: relative;
        }
        .ticker-game:not(:last-child)::after {
            content: '|';
            position: absolute;
            right: -8px;
            top: 50%;
            transform: translateY(-50%);
            color: #ccc;
            font-size: 12px;
        }

        .ticker-games.scrolling {
            animation: scroll-left 20s linear infinite;
        }

        @keyframes scroll-left {
            0% {
                transform: translateX(100%);
            }
            100% {
                transform: translateX(-100%);
            }
        }

        .ticker-games-container:hover .ticker-games.scrolling {
            animation-play-state: paused;
        }
            padding: 2px 10px 0 10px; /* Ensure games are not cut off */
            height: 100%;
            align-items: flex-start;
            justify-content: center;
            min-width: min-content;
        }

        .ticker-game {
            display: inline-flex;
            flex-direction: column;
            gap: 2px;
            flex-shrink: 0; /* Prevent games from shrinking */
            padding: 0 8px;
            border-right: 1px solid #e0e0e0;
            min-height: 36px;
        }
        .ticker-game:last-child {
            border-right: none;
        }

        .ticker-team {
            display: flex;
            align-items: center;
            gap: 2px;
        }

        .ticker-team-name {
            font-size: 13px;
            font-weight: 600;
        }

        .ticker-score {
            font-weight: bold;
            font-size: 14px;
            margin: 0 2px;
        }
        
        .ticker-status {
            font-size: 11px;
            color: #666;
            white-space: nowrap;
        }

        .ticker-team-logo {
            height: 18px;
            width: 18px;
            object-fit: contain;
            vertical-align: middle;
            margin: 0 1px;
        }
        .ticker-team.winner .ticker-team-name {
            font-weight: bold;
            color: #2e7d32;
        }
        .ticker-team.winner .ticker-score {
            color: #2e7d32;
            font-weight: bold;
        }
        
        .container {
            max-width: var(--max-width);
            margin: 0 auto;
            padding: 0;
            width: 100%;
        }
        
        .tab-content {
            display: none;
            scroll-margin-top: calc(var(--header-height) + var(--nav-height) + var(--ticker-height) + 20px);
        }

        .tab-content.active {
            display: block;
            padding-top: 0px; /* Reset padding */
            margin-top: 20px; /* Add margin instead of padding */
        }
        
        h2 { 
            font-size: 16px; 
            margin: 15px 0 8px 0; 
            font-weight: bold; 
        }
        
        h3 {
            font-size: 14px;
            margin: 10px 0;
            font-weight: bold;
        }
        
        table { 
            border-collapse: collapse; 
            width: 100%; 
            margin: 10px 0;
            table-layout: fixed;
        }
        
        th, td {
            border: 1px solid #ddd;
            padding: 4px 6px;
            text-align: center;
            font-size: 13px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            line-height: 1.2;
            height: 30px;
            vertical-align: middle;
        }

        /* Ìó§ÎçîÎäî Ï¢åÏ∏° Ï†ïÎ†¨ */
        th {
            text-align: left;
        }

        /* Left header column (team name) left-align */
        .magic-table td:nth-child(2) {
            text-align: left;
        }

        /* Team standings table: center-align team name header, left-align data */
        .detailed-table th:nth-child(2) {
            text-align: center;
        }
        .detailed-table td:nth-child(2) {
            text-align: left;
        }

        .magic-table { table-layout: fixed; width: 100%; }

        /* ÂÑ™Âãù„Éû„Ç∏„ÉÉ„ÇØ ÌÉ≠ Ïª¨Îüº ÏµúÏ†ÅÌôî - 1200px Í∏∞Ï§Ä */
        #magic-regular th:nth-child(1),
        #magic-regular td:nth-child(1) { width: 45px !important; }  /* È†Ü‰Ωç */
        #magic-regular th:nth-child(2),
        #magic-regular td:nth-child(2) { width: 230px !important; }  /* „ÉÅ„Éº„É† */
        #magic-regular th:nth-child(3),
        #magic-regular td:nth-child(3) { width: 50px !important; }  /* Ë©¶Âêà */
        #magic-regular th:nth-child(4),
        #magic-regular td:nth-child(4) { width: 40px !important; }  /* Âãù */
        #magic-regular th:nth-child(5),
        #magic-regular td:nth-child(5) { width: 40px !important; }  /* Êïó */
        #magic-regular th:nth-child(6),
        #magic-regular td:nth-child(6) { width: 40px !important; }  /* ÂàÜ */
        #magic-regular th:nth-child(7),
        #magic-regular td:nth-child(7) { width: 55px !important; }  /* ÂãùÁéá */
        #magic-regular th:nth-child(8),
        #magic-regular td:nth-child(8) { width: 75px !important; }  /* „Ç≤„Éº„É†Â∑Æ */
        #magic-regular th:nth-child(9),
        #magic-regular td:nth-child(9) { width: 75px !important; }  /* ÊÆã„ÇäË©¶Âêà */
        #magic-regular th:nth-child(10),
        #magic-regular td:nth-child(10) { width: 65px !important; }  /* ÊúÄÂ§ßÂãù */
        #magic-regular th:nth-child(11),
        #magic-regular td:nth-child(11) { width: 90px !important; }  /* 1‰ΩçÊù°‰ª∂ */
        #magic-regular th:nth-child(12),
        #magic-regular td:nth-child(12) { width: 90px !important; }  /* „Éû„Ç∏„ÉÉ„ÇØ */
        #magic-regular th:nth-child(13),
        #magic-regular td:nth-child(13) { width: 105px !important; }  /* „Ç®„É™„Éü„Éç„Éº„Éà */
        #magic-regular th:nth-child(14),
        #magic-regular td:nth-child(14) { width: 120px !important; }  /* ÈÄ≤Âá∫Áä∂Ê≥Å */

        /* „Éù„Çπ„Éà„Ç∑„Éº„Ç∫„É≥„Éû„Ç∏„ÉÉ„ÇØ ÌÉ≠ Ïª¨Îüº ÏµúÏ†ÅÌôî - 1200px Í∏∞Ï§Ä */
        #magic-playoff th:nth-child(1),
        #magic-playoff td:nth-child(1) { width: 45px !important; }  /* È†Ü‰Ωç */
        #magic-playoff th:nth-child(2),
        #magic-playoff td:nth-child(2) { width: 260px !important; }  /* „ÉÅ„Éº„É† */
        #magic-playoff th:nth-child(3),
        #magic-playoff td:nth-child(3) { width: 45px !important; }  /* Âãù */
        #magic-playoff th:nth-child(4),
        #magic-playoff td:nth-child(4) { width: 45px !important; }  /* Êïó */
        #magic-playoff th:nth-child(5),
        #magic-playoff td:nth-child(5) { width: 45px !important; }  /* ÂàÜ */
        #magic-playoff th:nth-child(6),
        #magic-playoff td:nth-child(6) { width: 60px !important; }  /* ÂãùÁéá */
        #magic-playoff th:nth-child(7),
        #magic-playoff td:nth-child(7) { width: 60px !important; }  /* Ë©¶Âêà */
        #magic-playoff th:nth-child(8),
        #magic-playoff td:nth-child(8) { width: 80px !important; }  /* „Ç≤„Éº„É†Â∑Æ */
        #magic-playoff th:nth-child(9),
        #magic-playoff td:nth-child(9) { width: 80px !important; }  /* ÊÆã„ÇäË©¶Âêà */
        #magic-playoff th:nth-child(10),
        #magic-playoff td:nth-child(10) { width: 70px !important; }  /* ÊúÄÂ§ßÂãù */
        #magic-playoff th:nth-child(11),
        #magic-playoff td:nth-child(11) { width: 95px !important; }  /* „Éû„Ç∏„ÉÉ„ÇØ */
        #magic-playoff th:nth-child(12),
        #magic-playoff td:nth-child(12) { width: 110px !important; }  /* „Ç®„É™„Éü„Éç„Éº„Éà */
        #magic-playoff th:nth-child(13),
        #magic-playoff td:nth-child(13) { width: 125px !important; }  /* ÈÄ≤Âá∫Áä∂Ê≥Å */

        /* ÏÉÅÏÑ∏ ÏàúÏúÑ ÌÖåÏù¥Î∏î Í≥†Ï†ï Ìè≠ */
        .detailed-table {
            table-layout: fixed;
            width: 100%;
        }

        .detailed-table th:nth-child(1),
        .detailed-table td:nth-child(1) { width: 45px; }
        .detailed-table th:nth-child(2),
        .detailed-table td:nth-child(2) {
            width: 200px;
            white-space: nowrap;
            overflow: visible;
            text-overflow: initial;
        }
        .detailed-table th:nth-child(3),
        .detailed-table td:nth-child(3) { width: 45px; }
        .detailed-table th:nth-child(4),
        .detailed-table td:nth-child(4) { width: 40px; }
        .detailed-table th:nth-child(5),
        .detailed-table td:nth-child(5) { width: 40px; }
        .detailed-table th:nth-child(6),
        .detailed-table td:nth-child(6) { width: 40px; }
        .detailed-table th:nth-child(7),
        .detailed-table td:nth-child(7) { width: 65px; }
        .detailed-table th:nth-child(8),
        .detailed-table td:nth-child(8) { width: 68px; }
        .detailed-table th:nth-child(9),
        .detailed-table td:nth-child(9) { width: 68px; }
        .detailed-table th:nth-child(10),
        .detailed-table td:nth-child(10) { width: 65px; }
        .detailed-table th:nth-child(11),
        .detailed-table td:nth-child(11) { width: 70px; }
        .detailed-table th:nth-child(12),
        .detailed-table td:nth-child(12) { width: 70px; }
        .detailed-table th:nth-child(13),
        .detailed-table td:nth-child(13) { width: 65px; }
        .detailed-table th:nth-child(14),
        .detailed-table td:nth-child(14) { width: 70px; }
        .detailed-table th:nth-child(15),
        .detailed-table td:nth-child(15) { width: 65px; }
        .detailed-table th:nth-child(16),
        .detailed-table td:nth-child(16) { width: 68px; }
        .detailed-table th:nth-child(17),
        .detailed-table td:nth-child(17) { width: 68px; }
        .detailed-table th:nth-child(18),
        .detailed-table td:nth-child(18) { width: 68px; }
        .detailed-table th:nth-child(19),
        .detailed-table td:nth-child(19) { width: 78px; }

        /* „Éõ„Éº„É†/„Ç¢„Ç¶„Çß„ÉºÈñ¢ÈÄ£ Ïª¨Îüº Ìå®Îî© Ï∂ïÏÜå */
        .detailed-table th:nth-child(16),
        .detailed-table th:nth-child(17),
        .detailed-table th:nth-child(18),
        .detailed-table th:nth-child(19) {
            padding: 2px 1px;
            font-size: 12px;
        }

        th { 
            background: #f5f5f5; 
            font-weight: bold;
            padding: 5px 3px;
        }

        .detailed-table td {
            padding: 5px 3px;
        }

        /* All games table style */
        .games-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 13px;
        }

        .games-table th,
        .games-table td {
            padding: 8px 6px;
            text-align: center;
            border-bottom: 1px solid #e0e0e0;
        }

        .games-table th {
            background: #f8f9fa;
            font-weight: bold;
            color: #333;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .games-table tbody tr:hover {
            background-color: #f5f5f5;
        }

        .games-table .win-team {
            font-weight: bold;
            color: #2e7d32;
        }

        .games-table .draw-game {
            color: #666;
            font-style: italic;
        }

        .games-table .extended-inning {
            color: #d32f2f;
            font-weight: bold;
        }

        .games-table .weekend-game {
            background-color: #fff3cd !important;
        }

        .games-table .weekend-game:hover {
            background-color: #ffeaa7 !important;
        }

        .games-table .team-logo {
            width: 20px;
            height: 20px;
            margin-right: 5px;
            vertical-align: middle;
        }

        .games-table .team-info {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* All games table column width optimization */
        .games-table {
            table-layout: fixed;
        }

        /* Ï†ÑÏ≤¥ Í≤åÏûÑ ÌÖåÏù¥Î∏î Ïª¨Îüº Ìè≠ - 1200px Í∏∞Ï§Ä ÌôïÏû• */
        .games-table th:nth-child(1),
        .games-table td:nth-child(1) {
            width: 120px; /* ÎÇ†Ïßú„ÉªÏöîÏùº: "9/17 (ÁÅ´)" */
        }

        .games-table th:nth-child(2),
        .games-table td:nth-child(2) {
            width: 60px; /* Î¶¨Í∑∏: "„Çª", "„Éë" */
        }

        .games-table th:nth-child(3),
        .games-table td:nth-child(3) {
            width: 200px; /* Away team: logo + team name */
        }

        .games-table th:nth-child(4),
        .games-table td:nth-child(4) {
            width: 100px; /* Ïä§ÏΩîÏñ¥: "10 - 5" ÎòêÎäî "3 - 3 (ÂºïÂàÜ)" */
        }

        .games-table th:nth-child(5),
        .games-table td:nth-child(5) {
            width: 200px; /* Home team: logo + team name */
        }

        .games-table th:nth-child(6),
        .games-table td:nth-child(6) {
            width: 80px; /* ÏãúÍ∞Ñ: "18:00", "14:00" */
        }

        .games-table th:nth-child(7),
        .games-table td:nth-child(7) {
            width: 150px; /* Íµ¨Ïû•: "Êù±‰∫¨„Éâ„Éº„É†", "Áî≤Â≠êÂúí" */
        }

        .games-table th:nth-child(8),
        .games-table td:nth-child(8) {
            width: 70px; /* Ïù¥Îãù: "9Âõû", "12Âõû" */
        }
        
        tr:nth-child(even) { 
            background: #f9f9f9; 
        }
        
        .leagues { 
            display: grid; 
            /* Always stack leagues vertically (Central above Pacific) */
            grid-template-columns: 1fr; 
            gap: 30px; 
            margin: 20px 0; 
        }
        
        .center { 
            text-align: center; 
        }
        
        .right { 
            text-align: right; 
        }
        
        .rank1 { 
            background: #e8f1ff; 
        }
        
        .rank2 { 
            background: #f0f0f0; 
        }
        
        .rank3 { 
            background: #f3f8ff; 
        }
        
        .win { 
            color: #0066cc; 
        }
        
        .loss { 
            color: #cc0000; 
        }
        
        .pct { 
            font-weight: bold; 
        }
        
        .info { 
            font-size: 13px; 
            color: #333; 
            margin: 10px 0;
            text-align: center;
        }

        #meta-bar {
            display: none;
        }
        
        .loading { 
            text-align: center; 
            padding: 20px; 
            color: #444; 
        }
        
        .magic-number { 
            font-size: 15px; 
            font-weight: bold; 
            color: #0066cc; 
        }
        
        .eliminated { 
            color: #cc0000; 
        }
        
        .clinched { 
            color: #00aa00; 
        }

        .row-eliminated {
            background: #ececec !important;
        }

        .row-eliminated td {
            background: transparent;
            color: #999 !important;
        }

        .scroll-table { 
            overflow-x: auto; 
        }

        
        /* Progress Tab Styles */
        .league-progress {
            background: #fff;
            border-radius: 10px;
            padding: 20px;
            border: 1px solid #ddd;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        
        .team-progress-item {
            display: flex;
            flex-direction: column;
            gap: 6px;
            margin-bottom: 8px;
            padding: 12px;
            border-radius: 8px;
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            transition: background-color 0.2s ease;
        }

        .team-progress-item:hover {
            background: #e9ecef;
        }

        .team-progress-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 12px;
        }

        .team-progress-name {
            font-weight: 600;
            font-size: 14px;
            color: #333;
            display: flex;
            align-items: center;
            gap: 6px;
            flex: 1;
        }

        .team-progress-bar {
            width: 100%;
            height: 18px;
            background: #e0e0e0;
            border-radius: 9px;
            overflow: hidden;
            border: 1px solid #ccc;
        }

        .team-progress-fill {
            height: 100%;
            transition: width 0.8s ease;
            border-radius: 8px;
            background: linear-gradient(90deg, currentColor, currentColor);
        }

        .team-progress-text {
            font-size: 14px;
            font-weight: 700;
            color: #333;
            text-align: right;
            white-space: nowrap;
        }

        .team-progress-summary {
            display: flex;
            align-items: center;
            gap: 8px;
            width: 100%;
            font-size: 13px;
            color: #444;
            background: #f1f3f5;
            border-radius: 12px;
            padding: 6px 10px;
        }

        .team-progress-summary span {
            flex: 1;
            font-weight: 600;
        }

        .team-progress-summary .summary-completed {
            text-align: left;
            color: #2e7d32;
        }

        .team-progress-summary .summary-remaining {
            text-align: center;
            color: #ff6f00;
        }

        .team-progress-summary .summary-total {
            text-align: right;
            color: #333;
        }

        .streak-win {
            color: #2e7d32;
            font-weight: 700;
        }

        .streak-loss {
            color: #c62828;
            font-weight: 700;
        }

        .streak-draw {
            color: #555;
            font-weight: 600;
        }
        
        .stat-card {
            background: #fff;
            border: 1px solid #ddd;
            border-radius: 10px;
            padding: 18px;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            transition: transform 0.2s ease;
        }
        
        .stat-card:hover {
            transform: translateY(-2px);
        }
        
        .stat-title {
            font-size: 13px;
            color: #666;
            margin-bottom: 8px;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .stat-value {
            font-size: 20px;
            font-weight: bold;
            color: #2e7d32;
            line-height: 1.2;
        }
        .league-tag {
            display: inline-block;
            font-size: 12px;
            padding: 2px 6px;
            border-radius: 10px;
            border: 1px solid #bbb;
            background: #f7f7f7;
        }
        .league-central { background: #e8f2ff; border-color: #b7d3ff; }
        .league-pacific { background: #e9fff0; border-color: #b9efcd; }

        /* Toggle */
        .schedule-toggle { margin-top: 8px; }
        .toggle-group {
            display: inline-flex;
            border: 1px solid #ddd;
            border-radius: 999px;
            overflow: hidden;
            background: #fafafa;
        }
        .toggle-btn {
            padding: 6px 12px;
            font-size: 13px;
            border: none;
            background: transparent;
            cursor: pointer;
        }
        .toggle-btn.active {
            background: white;
            color: #000;
            font-weight: bold;
        }
        
        @media (max-width: 768px) {
            :root {
                --content-padding: 10px;
            }

            .leagues {
                grid-template-columns: 1fr;
                gap: 20px;
            }

            .container {
                padding: var(--content-padding);
            }

            .nav-tabs {
                flex-direction: column;
                padding: 0 var(--content-padding);
            }

            .nav {
                top: 39px; /* Adjust for mobile header height */
            }

            .header-content {
                padding: 0 var(--content-padding);
            }

            .ticker-content {
                padding: 0 var(--content-padding);
            }

            /* Progress tab mobile layout */
            #progress .grid-3col {
                grid-template-columns: 1fr !important;
                gap: 10px !important;
            }

            #progress .ad-center {
                order: 2;
                margin: 10px 0 !important;
            }

            .nav-tab {
                width: 100%;
                border-right: none;
                border-bottom: 1px solid #ddd;
            }
            
            .games-grid {
                grid-template-columns: 1fr;
            }
            
            .game-row span:first-child,
            .game-row span:last-child {
                max-width: 40%;
                font-size: 12px;
            }
            
            table { 
                font-size: 12px; 
            }
            
            th, td { 
                padding: 4px 6px; 
            }
            
            .nav-tab { 
                padding: 8px 10px; 
                font-size: 12px; 
                white-space: nowrap;
            }
            
            .scroll-table {
                width: 100%;
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
            }

            .scroll-table table {
                min-width: 800px;
            }

            .games-grid { grid-template-columns: 1fr; }
        }

        /* Layout: sticky footer without JS (flex column) */
        html, body { height: 100%; }
        body { display: flex; flex-direction: column; min-height: 100vh; }
        main { flex: 1 0 auto; padding-top: calc(var(--header-height) + var(--nav-height) + var(--ticker-height)); }
        
        /* Simple site footer (flow layout; pushed to bottom by flex) */
        .site-footer {
            margin-top: auto;
            background: #ffffff; border-top: 1px solid #cfcfcf;
            box-shadow: 0 -2px 8px rgba(0,0,0,0.06);
        }
        .site-footer .footer-content {
            max-width: var(--max-width);
            margin: 0 auto;
            padding: 12px var(--content-padding);
            color: #222;
            font-size: 13px;
            line-height: 1.5;
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 8px;
            flex-wrap: wrap;
        }
        .site-footer a { color: #0066cc; text-decoration: none; }
        .site-footer a:hover { text-decoration: underline; }
        .site-footer { padding-bottom: env(safe-area-inset-bottom); }
        .today-date { color: #444; }

        /* Team logo before name */
        .team-logo {
            height: 1.2em;
            width: auto;
            vertical-align: text-bottom;
            margin-right: 0.35em;
        }

        /* Remaining games matrix styles */
        .matrix-container {
            overflow-x: auto;
            margin: 20px auto;
            background: white;
            border: 1px solid #ddd;
            border-radius: 4px;
            display: inline-block;
            max-width: 100%;
        }

        .remaining-matrix {
            display: grid;
            gap: 0;
            background: white;
            font-size: 14px;
            min-width: fit-content;
            margin: 0 auto;
        }

        .matrix-cell {
            background: white;
            padding: 6px;
            border: 1px solid #e0e0e0;
            display: flex;
            align-items: center;
        }

        .matrix-header-team {
            background: #f8f9fa;
            font-weight: bold;
            padding: 8px 10px;
            text-align: left;
            white-space: nowrap;
            justify-content: flex-start;
            position: sticky;
            left: 0;
            z-index: 1;
            border-right: 2px solid #ddd;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 180px;
        }

        .matrix-header-opponent {
            background: #f8f9fa;
            font-weight: bold;
            padding: 8px 6px;
            text-align: left;
            white-space: nowrap;
            border-bottom: 2px solid #ddd;
            overflow: hidden;
            text-overflow: ellipsis;
            font-size: 13px;
            min-width: 100px;
        }
        
        .matrix-header-opponent .team-logo {
            height: 0.9em;
            width: auto;
            margin-right: 2px;
        }

        .matrix-data-cell {
            font-weight: normal;
            font-size: 14px;
            width: 100%;
        }

        .matrix-data-cell.zero {
            color: #ccc;
            background: #fafafa;
        }

        .matrix-data-cell.has-games {
            background: #e3f2fd;
            color: #1565c0;
            font-weight: bold;
        }

        .matrix-total-cell {
            background: #fff3e0;
            font-weight: bold;
            color: #e65100;
            border: 1px solid #ffcc80;
        }

        .matrix-corner {
            background: #37474f;
            color: white;
            font-size: 13px;
            font-weight: bold;
        }

        /* Responsive adjustments for matrix */
        @media (max-width: 768px) {
            .remaining-matrix {
                font-size: 12px;
            }
            
            .matrix-cell {
                padding: 6px;
            }
            
            .matrix-header-team {
                padding: 8px 6px;
            }
            
            .matrix-header-opponent {
                min-height: 100px;
                padding: 6px;
            }
        }

        /* AdSense Í∞úÏÑ† Ïä§ÌÉÄÏùº */
        .adsbygoogle {
            min-width: 320px !important;
            width: 100% !important;
            max-width: 100% !important;
            display: block !important;
            min-height: 50px !important;
        }

        /* AdSense Ïª®ÌÖåÏù¥ÎÑà Í∞úÏÑ† */
        div[style*="min-width: 320px"] {
            min-width: 320px !important;
            width: 100% !important;
            overflow: hidden !important;
            box-sizing: border-box !important;
        }

        /* ÌÉ≠ Ïª®ÌÖåÏù¥ÎÑà ÏµúÏÜå ÌÅ¨Í∏∞ Î≥¥Ïû• */
        .tab-content {
            min-width: 320px;
            width: 100%;
        }

        /* NPB chart legend style */
        .npb-chart-legend {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            margin: 15px 0;
            padding: 15px;
            background: linear-gradient(135deg, #f8fafc, #ffffff);
            border: 1px solid #e2e8f0;
            border-radius: 12px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 12px;
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 13px;
            font-weight: 500;
        }

        .legend-item:hover {
            background: #f8fafc;
            border-color: #cbd5e0;
            transform: translateY(-1px);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .legend-color {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            flex-shrink: 0;
            border: 2px solid #ffffff;
            box-shadow: 0 0 0 1px #e2e8f0;
        }

        .legend-team-logo {
            width: 18px;
            height: 18px;
            object-fit: contain;
            flex-shrink: 0;
        }

        .legend-text {
            color: #2d3748;
            font-weight: 600;
            white-space: nowrap;
        }

        .floating-actions {
            position: fixed;
            right: 18px;
            bottom: 18px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            z-index: 1200;
            pointer-events: none;
        }

        .floating-actions::after {
            content: '';
            position: absolute;
            inset: 0;
            pointer-events: none;
        }

        .floating-action-button {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            border: none;
            width: 52px;
            height: 52px;
            border-radius: 50%;
            padding: 0;
            font-size: 18px;
            font-weight: 600;
            color: #ffffff;
            background: linear-gradient(135deg, #1e3c72, #2a5298);
            box-shadow: 0 12px 24px rgba(30, 60, 114, 0.35);
            cursor: pointer;
            transition: opacity 0.2s ease, transform 0.2s ease, box-shadow 0.2s ease, filter 0.2s ease;
            pointer-events: auto;
            opacity: 1;
            transform: translateY(0);
        }

        .floating-action-button[data-variant="accent"] {
            background: linear-gradient(135deg, #00695c, #1ba39c);
            box-shadow: 0 12px 26px rgba(0, 105, 92, 0.32);
        }

        .floating-action-button:hover,
        .floating-action-button:focus-visible {
            transform: translateY(-2px);
            box-shadow: 0 16px 32px rgba(30, 60, 114, 0.45);
            filter: brightness(1.08);
        }

        .floating-action-button[data-variant="accent"]:hover,
        .floating-action-button[data-variant="accent"]:focus-visible {
            box-shadow: 0 16px 32px rgba(0, 105, 92, 0.45);
        }

        .floating-action-button:focus-visible {
            outline: 2px solid rgba(255, 255, 255, 0.9);
            outline-offset: 2px;
        }

        .floating-action-icon {
            font-size: 20px;
            line-height: 1;
        }

        .floating-action-text {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }

        .floating-action-feedback {
            position: absolute;
            right: 0;
            bottom: 100%;
            margin-bottom: 10px;
            background: rgba(33, 33, 33, 0.9);
            color: #ffffff;
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 12px;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
            opacity: 0;
            transform: translateY(6px);
            transition: opacity 0.2s ease, transform 0.2s ease;
            pointer-events: none;
            white-space: nowrap;
        }

        .floating-action-feedback.visible {
            opacity: 1;
            transform: translateY(0);
        }

        .floating-action-button.is-hidden {
            opacity: 0;
            transform: translateY(12px);
            pointer-events: none;
        }

        .floating-share-menu {
            position: absolute;
            right: 70px;
            bottom: 8px;
            display: flex;
            flex-direction: column;
            gap: 6px;
            min-width: 210px;
            padding: 10px;
            border-radius: 14px;
            background: rgba(255, 255, 255, 0.97);
            border: 1px solid rgba(30, 60, 114, 0.15);
            box-shadow: 0 18px 44px rgba(15, 23, 42, 0.22);
            opacity: 0;
            transform: translateY(12px);
            transition: opacity 0.2s ease, transform 0.2s ease;
            pointer-events: none;
            backdrop-filter: blur(12px);
        }

        .floating-share-menu::before {
            content: '';
            position: absolute;
            right: -8px;
            bottom: 22px;
            width: 16px;
            height: 16px;
            background: rgba(255, 255, 255, 0.97);
            border-left: 1px solid rgba(30, 60, 114, 0.12);
            border-bottom: 1px solid rgba(30, 60, 114, 0.12);
            transform: rotate(45deg);
            border-radius: 2px;
        }

        .floating-share-menu.is-visible {
            opacity: 1;
            transform: translateY(0);
            pointer-events: auto;
        }

        .floating-share-option {
            display: flex;
            align-items: center;
            gap: 10px;
            width: 100%;
            padding: 10px 12px;
            border: none;
            border-radius: 10px;
            background: rgba(248, 250, 252, 0.8);
            color: #1f2937;
            font-size: 13px;
            font-weight: 600;
            text-align: left;
            cursor: pointer;
            transition: background 0.2s ease, color 0.2s ease, transform 0.2s ease;
        }

        .floating-share-option:hover,
        .floating-share-option:focus-visible {
            background: rgba(21, 101, 192, 0.12);
            color: #0d47a1;
            transform: translateX(2px);
            outline: none;
        }

        .floating-share-option-icon {
            font-size: 16px;
            width: 20px;
            text-align: center;
        }

        .floating-share-option-text {
            flex: 1;
            white-space: nowrap;
        }

        @media (max-width: 600px) {
            .floating-actions {
                right: 12px;
                bottom: 12px;
                gap: 8px;
            }

            .floating-action-button {
                width: 48px;
                height: 48px;
                font-size: 17px;
                box-shadow: 0 4px 14px rgba(25, 118, 210, 0.3);
            }

            .floating-action-icon {
                font-size: 18px;
            }

            .floating-share-menu {
                right: 60px;
                bottom: 4px;
                min-width: 190px;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-content">
            <div class="header-left">
                <a href="https://npb-dashboard.com" class="site-name">NPB Dashboard</a>
                <h1 data-i18n="main-title">NPB 2025„Ç∑„Éº„Ç∫„É≥ È†Ü‰ΩçË°®„Éª„Éû„Ç∏„ÉÉ„ÇØ„Éä„É≥„Éê„Éº„ÉªCSÈÄ≤Âá∫Á¢∫Áéá</h1>
            </div>
            <div class="language-selector">
                <button class="lang-btn active" onclick="changeLanguage('ja')" data-lang="ja">üáØüáµ Êó•Êú¨Ë™û</button>
                <button class="lang-btn" onclick="changeLanguage('ko')" data-lang="ko">üá∞üá∑ ÌïúÍµ≠Ïñ¥</button>
                <button class="lang-btn" onclick="changeLanguage('en')" data-lang="en">üá∫üá∏ English</button>
            </div>
        </div>
    </div>
    
    <div class="nav">
        <div class="nav-tabs">
            <div class="nav-tab" onclick="showTab('magic-regular', this)" data-i18n="nav-magic-regular">Ê≠£Ë¶è„Ç∑„Éº„Ç∫„É≥ÂÑ™Âãù„Éû„Ç∏„ÉÉ„ÇØ</div>
            <div class="nav-tab" onclick="showTab('magic-playoff', this)" data-i18n="nav-magic-playoff">„Éù„Çπ„Éà„Ç∑„Éº„Ç∫„É≥„Éû„Ç∏„ÉÉ„ÇØ</div>
            <div class="nav-tab" onclick="showTab('scenarios', this)" data-i18n="nav-scenarios">ÁµåË∑Ø„ÅÆÊï∞</div>
            <div class="nav-tab" onclick="showTab('progress', this)" data-i18n="nav-progress">ÈÄ≤Ë°åÁä∂Ê≥Å</div>
            <div class="nav-tab" onclick="showTab('standings', this)" data-i18n="nav-standings">„ÉÅ„Éº„É†È†Ü‰Ωç</div>
            <div class="nav-tab" onclick="showTab('h2h-records', this)" data-i18n="nav-h2h-records">ÂØæÊà¶ÊàêÁ∏æ</div>
            <div class="nav-tab" onclick="showTab('remaining', this)" data-i18n="nav-remaining">ÊÆã„ÇäË©¶ÂêàÊï∞</div>
            <div class="nav-tab" onclick="showTab('season-analysis', this)" data-i18n="nav-season-analysis">„Ç∑„Éº„Ç∫„É≥ÂàÜÊûê</div>
            <div class="nav-tab" onclick="showTab('all-games', this)" data-i18n="nav-all-games">ÂÖ®Ë©¶ÂêàÁµêÊûú</div>
        </div>
    </div>
    <div id="game-ticker" class="game-ticker">
        <div class="ticker-content">
            <div class="ticker-games-container">
                <div id="ticker-games" class="ticker-games"></div>
            </div>
            <div class="ticker-date-controls">
                <span id="ticker-prev-day" class="ticker-date-nav">&lt;</span>
                <span id="ticker-date" class="ticker-date" onclick="goToToday()"></span>
                <span id="ticker-next-day" class="ticker-date-nav">&gt;</span>
            </div>
        </div>
    </div>

    <main role="main">
    <div class="container">
        <!-- Meta info bar -->
        <div class="info" id="meta-bar">
            <span>ÊúÄÁµÇÊõ¥Êñ∞: <span id="last-update">‚Äî</span></span>
            <span style="margin: 0 6px; color: #aaa;">¬∑</span>
            <span>Á∑èË©¶ÂêàÊï∞: <span id="total-games">‚ÄîË©¶Âêà</span></span>
        </div>


        
        

        <!-- Regular Season Magic Numbers -->
        <div id="magic-regular" class="tab-content active">
            <h2 data-i18n="title-regular-magic">2025Âπ¥Ê≠£Ë¶è„Ç∑„Éº„Ç∫„É≥ÂÑ™Âãù„Éû„Ç∏„ÉÉ„ÇØ„Éä„É≥„Éê„Éº„Äê„Çª„É™„Éº„Ç∞„Éª„Éë„É™„Éº„Ç∞„Äë</h2>
            
            <div class="leagues">
                <div>
                    <h3 data-i18n="central-league">„Çª„É≥„Éà„É©„É´„É™„Éº„Ç∞</h3>
                    <table class="magic-table">
                        <thead>
                            <tr>
                                <th class="center" data-i18n="rank">È†Ü‰Ωç</th>
                                <th data-i18n="team">„ÉÅ„Éº„É†</th>
                                <th class="center" data-i18n="games-played">Ë©¶Âêà</th>
                                <th class="center" data-i18n="wins">Âãù</th>
                                <th class="center" data-i18n="losses">Êïó</th>
                                <th class="center" data-i18n="draws">ÂàÜ</th>
                                <th class="center" data-i18n="win-rate">ÂãùÁéá</th>
                                <th class="center" data-i18n="games-behind">„Ç≤„Éº„É†Â∑Æ</th>
                                <th class="center" data-i18n="remaining-games">ÊÆã„ÇäË©¶Âêà</th>
                                <th class="center" data-i18n="max-wins">ÊúÄÂ§ßÂãù</th>
                                <th class="center" data-i18n="first-place-condition">1‰ΩçÊù°‰ª∂</th>
                                <th class="center" data-i18n="magic">„Éû„Ç∏„ÉÉ„ÇØ</th>
                                <th class="center" data-i18n="eliminate">„Ç®„É™„Éü„Éç„Éº„Éà</th>
                                <th class="center" data-i18n="playoff-status">ÈÄ≤Âá∫Áä∂Ê≥Å</th>
                            </tr>
                        </thead>
                        <tbody id="central-magic-regular">
                            <tr><td colspan="13" class="loading">Ë™≠„ÅøËæº„Åø‰∏≠...</td></tr>
                        </tbody>
                    </table>
                </div>

                <!-- AdSense Ad Between Leagues - Regular Magic -->
                <div style="margin: 20px 0; text-align: center; overflow: visible; min-width: 320px; width: 100%; max-width: 100%;">
                    <ins class="adsbygoogle"
                         style="display:block !important; min-width: 300px; width: 100%; max-width: 100%; visibility: visible;"
                         data-ad-client="ca-pub-5508768187151867"
                         data-ad-slot="7298546648"
                         data-ad-format="auto"
                         data-full-width-responsive="true"></ins>
                    <script>
                        (adsbygoogle = window.adsbygoogle || []).push({});
                    </script>
                </div>

                <div>
                    <h3 data-i18n="pacific-league">„Éë„Ç∑„Éï„Ç£„ÉÉ„ÇØ„É™„Éº„Ç∞</h3>
                    <table class="magic-table">
                        <thead>
                            <tr>
                                <th class="center" data-i18n="rank">È†Ü‰Ωç</th>
                                <th data-i18n="team">„ÉÅ„Éº„É†</th>
                                <th class="center" data-i18n="games-played">Ë©¶Âêà</th>
                                <th class="center" data-i18n="wins">Âãù</th>
                                <th class="center" data-i18n="losses">Êïó</th>
                                <th class="center" data-i18n="draws">ÂàÜ</th>
                                <th class="center" data-i18n="win-rate">ÂãùÁéá</th>
                                <th class="center" data-i18n="games-behind">„Ç≤„Éº„É†Â∑Æ</th>
                                <th class="center" data-i18n="remaining-games">ÊÆã„ÇäË©¶Âêà</th>
                                <th class="center" data-i18n="max-wins">ÊúÄÂ§ßÂãù</th>
                                <th class="center" data-i18n="first-place-condition">1‰ΩçÊù°‰ª∂</th>
                                <th class="center" data-i18n="magic">„Éû„Ç∏„ÉÉ„ÇØ</th>
                                <th class="center" data-i18n="eliminate">„Ç®„É™„Éü„Éç„Éº„Éà</th>
                                <th class="center" data-i18n="playoff-status">ÈÄ≤Âá∫Áä∂Ê≥Å</th>
                            </tr>
                        </thead>
                        <tbody id="pacific-magic-regular">
                            <tr><td colspan="13" class="loading">Ë™≠„ÅøËæº„Åø‰∏≠...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
            
            <div class="tab-help tab-help-magic-regular" style="background: #f8f9fa; border: 1px solid #dee2e6; border-radius: 4px; padding: 12px; margin: 15px 0; font-size: 13px; color: #333;">
                <strong>üìä „Éû„Ç∏„ÉÉ„ÇØ / „Ç®„É™„Éü„Éç„Éº„Ç∑„Éß„É≥„ÅÆÂÆöÁæ©</strong><br>
                <div style="margin-top: 8px; line-height: 1.5;">
                ‚Ä¢ <strong>Á∑èË©¶ÂêàÊï∞</strong>: NPB„ÅØÂêÑ„ÉÅ„Éº„É†<strong>143Ë©¶Âêà</strong><br>
                ‚Ä¢ <strong>ÂãùÁéá</strong>: Âãù / (Âãù + Êïó)ÔºàÂàÜ„ÅØÂãùÁéá„Å´Âê´„ÇÅ„Å™„ÅÑÔºâ<br>
                ‚Ä¢ <strong>ÂÑ™Âãù„Éû„Ç∏„ÉÉ„ÇØ</strong>: (2‰Ωç„ÅÆ<strong>ÊúÄÂ§ßÂèØËÉΩÂãùÊï∞</strong>) ‚àí (1‰Ωç„ÅÆÁèæÂú®ÂãùÊï∞) + 1Ôºà0‰ª•‰∏ã„Åß‚úìÔºâ<br>
                ‚Ä¢ <strong>„Ç®„É™„Éü„Éç„Éº„Éà(E)</strong>: 1‰ΩçÂãùÊï∞ Ôºû „ÉÅ„Éº„É†ÊúÄÂ§ßÂèØËÉΩÂãùÊï∞, „Åæ„Åü„ÅØ <code>(143+1) ‚àí 1‰ΩçÂãù ‚àí „ÉÅ„Éº„É†Êïó ‚â§ 0</code><br>
                ‚Ä¢ <strong>Ë®òÂè∑</strong>: <strong>‚úì</strong>ÔºùÁ¢∫ÂÆö, <strong>E</strong>Ôºù‰∏çÂèØËÉΩ, <strong>-</strong>ÔºùË©≤ÂΩì„Å™„Åó
                </div>
            </div>

        </div>

        <!-- Playoff Magic Numbers -->
        <div id="magic-playoff" class="tab-content">
            <h2 data-i18n="title-playoff-magic">„ÇØ„É©„Ç§„Éû„ÉÉ„ÇØ„Çπ„Ç∑„É™„Éº„Ç∫(CS)ÈÄ≤Âá∫„Éû„Ç∏„ÉÉ„ÇØ„Éä„É≥„Éê„Éº„Äê2025Âπ¥ÊúÄÊñ∞„Äë</h2>
            <div class="leagues">
                <div>
                    <h3 data-i18n="central-league-top3">„Çª„É≥„Éà„É©„É´„É™„Éº„Ç∞ (‰∏ä‰Ωç3„ÉÅ„Éº„É†)</h3>
                    <table class="magic-table">
                        <thead>
                            <tr>
                                <th class="center" data-i18n="rank">È†Ü‰Ωç</th>
                                <th data-i18n="team">„ÉÅ„Éº„É†</th>
                                <th class="center" data-i18n="wins">Âãù</th>
                                <th class="center" data-i18n="losses">Êïó</th>
                                <th class="center" data-i18n="draws">ÂàÜ</th>
                                <th class="center" data-i18n="win-rate">ÂãùÁéá</th>
                                <th class="center" data-i18n="games-played">Ë©¶Âêà</th>
                                <th class="center" data-i18n="games-behind">„Ç≤„Éº„É†Â∑Æ</th>
                                <th class="center" data-i18n="remaining-games">ÊÆã„ÇäË©¶Âêà</th>
                                <th class="center" data-i18n="max-wins">ÊúÄÂ§ßÂãù</th>
                                <th class="center" data-i18n="magic">„Éû„Ç∏„ÉÉ„ÇØ</th>
                                <th class="center" data-i18n="eliminate">„Ç®„É™„Éü„Éç„Éº„Éà</th>
                                <th class="center" data-i18n="playoff-status">ÈÄ≤Âá∫Áä∂Ê≥Å</th>
                            </tr>
                        </thead>
                        <tbody id="central-magic-playoff">
                            <tr><td colspan="13" class="loading">Ë™≠„ÅøËæº„Åø‰∏≠...</td></tr>
                        </tbody>
                    </table>
                </div>

                <!-- AdSense Ad Between Leagues - Playoff Magic -->
                <div style="margin: 20px 0; text-align: center; overflow: visible; min-width: 320px; width: 100%; max-width: 100%;">
                    <ins class="adsbygoogle"
                         style="display:block !important; min-width: 300px; width: 100%; max-width: 100%; visibility: visible;"
                         data-ad-client="ca-pub-5508768187151867"
                         data-ad-slot="9345718962"
                         data-ad-format="autorelaxed"></ins>
                    <script>
                        (adsbygoogle = window.adsbygoogle || []).push({});
                    </script>
                </div>

                <div>
                    <h3 data-i18n="pacific-league-top3">„Éë„Ç∑„Éï„Ç£„ÉÉ„ÇØ„É™„Éº„Ç∞ (‰∏ä‰Ωç3„ÉÅ„Éº„É†)</h3>
                    <table class="magic-table">
                        <thead>
                            <tr>
                                <th class="center" data-i18n="rank">È†Ü‰Ωç</th>
                                <th data-i18n="team">„ÉÅ„Éº„É†</th>
                                <th class="center" data-i18n="wins">Âãù</th>
                                <th class="center" data-i18n="losses">Êïó</th>
                                <th class="center" data-i18n="draws">ÂàÜ</th>
                                <th class="center" data-i18n="win-rate">ÂãùÁéá</th>
                                <th class="center" data-i18n="games-played">Ë©¶Âêà</th>
                                <th class="center" data-i18n="games-behind">„Ç≤„Éº„É†Â∑Æ</th>
                                <th class="center" data-i18n="remaining-games">ÊÆã„ÇäË©¶Âêà</th>
                                <th class="center" data-i18n="max-wins">ÊúÄÂ§ßÂãù</th>
                                <th class="center" data-i18n="magic">„Éû„Ç∏„ÉÉ„ÇØ</th>
                                <th class="center" data-i18n="eliminate">„Ç®„É™„Éü„Éç„Éº„Éà</th>
                                <th class="center" data-i18n="playoff-status">ÈÄ≤Âá∫Áä∂Ê≥Å</th>
                            </tr>
                        </thead>
                        <tbody id="pacific-magic-playoff">
                            <tr><td colspan="13" class="loading">Ë™≠„ÅøËæº„Åø‰∏≠...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="tab-help tab-help-magic-playoff" style="background: #fff3cd; border: 1px solid #ffeaa7; border-radius: 4px; padding: 12px; margin: 15px 0; font-size: 13px; color: #533f03;">
                <strong>üèÜ „ÇØ„É©„Ç§„Éû„ÉÉ„ÇØ„Çπ„Ç∑„É™„Éº„Ç∫ (CS) ÈÄ≤Âá∫„Å´„Å§„ÅÑ„Å¶</strong><br>
                <div style="margin-top: 8px; line-height: 1.5;">
                ‚Ä¢ <strong>ÈÄ≤Âá∫„ÉÅ„Éº„É†</strong>: ÂêÑ„É™„Éº„Ç∞Ôºà„Çª„Éª„ÉëÔºâ<strong>‰∏ä‰Ωç3„ÉÅ„Éº„É†</strong>„ÅåCSÈÄ≤Âá∫<br>
                ‚Ä¢ <strong>„Éï„Ç°„Éº„Çπ„Éà„Çπ„ÉÜ„Éº„Ç∏</strong>: 2‰Ωçvs3‰ΩçÔºà3Êà¶2ÂãùÂà∂Ôºâ<br>
                ‚Ä¢ <strong>„Éï„Ç°„Ç§„Éä„É´„Çπ„ÉÜ„Éº„Ç∏</strong>: 1‰Ωçvs„Éï„Ç°„Éº„Çπ„Éà„Çπ„ÉÜ„Éº„Ç∏ÂãùËÄÖÔºà6Êà¶4ÂãùÂà∂„ÄÅ1‰Ωç„Å´1Âãù„Ç¢„Éâ„Éê„É≥„ÉÜ„Éº„Ç∏Ôºâ<br>
                ‚Ä¢ <strong>„Éû„Ç∏„ÉÉ„ÇØ</strong>: CSÈÄ≤Âá∫Á¢∫ÂÆö„Åæ„Åß„ÅÆÂøÖË¶ÅÂãùÊï∞Ôºà‚úì„ÅßÁ¢∫ÂÆöÔºâ<br>
                ‚Ä¢ <strong>„Ç®„É™„Éü„Éç„Éº„Éà(E)</strong>: CSÈÄ≤Âá∫„ÅÆÂèØËÉΩÊÄß„ÅåÊ∂àÂ§±ÔºàÊï∞ÂÄ§„ÅØÊÆã„ÇäÊïóÊï∞„ÅÆË®±ÂÆπÂÄ§Ôºâ<br>
                ‚Ä¢ <strong>ÈÄ≤Âá∫Áä∂Ê≥Å</strong>: „Éï„Ç°„Ç§„Éä„É´Áõ¥Ë°åÔºà1‰ΩçÔºâ / „Éï„Ç°„Éº„Çπ„Éà„Çπ„ÉÜ„Éº„Ç∏Ôºà2‰Ωç„Éª3‰ΩçÔºâ
                </div>
            </div>

        </div>

        <!-- Scenarios -->
        <div id="scenarios" class="tab-content">
            <h2 data-i18n="title-scenarios">ÁµåË∑Ø„ÅÆÊï∞ÔºàÂ†¥Âêà„ÅÆÊï∞Ôºâ</h2>

            <!-- Central League Scenario Views -->
            <div style="margin-bottom: 20px;">
                <h3 data-i18n="central-league">„Çª„É≥„Éà„É©„É´„É™„Éº„Ç∞</h3>
                <div class="schedule-toggle" style="margin: 8px 0;">
                    <div class="toggle-group" role="tablist" aria-label="Central Scenario View">
                        <button id="btn-central-matrix" class="toggle-btn active" role="tab" aria-selected="true" data-i18n="matrix">„Éû„Éà„É™„ÇØ„Çπ</button>
                        <button id="btn-central-detailed" class="toggle-btn" role="tab" aria-selected="false" data-i18n="detailed">Ë©≥Á¥∞</button>
                    </div>
                </div>
                <div id="central-scenario-matrix" class="scenario-section" style="display: none;">
                    <div id="central-scenario-content"></div>
                </div>
                <div id="central-scenario-detailed" class="scenario-section" style="display: none;"></div>
            </div>

            <!-- AdSense Ad Between Leagues - Scenarios -->
            <div style="margin: 20px 0; text-align: center; overflow: visible; min-width: 320px; width: 100%; max-width: 100%;">
                <ins class="adsbygoogle"
                     style="display:block !important; min-width: 300px; width: 100%; max-width: 100%; visibility: visible;"
                     data-ad-client="ca-pub-5508768187151867"
                     data-ad-slot="7298546648"
                     data-ad-format="auto"
                     data-full-width-responsive="true"></ins>
                    <script>
                        (adsbygoogle = window.adsbygoogle || []).push({});
                    </script>            </div>

            <!-- Pacific League Scenario Views -->
            <div>
                <h3 data-i18n="pacific-league">„Éë„Ç∑„Éï„Ç£„ÉÉ„ÇØ„É™„Éº„Ç∞</h3>
                <div class="schedule-toggle" style="margin: 8px 0;">
                    <div class="toggle-group" role="tablist" aria-label="Pacific Scenario View">
                        <button id="btn-pacific-matrix" class="toggle-btn active" role="tab" aria-selected="true" data-i18n="matrix">„Éû„Éà„É™„ÇØ„Çπ</button>
                        <button id="btn-pacific-detailed" class="toggle-btn" role="tab" aria-selected="false" data-i18n="detailed">Ë©≥Á¥∞</button>
                    </div>
                </div>
                <div id="pacific-scenario-matrix" class="scenario-section" style="display: none;">
                    <div id="pacific-scenario-content"></div>
                </div>
                <div id="pacific-scenario-detailed" class="scenario-section" style="display: none;"></div>
            </div>

            <div class="tab-help tab-help-scenarios" style="background: #e7f3ff; border: 1px solid #b3d7ff; border-radius: 4px; padding: 12px; margin: 15px 0; font-size: 13px; color: #003566;">
                <strong>üìà ÂãùÁéáÂà•„Ç∑„Éä„É™„Ç™ÂàÜÊûê</strong><br>
                <div style="margin-top: 8px; line-height: 1.5;">
                ‚Ä¢ <strong>„Éû„Éà„É™„ÇØ„Çπ</strong>: ÊÆã„ÇäÂãùÊïó„Åî„Å®„ÅÆÊúÄÁµÇÂãùÁéá„ÇíÊ®™Êñ≠ÊØîËºÉ<br>
                ‚Ä¢ <strong>Ë©≥Á¥∞</strong>: ‰∏ä‰Ωç„ÉÅ„Éº„É†„ÅÆÂÖ®ÊÆã„ÇäÂãùÊïóÁµÑ„ÅøÂêà„Çè„Åõ„Çí‰∏ÄË¶ß<br>
                ‚Ä¢ <strong>Ëµ§„ÅÑ‰ªïÂàá„ÇäÁ∑ö</strong>: <u>3‰Ωç„É©„Ç§„É≥</u>ÔºàCSÈÄ≤Âá∫Êû†„ÅÆÂ¢ÉÁïåÔºâ<br>
                ‚Ä¢ <strong>Ë°®Á§∫ÂØæË±°</strong>: <u>3‰ΩçÈÄ≤Âá∫„ÅÆÂèØËÉΩÊÄß„ÅåÊÆã„Çã„ÉÅ„Éº„É†„ÅÆ„Åø</u>„ÇíË°®Á§∫Ôºà3‰ΩçÈÄ≤Âá∫ËÑ±ËêΩ„ÅåÁ¢∫ÂÆö„Åó„Åü„ÉÅ„Éº„É†„ÅØËá™ÂãïÁöÑ„Å´ÈùûË°®Á§∫Ôºâ
                </div>
            </div>

        </div>

        <!-- Detailed Standings -->
        <div id="standings" class="tab-content">
            <h2 data-i18n="title-detailed-standings">NPBË©≥Á¥∞È†Ü‰ΩçË°®„ÄêÂãùÁéá„Éª„Ç≤„Éº„É†Â∑Æ„ÉªÊÆã„ÇäË©¶ÂêàÊï∞„Äë</h2>
            <div class="scroll-table">
                <h3 data-i18n="central-league">„Çª„É≥„Éà„É©„É´„É™„Éº„Ç∞</h3>
                <table class="detailed-table">
                    <thead>
                        <tr>
                            <th class="center">È†Ü‰Ωç</th>
                            <th>„ÉÅ„Éº„É†</th>
                            <th class="center">Ë©¶Âêà</th>
                            <th class="center">Âãù</th>
                            <th class="center">Êïó</th>
                            <th class="center">ÂàÜ</th>
                            <th class="center">ÂãùÁéá</th>
                            <th class="center">ÊÆã„Çä</th>
                            <th class="center">Â∑Æ</th>
                            <th class="center">ÈÄ£Âãù/ÈÄ£Êïó</th>
                            <th class="center">Áõ¥Ëøë10</th>
                            <th class="center">„Éõ„Éº„É†</th>
                            <th class="center">„Éõ„Éº„É†Áéá</th>
                            <th class="center">„Ç¢„Ç¶„Çß„Éº</th>
                            <th class="center">„Ç¢„Ç¶„Çß„ÉºÁéá</th>
                            <th class="center">ÊúÄÈ´òÈ†Ü‰Ωç</th>
                            <th class="center">ÊúÄ‰ΩéÈ†Ü‰Ωç</th>
                        </tr>
                    </thead>
                    <tbody id="central-detailed">
                        <tr><td colspan="17" class="loading">Ë™≠„ÅøËæº„Åø‰∏≠...</td></tr>
                    </tbody>
                </table>
            </div>

            <!-- AdSense Ad Between Leagues - Standings -->
            <div style="margin: 20px 0; text-align: center; overflow: visible; min-width: 320px; width: 100%; max-width: 100%;">
                <ins class="adsbygoogle"
                     style="display:block !important; min-width: 300px; width: 100%; max-width: 100%; visibility: visible;"
                     data-ad-client="ca-pub-5508768187151867"
                     data-ad-slot="9345718962"
                     data-ad-format="autorelaxed"></ins>
                    <script>
                        (adsbygoogle = window.adsbygoogle || []).push({});
                    </script>            </div>

            <div class="scroll-table" style="margin-top: 30px;">
                <h3 data-i18n="pacific-league">„Éë„Ç∑„Éï„Ç£„ÉÉ„ÇØ„É™„Éº„Ç∞</h3>
                <table class="detailed-table">
                    <thead>
                        <tr>
                            <th class="center">È†Ü‰Ωç</th>
                            <th>„ÉÅ„Éº„É†</th>
                            <th class="center">Ë©¶Âêà</th>
                            <th class="center">Âãù</th>
                            <th class="center">Êïó</th>
                            <th class="center">ÂàÜ</th>
                            <th class="center">ÂãùÁéá</th>
                            <th class="center">ÊÆã„Çä</th>
                            <th class="center">Â∑Æ</th>
                            <th class="center">ÈÄ£Âãù/ÈÄ£Êïó</th>
                            <th class="center">Áõ¥Ëøë10</th>
                            <th class="center">„Éõ„Éº„É†</th>
                            <th class="center">„Éõ„Éº„É†Áéá</th>
                            <th class="center">„Ç¢„Ç¶„Çß„Éº</th>
                            <th class="center">„Ç¢„Ç¶„Çß„ÉºÁéá</th>
                            <th class="center">ÊúÄÈ´òÈ†Ü‰Ωç</th>
                            <th class="center">ÊúÄ‰ΩéÈ†Ü‰Ωç</th>
                        </tr>
                    </thead>
                    <tbody id="pacific-detailed">
                        <tr><td colspan="17" class="loading">Ë™≠„ÅøËæº„Åø‰∏≠...</td></tr>
                    </tbody>
                </table>
            </div>
            <div class="tab-help tab-help-standings" style="background: #f1f3f5; border: 1px solid #dee2e6; border-radius: 4px; padding: 10px; margin: 10px 0; font-size: 12px; color: #333;">
                ‚Ä¢ <strong>ÂãùÁéá</strong>= Âãù / (Âãù+Êïó), <strong>ÊÆã„Çä</strong>= 143 ‚àí Ë©¶Âêà, <strong>Â∑Æ</strong>= È¶ñ‰Ωç„Åã„Çâ„ÅÆ„Ç≤„Éº„É†Â∑Æ<br>
                ‚Ä¢ <strong>ÂàÜ</strong>„ÅØÂãùÁéá„Å´Âê´„Åæ„Çå„Åæ„Åõ„Çì„ÄÇË°®Á§∫„ÅØÊúÄÊñ∞JSON„Å´Âü∫„Å•„Åç„Åæ„Åô„ÄÇ
            </div>
        </div>

        <!-- Head-to-Head Records -->
        <div id="h2h-records" class="tab-content">
            <h2 data-i18n="title-h2h-matrix">ÂØæÊà¶ÊàêÁ∏æ„Éû„Éà„É™„ÇØ„Çπ„Äê„ÉÅ„Éº„É†Âà•ÂØæÊà¶ÊàêÁ∏æ„Äë</h2>
            <div style="margin: 20px 0;">
                <h3 data-i18n="central-league">„Çª„É≥„Éà„É©„É´„É™„Éº„Ç∞</h3>
                <div class="matrix-container">
                    <div id="central-h2h-matrix" class="remaining-matrix">
                        <div class="loading">Ë™≠„ÅøËæº„Åø‰∏≠...</div>
                    </div>
                </div>
            </div>

            <!-- AdSense Ad Between Leagues - H2H Records -->
            <div style="margin: 20px 0; text-align: center; overflow: visible; min-width: 320px; width: 100%; max-width: 100%;">
                <ins class="adsbygoogle"
                     style="display:block !important; min-width: 300px; width: 100%; max-width: 100%; visibility: visible;"
                     data-ad-client="ca-pub-5508768187151867"
                     data-ad-slot="7298546648"
                     data-ad-format="auto"
                     data-full-width-responsive="true"></ins>
                    <script>
                        (adsbygoogle = window.adsbygoogle || []).push({});
                    </script>            </div>

            <div style="margin: 20px 0;">
                <h3 data-i18n="pacific-league">„Éë„Ç∑„Éï„Ç£„ÉÉ„ÇØ„É™„Éº„Ç∞</h3>
                <div class="matrix-container">
                    <div id="pacific-h2h-matrix" class="remaining-matrix">
                        <div class="loading">Ë™≠„ÅøËæº„Åø‰∏≠...</div>
                    </div>
                </div>
            </div>
            <div class="tab-help tab-help-h2h" style="background: #f1f3f5; border: 1px solid #dee2e6; border-radius: 4px; padding: 10px; margin: 10px 0; font-size: 12px; color: #333;">
                ‚Ä¢ <strong>Á∏¶Ëª∏(Â∑¶ÂÅ¥)</strong>: „ÉÅ„Éº„É†„ÄÅ<strong>Ê®™Ëª∏(‰∏äÈÉ®)</strong>: ÂÖ®12„ÉÅ„Éº„É†ÔºàÂêå„É™„Éº„Ç∞Ôºã‰∫§ÊµÅÊà¶Ôºâ<br>
                ‚Ä¢ <strong>Âãù-Êïó</strong>: ÂêÑ„ÉÅ„Éº„É†Èñì„ÅÆÂØæÊà¶ÊàêÁ∏æÔºàÂãùÂà©Êï∞-ÊïóÂåóÊï∞Ôºâ<br>
                ‚Ä¢ <strong>„ÉÅ„Éº„É†Âêç</strong>: „É≠„Ç¥‰ªò„ÅçÊó•Êú¨Ë™ûÂêç„ÅßË°®Á§∫<br>
                ‚Ä¢ <strong>Âè≥Á´Ø„Éª‰∏ãÈÉ®„ÅÆÊï∞Â≠ó</strong>: ÂêÑ„ÉÅ„Éº„É†„ÅÆÁ∑èÂãùÂà©Êï∞<br>
                ‚Ä¢ <strong>ËÉåÊôØËâ≤</strong>: „Ç™„É¨„É≥„Ç∏Ëâ≤„ÅØ‰∫§ÊµÅÊà¶„ÇíË°®Á§∫
            </div>

        </div>

        <!-- Remaining Games -->
        <div id="remaining" class="tab-content">
            <h2 data-i18n="title-remaining-matrix">ÊÆã„ÇäË©¶ÂêàÂØæÊà¶„Éû„Éà„É™„ÇØ„Çπ„Äê„ÉÅ„Éº„É†Âà•ÂØæÊà¶‰∫àÂÆö„Äë</h2>
            <div style="margin: 20px 0;">
                <h3 data-i18n="central-league">„Çª„É≥„Éà„É©„É´„É™„Éº„Ç∞</h3>
                <div class="matrix-container">
                    <div id="central-remaining-matrix" class="remaining-matrix">
                        <div class="loading">Ë™≠„ÅøËæº„Åø‰∏≠...</div>
                    </div>
                </div>
            </div>

            <!-- AdSense Ad Between Leagues - Remaining Games -->
            <div style="margin: 20px 0; text-align: center; overflow: visible; min-width: 320px; width: 100%; max-width: 100%;">
                <ins class="adsbygoogle"
                     style="display:block !important; min-width: 300px; width: 100%; max-width: 100%; visibility: visible;"
                     data-ad-client="ca-pub-5508768187151867"
                     data-ad-slot="9345718962"
                     data-ad-format="autorelaxed"></ins>
                    <script>
                        (adsbygoogle = window.adsbygoogle || []).push({});
                    </script>            </div>

            <div style="margin: 20px 0;">
                <h3 data-i18n="pacific-league">„Éë„Ç∑„Éï„Ç£„ÉÉ„ÇØ„É™„Éº„Ç∞</h3>
                <div class="matrix-container">
                    <div id="pacific-remaining-matrix" class="remaining-matrix">
                        <div class="loading">Ë™≠„ÅøËæº„Åø‰∏≠...</div>
                    </div>
                </div>
            </div>
            <div class="tab-help tab-help-remaining" style="background: #f1f3f5; border: 1px solid #dee2e6; border-radius: 4px; padding: 10px; margin: 10px 0; font-size: 12px; color: #333;">
                ‚Ä¢ <strong>Á∏¶Ëª∏(Â∑¶ÂÅ¥)</strong>: „ÉÅ„Éº„É†„ÄÅ<strong>Ê®™Ëª∏(‰∏äÈÉ®)</strong>: ÂÖ®12„ÉÅ„Éº„É†ÔºàÂêå„É™„Éº„Ç∞Ôºã‰∫§ÊµÅÊà¶Ôºâ<br>
                ‚Ä¢ <strong>Êï∞Â≠ó</strong>: ÂêÑ„ÉÅ„Éº„É†Èñì„ÅÆÊÆã„ÇäÂØæÊà¶Êï∞Ôºà„Éõ„Éº„É†+„Ç¢„Ç¶„Çß„ÉºÔºâ<br>
                ‚Ä¢ <strong>„ÉÅ„Éº„É†Âêç</strong>: „É≠„Ç¥‰ªò„ÅçÊó•Êú¨Ë™ûÂêç„ÅßË°®Á§∫<br>
                ‚Ä¢ <strong>Âè≥Á´Ø„Éª‰∏ãÈÉ®„ÅÆÊï∞Â≠ó</strong>: ÂêÑ„ÉÅ„Éº„É†„ÅÆÊÆã„ÇäË©¶ÂêàÊï∞ÂêàË®à<br>
                ‚Ä¢ <strong>ËÉåÊôØËâ≤</strong>: „Ç™„É¨„É≥„Ç∏Ëâ≤„ÅØ‰∫§ÊµÅÊà¶„ÇíË°®Á§∫
            </div>

        </div>

        <!-- Progress Tab -->
        <div id="progress" class="tab-content">
            <h2 data-i18n="title-progress">2025Âπ¥„Ç∑„Éº„Ç∫„É≥ÈÄ≤Ë°åÁä∂Ê≥Å„ÄêÊ∂àÂåñË©¶ÂêàÊï∞„ÉªÈÄ≤ÊçóÁéá„Äë</h2>
            
            <!-- Ï†ÑÏ≤¥ ÏÜåÌôîÏú® ÏÑπÏÖò -->
            <div style="margin: 20px 0;">
                <h3>üèÜ „Ç∑„Éº„Ç∫„É≥ÂÖ®‰ΩìÈÄ≤Ë°åÁéá</h3>
                <div id="season-progress" style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin: 15px 0;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                        <span style="font-size: 18px; font-weight: bold;">ÂÖ®‰ΩìÈÄ≤Ë°åÁéá</span>
                        <span id="overall-percentage" style="font-size: 24px; font-weight: bold; color: #2e7d32;">‚Äî%</span>
                    </div>
                    <div id="overall-progress-bar" style="width: 100%; height: 20px; background: #e0e0e0; border-radius: 10px; overflow: hidden;">
                        <div id="overall-progress-fill" style="height: 100%; background: linear-gradient(90deg, #4caf50, #2e7d32); width: 0%; transition: width 0.5s ease;"></div>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin-top: 10px; font-size: 14px; color: #666;">
                        <span>ÂÆå‰∫Ü: <span id="completed-games">‚Äî</span>Ë©¶Âêà</span>
                        <span>ÊÆã„Çä: <span id="remaining-total">‚Äî</span>Ë©¶Âêà</span>
                        <span>Á∑èË©¶ÂêàÊï∞: <span id="total-season-games">‚Äî</span>Ë©¶Âêà</span>
                    </div>
                </div>
            </div>

            <!-- AdSense Ad Between Progress Sections -->
            <div style="margin: 20px 0; text-align: center; overflow: visible; min-width: 320px; width: 100%; max-width: 100%;">
                <ins class="adsbygoogle"
                     style="display:block !important; min-width: 300px; width: 100%; max-width: 100%; visibility: visible;"
                     data-ad-client="ca-pub-5508768187151867"
                     data-ad-slot="9345718962"
                     data-ad-format="autorelaxed"></ins>
                    <script>
                        (adsbygoogle = window.adsbygoogle || []).push({});
                    </script>            </div>

            <!-- Team progress section -->
            <div style="margin: 20px 0;">
                <h3>üìä „ÉÅ„Éº„É†Âà•ÈÄ≤Ë°åÁä∂Ê≥Å</h3>
                <div class="grid-3col" style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin: 15px 0; align-items: start;">

                    <!-- ÏÑºÌä∏Îü¥Î¶¨Í∑∏ -->
                    <div>
                        <h4>„Çª„É≥„Éà„É©„É´„É™„Éº„Ç∞</h4>
                        <div id="central-progress" class="league-progress">
                            <div class="loading">„Éá„Éº„ÇøË™≠„ÅøËæº„Åø‰∏≠...</div>
                        </div>
                    </div>

                    <!-- ÌçºÏãúÌîΩÎ¶¨Í∑∏ -->
                    <div>
                        <h4>„Éë„Ç∑„Éï„Ç£„ÉÉ„ÇØ„É™„Éº„Ç∞</h4>
                        <div id="pacific-progress" class="league-progress">
                            <div class="loading">„Éá„Éº„ÇøË™≠„ÅøËæº„Åø‰∏≠...</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Ï∂îÍ∞Ä ÌÜµÍ≥Ñ ÏÑπÏÖò -->
            <div style="margin: 20px 0;">
                <h3>üìà Ë©≥Á¥∞Áµ±Ë®à</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                    <div class="stat-card">
                        <div class="stat-title">Âπ≥ÂùáÊ∂àÂåñÁéá</div>
                        <div class="stat-value" id="average-progress">‚Äî%</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-title">ÊúÄÈ´òÈÄ≤Ë°å„ÉÅ„Éº„É†</div>
                        <div class="stat-value" id="highest-team">‚Äî</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-title">ÊúÄ‰ΩéÈÄ≤Ë°å„ÉÅ„Éº„É†</div>
                        <div class="stat-value" id="lowest-team">‚Äî</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-title">ÈÄ≤Ë°åÂ∑Æ</div>
                        <div class="stat-value" id="progress-gap">‚ÄîË©¶Âêà</div>
                    </div>
                </div>
            </div>

            <div class="tab-help" style="background: #f1f3f5; border: 1px solid #dee2e6; border-radius: 4px; padding: 10px; margin: 10px 0; font-size: 12px; color: #333;">
                ‚Ä¢ <strong data-i18n="progress-rate">ÈÄ≤Ë°åÁéá</strong>: <span data-i18n="progress-rate-desc">ÂêÑ„ÉÅ„Éº„É†„ÅåÊ∂àÂåñ„Åó„ÅüË©¶ÂêàÊï∞ / 143Ë©¶Âêà √ó 100%</span><br>
                ‚Ä¢ <strong data-i18n="overall-progress">ÂÖ®‰ΩìÈÄ≤Ë°åÁéá</strong>: <span data-i18n="overall-progress-desc">ÂÖ®„ÉÅ„Éº„É†Âπ≥Âùá„ÅÆÈÄ≤Ë°åÁä∂Ê≥Å</span><br>
                ‚Ä¢ <strong data-i18n="remaining-games-label">ÊÆã„ÇäË©¶Âêà</strong>: <span data-i18n="remaining-calc">143 - ÁèæÂú®„ÅÆÊ∂àÂåñË©¶ÂêàÊï∞</span><br>
                ‚Ä¢ Îç∞Ïù¥ÌÑ∞„ÅØÏµúÊñ∞„ÅÆÈ†Ü‰ΩçË°®„Å´Âü∫„Å•„ÅÑ„Å¶ÏûêÎèôÊõ¥Êñ∞„Åï„Çå„Åæ„Åô
            </div>
        </div>

        <!-- Season Analysis Tab -->
        <div id="season-analysis" class="tab-content">
            <h2 data-i18n="title-season-analysis">„Ç∑„Éº„Ç∫„É≥ÂàÜÊûê„ÄêÈ†Ü‰Ωç„ÉªÂãùÁéá„Éª„Ç≤„Éº„É†Â∑Æ„ÉªÂãùÊï∞Â§âÂãï„Äë</h2>

            <div style="margin: 20px 0;">
                <h3 data-i18n="central-league">„Çª„É≥„Éà„É©„É´„É™„Éº„Ç∞</h3>

                <!-- ÏàúÏúÑ Î≥ÄÎèô Ï∞®Ìä∏ -->
                <div style="margin: 30px 0;">
                    <h4 data-i18n="chart-ranking-changes">„Ç∑„Éº„Ç∫„É≥È†Ü‰ΩçÂ§âÂãï„ÉÅ„É£„Éº„Éà</h4>
                    <div id="central-ranking-legend"></div>
                    <div id="central-ranking-chart" style="width: 100%; height: 500px; border: 1px solid #e2e8f0; margin: 20px 0; position: relative; background: linear-gradient(to bottom, #ffffff, #f7fafc); border-radius: 12px; padding: 20px; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.07);">
                        <div id="central-ranking-canvas"></div>
                    </div>
                </div>

                <!-- ÏäπÎ•† Î≥ÄÌôî Ï∞®Ìä∏ -->
                <div style="margin: 30px 0;">
                    <h4 data-i18n="chart-winrate-changes">„Ç∑„Éº„Ç∫„É≥ÂãùÁéáÂ§âÂåñ„ÉÅ„É£„Éº„Éà</h4>
                    <div id="central-winrate-legend"></div>
                    <div id="central-winrate-chart" style="width: 100%; height: 500px; border: 1px solid #e2e8f0; margin: 20px 0; position: relative; background: linear-gradient(to bottom, #ffffff, #f7fafc); border-radius: 12px; padding: 20px; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.07);">
                        <div id="central-winrate-canvas"></div>
                    </div>
                </div>

                <!-- AdSense Ad Before „Ç≤„Éº„É†Â∑ÆÂ§âÂåñ„ÉÅ„É£„Éº„Éà -->
                <div style="margin: 20px 0; text-align: center; overflow: visible; min-width: 320px; width: 100%; max-width: 100%;">
                    <ins class="adsbygoogle"
                         style="display:block !important; min-width: 300px; width: 100%; max-width: 100%; visibility: visible;"
                         data-ad-client="ca-pub-5508768187151867"
                         data-ad-slot="7298546648"
                         data-ad-format="auto"
                         data-full-width-responsive="true"></ins>
                    <script>
                        (adsbygoogle = window.adsbygoogle || []).push({});
                    </script>
                </div>

                <!-- Í≤åÏûÑÏ∞® Î≥ÄÌôî Ï∞®Ìä∏ -->
                <div style="margin: 30px 0;">
                    <h4 data-i18n="chart-gamesbehind-changes">„Ç∑„Éº„Ç∫„É≥„Ç≤„Éº„É†Â∑ÆÂ§âÂåñ„ÉÅ„É£„Éº„Éà</h4>
                    <div id="central-gamesbehind-legend"></div>
                    <div id="central-gamesbehind-chart" style="width: 100%; height: 500px; border: 1px solid #e2e8f0; margin: 20px 0; position: relative; background: linear-gradient(to bottom, #ffffff, #f7fafc); border-radius: 12px; padding: 20px; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.07);">
                        <div id="central-gamesbehind-canvas"></div>
                    </div>
                </div>

                <!-- ÏäπÏàò Î≥ÄÌôî Ï∞®Ìä∏ -->
                <div style="margin: 30px 0;">
                    <h4 data-i18n="chart-wins-changes">„Ç∑„Éº„Ç∫„É≥ÂãùÊï∞Â§âÂåñ„ÉÅ„É£„Éº„Éà</h4>
                    <div id="central-wins-legend"></div>
                    <div id="central-wins-chart" style="width: 100%; height: 500px; border: 1px solid #e2e8f0; margin: 20px 0; position: relative; background: linear-gradient(to bottom, #ffffff, #f7fafc); border-radius: 12px; padding: 20px; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.07);">
                        <div id="central-wins-canvas"></div>
                    </div>
                </div>
            </div>

            <!-- AdSense Ad Between Central and Pacific Leagues - Season Analysis -->
            <div style="margin: 20px 0; text-align: center; overflow: hidden; min-width: 320px;">
                    <ins class="adsbygoogle"
                         style="display:block; min-width: 300px;"
                         data-ad-client="ca-pub-5508768187151867"
                         data-ad-slot="9345718962"
                         data-ad-format="autorelaxed"></ins>
                    <script>
                        (adsbygoogle = window.adsbygoogle || []).push({});
                    </script>            </div>

            <div style="margin: 20px 0;">
                <h3 data-i18n="pacific-league">„Éë„Ç∑„Éï„Ç£„ÉÉ„ÇØ„É™„Éº„Ç∞</h3>

                <!-- ÏàúÏúÑ Î≥ÄÎèô Ï∞®Ìä∏ -->
                <div style="margin: 30px 0;">
                    <h4 data-i18n="chart-ranking-changes">„Ç∑„Éº„Ç∫„É≥È†Ü‰ΩçÂ§âÂãï„ÉÅ„É£„Éº„Éà</h4>
                    <div id="pacific-ranking-legend"></div>
                    <div id="pacific-ranking-chart" style="width: 100%; height: 500px; border: 1px solid #e2e8f0; margin: 20px 0; position: relative; background: linear-gradient(to bottom, #ffffff, #f7fafc); border-radius: 12px; padding: 20px; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.07);">
                        <div id="pacific-ranking-canvas"></div>
                    </div>
                </div>

                <!-- ÏäπÎ•† Î≥ÄÌôî Ï∞®Ìä∏ -->
                <div style="margin: 30px 0;">
                    <h4 data-i18n="chart-winrate-changes">„Ç∑„Éº„Ç∫„É≥ÂãùÁéáÂ§âÂåñ„ÉÅ„É£„Éº„Éà</h4>
                    <div id="pacific-winrate-legend"></div>
                    <div id="pacific-winrate-chart" style="width: 100%; height: 500px; border: 1px solid #e2e8f0; margin: 20px 0; position: relative; background: linear-gradient(to bottom, #ffffff, #f7fafc); border-radius: 12px; padding: 20px; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.07);">
                        <div id="pacific-winrate-canvas"></div>
                    </div>
                </div>

                <!-- AdSense Ad Before Pacific Gamesbehind Chart -->
                <div style="margin: 20px 0; text-align: center; overflow: visible; min-width: 320px; width: 100%; max-width: 100%;">
                    <ins class="adsbygoogle"
                         style="display:block !important; min-width: 300px; width: 100%; max-width: 100%; visibility: visible;"
                         data-ad-client="ca-pub-5508768187151867"
                         data-ad-slot="7298546648"
                         data-ad-format="auto"
                         data-full-width-responsive="true"></ins>
                    <script>
                        (adsbygoogle = window.adsbygoogle || []).push({});
                    </script>
                </div>

                <!-- Í≤åÏûÑÏ∞® Î≥ÄÌôî Ï∞®Ìä∏ -->
                <div style="margin: 30px 0;">
                    <h4 data-i18n="chart-gamesbehind-changes">„Ç∑„Éº„Ç∫„É≥„Ç≤„Éº„É†Â∑ÆÂ§âÂåñ„ÉÅ„É£„Éº„Éà</h4>
                    <div id="pacific-gamesbehind-legend"></div>
                    <div id="pacific-gamesbehind-chart" style="width: 100%; height: 500px; border: 1px solid #e2e8f0; margin: 20px 0; position: relative; background: linear-gradient(to bottom, #ffffff, #f7fafc); border-radius: 12px; padding: 20px; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.07);">
                        <div id="pacific-gamesbehind-canvas"></div>
                    </div>
                </div>

                <!-- ÏäπÏàò Î≥ÄÌôî Ï∞®Ìä∏ -->
                <div style="margin: 30px 0;">
                    <h4 data-i18n="chart-wins-changes">„Ç∑„Éº„Ç∫„É≥ÂãùÊï∞Â§âÂåñ„ÉÅ„É£„Éº„Éà</h4>
                    <div id="pacific-wins-legend"></div>
                    <div id="pacific-wins-chart" style="width: 100%; height: 500px; border: 1px solid #e2e8f0; margin: 20px 0; position: relative; background: linear-gradient(to bottom, #ffffff, #f7fafc); border-radius: 12px; padding: 20px; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.07);">
                        <div id="pacific-wins-canvas"></div>
                    </div>
                </div>
            </div>

            <div class="tab-help tab-help-season-analysis" style="background: #f1f3f5; border: 1px solid #dee2e6; border-radius: 4px; padding: 10px; margin: 10px 0; font-size: 12px; color: #333;">
                ‚Ä¢ <strong>È†Ü‰ΩçÂ§âÂãï</strong>: „Ç∑„Éº„Ç∫„É≥ÂÖ®‰Ωì„ÅÆÈ†Ü‰ΩçÂ§âÂåñ„ÅÆÊé®Áßª<br>
                ‚Ä¢ <strong>ÂãùÁéáÂ§âÂåñ</strong>: ÂêÑ„ÉÅ„Éº„É†„ÅÆ„Ç∑„Éº„Ç∫„É≥ÂãùÁéáÂ§âÂãï<br>
                ‚Ä¢ <strong>„Ç≤„Éº„É†Â∑ÆÂ§âÂåñ</strong>: 1‰Ωç„ÉÅ„Éº„É†„Å®„ÅÆ„Ç≤„Éº„É†Â∑ÆÂ§âÂåñ<br>
                ‚Ä¢ <strong>ÂãùÊï∞Â§âÂåñ</strong>: Á¥ØÁ©çÂãùÊï∞Â¢óÂä†Êé®Áßª<br>
                ‚Ä¢ <strong>„ÉÅ„É£„Éº„ÉàÂá°‰æã</strong>: ÂêÑ„ÉÅ„Éº„É†Âà•Ëâ≤ÂàÜ„ÅëË°®Á§∫
            </div>

        </div>

        <!-- All Games Tab -->
        <div id="all-games" class="tab-content">
            <h2 data-i18n="title-all-games">ÂÖ®Ë©¶ÂêàÁµêÊûú„ÄêÊó•‰ªòÂà•ÁµåÈÅé„Äë</h2>

            <div style="margin: 20px 0;">
                <div style="background: #f8f9fa; border-radius: 8px; padding: 15px; margin-bottom: 20px;">
                    <h3>üìÖ Ë©¶ÂêàÁµêÊûú‰∏ÄË¶ß</h3>
                    <p style="margin: 0 0 15px 0; color: #666; font-size: 14px;">Êó•‰ªòÈ†Ü„Å´ÂÖ®„Å¶„ÅÆË©¶ÂêàÁµêÊûú„ÇíË°®Á§∫„Åó„Åæ„Åô„ÄÇ„É™„Éº„Ç∞Âà•„Å´Ëâ≤ÂàÜ„Åë„Åï„Çå„Å¶„ÅÑ„Åæ„Åô„ÄÇ</p>

                    <!-- Advanced Filters -->
                    <div style="margin-top: 15px; display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                        <!-- Team Filter -->
                        <div>
                            <label style="font-weight: bold; display: block; margin-bottom: 5px;">„ÉÅ„Éº„É†:</label>
                            <select id="team-filter" style="width: 100%; padding: 5px; border: 1px solid #ddd; border-radius: 4px;">
                                <option value="">ÂÖ®„ÉÅ„Éº„É†</option>
                                <optgroup label="„Çª„É≥„Éà„É©„É´„É™„Éº„Ç∞">
                                    <option value="YOG">Ë™≠Â£≤„Ç∏„É£„Ç§„Ç¢„É≥„ÉÑ</option>
                                    <option value="HAN">Èò™Á•û„Çø„Ç§„Ç¨„Éº„Çπ</option>
                                    <option value="YDB">Ê®™ÊµúDeNA„Éô„Ç§„Çπ„Çø„Éº„Ç∫</option>
                                    <option value="HIR">Â∫ÉÂ≥∂Êù±Ê¥ã„Ç´„Éº„Éó</option>
                                    <option value="CHU">‰∏≠Êó•„Éâ„É©„Ç¥„É≥„Ç∫</option>
                                    <option value="YAK">Êù±‰∫¨„É§„ÇØ„É´„Éà„Çπ„ÉØ„É≠„Éº„Ç∫</option>
                                </optgroup>
                                <optgroup label="„Éë„Ç∑„Éï„Ç£„ÉÉ„ÇØ„É™„Éº„Ç∞">
                                    <option value="SOF">Á¶èÂ≤°„ÇΩ„Éï„Éà„Éê„É≥„ÇØ„Éõ„Éº„ÇØ„Çπ</option>
                                    <option value="NIP">ÂåóÊµ∑ÈÅìÊó•Êú¨„Éè„É†„Éï„Ç°„Ç§„Çø„Éº„Ç∫</option>
                                    <option value="ORI">„Ç™„É™„ÉÉ„ÇØ„Çπ„Éê„Éï„Ç°„É≠„Éº„Ç∫</option>
                                    <option value="RAK">Êù±ÂåóÊ•ΩÂ§©„Ç¥„Éº„É´„Éá„É≥„Ç§„Éº„Ç∞„É´„Çπ</option>
                                    <option value="SEI">ÂüºÁéâË•øÊ≠¶„É©„Ç§„Ç™„É≥„Ç∫</option>
                                    <option value="LOT">ÂçÉËëâ„É≠„ÉÉ„ÉÜ„Éû„É™„Éº„É≥„Ç∫</option>
                                </optgroup>
                            </select>
                        </div>

                        <!-- Month Filter -->
                        <div>
                            <label style="font-weight: bold; display: block; margin-bottom: 5px;">Êúà:</label>
                            <select id="month-filter" style="width: 100%; padding: 5px; border: 1px solid #ddd; border-radius: 4px;">
                                <option value="">ÂÖ®Êúà</option>
                                <option value="3">3Êúà</option>
                                <option value="4">4Êúà</option>
                                <option value="5">5Êúà</option>
                                <option value="6">6Êúà</option>
                                <option value="7">7Êúà</option>
                                <option value="8">8Êúà</option>
                                <option value="9">9Êúà</option>
                                <option value="10">10Êúà</option>
                                <option value="11">11Êúà</option>
                            </select>
                        </div>

                        <!-- League Filter -->
                        <div>
                            <label style="font-weight: bold; display: block; margin-bottom: 5px;">„É™„Éº„Ç∞:</label>
                            <select id="league-filter" style="width: 100%; padding: 5px; border: 1px solid #ddd; border-radius: 4px;">
                                <option value="">ÂÖ®„É™„Éº„Ç∞</option>
                                <option value="Central">„Çª„É≥„Éà„É©„É´„É™„Éº„Ç∞</option>
                                <option value="Pacific">„Éë„Ç∑„Éï„Ç£„ÉÉ„ÇØ„É™„Éº„Ç∞</option>
                            </select>
                        </div>

                        <!-- Inning Filter -->
                        <div>
                            <label style="font-weight: bold; display: block; margin-bottom: 5px;">„Ç§„Éã„É≥„Ç∞:</label>
                            <select id="inning-filter" style="width: 100%; padding: 5px; border: 1px solid #ddd; border-radius: 4px;">
                                <option value="">ÂÖ®„Ç§„Éã„É≥„Ç∞</option>
                                <option value="9">9ÂõûÊà¶</option>
                                <option value="extra">Âª∂Èï∑Êà¶ (10Âõû‰ª•‰∏ä)</option>
                            </select>
                        </div>

                        <!-- Stadium Filter -->
                        <div>
                            <label style="font-weight: bold; display: block; margin-bottom: 5px;">ÁêÉÂ†¥:</label>
                            <select id="stadium-filter" style="width: 100%; padding: 5px; border: 1px solid #ddd; border-radius: 4px;">
                                <option value="">ÂÖ®ÁêÉÂ†¥</option>
                                <option value="Êù±‰∫¨„Éâ„Éº„É†">Êù±‰∫¨„Éâ„Éº„É†</option>
                                <option value="ÊòéÊ≤ªÁ•ûÂÆÆÈáéÁêÉÂ†¥">Á•ûÂÆÆÁêÉÂ†¥</option>
                                <option value="Ê®™Êµú„Çπ„Çø„Ç∏„Ç¢„É†">Ê®™Êµú„Çπ„Çø„Ç∏„Ç¢„É†</option>
                                <option value="Èò™Á•ûÁî≤Â≠êÂúíÁêÉÂ†¥">Áî≤Â≠êÂúí</option>
                                <option value="„Éû„ÉÑ„ÉÄ„Çπ„Çø„Ç∏„Ç¢„É†">„Éû„ÉÑ„ÉÄ„Çπ„Çø„Ç∏„Ç¢„É†</option>
                                <option value="„Éê„É≥„ÉÜ„É™„É≥„Éâ„Éº„É†">„Éê„É≥„ÉÜ„É™„É≥„Éâ„Éº„É†</option>
                                <option value="‰∫¨„Çª„É©„Éâ„Éº„É†Â§ßÈò™">‰∫¨„Çª„É©„Éâ„Éº„É†</option>
                                <option value="„Åø„Åö„Åª„Éö„Ç§„Éö„Ç§„Éâ„Éº„É†">PayPay„Éâ„Éº„É†</option>
                                <option value="Ê•ΩÂ§©„É¢„Éê„Ç§„É´„Éë„Éº„ÇØ">Ê•ΩÂ§©„É¢„Éê„Ç§„É´</option>
                                <option value="„Éô„É´„Éº„Éä„Éâ„Éº„É†">„Éô„É´„Éº„Éä„Éâ„Éº„É†</option>
                                <option value="ZOZO„Éû„É™„É≥„Çπ„Çø„Ç∏„Ç¢„É†">ZOZO„Éû„É™„É≥</option>
                                <option value="„Ç®„Çπ„Ç≥„É≥„Éï„Ç£„Éº„É´„ÉâHOKKAIDO">„Ç®„Çπ„Ç≥„É≥</option>
                            </select>
                        </div>

                        <!-- Time Filter -->
                        <div>
                            <label style="font-weight: bold; display: block; margin-bottom: 5px;">ÈñãÂßãÊôÇÈñì:</label>
                            <select id="time-filter" style="width: 100%; padding: 5px; border: 1px solid #ddd; border-radius: 4px;">
                                <option value="">ÂÖ®ÊôÇÈñì</option>
                                <option value="day">„Éá„Éº„Ç≤„Éº„É† („Äú15:59)</option>
                                <option value="night">„Éä„Ç§„Éà„Ç≤„Éº„É† (16:00„Äú)</option>
                                <option value="13">13ÊôÇÂè∞</option>
                                <option value="14">14ÊôÇÂè∞</option>
                                <option value="17">17ÊôÇÂè∞</option>
                                <option value="18">18ÊôÇÂè∞</option>
                            </select>
                        </div>

                        <!-- Date Range Filter -->
                        <div>
                            <label style="font-weight: bold; display: block; margin-bottom: 5px;">ÊúüÈñì:</label>
                            <div style="display: flex; gap: 5px; align-items: center;">
                                <input type="date" id="date-from" style="flex: 1; padding: 5px; border: 1px solid #ddd; border-radius: 4px;">
                                <span>„Äú</span>
                                <input type="date" id="date-to" style="flex: 1; padding: 5px; border: 1px solid #ddd; border-radius: 4px;">
                            </div>
                        </div>
                    </div>

                    <!-- Reset Button -->
                    <div style="margin-top: 15px; text-align: center;">
                        <button onclick="resetAllFilters()" style="padding: 8px 20px; background: #6c757d; color: white; border: none; border-radius: 4px; cursor: pointer; font-weight: bold;">ÂÖ®„Éï„Ç£„É´„Çø„Éº„É™„Çª„ÉÉ„Éà</button>
                    </div>
                </div>

                <!-- AdSense Ad After Filter Section -->
                <div style="margin: 20px 0; text-align: center; overflow: visible; min-width: 320px; width: 100%; max-width: 100%;">
                    <ins class="adsbygoogle"
                         style="display:block !important; min-width: 300px; width: 100%; max-width: 100%; visibility: visible;"
                         data-ad-client="ca-pub-5508768187151867"
                         data-ad-slot="9345718962"
                         data-ad-format="autorelaxed"></ins>
                    <script>
                        (adsbygoogle = window.adsbygoogle || []).push({});
                    </script>
                </div>

                <!-- Filter Results Summary - Ìëú Î∞îÎ°ú ÏúÑÎ°ú Ïù¥Îèô -->
                <div id="filter-summary" style="background: #e3f2fd; border: 1px solid #1976d2; border-radius: 4px; padding: 10px; margin: 15px 0; font-size: 13px; color: #1565c0;">
                    <strong>üìä Ë°®Á§∫ÁµêÊûú:</strong> <span id="filter-result-text">Ë™≠„ÅøËæº„Åø‰∏≠...</span>
                </div>

                <!-- All Games Combined Table -->
                <div>
                    <h4 style="color: #333; border-bottom: 2px solid #333; padding-bottom: 5px;">
                        üèÜ ÂÖ®Ë©¶ÂêàÁµêÊûú
                    </h4>
                    <div class="scroll-table">
                        <table id="all-games-table" class="games-table">
                            <thead>
                                <tr>
                                    <th>Êó•‰ªò„ÉªÊõúÊó•</th>
                                    <th>„É™„Éº„Ç∞</th>
                                    <th>„Ç¢„Ç¶„Çß„Ç§</th>
                                    <th>„Çπ„Ç≥„Ç¢</th>
                                    <th>„Éõ„Éº„É†</th>
                                    <th>ÊôÇÈñì</th>
                                    <th>ÁêÉÂ†¥</th>
                                    <th>„Ç§„Éã„É≥„Ç∞</th>
                                </tr>
                            </thead>
                            <tbody id="all-games-body">
                                <tr><td colspan="8" class="loading">Ë™≠„ÅøËæº„Åø‰∏≠...</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <div class="tab-help" style="background: #f1f3f5; border: 1px solid #dee2e6; border-radius: 4px; padding: 10px; margin: 10px 0; font-size: 12px; color: #333;">
                ‚Ä¢ <strong>È´òÂ∫¶„Éï„Ç£„É´„Çø„Éº</strong>: „ÉÅ„Éº„É†„ÄÅÊúà„ÄÅ„É™„Éº„Ç∞„ÄÅ„Ç§„Éã„É≥„Ç∞Âà•„ÅÆÊ§úÁ¥¢„ÅåÂèØËÉΩ<br>
                ‚Ä¢ <strong>Êó•‰ªòÈ†ÜË°®Á§∫</strong>: ÊúÄÊñ∞„ÅÆË©¶Âêà„Åã„ÇâÂè§„ÅÑË©¶ÂêàÈ†Ü„Å´Ë°®Á§∫<br>
                ‚Ä¢ <strong>„É™„Éº„Ç∞Âà•Ëâ≤ÂàÜ„Åë</strong>: „Çª„Éª„É™„Éº„Ç∞(Á∑ë)„ÄÅ„Éë„Éª„É™„Éº„Ç∞(Èùí)„ÅßÂå∫ÂàÜ<br>
                ‚Ä¢ <strong>Âª∂Èï∑Êà¶Ë°®Á§∫</strong>: 9Âõû„ÇíË∂Ö„Åà„ÅüË©¶Âêà„ÅØÂª∂Èï∑„Ç§„Éã„É≥„Ç∞Êï∞„ÇíË°®Á§∫<br>
                ‚Ä¢ <strong>ÈÄ±Êú´Âº∑Ë™ø</strong>: ÂúüÊó•„ÅÆË©¶Âêà„ÅØËÉåÊôØËâ≤„ÅßÂº∑Ë™øË°®Á§∫
            </div>

        </div>
        </section>
    </div> <!-- container Îã´Í∏∞ -->
    </main>

    <div class="floating-actions" role="region" aria-label="Quick actions">
        <button type="button" class="floating-action-button is-hidden" id="scrollTopButton" tabindex="-1">
            <span class="floating-action-icon" aria-hidden="true">‚¨Ü</span>
            <span class="floating-action-text" data-i18n="action-go-top">„Éà„ÉÉ„Éó„Å∏</span>
        </button>
        <button type="button" class="floating-action-button" id="shareButton" data-variant="accent" aria-haspopup="true" aria-expanded="false" aria-controls="shareMenu">
            <span class="floating-action-icon" aria-hidden="true">üîó</span>
            <span class="floating-action-text" data-i18n="action-share">SNSÂÖ±Êúâ</span>
        </button>
        <div class="floating-share-menu" id="shareMenu" role="menu" aria-hidden="true" aria-label="SNS Í≥µÏú† ÏòµÏÖò">
            <button type="button" class="floating-share-option" data-share-action="copy" role="menuitem">
                <span class="floating-share-option-icon" aria-hidden="true">üìã</span>
                <span class="floating-share-option-text" data-i18n="action-share-copy">ÎßÅÌÅ¨ Î≥µÏÇ¨</span>
            </button>
            <button type="button" class="floating-share-option" data-share-action="line" role="menuitem">
                <span class="floating-share-option-icon" aria-hidden="true">üí¨</span>
                <span class="floating-share-option-text" data-i18n="action-share-line">LINE Í≥µÏú†</span>
            </button>
            <button type="button" class="floating-share-option" data-share-action="threads" role="menuitem">
                <span class="floating-share-option-icon" aria-hidden="true">üßµ</span>
                <span class="floating-share-option-text" data-i18n="action-share-threads">Threads Í≥µÏú†</span>
            </button>
            <button type="button" class="floating-share-option" data-share-action="facebook" role="menuitem">
                <span class="floating-share-option-icon" aria-hidden="true">üìò</span>
                <span class="floating-share-option-text" data-i18n="action-share-facebook">Facebook Í≥µÏú†</span>
            </button>
            <button type="button" class="floating-share-option" data-share-action="x" role="menuitem">
                <span class="floating-share-option-icon" aria-hidden="true">ùïè</span>
                <span class="floating-share-option-text" data-i18n="action-share-x">X Í≥µÏú†</span>
            </button>
        </div>
        <div class="floating-action-feedback" id="floatingActionFeedback" aria-live="polite"></div>
    </div>

    <script>
        // ===== Multi-language translation data =====
        const translations = {
            ja: {
                // Main header
                'main-title': 'NPB 2025„Ç∑„Éº„Ç∫„É≥ È†Ü‰ΩçË°®„Éª„Éû„Ç∏„ÉÉ„ÇØ„Éä„É≥„Éê„Éº„ÉªCSÈÄ≤Âá∫Á¢∫Áéá',
                
                // Navigation tabs
                'nav-magic-regular': 'ÂÑ™Âãù„Éû„Ç∏„ÉÉ„ÇØ',
                'nav-magic-playoff': '„Éù„Çπ„Éà„Ç∑„Éº„Ç∫„É≥„Éû„Ç∏„ÉÉ„ÇØ', 
                'nav-scenarios': 'ÁµåË∑Ø„ÅÆÊï∞',
                'nav-standings': '„ÉÅ„Éº„É†È†Ü‰Ωç',
                'nav-h2h-records': 'ÂØæÊà¶ÊàêÁ∏æ',
                'nav-remaining': 'ÊÆã„ÇäË©¶ÂêàÊï∞',
                'nav-season-analysis': '„Ç∑„Éº„Ç∫„É≥ÂàÜÊûê',
                'nav-progress': 'ÈÄ≤Ë°åÁä∂Ê≥Å',
                'nav-all-games': 'ÂÖ®Ë©¶ÂêàÁµêÊûú',
                
                // Section titles
                'title-regular-magic': '2025Âπ¥Ê≠£Ë¶è„Ç∑„Éº„Ç∫„É≥ÂÑ™Âãù„Éû„Ç∏„ÉÉ„ÇØ„Éä„É≥„Éê„Éº„Äê„Çª„É™„Éº„Ç∞„Éª„Éë„É™„Éº„Ç∞„Äë',
                'title-playoff-magic': '„ÇØ„É©„Ç§„Éû„ÉÉ„ÇØ„Çπ„Ç∑„É™„Éº„Ç∫(CS)ÈÄ≤Âá∫„Éû„Ç∏„ÉÉ„ÇØ„Éä„É≥„Éê„Éº„Äê2025Âπ¥ÊúÄÊñ∞„Äë',
                'title-detailed-standings': 'NPBË©≥Á¥∞È†Ü‰ΩçË°®„ÄêÂãùÁéá„Éª„Ç≤„Éº„É†Â∑Æ„ÉªÊÆã„ÇäË©¶ÂêàÊï∞„Äë',
                'title-h2h-matrix': 'ÂØæÊà¶ÊàêÁ∏æ„Éû„Éà„É™„ÇØ„Çπ„Äê„ÉÅ„Éº„É†Âà•ÂØæÊà¶ÊàêÁ∏æ„Äë',
                'title-remaining-matrix': 'ÊÆã„ÇäË©¶ÂêàÂØæÊà¶„Éû„Éà„É™„ÇØ„Çπ„Äê„ÉÅ„Éº„É†Âà•ÂØæÊà¶‰∫àÂÆö„Äë',
                'title-season-analysis': '„Ç∑„Éº„Ç∫„É≥ÂàÜÊûê„ÄêÈ†Ü‰Ωç„ÉªÂãùÁéá„Éª„Ç≤„Éº„É†Â∑Æ„ÉªÂãùÊï∞Â§âÂãï„Äë',
                'title-progress': '2025Âπ¥„Ç∑„Éº„Ç∫„É≥ÈÄ≤Ë°åÁä∂Ê≥Å„ÄêÊ∂àÂåñË©¶ÂêàÊï∞„ÉªÈÄ≤ÊçóÁéá„Äë',
                'title-scenarios': 'ÁµåË∑Ø„ÅÆÊï∞ÔºàÂ†¥Âêà„ÅÆÊï∞Ôºâ',
                'title-all-games': 'ÂÖ®Ë©¶ÂêàÁµêÊûú„ÄêÊó•‰ªòÂà•ÁµåÈÅé„Äë',

                // Chart titles
                'chart-ranking-changes': '„Ç∑„Éº„Ç∫„É≥È†Ü‰ΩçÂ§âÂãï„ÉÅ„É£„Éº„Éà',
                'chart-winrate-changes': '„Ç∑„Éº„Ç∫„É≥ÂãùÁéáÂ§âÂåñ„ÉÅ„É£„Éº„Éà',
                'chart-gamesbehind-changes': '„Ç∑„Éº„Ç∫„É≥„Ç≤„Éº„É†Â∑ÆÂ§âÂåñ„ÉÅ„É£„Éº„Éà',
                'chart-wins-changes': '„Ç∑„Éº„Ç∫„É≥ÂãùÊï∞Â§âÂåñ„ÉÅ„É£„Éº„Éà',

                // League names
                'central-league': '„Çª„É≥„Éà„É©„É´„É™„Éº„Ç∞',
                'pacific-league': '„Éë„Ç∑„Éï„Ç£„ÉÉ„ÇØ„É™„Éº„Ç∞',
                'central-league-top3': '„Çª„É≥„Éà„É©„É´„É™„Éº„Ç∞ (‰∏ä‰Ωç3„ÉÅ„Éº„É†)',
                'pacific-league-top3': '„Éë„Ç∑„Éï„Ç£„ÉÉ„ÇØ„É™„Éº„Ç∞ (‰∏ä‰Ωç3„ÉÅ„Éº„É†)',
                
                // Table headers
                'rank': 'È†Ü‰Ωç',
                'team': '„ÉÅ„Éº„É†',
                'games-played': 'Ë©¶Âêà',
                'wins': 'Âãù',
                'losses': 'Êïó',
                'draws': 'ÂàÜ',
                'win-rate': 'ÂãùÁéá',
                'games-behind': '„Ç≤„Éº„É†Â∑Æ',
                'remaining-games': 'ÊÆã„ÇäË©¶Âêà',
                'max-wins': 'ÊúÄÂ§ßÂãù',
                'first-place-condition': '1‰ΩçÊù°‰ª∂',
                'magic': '„Éû„Ç∏„ÉÉ„ÇØ',
                'eliminate': '„Ç®„É™„Éü„Éç„Éº„Éà',
                'playoff-status': 'ÈÄ≤Âá∫Áä∂Ê≥Å',
                'clinch': '„ÇØ„É™„É≥„ÉÅ',
                'runs-scored': 'ÂæóÁÇπ',
                'runs-allowed': 'Â§±ÁÇπ',
                'run-differential': 'ÂæóÂ§±ÁÇπÂ∑Æ',
                
                // Buttons
                'today': '‰ªäÊó•',
                'tomorrow': 'ÊòéÊó•',
                'matrix': '„Éû„Éà„É™„ÇØ„Çπ',
                'detailed': 'Ë©≥Á¥∞',
                'action-go-top': '„Éà„ÉÉ„Éó„Å∏',
                'action-share': 'SNSÂÖ±Êúâ',
                'action-share-message': 'NPB 2025È†Ü‰ΩçË°®„ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„Éâ„Çí„ÉÅ„Çß„ÉÉ„ÇØÔºÅ',
                'action-share-success': 'ÂÖ±Êúâ„É°„Éã„É•„Éº„ÇíÈñã„Åç„Åæ„Åó„Åü',
                'action-share-copied': '„É™„É≥„ÇØ„Çí„Ç≥„Éî„Éº„Åó„Åæ„Åó„Åü',
                'action-share-error': 'ÂÖ±Êúâ„Å´Â§±Êïó„Åó„Åæ„Åó„Åü„ÄÇ„ÇÇ„ÅÜ‰∏ÄÂ∫¶„ÅäË©¶„Åó„Åè„Å†„Åï„ÅÑ„ÄÇ',
                'action-quick-actions': '„ÇØ„Ç§„ÉÉ„ÇØ„Ç¢„ÇØ„Ç∑„Éß„É≥',
                'action-share-opened': 'ÂÖ±Êúâ„Éö„Éº„Ç∏„ÇíÈñã„Åç„Åæ„Åó„Åü',
                'action-share-menu': 'SNSÂÖ±Êúâ„Ç™„Éó„Ç∑„Éß„É≥',
                'action-share-copy': '„É™„É≥„ÇØ„Çí„Ç≥„Éî„Éº',
                'action-share-line': 'LINE„ÅßÂÖ±Êúâ',
                'action-share-threads': 'Threads„ÅßÂÖ±Êúâ',
                'action-share-facebook': 'Facebook„ÅßÂÖ±Êúâ',
                'action-share-x': 'X„ÅßÂÖ±Êúâ',
                
                // Help and descriptions
                'help-regular-magic': '<strong>üèÜ Ê≠£Ë¶è„Ç∑„Éº„Ç∫„É≥ÂÑ™Âãù„Éû„Ç∏„ÉÉ„ÇØ„Éä„É≥„Éê„Éº</strong><br>ÂêÑ„ÉÅ„Éº„É†„ÅåÂÑ™Âãù„ÇíÁ¢∫ÂÆö„Åô„Çã„Åü„ÇÅ„Å´ÂøÖË¶Å„Å™ÊúÄÂ∞ëÂãùÂà©Êï∞„Åß„Åô„ÄÇ‰ªñ„ÉÅ„Éº„É†„ÅÆÁµêÊûú„Å´Èñ¢‰øÇ„Å™„Åè„ÄÅ„Åì„ÅÆÊï∞„Å†„ÅëÂãù„Å¶„Å∞ÂÑ™Âãù„ÅåÊ±∫ÂÆö„Åó„Åæ„Åô„ÄÇ„Äå‚úì„Äç„ÅØÊó¢„Å´ÂÑ™ÂãùÁ¢∫ÂÆöÊ∏à„Åø„ÇíÁ§∫„Åó„Åæ„Åô„ÄÇ',
                'help-playoff-magic': '<strong>üèÜ „ÇØ„É©„Ç§„Éû„ÉÉ„ÇØ„Çπ„Ç∑„É™„Éº„Ç∫ (CS) ÈÄ≤Âá∫„Å´„Å§„ÅÑ„Å¶</strong><br>„Çª„É™„Éº„Ç∞„Éª„Éë„É™„Éº„Ç∞„Å®„ÇÇ„Å´‰∏ä‰Ωç3„ÉÅ„Éº„É†„ÅåCSÈÄ≤Âá∫„ÄÇ3‰Ωç‰ª•ÂÜÖÁ¢∫ÂÆö„Å´ÂøÖË¶Å„Å™ÊúÄÂ∞ëÂãùÂà©Êï∞„ÇíË°®Á§∫„ÄÇÈ†Ü‰ΩçÁ¢∫ÂÆöÊ∏à„Åø„ÅØ„Äå‚úì„Äç„ÅßË°®Á§∫„ÄÇ',
                'help-scenarios': '<strong>üìä „Ç∑„Éä„É™„Ç™ÂàÜÊûê„Å´„Å§„ÅÑ„Å¶</strong><br>ÂêÑ„ÉÅ„Éº„É†„ÅåÁâπÂÆöÈ†Ü‰Ωç„Å´„Å™„ÇãÂèØËÉΩÊÄß„ÅÆ„ÅÇ„ÇãÂ†¥Âêà„ÅÆÊï∞„ÇíË°®Á§∫„Åó„Åæ„Åô„ÄÇË®àÁÆó„ÅØÊÆã„ÇäË©¶Âêà„ÅÆÂÖ®„Éë„Çø„Éº„É≥„ÇíËÄÉÊÖÆ„Åó„Åæ„Åô„ÄÇ',
                'help-standings': '<strong>üìã È†Ü‰ΩçË°®„Å´„Å§„ÅÑ„Å¶</strong><br>ÁèæÂú®„ÅÆÂêÑ„ÉÅ„Éº„É†ÊàêÁ∏æ„Å®È†Ü‰Ωç„Åß„Åô„ÄÇÂãùÁéá„ÅØÂºï„ÅçÂàÜ„Åë„ÇíÈô§Â§ñ„Åó„Å¶Ë®àÁÆó„Åï„Çå„Åæ„Åô„ÄÇ',
                'help-remaining': '<strong>üóì ÊÆã„ÇäË©¶Âêà„Å´„Å§„ÅÑ„Å¶</strong><br>ÂêÑ„ÉÅ„Éº„É†Èñì„ÅÆÊÆã„ÇäÂØæÊà¶Êï∞„ÇíË°®Á§∫„Åó„Åæ„Åô„ÄÇÊï∞Â≠ó„ÅØÊÆã„ÇäÂØæÊà¶ÂõûÊï∞„ÇíÁ§∫„Åó„Åæ„Åô„ÄÇ',
                'help-progress': '<strong>üìà ÈÄ≤Ë°åÁä∂Ê≥Å„Å´„Å§„ÅÑ„Å¶</strong><br>„Ç∑„Éº„Ç∫„É≥ÂÖ®‰Ωì„Åä„Çà„Å≥ÂêÑ„ÉÅ„Éº„É†„ÅÆÊ∂àÂåñË©¶ÂêàÊï∞„Å®ÈÄ≤ÊçóÁéá„ÇíË°®Á§∫„Åó„Åæ„Åô„ÄÇ',
                
                // Status messages
                'championship-decided': 'ÂÑ™ÂãùÊ±∫ÂÆö',
                'playoff-secured': 'CSÁ¢∫ÂÆö',
                'eliminated': 'ÂúèÂ§ñÁ¢∫ÂÆö',
                'still-possible': 'ÂèØËÉΩÊÄß„ÅÇ„Çä',
                
                // NPB team names (Japanese)
                'giants': 'Ë™≠Â£≤„Ç∏„É£„Ç§„Ç¢„É≥„ÉÑ',
                'tigers': 'Èò™Á•û„Çø„Ç§„Ç¨„Éº„Çπ', 
                'dragons': '‰∏≠Êó•„Éâ„É©„Ç¥„É≥„Ç∫',
                'carp': 'Â∫ÉÂ≥∂Êù±Ê¥ã„Ç´„Éº„Éó',
                'swallows': 'Êù±‰∫¨„É§„ÇØ„É´„Éà„Çπ„ÉØ„É≠„Éº„Ç∫',
                'baystars': 'Ê®™ÊµúDeNA„Éô„Ç§„Çπ„Çø„Éº„Ç∫',
                'hawks': '„ÇΩ„Éï„Éà„Éê„É≥„ÇØ„Éõ„Éº„ÇØ„Çπ',
                'eagles': 'Êù±ÂåóÊ•ΩÂ§©„Ç¥„Éº„É´„Éá„É≥„Ç§„Éº„Ç∞„É´„Çπ',
                'lions': 'ÂüºÁéâË•øÊ≠¶„É©„Ç§„Ç™„É≥„Ç∫',
                'marines': 'ÂçÉËëâ„É≠„ÉÉ„ÉÜ„Éû„É™„Éº„É≥„Ç∫',
                'fighters': 'ÂåóÊµ∑ÈÅìÊó•Êú¨„Éè„É†„Éï„Ç°„Ç§„Çø„Éº„Ç∫',
                'buffaloes': '„Ç™„É™„ÉÉ„ÇØ„Çπ„Éê„Éï„Ç°„É≠„Éº„Ç∫',
                
                // Team short names
                'giants-short': '„Ç∏„É£„Ç§„Ç¢„É≥„ÉÑ',
                'tigers-short': '„Çø„Ç§„Ç¨„Éº„Çπ',
                'dragons-short': '„Éâ„É©„Ç¥„É≥„Ç∫',
                'carp-short': '„Ç´„Éº„Éó',
                'swallows-short': '„Çπ„ÉØ„É≠„Éº„Ç∫',
                'baystars-short': '„Éô„Ç§„Çπ„Çø„Éº„Ç∫',
                'hawks-short': '„Éõ„Éº„ÇØ„Çπ',
                'eagles-short': '„Ç§„Éº„Ç∞„É´„Çπ',
                'lions-short': '„É©„Ç§„Ç™„É≥„Ç∫',
                'marines-short': '„Éû„É™„Éº„É≥„Ç∫',
                'fighters-short': '„Éï„Ç°„Ç§„Çø„Éº„Ç∫',
                'buffaloes-short': '„Éê„Éï„Ç°„É≠„Éº„Ç∫',
                
                // Ï°∞Í±¥ Î©îÏãúÏßÄ
                'wins-needed': 'ÂãùÂøÖË¶Å',
                'championship-secured': 'ÂÑ™ÂãùÁ¢∫ÂÆöÊ∏à„Åø',
                'playoff-advancement-secured': 'CSÈÄ≤Âá∫Á¢∫ÂÆö',
                'eliminated-short': 'E',
                'no-remaining-games': 'ÊÆã„ÇäË©¶Âêà„Å™„Åó',
                
                // Progress status text
                'games-completed': 'ÂÆå‰∫Ü',
                'games-remaining': 'ÊÆã„Çä',
                'games-unit': 'Ë©¶Âêà',
                'progress-gap': 'Ë©¶ÂêàÂ∑Æ',

                // Progress related
                'progress-rate': 'ÈÄ≤Ë°åÁéá',
                'progress-rate-desc': 'ÂêÑ„ÉÅ„Éº„É†„ÅåÊ∂àÂåñ„Åó„ÅüË©¶ÂêàÊï∞ / 143Ë©¶Âêà √ó 100%',
                'overall-progress': 'ÂÖ®‰ΩìÈÄ≤Ë°åÁéá',
                'overall-progress-desc': 'ÂÖ®„ÉÅ„Éº„É†Âπ≥Âùá„ÅÆÈÄ≤Ë°åÁä∂Ê≥Å',
                'remaining-games-label': 'ÊÆã„ÇäË©¶Âêà',
                'remaining-calc': '143 - ÁèæÂú®„ÅÆÊ∂àÂåñË©¶ÂêàÊï∞',
                'data-auto-update': '„Éá„Éº„Çø„ÅØÊúÄÊñ∞„ÅÆÈ†Ü‰ΩçË°®„Å´Âü∫„Å•„ÅÑ„Å¶Ëá™ÂãïÊõ¥Êñ∞„Åï„Çå„Åæ„Åô'
            },
            ko: {
                // Main header
                'main-title': 'NPB 2025ÏãúÏ¶å ÏàúÏúÑÌëú¬∑Îß§ÏßÅÎÑòÎ≤Ñ¬∑CSÏßÑÏ∂úÌôïÎ•†',
                
                // Navigation tabs
                'nav-magic-regular': 'Ï†ïÍ∑úÏãúÏ¶å Ïö∞Ïäπ Îß§ÏßÅ',
                'nav-magic-playoff': 'ÌîåÎ†àÏù¥Ïò§ÌîÑ Îß§ÏßÅ',
                'nav-scenarios': 'Í≤ΩÎ°úÏùò Ïàò',
                'nav-standings': 'ÌåÄ ÏàúÏúÑ',
                'nav-h2h-records': 'ÎåÄÏ†ÑÏÑ±Ï†Å',
                'nav-remaining': 'ÎÇ®ÏùÄ Í≤ΩÍ∏∞Ïàò',
                'nav-season-analysis': 'ÏãúÏ¶å Î∂ÑÏÑù',
                'nav-progress': 'ÏßÑÌñâ ÏÉÅÌô©',
                'nav-all-games': 'Ï†ÑÏ≤¥ Í≤ΩÍ∏∞ Í≤∞Í≥º',
                
                // Section titles
                'title-regular-magic': '2025ÎÖÑ Ï†ïÍ∑úÏãúÏ¶å Ïö∞Ïäπ Îß§ÏßÅÎÑòÎ≤Ñ„ÄêÏÑºÌä∏Îü¥¬∑ÌçºÏãúÌîΩ Î¶¨Í∑∏„Äë',
                'title-playoff-magic': 'ÌÅ¥ÎùºÏù¥Îß•Ïä§ ÏãúÎ¶¨Ï¶à(CS) ÏßÑÏ∂ú Îß§ÏßÅÎÑòÎ≤Ñ„Äê2025ÎÖÑ ÏµúÏã†„Äë',
                'title-detailed-standings': 'NPB ÏÉÅÏÑ∏ ÏàúÏúÑÌëú„ÄêÏäπÎ•†¬∑Í≤åÏûÑÏ∞®¬∑ÎÇ®ÏùÄÍ≤ΩÍ∏∞Ïàò„Äë',
                'title-h2h-matrix': 'ÎåÄÏ†ÑÏÑ±Ï†Å Îß§Ìä∏Î¶≠Ïä§„ÄêÌåÄÎ≥Ñ ÎåÄÏ†ÑÏÑ±Ï†Å„Äë',
                'title-remaining-matrix': 'ÎÇ®ÏùÄ Í≤ΩÍ∏∞ ÎåÄÏ†Ñ Îß§Ìä∏Î¶≠Ïä§„ÄêÌåÄÎ≥Ñ ÎåÄÏ†Ñ ÏòàÏ†ï„Äë',
                'title-season-analysis': 'ÏãúÏ¶å Î∂ÑÏÑù„ÄêÏàúÏúÑ¬∑ÏäπÎ•†¬∑Í≤åÏûÑÏ∞®¬∑ÏäπÏàò Î≥ÄÎèô„Äë',
                'title-progress': '2025ÎÖÑ ÏãúÏ¶å ÏßÑÌñâ ÏÉÅÌô©„ÄêÏÜåÌôîÍ≤ΩÍ∏∞Ïàò¬∑ÏßÑÌñâÎ•†„Äë',
                'title-scenarios': 'Í≤ΩÎ°úÏùò ÏàòÔºàÍ≤ΩÏö∞Ïùò ÏàòÔºâ',
                'title-all-games': 'Ï†ÑÏ≤¥ Í≤ΩÍ∏∞ Í≤∞Í≥º„ÄêÎÇ†ÏßúÎ≥Ñ Í≤ΩÍ≥º„Äë',

                // Chart titles
                'chart-ranking-changes': 'ÏãúÏ¶å ÏàúÏúÑ Î≥ÄÎèô Ï∞®Ìä∏',
                'chart-winrate-changes': 'ÏãúÏ¶å ÏäπÎ•† Î≥ÄÌôî Ï∞®Ìä∏',
                'chart-gamesbehind-changes': 'ÏãúÏ¶å Í≤åÏûÑÏ∞® Î≥ÄÌôî Ï∞®Ìä∏',
                'chart-wins-changes': 'ÏãúÏ¶å ÏäπÏàò Î≥ÄÌôî Ï∞®Ìä∏',

                // League names
                'central-league': 'ÏÑºÌä∏Îü¥Î¶¨Í∑∏',
                'pacific-league': 'ÌçºÏãúÌîΩÎ¶¨Í∑∏',
                'central-league-top3': 'ÏÑºÌä∏Îü¥Î¶¨Í∑∏ (ÏÉÅÏúÑ 3ÌåÄ)',
                'pacific-league-top3': 'ÌçºÏãúÌîΩÎ¶¨Í∑∏ (ÏÉÅÏúÑ 3ÌåÄ)',
                
                // Table headers
                'rank': 'ÏàúÏúÑ',
                'team': 'ÌåÄ',
                'games-played': 'Í≤ΩÍ∏∞',
                'wins': 'Ïäπ',
                'losses': 'Ìå®',
                'draws': 'Î¨¥',
                'win-rate': 'ÏäπÎ•†',
                'games-behind': 'Í≤åÏûÑÏ∞®',
                'remaining-games': 'ÎÇ®ÏùÄÍ≤ΩÍ∏∞',
                'max-wins': 'ÏµúÎåÄÏäπÏàò',
                'first-place-condition': '1ÏúÑÏ°∞Í±¥',
                'magic': 'Îß§ÏßÅ',
                'eliminate': 'ÏóòÎ¶¨ÎØ∏ÎÑ§Ïù¥Ìä∏',
                'playoff-status': 'ÏßÑÏ∂úÏÉÅÌô©',
                'clinch': 'ÌÅ¥Î¶∞Ïπò',
                'runs-scored': 'ÎìùÏ†ê',
                'runs-allowed': 'Ïã§Ï†ê',
                'run-differential': 'ÎìùÏã§Ï†êÏ∞®',
                
                // Buttons
                'today': 'Ïò§Îäò',
                'tomorrow': 'ÎÇ¥Ïùº',
                'matrix': 'Îß§Ìä∏Î¶≠Ïä§',
                'detailed': 'ÏÉÅÏÑ∏',
                'table': 'ÌïÑÏöîÏäπÏàòÌëú',
                'action-go-top': 'Îß® ÏúÑÎ°ú',
                'action-share': 'SNS Í≥µÏú†',
                'action-share-message': 'NPB 2025 ÏàúÏúÑÌëú ÎåÄÏãúÎ≥¥ÎìúÎ•º ÌôïÏù∏ÌïòÏÑ∏Ïöî!',
                'action-share-success': 'Í≥µÏú† Î©îÎâ¥Î•º Ïó¥ÏóàÏäµÎãàÎã§',
                'action-share-copied': 'ÎßÅÌÅ¨Î•º Î≥µÏÇ¨ÌñàÏäµÎãàÎã§',
                'action-share-error': 'Í≥µÏú†Ïóê Ïã§Ìå®ÌñàÏäµÎãàÎã§. Îã§Ïãú ÏãúÎèÑÌï¥Ï£ºÏÑ∏Ïöî.',
                'action-quick-actions': 'Îπ†Î•∏ Ïã§Ìñâ Î©îÎâ¥',
                'action-share-opened': 'Í≥µÏú† ÌéòÏù¥ÏßÄÎ•º Ïó¥ÏóàÏäµÎãàÎã§',
                'action-share-menu': 'SNS Í≥µÏú† ÏòµÏÖò',
                'action-share-copy': 'ÎßÅÌÅ¨ Î≥µÏÇ¨',
                'action-share-line': 'LINE Í≥µÏú†',
                'action-share-threads': 'Threads Í≥µÏú†',
                'action-share-facebook': 'Facebook Í≥µÏú†',
                'action-share-x': 'X Í≥µÏú†',
                
                // Help and descriptions
                'help-regular-magic': '<strong>üèÜ Ï†ïÍ∑úÏãúÏ¶å Ïö∞Ïäπ Îß§ÏßÅÎÑòÎ≤Ñ</strong><br>Í∞Å ÌåÄÏù¥ Ïö∞ÏäπÏùÑ ÌôïÏ†ïÌïòÍ∏∞ ÏúÑÌï¥ ÌïÑÏöîÌïú ÏµúÏÜå ÏäπÎ¶¨ÏàòÏûÖÎãàÎã§. Îã§Î•∏ ÌåÄÏùò Í≤∞Í≥ºÏóê Í¥ÄÍ≥ÑÏóÜÏù¥ Ïù¥ ÏàòÎßåÌÅº ÏäπÎ¶¨ÌïòÎ©¥ Ïö∞ÏäπÏù¥ Í≤∞Ï†ïÎê©ÎãàÎã§. „Äå‚úì„ÄçÎäî Ïù¥ÎØ∏ Ïö∞ÏäπÏù¥ ÌôïÏ†ïÎê®ÏùÑ ÎÇòÌÉÄÎÉÖÎãàÎã§.',
                'help-playoff-magic': '<strong>üèÜ ÌÅ¥ÎùºÏù¥Îß•Ïä§ ÏãúÎ¶¨Ï¶à (CS) ÏßÑÏ∂úÏóê ÎåÄÌï¥</strong><br>ÏÑºÌä∏Îü¥¬∑ÌçºÏãúÌîΩÎ¶¨Í∑∏ Î™®Îëê ÏÉÅÏúÑ 3ÌåÄÏù¥ CS ÏßÑÏ∂ú. 3ÏúÑ Ïù¥ÎÇ¥ ÌôïÏ†ïÏóê ÌïÑÏöîÌïú ÏµúÏÜå ÏäπÎ¶¨ÏàòÎ•º ÌëúÏãú. ÏàúÏúÑ ÌôïÏ†ïÏãú „Äå‚úì„ÄçÎ°ú ÌëúÏãú.',
                'help-scenarios': '<strong>üìä ÏãúÎÇòÎ¶¨Ïò§ Î∂ÑÏÑùÏóê ÎåÄÌï¥</strong><br>Í∞Å ÌåÄÏù¥ ÌäπÏ†ï ÏàúÏúÑÍ∞Ä Îê† Í∞ÄÎä•ÏÑ±Ïù¥ ÏûàÎäî Í≤ΩÏö∞Ïùò ÏàòÎ•º ÌëúÏãúÌï©ÎãàÎã§. Í≥ÑÏÇ∞ÏùÄ ÎÇ®ÏùÄ Í≤ΩÍ∏∞Ïùò Î™®Îì† Ìå®ÌÑ¥ÏùÑ Í≥†Î†§Ìï©ÎãàÎã§.',
                'help-standings': '<strong>üìã ÏàúÏúÑÌëúÏóê ÎåÄÌï¥</strong><br>ÌòÑÏû¨ Í∞Å ÌåÄÏùò ÏÑ±Ï†ÅÍ≥º ÏàúÏúÑÏûÖÎãàÎã§. ÏäπÎ•†ÏùÄ Î¨¥ÏäπÎ∂ÄÎ•º Ï†úÏô∏ÌïòÍ≥† Í≥ÑÏÇ∞Îê©ÎãàÎã§.',
                'help-remaining': '<strong>üóì ÎÇ®ÏùÄ Í≤ΩÍ∏∞Ïóê ÎåÄÌï¥</strong><br>Í∞Å ÌåÄ Í∞ÑÏùò ÎÇ®ÏùÄ ÎåÄÏ†ÑÏàòÎ•º ÌëúÏãúÌï©ÎãàÎã§. Ïà´ÏûêÎäî ÎÇ®ÏùÄ ÎåÄÏ†Ñ ÌöüÏàòÎ•º ÎÇòÌÉÄÎÉÖÎãàÎã§.',
                'help-progress': '<strong>üìà ÏßÑÌñâ ÏÉÅÌô©Ïóê ÎåÄÌï¥</strong><br>ÏãúÏ¶å Ï†ÑÏ≤¥ Î∞è Í∞Å ÌåÄÏùò ÏÜåÌôî Í≤ΩÍ∏∞ÏàòÏôÄ ÏßÑÌñâÎ•†ÏùÑ ÌëúÏãúÌï©ÎãàÎã§.',
                
                // Status messages
                'championship-decided': 'Ïö∞Ïäπ Í≤∞Ï†ï',
                'playoff-secured': 'CS ÌôïÏ†ï',
                'eliminated': 'Í∂åÏô∏ ÌôïÏ†ï',
                'still-possible': 'Í∞ÄÎä•ÏÑ± ÏûàÏùå',
                
                // NPB team names (Korean)
                'giants': 'ÏöîÎØ∏Ïö∞Î¶¨ ÏûêÏù¥Ïñ∏Ï∏†',
                'tigers': 'ÌïúÏã† ÌÉÄÏù¥Í±∞Ïä§',
                'dragons': 'Ï£ºÎãàÏπò ÎìúÎûòÍ≥§Ïä§',
                'carp': 'ÌûàÎ°úÏãúÎßà ÎèÑÏöî Ïπ¥ÌîÑ',
                'swallows': 'ÎèÑÏøÑ ÏïºÏø†Î•¥Ìä∏ Ïä§ÏôàÎ°úÏ¶à',
                'baystars': 'ÏöîÏΩîÌïòÎßà DeNA Î≤†Ïù¥Ïä§ÌÉÄÏä§',
                'hawks': 'ÏÜåÌîÑÌä∏Î±ÖÌÅ¨ Ìò∏ÌÅ¨Ïä§',
                'eagles': 'ÌÜ†Ìò∏Ïø† ÎùºÏø†ÌÖê Í≥®Îì†Ïù¥Í∏ÄÏä§',
                'lions': 'ÏÇ¨Ïù¥ÌÉÄÎßà ÏÑ∏Ïù¥Î∂Ä ÎùºÏù¥Ïò®Ïä§',
                'marines': 'ÏπòÎ∞î Î°ØÎç∞ ÎßàÎ¶∞Ïä§',
                'fighters': 'ÌôãÏπ¥Ïù¥ÎèÑ ÎãõÌè∞ÌñÑ ÌååÏù¥ÌÑ∞Ïä§',
                'buffaloes': 'Ïò§Î¶≠Ïä§ Î≤ÑÌåîÎ°úÏä§',
                
                // Team short names
                'giants-short': 'ÏûêÏù¥Ïñ∏Ï∏†',
                'tigers-short': 'ÌÉÄÏù¥Í±∞Ïä§',
                'dragons-short': 'ÎìúÎûòÍ≥§Ïä§',
                'carp-short': 'Ïπ¥ÌîÑ',
                'swallows-short': 'Ïä§ÏôàÎ°úÏ¶à',
                'baystars-short': 'Î≤†Ïù¥Ïä§ÌÉÄÏä§',
                'hawks-short': 'Ìò∏ÌÅ¨Ïä§',
                'eagles-short': 'Ïù¥Í∏ÄÏä§',
                'lions-short': 'ÎùºÏù¥Ïò®Ïä§',
                'marines-short': 'ÎßàÎ¶∞Ïä§',
                'fighters-short': 'ÌååÏù¥ÌÑ∞Ïä§',
                'buffaloes-short': 'Î≤ÑÌåîÎ°úÏä§',
                
                // Ï°∞Í±¥ Î©îÏãúÏßÄ
                'wins-needed': 'Ïäπ ÌïÑÏöî',
                'championship-secured': 'Ïö∞Ïäπ ÌôïÏ†ï',
                'playoff-advancement-secured': 'CS ÏßÑÏ∂ú ÌôïÏ†ï',
                'eliminated-short': 'E',
                'no-remaining-games': 'ÎÇ®ÏùÄ Í≤ΩÍ∏∞ ÏóÜÏùå',
                
                // Progress status text
                'games-completed': 'ÏôÑÎ£å',
                'games-remaining': 'ÎÇ®ÏùÄ',
                'games-unit': 'Í≤ΩÍ∏∞',
                'progress-gap': 'Í≤ΩÍ∏∞Ï∞®',

                // Progress related
                'progress-rate': 'ÏßÑÌñâÎ•†',
                'progress-rate-desc': 'Í∞Å ÌåÄÏù¥ ÏÜåÌôîÌïú Í≤ΩÍ∏∞Ïàò / 143Í≤ΩÍ∏∞ √ó 100%',
                'overall-progress': 'Ï†ÑÏ≤¥ÏßÑÌñâÎ•†',
                'overall-progress-desc': 'Ï†Ñ ÌåÄ ÌèâÍ∑†Ïùò ÏßÑÌñâÏÉÅÌô©',
                'remaining-games-label': 'ÎÇ®ÏùÄ Í≤ΩÍ∏∞',
                'remaining-calc': '143 - ÌòÑÏû¨Ïùò ÏÜåÌôîÍ≤ΩÍ∏∞Ïàò',
                'data-auto-update': 'Îç∞Ïù¥ÌÑ∞Îäî ÏµúÏã†Ïùò ÏàúÏúÑÌëúÏóê Í∏∞Î∞òÌïòÏó¨ ÏûêÎèôÏóÖÎç∞Ïù¥Ìä∏Îê©ÎãàÎã§'
            },
            en: {
                // Main header
                'main-title': 'NPB 2025 Season Standings ¬∑ Magic Numbers ¬∑ CS Playoff Probability',
                
                // Navigation tabs
                'nav-magic-regular': 'Regular Season Magic',
                'nav-magic-playoff': 'Playoff Magic',
                'nav-scenarios': 'Path Count',
                'nav-standings': 'Team Standings',
                'nav-h2h-records': 'Head-to-Head',
                'nav-remaining': 'Remaining Games',
                'nav-season-analysis': 'Season Analysis',
                'nav-progress': 'Season Progress',
                'nav-all-games': 'All Game Results',
                
                // Section titles
                'title-regular-magic': '2025 Regular Season Championship Magic Numbers„ÄêCentral„ÉªPacific League„Äë',
                'title-playoff-magic': 'Climax Series (CS) Advancement Magic Numbers„Äê2025 Latest„Äë',
                'title-detailed-standings': 'NPB Detailed Standings„ÄêWin Rate„ÉªGames Behind„ÉªRemaining Games„Äë',
                'title-h2h-matrix': 'Head-to-Head Records Matrix„ÄêTeam vs Team Records„Äë',
                'title-remaining-matrix': 'Remaining Games Matrix„ÄêTeam vs Team Schedule„Äë',
                'title-season-analysis': 'Season Analysis„ÄêRanking„ÉªWin Rate„ÉªGames Behind„ÉªWins Changes„Äë',
                'title-progress': '2025 Season Progress„ÄêGames Played„ÉªProgress Rate„Äë',
                'title-scenarios': 'Path Count (Number of Cases)',
                'title-all-games': 'All Game Results„ÄêDate-wise Progress„Äë',

                // Chart titles
                'chart-ranking-changes': 'Season Ranking Changes Chart',
                'chart-winrate-changes': 'Season Win Rate Changes Chart',
                'chart-gamesbehind-changes': 'Season Games Behind Changes Chart',
                'chart-wins-changes': 'Season Wins Changes Chart',

                // League names
                'central-league': 'Central League',
                'pacific-league': 'Pacific League',
                'central-league-top3': 'Central League (Top 3 Teams)',
                'pacific-league-top3': 'Pacific League (Top 3 Teams)',
                
                // Table headers
                'rank': 'Rank',
                'team': 'Team',
                'games-played': 'GP',
                'wins': 'W',
                'losses': 'L',
                'draws': 'T',
                'win-rate': 'PCT',
                'games-behind': 'GB',
                'remaining-games': 'Remaining',
                'max-wins': 'Max Wins',
                'first-place-condition': '1st Place Condition',
                'magic': 'Magic',
                'eliminate': 'Eliminate',
                'playoff-status': 'Playoff Status',
                'clinch': 'Clinch',
                'runs-scored': 'RS',
                'runs-allowed': 'RA',
                'run-differential': 'Diff',
                
                // Buttons
                'today': 'Today',
                'tomorrow': 'Tomorrow',
                'matrix': 'Matrix',
                'detailed': 'Detailed',
                'table': 'Win Requirements',
                'action-go-top': 'Back to Top',
                'action-share': 'Share',
                'action-share-message': 'Check out the NPB 2025 standings dashboard!',
                'action-share-success': 'Share dialog opened',
                'action-share-copied': 'Link copied to clipboard',
                'action-share-error': 'Unable to share. Please try again.',
                'action-quick-actions': 'Quick actions',
                'action-share-opened': 'Opened share page',
                'action-share-menu': 'Share options',
                'action-share-copy': 'Copy link',
                'action-share-line': 'Share on LINE',
                'action-share-threads': 'Share on Threads',
                'action-share-facebook': 'Share on Facebook',
                'action-share-x': 'Share on X',
                
                // Help and descriptions
                'help-regular-magic': '<strong>üèÜ Regular Season Championship Magic Numbers</strong><br>The minimum number of wins each team needs to secure the championship. Regardless of other teams\' results, winning this many games guarantees the championship. \"‚úì\" indicates championship already secured.',
                'help-playoff-magic': '<strong>üèÜ About Climax Series (CS) Advancement</strong><br>Top 3 teams from both Central and Pacific leagues advance to CS. Shows minimum wins needed to secure top 3 position. \"‚úì\" indicates position already secured.',
                'help-scenarios': '<strong>üìä About Scenario Analysis</strong><br>Shows the number of possible cases where each team can finish at specific rankings. Calculations consider all possible patterns of remaining games.',
                'help-standings': '<strong>üìã About Standings</strong><br>Current performance and rankings of each team. Win percentage is calculated excluding ties.',
                'help-remaining': '<strong>üóì About Remaining Games</strong><br>Shows remaining matchups between each team. Numbers indicate remaining games to be played.',
                'help-progress': '<strong>üìà About Season Progress</strong><br>Shows games played and progress rate for the entire season and each team.',
                
                // Status messages
                'championship-decided': 'Championship Decided',
                'playoff-secured': 'CS Secured',
                'eliminated': 'Eliminated',
                'still-possible': 'Still Possible',
                
                // NPB team names (English)
                'giants': 'Yomiuri Giants',
                'tigers': 'Hanshin Tigers',
                'dragons': 'Chunichi Dragons',
                'carp': 'Hiroshima Toyo Carp',
                'swallows': 'Tokyo Yakult Swallows',
                'baystars': 'Yokohama DeNA BayStars',
                'hawks': 'SoftBank Hawks',
                'eagles': 'Tohoku Rakuten Golden Eagles',
                'lions': 'Saitama Seibu Lions',
                'marines': 'Chiba Lotte Marines',
                'fighters': 'Hokkaido Nippon-Ham Fighters',
                'buffaloes': 'Orix Buffaloes',
                
                // Team short names
                'giants-short': 'Giants',
                'tigers-short': 'Tigers',
                'dragons-short': 'Dragons',
                'carp-short': 'Carp',
                'swallows-short': 'Swallows',
                'baystars-short': 'BayStars',
                'hawks-short': 'Hawks',
                'eagles-short': 'Eagles',
                'lions-short': 'Lions',
                'marines-short': 'Marines',
                'fighters-short': 'Fighters',
                'buffaloes-short': 'Buffaloes',
                
                // Ï°∞Í±¥ Î©îÏãúÏßÄ
                'wins-needed': 'Wins Needed',
                'championship-secured': 'Championship Secured',
                'playoff-advancement-secured': 'CS Secured',
                'eliminated-short': 'E',
                'no-remaining-games': 'No Games Left',
                
                // Progress status text
                'games-completed': 'Completed',
                'games-remaining': 'Remaining',
                'games-unit': 'Games',
                'progress-gap': 'Games Gap',

                // Progress related
                'progress-rate': 'Progress Rate',
                'progress-rate-desc': 'Games played by each team / 143 games √ó 100%',
                'overall-progress': 'Overall Progress',
                'overall-progress-desc': 'Average progress of all teams',
                'remaining-games-label': 'Remaining Games',
                'remaining-calc': '143 - Current games played',
                'data-auto-update': 'Data is automatically updated based on the latest standings'
            }
        };

        // ===== „Ç∞„É≠„Éº„Éê„É´Â§âÊï∞ =====
        let standingsData = null;      // È†Ü‰ΩçË°®„Éá„Éº„Çø
        let seasonConfig = null;       // „Ç∑„Éº„Ç∫„É≥Ë®≠ÂÆö„Éá„Éº„Çø  
        let gamesData = null;          // ÂÖ®Ë©¶ÂêàÔºàÂÆå‰∫ÜÂàÜÔºâ„Éá„Éº„Çø
        let lastTenRecordsByTeam = {}; // „ÉÅ„Éº„É†Âà•Áõ¥Ëøë10Ë©¶ÂêàÊàêÁ∏æ
        let upcomingGamesData = null;  // ÊÆã„ÇäË©¶Âêà„Éá„Éº„Çø
        let homeAwayRemainingByTeam = {}; // { team_id: { home: n, away: n, opponents: {} } }
        let TOTAL_GAMES = 143;         // NPB Ê≠£Ë¶è„Ç∑„Éº„Ç∫„É≥: 1„ÉÅ„Éº„É†143Ë©¶Âêà

        // Structured data helpers for upcoming events
        const EVENT_BASE_URL = 'https://npb-dashboard.com';
        const EVENT_STRUCTURED_DATA_ID = 'ldjson-upcoming-events';
        const EVENT_TIMEZONE_OFFSET = '+09:00';
        const DEFAULT_EVENT_TIME = '12:00';
        const EVENT_DURATION_HOURS = 3;
        const TEAM_LOGO_MAP = {
            YOG: 'yomiuri-giants.svg',
            YAK: 'tokyo-yakult-swallows.svg',
            YDB: 'yokohama-dena-baystars.svg',
            HAN: 'hanshin-tigers.svg',
            HIR: 'hiroshima-toyo-carp.svg',
            CHU: 'chunichi-dragons.svg',
            SOF: 'fukuoka-softbank-hawks.svg',
            NIP: 'hokkaido-nippon-ham-fighters.svg',
            SEI: 'saitama-seibu-lions.svg',
            RAK: 'tohoku-rakuten-golden-eagles.svg',
            ORI: 'orix-buffaloes.svg',
            LOT: 'chiba-lotte-marines.svg'
        };

        function slugify(value) {
            if (!value) return 'item';
            const slug = value.toString().trim().toLowerCase().replace(/[^a-z0-9]+/g, '-');
            return slug || 'item';
        }

        function normalizeTime(value) {
            if (!value) return null;
            const withAsciiDigits = value
                .replace(/[Ôºê-Ôºô]/g, char => String.fromCharCode(char.charCodeAt(0) - 0xFEE0));
            const normalized = withAsciiDigits.replace(/[Ôºö]/g, ':').trim();
            const [hour, minute] = normalized.split(':');
            if (!hour || !minute) return null;
            const parsedHour = Number.parseInt(hour, 10);
            const parsedMinute = Number.parseInt(minute, 10);
            if (Number.isNaN(parsedHour) || Number.isNaN(parsedMinute)) {
                return null;
            }
            return `${String(parsedHour).padStart(2, '0')}:${String(parsedMinute).padStart(2, '0')}`;
        }

        function extractStadiumDetails(rawValue) {
            if (!rawValue || typeof rawValue !== 'string') {
                return { name: null, time: null };
            }
            const normalized = rawValue.replace(/[Ôºö]/g, ':').trim();
            const match = normalized.match(/(.+?)\s*(\d{1,2}:\d{2})$/);
            if (match) {
                return {
                    name: match[1].trim(),
                    time: normalizeTime(match[2])
                };
            }
            return { name: normalized, time: null };
        }

        function addOneDay(dateStr) {
            const parts = dateStr ? dateStr.split('-').map(Number) : [];
            if (parts.length !== 3) return dateStr;
            const next = new Date(Date.UTC(parts[0], parts[1] - 1, parts[2]));
            next.setUTCDate(next.getUTCDate() + 1);
            const year = next.getUTCFullYear();
            const month = String(next.getUTCMonth() + 1).padStart(2, '0');
            const day = String(next.getUTCDate()).padStart(2, '0');
            return `${year}-${month}-${day}`;
        }

        function buildIsoDate(dateStr, timeStr) {
            if (!dateStr) return null;
            const time = normalizeTime(timeStr) || DEFAULT_EVENT_TIME;
            return `${dateStr}T${time}:00${EVENT_TIMEZONE_OFFSET}`;
        }

        function buildIsoEndDate(dateStr, timeStr) {
            if (!dateStr) return null;
            const time = normalizeTime(timeStr) || DEFAULT_EVENT_TIME;
            const [hourStr, minuteStr] = time.split(':');
            let hour = parseInt(hourStr, 10);
            const minute = parseInt(minuteStr, 10);
            if (Number.isNaN(hour) || Number.isNaN(minute)) {
                return `${dateStr}T${DEFAULT_EVENT_TIME}:00${EVENT_TIMEZONE_OFFSET}`;
            }
            hour += EVENT_DURATION_HOURS;
            let endDate = dateStr;
            while (hour >= 24) {
                hour -= 24;
                endDate = addOneDay(endDate);
            }
            const endHour = String(hour).padStart(2, '0');
            const endMinute = String(minute).padStart(2, '0');
            return `${endDate}T${endHour}:${endMinute}:00${EVENT_TIMEZONE_OFFSET}`;
        }

        function mapEventStatus(status) {
            const value = (status || '').toString().toLowerCase();
            switch (value) {
                case 'postponed':
                    return 'https://schema.org/EventPostponed';
                case 'cancelled':
                case 'canceled':
                    return 'https://schema.org/EventCancelled';
                case 'rescheduled':
                    return 'https://schema.org/EventRescheduled';
                default:
                    return 'https://schema.org/EventScheduled';
            }
        }

        function getTeamLogoUrls(homeAbbr, awayAbbr) {
            const result = [];
            [awayAbbr, homeAbbr].forEach(code => {
                const file = TEAM_LOGO_MAP[code];
                if (file) {
                    result.push(`${EVENT_BASE_URL}/assets/npb-logos/svg/${file}`);
                }
            });
            if (!result.length) {
                result.push(`${EVENT_BASE_URL}/favicon.png`);
            }
            return result;
        }

        function buildEventGraph(games) {
            if (!Array.isArray(games)) return [];
            const sanitized = games
                .map(game => {
                    const date = game.game_date || game.date;
                    if (!date) return null;
                    const stadiumDetails = extractStadiumDetails(game.stadium || game.venue || '');
                    const homeName = game.home_team_name || game.home;
                    const awayName = game.away_team_name || game.away;
                    const status = (game.game_status || 'scheduled').toString().toLowerCase();
                    return {
                        raw: game,
                        date,
                        stadiumDetails,
                        homeName,
                        awayName,
                        status
                    };
                })
                .filter(item => item && item.homeName && item.awayName && !['final', 'finished', 'complete', 'completed'].includes(item.status));

            sanitized.sort((a, b) => {
                if (a.date === b.date) {
                    const timeA = a.stadiumDetails.time || DEFAULT_EVENT_TIME;
                    const timeB = b.stadiumDetails.time || DEFAULT_EVENT_TIME;
                    return timeA.localeCompare(timeB);
                }
                return a.date.localeCompare(b.date);
            });

            return sanitized
                .slice(0, 12)
                .map(item => {
                    const homeAbbr = item.raw.home_team_abbr || slugify(item.homeName);
                    const awayAbbr = item.raw.away_team_abbr || slugify(item.awayName);
                    const eventId = `${EVENT_BASE_URL}/#event-${item.date}-${awayAbbr}-${homeAbbr}`;
                    const startDate = buildIsoDate(item.date, item.stadiumDetails.time);
                    const endDate = buildIsoEndDate(item.date, item.stadiumDetails.time);
                    const status = mapEventStatus(item.raw.game_status);
                    return {
                        "@type": "SportsEvent",
                        "@id": eventId,
                        "name": `${item.awayName} vs ${item.homeName}`,
                        "startDate": startDate,
                        "endDate": endDate,
                        "eventStatus": status,
                        "eventAttendanceMode": "https://schema.org/OfflineEventAttendanceMode",
                        "location": {
                            "@type": "Place",
                            "name": item.stadiumDetails.name || '‰ºöÂ†¥Êú™ÂÆö',
                            "address": {
                                "@type": "PostalAddress",
                                "addressCountry": "JP"
                            }
                        },
                        "description": `${item.date} „Å´ÈñãÂÇ¨‰∫àÂÆö„ÅÆ ${item.awayName} ÂØæ ${item.homeName} „ÅÆË©¶Âêà„ÄÇ${item.stadiumDetails.name || '‰ºöÂ†¥Êú™ÂÆö'} „ÅßË°å„Çè„Çå„Åæ„Åô„ÄÇ`,
                        "image": getTeamLogoUrls(homeAbbr, awayAbbr),
                        "performer": [
                            { "@type": "SportsTeam", "name": item.awayName, "sport": "Baseball" },
                            { "@type": "SportsTeam", "name": item.homeName, "sport": "Baseball" }
                        ],
                        "homeTeam": { "@type": "SportsTeam", "name": item.homeName, "sport": "Baseball" },
                        "awayTeam": { "@type": "SportsTeam", "name": item.awayName, "sport": "Baseball" },
                        "organizer": {
                            "@type": "SportsOrganization",
                            "name": "Nippon Professional Baseball",
                            "url": "https://npb.jp"
                        },
                        "offers": {
                            "@type": "Offer",
                            "price": "0",
                            "priceCurrency": "JPY",
                            "availability": "https://schema.org/InStock",
                            "url": eventId
                        },
                        "isAccessibleForFree": true
                    };
                });
        }

        function injectEventStructuredData(games) {
            const graph = buildEventGraph(games);
            const existing = document.getElementById(EVENT_STRUCTURED_DATA_ID);
            if (!graph.length) {
                if (existing) existing.remove();
                return;
            }
            const payload = {
                "@context": "https://schema.org",
                "@graph": graph
            };
            const scriptContent = JSON.stringify(payload, null, 2);
            if (existing) {
                existing.textContent = scriptContent;
                return;
            }
            const script = document.createElement('script');
            script.type = 'application/ld+json';
            script.id = EVENT_STRUCTURED_DATA_ID;
            script.textContent = scriptContent;
            document.head.appendChild(script);
        }

        // Helper to convert existing data format for new calculation functions
        function convertTeamDataForMagic(teams) {
            return teams.map(team => ({
                id: team.team_id || team.team_name,
                W: team.wins,
                L: team.losses,
                T: team.draws || 0
            }));
        }

        // ===== NPB Îß§ÏßÅ/Ìä∏ÎûòÏßÅ ÎÑòÎ≤Ñ Í≥ÑÏÇ∞ Í≥µÌÜµ Ïú†Ìã∏ Ìï®ÏàòÎì§ =====
        function calcR(team, season=143) {
            return season - (team.W + team.L + team.T);
        }
        function winPct(team, R) { // ÌòÑÏû¨ ÏäπÎ•†
            const denom = team.W + team.L;
            return denom > 0 ? team.W / denom : 0;
        }
        function pMax(team, R) { // ÎÇ®ÏùÄ Ï†ÑÏäπ
            const denom = team.W + team.L + R;
            return denom > 0 ? (team.W + R) / denom : 0;
        }
        function pMin(team, R) { // ÎÇ®ÏùÄ Ï†ÑÌå®
            const denom = team.W + team.L + R;
            return denom > 0 ? (team.W) / denom : 0;
        }
        function clamp(v, lo, hi) { return Math.max(lo, Math.min(hi, v)); }
        function round3(x){ return Number(x.toFixed(3)); }

        // ===== NPB regular season magic/tragic calculation library =====
        // Current standings (sorted by win rate in descending order). Ties excluded from denominator
        function sortStandings(teams, season=143) {
            return [...teams].map(t => {
                const R = calcR(t, season);
                return { ...t, R, winPct: winPct(t, R) };
            }).sort((a,b)=> b.winPct - a.winPct);
        }

        // Î™®Îìú 1) Í≥µÏãù Î∞©Ïãù: ÌòÑÏû¨ 1ÏúÑ vs ÌòÑÏû¨ 2ÏúÑ
        function officialLeaderMagicTragic(teams, season=143) {
            const table = sortStandings(teams, season);
            const leader = table[0];
            const runner = table[1];

            const R1 = leader.R;
            const D1 = leader.W + leader.L + R1;          // ÏµúÏ¢Ö Î∂ÑÎ™®(Î¨¥ÏäπÎ∂Ä Ï†úÏô∏)
            const R2 = runner.R;
            const D2 = runner.W + runner.L + R2;

            // 1ÏúÑ ÌôïÏ†ï(Îß§ÏßÅ): (W1 + x) / D1  >  (W2 + R2) / D2  (strict) / ‚â• (tieOK)
            const K1_official = (runner.W + R2) / D2;      // 2ÏúÑÏùò ÏµúÎåÄ Í∞ÄÎä• ÏäπÎ•†
            const needWins_rhs = K1_official * D1 - leader.W;
            const x_strict = Math.max(0, Math.floor(needWins_rhs) + 1);
            const x_tieOK  = Math.max(0, Math.ceil(needWins_rhs));
            const x_strict_c = clamp(x_strict, 0, R1);
            const x_tieOK_c  = clamp(x_tieOK,  0, R1);

            // 1ÏúÑ ÌÉàÎùΩ(Ìä∏ÎûòÏßÅ): (W1 + R1 - y) / D1  ‚â§  (W2) / D2  (strict) / < (tieOK)
            const K1min_official = (runner.W) / D2;        // 2ÏúÑÏùò ÏµúÏÜå Í∞ÄÎä• ÏäπÎ•†
            const lose_rhs = leader.W + R1 - K1min_official * D1;
            const y_strict = Math.max(0, Math.ceil(lose_rhs));
            const y_tieOK  = Math.max(0, Math.floor(lose_rhs) + 1);
            const y_strict_c = clamp(y_strict, 0, R1);
            const y_tieOK_c  = clamp(y_tieOK,  0, R1);

            return {
                leader: { id: leader.id, W: leader.W, L: leader.L, T: leader.T, R: leader.R, winPct: round3(leader.winPct) },
                runnerUp: { id: runner.id, W: runner.W, L: runner.L, T: runner.T, R: runner.R, winPct: round3(runner.winPct) },
                K1_official: round3(K1_official),
                K1min_official: round3(K1min_official),
                x_strict: x_strict_c,   // ÎèôÎ•† Î∂àÌóà
                x_tieOK:  x_tieOK_c,    // ÎèôÎ•† ÌóàÏö©
                y_strict: y_strict_c,   // ÎèôÎ•† Î∂àÌóà
                y_tieOK:  y_tieOK_c     // ÎèôÎ•† ÌóàÏö©
            };
        }

        // Î™®Îìú 2) Î≥¥Ïàò Î∞©Ïãù: Ï†Ñ ÌåÄ Í∏∞Ï§Ä(ÏµúÎåì/ÏµúÏÜü ÏäπÎ•†)
        function conservativeAllTeamsMagicTragic(teams, season=143) {
            return teams.map(t => {
                const Ri = calcR(t, season);
                const Di = t.W + t.L + Ri;

                // Îã§Î•∏ ÌåÄÎì§Ïùò ÏµúÎåÄ Í∞ÄÎä• ÏäπÎ•†Ïùò ÏµúÎåìÍ∞í (ÎÇ¥Í∞Ä ÎÑòÏñ¥Ïïº Ìï† Í∏∞Ï§Ä)
                let K1_max = 0;
                // Îã§Î•∏ ÌåÄÎì§Ïùò ÏµúÏÜå Í∞ÄÎä• ÏäπÎ•†Ïùò ÏµúÎåìÍ∞í (ÎÇ¥Í∞Ä Î™ª ÎØ∏ÏπòÎ©¥ ÌÉàÎùΩ Î≥¥Ïû•)
                let K1_min = 0;

                for (const u of teams) {
                    if (u.id === t.id) continue;
                    const Ru = calcR(u, season);
                    K1_max = Math.max(K1_max, pMax(u, Ru));
                    K1_min = Math.max(K1_min, pMin(u, Ru));
                }

                // Îß§ÏßÅÎÑòÎ≤Ñ(1ÏúÑ ÌôïÏ†ï): (Wi + x)/Di > K1_max (strict) / ‚â• (tieOK)
                const needWins_rhs = K1_max * Di - t.W;
                const x_strict = Math.max(0, Math.floor(needWins_rhs) + 1);
                const x_tieOK  = Math.max(0, Math.ceil(needWins_rhs));

                // Ìä∏ÎûòÏßÅÎÑòÎ≤Ñ(1ÏúÑ ÌÉàÎùΩ): (Wi + Ri - y)/Di ‚â§ K1_min (strict) / < (tieOK)
                const lose_rhs = t.W + Ri - K1_min * Di;
                const y_strict = Math.max(0, Math.ceil(lose_rhs));
                const y_tieOK  = Math.max(0, Math.floor(lose_rhs) + 1);

                return {
                    team: t.id,
                    W: t.W, L: t.L, T: t.T, R: Ri,
                    winPct: round3(winPct(t, Ri)),
                    K1_max: round3(K1_max),
                    K1_min: round3(K1_min),
                    x_strict: clamp(x_strict, 0, Ri),
                    x_tieOK:  clamp(x_tieOK,  0, Ri),
                    y_strict: clamp(y_strict, 0, Ri),
                    y_tieOK:  clamp(y_tieOK,  0, Ri)
                };
            });
        }

        // ÌÜµÌï© ÏóîÌä∏Î¶¨ Ìï®Ïàò
        function npbRank1MagicTragic(teams, season=143) {
            const official = officialLeaderMagicTragic(teams, season);     // ÌòÑÏû¨ 1ÏúÑ Ï†ÑÏö©(2ÏúÑÎßå ÎπÑÍµê)
            const conservative = conservativeAllTeamsMagicTragic(teams, season); // Ï†Ñ ÌåÄ Î≥¥Ïàò Í≥ÑÏÇ∞
            const leaderInfo = sortStandings(teams, season)[0];
            return {
                leader: { id: leaderInfo.id, W: leaderInfo.W, L: leaderInfo.L, T: leaderInfo.T, R: leaderInfo.R, winPct: round3(leaderInfo.winPct) },
                official: { onlyLeader: official },
                conservative: { rows: conservative }
            };
        }

        // ===== NPB ÌîÑÎ†àÏù¥Ïò§ÌîÑ(ÏÉÅÏúÑ 3ÏúÑ) Îß§ÏßÅ/Ìä∏ÎûòÏßÅ Í≥ÑÏÇ∞ ÎùºÏù¥Î∏åÎü¨Î¶¨ =====
        function pNow(team) { // ÌòÑÏû¨ ÏäπÎ•† (Î¨¥ÏäπÎ∂Ä Ï†úÏô∏)
            const denom = team.W + team.L;
            return denom > 0 ? team.W / denom : 0;
        }

        function kthLargest(arr, k) {
            if (!arr.length || k < 1) return 0;
            const sorted = [...arr].sort((a, b) => b - a);
            return sorted[k - 1] ?? 0;
        }

        function kBenchmarksForTeam(i, teams, season, k) {
            const maxList = [];
            const minList = [];
            for (const t of teams) {
                if (t.id === i.id) continue;
                const R = calcR(t, season);
                maxList.push(pMax(t, R));
                minList.push(pMin(t, R));
            }
            return {
                Kk_max: kthLargest(maxList, k),
                Kk_min: kthLargest(minList, k)
            };
        }

        function magicTragicForK(team, season, k, Kk_max, Kk_min) {
            const Ri = calcR(team, season);
            const Di = team.W + team.L + Ri;

            // Magic (ÌôïÏ†ï)
            const rhsMagic = Kk_max * Di - team.W;
            const x_strict = Math.max(0, Math.floor(rhsMagic) + 1); // >
            const x_tieOK  = Math.max(0, Math.ceil(rhsMagic));      // ‚â•

            // Tragic (ÌÉàÎùΩ)
            const rhsTr = team.W + Ri - Kk_min * Di;
            const y_strict = Math.max(0, Math.ceil(rhsTr));         // ‚â§
            const y_tieOK  = Math.max(0, Math.floor(rhsTr) + 1);    // <

            return {
                R: Ri,
                x_strict: clamp(x_strict, 0, Ri),
                x_tieOK:  clamp(x_tieOK,  0, Ri),
                y_strict: clamp(y_strict, 0, Ri),
                y_tieOK:  clamp(y_tieOK,  0, Ri)
            };
        }

        function npbPlayoffMagicTragic(teams, season = 143, ks = [1, 2, 3]) {
            return teams.map(team => {
                const Ri = calcR(team, season);
                const row = {
                    team: team.id,
                    W: team.W, L: team.L, T: team.T, R: Ri,
                    winPct: round3(pNow(team))
                };

                for (const k of ks) {
                    const { Kk_max, Kk_min } = kBenchmarksForTeam(team, teams, season, k);
                    const res = magicTragicForK(team, season, k, Kk_max, Kk_min);
                    row[`K${k}_max`] = round3(Kk_max);
                    row[`K${k}_min`] = round3(Kk_min);
                    row[`x${k}_strict`] = res.x_strict;
                    row[`x${k}_tieOK`]  = res.x_tieOK;
                    row[`y${k}_strict`] = res.y_strict;
                    row[`y${k}_tieOK`]  = res.y_tieOK;
                }
                return row;
            });
        }

        // ===== „ÉÅ„Éº„É†„É≠„Ç¥ÔºàÁï•Áß∞‚Üí„Éï„Ç°„Ç§„É´„Éë„ÇπÔºâ =====
        const TEAM_LOGOS = {
            YOG: 'assets/npb-logos/svg/yomiuri-giants.svg',
            HAN: 'assets/npb-logos/svg/hanshin-tigers.svg',
            CHU: 'assets/npb-logos/svg/chunichi-dragons.svg',
            HIR: 'assets/npb-logos/svg/hiroshima-toyo-carp.svg',
            YDB: 'assets/npb-logos/svg/yokohama-dena-baystars.svg',
            YAK: 'assets/npb-logos/svg/tokyo-yakult-swallows.svg',
            SOF: 'assets/npb-logos/svg/fukuoka-softbank-hawks.svg',
            LOT: 'assets/npb-logos/svg/chiba-lotte-marines.svg',
            SEI: 'assets/npb-logos/svg/saitama-seibu-lions.svg',
            ORI: 'assets/npb-logos/svg/orix-buffaloes.svg',
            NIP: 'assets/npb-logos/svg/hokkaido-nippon-ham-fighters.svg',
            RAK: 'assets/npb-logos/svg/tohoku-rakuten-golden-eagles.svg'
        };

        function renderTeamLabel(abbr, name, shortName = false) {
            const src = TEAM_LOGOS[abbr] || '';
            let safeName = name || abbr || '';
            
            // ÌåÄÎ™Ö Î≤àÏó≠ Ï†ÅÏö©
            safeName = translateTeamName(safeName, shortName);
            
        const img = src ? `<img class="team-logo" src="${src}" alt="${safeName}" loading="lazy">` : '';
        return `${img}${safeName}`;
    }
        // ===== „Çø„ÉñÂàá„ÇäÊõø„ÅàÊ©üËÉΩ =====
        function showTab(tabId, el) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
                tab.setAttribute('aria-hidden', 'true');
            });

            // Reset all nav buttons
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
                tab.setAttribute('aria-selected', 'false');
            });

            // Show selected tab
            const selectedTab = document.getElementById(tabId);
            if (!selectedTab) {
                return;
            }
            selectedTab.classList.add('active');
            selectedTab.setAttribute('aria-hidden', 'false');

            // Activate nav button
            if (el) {
                el.classList.add('active');
                el.setAttribute('aria-selected', 'true');
            } else {
                // If no element provided, find and activate the correct nav button
                document.querySelectorAll('.nav-tab').forEach(tab => {
                    if (tab.getAttribute('onclick') && tab.getAttribute('onclick').includes(`'${tabId}'`)) {
                        tab.classList.add('active');
                        tab.setAttribute('aria-selected', 'true');
                        el = tab;
                    }
                });
            }

            try {
                sessionStorage.setItem('npb-current-tab', tabId);
            } catch (storageError) {
                // Ignore storage errors (private mode, etc.)
            }

            // Update URL hash without triggering default jump
            const hash = `#${tabId}`;
            if (window.history && window.history.replaceState) {
                window.history.replaceState(null, '', hash);
            } else {
                window.location.hash = tabId;
            }

            // Ensure newly shown tab content is aligned below the fixed header
            requestAnimationFrame(() => {
                selectedTab.scrollIntoView({ behavior: 'smooth', block: 'start' });
            });

        }


        // ===== Ê≠£Ë¶è„Ç∑„Éº„Ç∫„É≥ÂÑ™Âãù„Éû„Ç∏„ÉÉ„ÇØÊõ¥Êñ∞ =====
        function updateMagicRegular() {
            updateMagicTable('central-magic-regular', standingsData.central_league?.standings || [], true);
            updateMagicTable('pacific-magic-regular', standingsData.pacific_league?.standings || [], true);
        }

        // ===== „Éù„Çπ„Éà„Ç∑„Éº„Ç∫„É≥„Éû„Ç∏„ÉÉ„ÇØÊõ¥Êñ∞ =====
        function updateMagicPlayoff() {
            updateMagicTable('central-magic-playoff', standingsData.central_league?.standings || [], false);
            updateMagicTable('pacific-magic-playoff', standingsData.pacific_league?.standings || [], false);
        }

        // ===== „Éû„Ç∏„ÉÉ„ÇØ„Éä„É≥„Éê„Éº„ÉÜ„Éº„Éñ„É´Êõ¥Êñ∞ÔºàÂÖ±ÈÄöÈñ¢Êï∞Ôºâ =====
        function updateMagicTable(id, teams, isRegular) {
            const tbody = document.getElementById(id);
            if (!teams.length) {
                tbody.innerHTML = '<tr><td colspan="13" class="loading">„Éá„Éº„Çø„Åå„ÅÇ„Çä„Åæ„Åõ„Çì</td></tr>';
                return;
            }

            // Îß§ÏßÅÎÑòÎ≤Ñ Í≥ÑÏÇ∞ÏùÑ ÏúÑÌïú Îç∞Ïù¥ÌÑ∞ Ï§ÄÎπÑ
            let magicResults = null;
            let useConservativeMode = false;
            let allowTies = true;
            
            if (isRegular) {
                // Ï†ïÍ∑úÏãúÏ¶å: ÏÉàÎ°úÏö¥ Îß§ÏßÅ/Ìä∏ÎûòÏßÅ Í≥ÑÏÇ∞ Î°úÏßÅ ÏÇ¨Ïö©
                const convertedTeams = convertTeamDataForMagic(teams);
                magicResults = npbRank1MagicTragic(convertedTeams, TOTAL_GAMES);
                
                // UI ÌëúÏãú Î™®Îìú ÏÑ§Ï†ï (ÎùºÎîîÏò§ Î≤ÑÌäºÏóêÏÑú ÏùΩÏñ¥Ïò¥)
                useConservativeMode = document.querySelector('input[name="magic-mode"]:checked')?.value === 'conservative' || false;
                allowTies = document.querySelector('input[name="tie-mode"]:checked')?.value === 'allow' || true;
            }

            const leader = teams[0];
            const thirdPlace = teams[2] || {};
            
            tbody.innerHTML = teams.map(team => {
                const rankClass = team.position_rank === 1 ? 'rank1' :
                                 team.position_rank === 2 ? 'rank2' :
                                 team.position_rank === 3 ? 'rank3' : '';

                const remainingGames = TOTAL_GAMES - team.games_played;
                const maxWins = team.wins + remainingGames;
                let magic = '-';
                let clinch = '-';
                let csConfirmed = '-';  // ÌîåÎ†àÏù¥Ïò§ÌîÑÏö© CSÌôïÏ†ï Î≥ÄÏàò
                let eliminate = '-';
                let condition = '-';
                
                if (isRegular) {
                    // Ê≠£Ë¶è„Ç∑„Éº„Ç∫„É≥ÂÑ™Âãù„Éû„Ç∏„ÉÉ„ÇØ„Éä„É≥„Éê„ÉºË®àÁÆó
                    if (team.position_rank === 1) {
                        const secondPlace = teams[1];
                        if (secondPlace && remainingGames > 0) {
                            // „Éû„Ç∏„ÉÉ„ÇØ„Éä„É≥„Éê„Éº = Ôºà2‰Ωç„ÉÅ„Éº„É†„ÅÆÊúÄÂ§ßÂèØËÉΩÂãùÊï∞Ôºâ - Ôºà1‰Ωç„ÉÅ„Éº„É†„ÅÆÁèæÂú®ÂãùÊï∞Ôºâ + 1
                            const secondPlaceRemaining = TOTAL_GAMES - secondPlace.games_played;
                            const secondPlaceMaxWins = secondPlace.wins + secondPlaceRemaining;
                            const magicNumber = secondPlaceMaxWins - team.wins + 1;
                            
                            if (magicNumber <= 0) {
                                magic = '‚úì'; // ÂÑ™ÂãùÁ¢∫ÂÆöÊ∏à
                                clinch = 'ÂÑ™Âãù';
                                condition = 'Á¢∫ÂÆö';
                            } else {
                                magic = magicNumber;
                                condition = `${magicNumber}ÂãùÂøÖË¶Å`;
                            }
                        } else if (remainingGames === 0) {
                            magic = '‚úì'; // „Ç∑„Éº„Ç∫„É≥ÁµÇ‰∫Ü
                            clinch = 'Á¢∫ÂÆö';
                            condition = 'Á¢∫ÂÆö';
                        }
                    } else {
                        // 2‰Ωç‰ª•‰∏ã„ÉÅ„Éº„É†„ÅÆÂÑ™ÂãùÊù°‰ª∂Ë®àÁÆó
                        const teamMaxWins = team.wins + remainingGames;
                        const leaderCurrentWins = leader.wins;
                        const leaderRemaining = TOTAL_GAMES - leader.games_played;

                        if (teamMaxWins <= leaderCurrentWins) {
                            condition = '‰∏çÂèØËÉΩ';
                            magic = '-';
                        } else {
                            // „Åì„ÅÆ„ÉÅ„Éº„É†„Åå1‰Ωç„Å´„Å™„Çã„Åü„ÇÅ„Å´1‰Ωç„ÉÅ„Éº„É†„ÅåÊúÄÂ§ß‰ΩïÂãù„Åæ„Åß„Å´Êäë„Åà„ÇãÂøÖË¶Å„Åå„ÅÇ„Çã„Åã
                            const leaderMaxAllowed = teamMaxWins - 1;
                            if (leaderMaxAllowed < leaderCurrentWins) {
                                condition = '‰∏çÂèØËÉΩ';
                                magic = '-';
                            } else {
                                condition = `1‰Ωç${leaderMaxAllowed}Âãù‰ª•‰∏ã`;

                                // 2‰Ωç‰ª•‰∏ã ÌåÄÏùò Îß§ÏßÅÎÑòÎ≤Ñ Í≥ÑÏÇ∞: Ïù¥ ÌåÄÏù¥ Ïö∞ÏäπÌïòÍ∏∞ ÏúÑÌï¥ ÌïÑÏöîÌïú ÏäπÏàò
                                const winsNeededForTitle = leaderMaxAllowed - team.wins + 1;
                                if (winsNeededForTitle <= 0) {
                                    magic = '‚úì';
                                } else if (winsNeededForTitle > remainingGames) {
                                    magic = '-'; // ÎÇ®ÏùÄ Í≤ΩÍ∏∞Î°úÎäî Î∂àÍ∞ÄÎä•
                                } else {
                                    magic = winsNeededForTitle;
                                }
                            }
                        }
                    }
                    
                    // ÏÉàÎ°úÏö¥ Ìä∏ÎûòÏßÅÎÑòÎ≤Ñ Í≥ÑÏÇ∞ (Ï†úÍ≥µÎ∞õÏùÄ Î°úÏßÅ ÏÇ¨Ïö©)
                    if (team.position_rank === 1) {
                        // 1ÏúÑÌåÄÏùÄ Ïö∞Ïäπ ÌÉàÎùΩÏù¥ ÏóÜÏúºÎØÄÎ°ú ÏóòÎ¶¨ÎØ∏ÎÑ§Ïù¥ÏÖò ÌëúÏãú ÏïàÌï®
                        eliminate = '-';
                    } else {
                        // 2ÏúÑ Ïù¥Ìïò ÌåÄÎì§Ïùò Ïö∞Ïäπ ÌÉàÎùΩ Í≥ÑÏÇ∞
                        if (useConservativeMode) {
                            const teamResult = magicResults.conservative.rows.find(r => r.team === (team.team_id || team.team_name));
                            if (teamResult) {
                                const tragicValue = allowTies ? teamResult.y_tieOK : teamResult.y_strict;
                                eliminate = tragicValue === 0 ? 'E' : (tragicValue >= teamResult.R ? 'E' : tragicValue);
                            }
                        } else {
                            // Í∏∞Ï°¥ MLB Ïä§ÌÉÄÏùº Í≥ÑÏÇ∞ Ïú†ÏßÄ (ÌïòÏúÑ Ìò∏ÌôòÏÑ±)
                            const teamMaxWins = team.wins + remainingGames;
                            const alreadyEliminated = leader.wins > teamMaxWins;
                            if (alreadyEliminated) {
                                eliminate = 'E';
                            } else {
                                const combo = (TOTAL_GAMES + 1) - leader.wins - team.losses;
                                eliminate = combo <= 0 ? 'E' : combo;
                            }
                        }
                    }
                } else {
                    // ÏÉàÎ°úÏö¥ ÌîÑÎ†àÏù¥Ïò§ÌîÑ Îß§ÏßÅ/Ìä∏ÎûòÏßÅ Í≥ÑÏÇ∞ Î°úÏßÅ ÏÇ¨Ïö©
                    const convertedTeams = convertTeamDataForMagic(teams);
                    const playoffResults = npbPlayoffMagicTragic(convertedTeams, TOTAL_GAMES, [1, 2, 3]);
                    
                    // ÌòÑÏû¨ ÌåÄÏùò Í≤∞Í≥º Ï∞æÍ∏∞
                    const teamResult = playoffResults.find(r => r.team === (team.team_id || team.team_name));
                    
                    if (teamResult) {
                        // Îã®ÏàúÌïòÍ≤å Í≥ÑÏÇ∞ Í≤∞Í≥ºÎßå ÌëúÍ∏∞
                        const x3_magic = teamResult.x3_tieOK; // 3ÏúÑ ÌôïÏ†ï Îß§ÏßÅÎÑòÎ≤Ñ
                        const x2_magic = teamResult.x2_tieOK; // 2ÏúÑ ÌôïÏ†ï Îß§ÏßÅÎÑòÎ≤Ñ  
                        const x1_magic = teamResult.x1_tieOK; // 1ÏúÑ ÌôïÏ†ï Îß§ÏßÅÎÑòÎ≤Ñ
                        
                        // Îß§ÏßÅÎÑòÎ≤Ñ ÌëúÏãú
                        if (x3_magic === 0) {
                            clinch = '‚úì';
                        } else {
                            clinch = x3_magic;
                        }
                        
                        // „ÇØ„É©„Ç§„Éû„ÉÉ„ÇØ„Çπ„Ç∑„É™„Éº„Ç∫ÈÄ≤Âá∫Áä∂ÊÖãË°®Á§∫
                        if (x1_magic === 0) {
                            csConfirmed = '„Éï„Ç°„Ç§„Éä„É´Áõ¥Ë°å';
                            condition = '„Éï„Ç°„Ç§„Éä„É´Áõ¥Ë°å';
                        } else if (x2_magic === 0) {
                            csConfirmed = '„Éï„Ç°„Éº„Çπ„Éà„Çπ„ÉÜ„Éº„Ç∏';
                            condition = '„Éï„Ç°„Éº„Çπ„Éà„Çπ„ÉÜ„Éº„Ç∏';
                        } else if (x3_magic === 0) {
                            csConfirmed = '„Éï„Ç°„Éº„Çπ„Éà„Çπ„ÉÜ„Éº„Ç∏';
                            condition = '„Éï„Ç°„Éº„Çπ„Éà„Çπ„ÉÜ„Éº„Ç∏';
                        } else {
                            condition = `CSÈÄ≤Âá∫„Åæ„Åß${x3_magic}Âãù`;
                        }
                    }
                    
                    // (Í∏∞Ï°¥ CS ÌôïÏ†ï ÌåêÏ†ï Î°úÏßÅ Ï†úÍ±∞Îê® - ÏÉàÎ°úÏö¥ Î°úÏßÅÏù¥ Ïù¥ÎØ∏ Ï≤òÎ¶¨)
                    
                    // ÏóòÎ¶¨ÎØ∏ÎÑ§Ïù¥ÏÖò Í≥ÑÏÇ∞ (Îã®ÏàúÌïòÍ≤å)
                    if (teamResult) {
                        const y3_tragic = teamResult.y3_tieOK; // 3ÏúÑ ÌÉàÎùΩ Ìä∏ÎûòÏßÅÎÑòÎ≤Ñ
                        if (y3_tragic === 0) {
                            eliminate = 'E';
                        } else {
                            eliminate = y3_tragic;
                        }
                    }
                }
                
                const eliminatedRow = eliminate === 'E' || eliminate === 0 || eliminate === '0';
                const rowClassNames = [rankClass];
                if (eliminatedRow) rowClassNames.push('row-eliminated');
                const rowClassAttr = rowClassNames.filter(Boolean).join(' ');

                if (isRegular) {
                    // Ï†ïÍ∑úÏãúÏ¶å: È†Ü‰Ωç „ÉÅ„Éº„É† Âãù Êïó ÂàÜ ÂãùÁéá „Ç≤„Éº„É†Â∑Æ ÊÆã„ÇäË©¶Âêà ÊúÄÂ§ßÂãù 1‰ΩçÊù°‰ª∂ „Éû„Ç∏„ÉÉ„ÇØ „Ç®„É™„Éü„Éç„Éº„Éà ÈÄ≤Ï∂úÁä∂Ê≥Å
                    const firstPlaceBorder = team.position_rank === 1 ? 'style="border: 3px solid #FF0000;"' : '';
                    return `
                        <tr class="${rowClassAttr}" ${firstPlaceBorder}>
                            <td class="center">${team.position_rank}</td>
                            <td>${renderTeamLabel(team.team_abbreviation, team.team_name)}</td>
                            <td class="center">${team.games_played}</td>
                            <td class="center win">${team.wins}</td>
                            <td class="center loss">${team.losses}</td>
                            <td class="center">${team.draws || 0}</td>
                            <td class="center pct">0.${team.win_percentage.toFixed(3).split('.')[1]}</td>
                            <td class="center">${team.games_behind > 0 ? team.games_behind.toFixed(1) : '-'}</td>
                            <td class="center">${remainingGames}</td>
                            <td class="center">${maxWins}</td>
                            <td class="center" style="font-size: 12px;">${translateCondition(condition)}</td>
                            <td class="center ${magic === '‚úì' ? 'clinched' : 'magic-number'}">${magic}</td>
                            <td class="center ${eliminate === 'E' ? 'eliminated' : ''}">${eliminate}</td>
                            <td class="center ${clinch !== '-' ? 'clinched' : ''}" style="font-size: 12px;">${clinch}</td>
                        </tr>
                    `;
                } else {
                    // ÌîåÎ†àÏù¥Ïò§ÌîÑ: È†Ü‰Ωç „ÉÅ„Éº„É† Âãù Êïó ÂàÜ ÂãùÁéá „Ç≤„Éº„É†Â∑Æ ÊÆã„ÇäË©¶Âêà ÊúÄÂ§ßÂãù 3ÏúÑÊù°‰ª∂ „Éû„Ç∏„ÉÉ„ÇØ „Ç®„É™„Éü„Éç„Éº„Éà ÈÄ≤Âá∫Áä∂Ê≥Å
                    let playoffBorder = '';
                    // 1-3ÏúÑ Í∑∏Î£π Î∞ïÏä§Î•º ÏúÑÌïú ÌÖåÎëêÎ¶¨ ÏÑ§Ï†ï
                    if (team.position_rank === 1) {
                        playoffBorder = 'style="border: 3px solid #FF0000; border-bottom: none;"'; // Ï≤´ Î≤àÏß∏ Ìñâ: ÏúÑ,Ï¢å,Ïö∞ ÌÖåÎëêÎ¶¨
                    } else if (team.position_rank === 2) {
                        playoffBorder = 'style="border-left: 3px solid #FF0000; border-right: 3px solid #FF0000;"'; // Ï§ëÍ∞Ñ Ìñâ: Ï¢å,Ïö∞ ÌÖåÎëêÎ¶¨
                    } else if (team.position_rank === 3) {
                        playoffBorder = 'style="border: 3px solid #FF0000; border-top: none;"'; // ÎßàÏßÄÎßâ Ìñâ: ÏïÑÎûò,Ï¢å,Ïö∞ ÌÖåÎëêÎ¶¨
                    }

                    return `
                        <tr class="${rowClassAttr}" ${playoffBorder}>
                            <td class="center">${team.position_rank}</td>
                            <td>${renderTeamLabel(team.team_abbreviation, team.team_name)}</td>
                            <td class="center">${team.games_played}</td>
                            <td class="center win">${team.wins}</td>
                            <td class="center loss">${team.losses}</td>
                            <td class="center">${team.draws || 0}</td>
                            <td class="center pct">0.${team.win_percentage.toFixed(3).split('.')[1]}</td>
                            <td class="center">${team.games_behind > 0 ? team.games_behind.toFixed(1) : '-'}</td>
                            <td class="center">${remainingGames}</td>
                            <td class="center">${maxWins}</td>
                            <td class="center ${clinch === '‚úì' ? 'clinched' : 'magic-number'}">${clinch}</td>
                            <td class="center ${eliminate === 'E' ? 'eliminated' : ''}">${eliminate}</td>
                            <td class="center ${csConfirmed !== '-' ? 'clinched' : ''}" style="font-size: 12px;">${csConfirmed}</td>
                        </tr>
                    `;
                }
            }).join('');
        }

        // ===== Ë©≥Á¥∞È†Ü‰ΩçË°®Êõ¥Êñ∞ =====
        function updateDetailedStandings() {
            updateDetailedTable('central-detailed', standingsData.central_league?.standings || []);
            updateDetailedTable('pacific-detailed', standingsData.pacific_league?.standings || []);
        }

        // ===== Ë©≥Á¥∞È†Ü‰Ωç„ÉÜ„Éº„Éñ„É´Êõ¥Êñ∞ÔºàÂÖ±ÈÄöÈñ¢Êï∞Ôºâ =====
        function updateDetailedTable(id, teams) {
            const tbody = document.getElementById(id);
            if (!teams.length) {
                tbody.innerHTML = '<tr><td colspan="17" class="loading">„Éá„Éº„Çø„Åå„ÅÇ„Çä„Åæ„Åõ„Çì</td></tr>';
                return;
            }

            tbody.innerHTML = teams.map(team => {
                const rankClass = team.position_rank === 1 ? 'rank1' : 
                                 team.position_rank === 2 ? 'rank2' : 
                                 team.position_rank === 3 ? 'rank3' : '';
                
                const remainingGames = TOTAL_GAMES - team.games_played;
                const lastTenInfo = lastTenRecordsByTeam[String(team.team_id)] || null;
                const lastTenDisplay = (lastTenInfo && lastTenInfo.games > 0) ? lastTenInfo.record : '‚Äî';
                const streakInfo = lastTenInfo?.streak || { type: 'none', count: 0 };
                let streakDisplay = '‚Äî';
                let streakClass = '';
                if (streakInfo.type === 'win' && streakInfo.count > 0) {
                    streakDisplay = `${streakInfo.count}ÈÄ£Âãù`;
                    streakClass = 'streak-win';
                } else if (streakInfo.type === 'loss' && streakInfo.count > 0) {
                    streakDisplay = `${streakInfo.count}ÈÄ£Êïó`;
                    streakClass = 'streak-loss';
                } else if (streakInfo.type === 'draw' && streakInfo.count > 0) {
                    streakDisplay = `${streakInfo.count}ÂàÜ`;
                    streakClass = 'streak-draw';
                }
                
                // „Éõ„Éº„É†/„Ç¢„Ç¶„Çß„Ç§ÂàÜÂâ≤„Ç∑„Éü„É•„É¨„Éº„ÉàÔºàÂÆü„Éá„Éº„Çø„Å™„Åó„ÅÆÂ†¥Âêà„ÅÆ‰ªÆË®àÁÆóÔºâ
                const homeAdvantage = seasonConfig?.display_config?.home_advantage || 0.55;
                const homeGames = Math.floor(team.games_played / 2);
                const awayGames = team.games_played - homeGames;
                const homeWins = Math.floor(team.wins * homeAdvantage); // „Éõ„Éº„É†„Ç¢„Éâ„Éê„É≥„ÉÜ„Éº„Ç∏Ë®àÁÆó
                const awayWins = team.wins - homeWins;
                const homeLosses = homeGames - homeWins;
                const awayLosses = awayGames - awayWins;
                const homeWinPct = homeGames > 0 ? '0.' + (homeWins / homeGames).toFixed(3).split('.')[1] : '0.000';
                const awayWinPct = awayGames > 0 ? '0.' + (awayWins / awayGames).toFixed(3).split('.')[1] : '0.000';
                
                // ÊúÄÈ´ò/ÊúÄ‰ΩéÈ†Ü‰ΩçÂèØËÉΩÊÄßË®àÁÆó
                const maxWins = team.wins + remainingGames;  // „Åì„ÅÆ„ÉÅ„Éº„É†„ÅÆÊúÄÂ§ßÂèØËÉΩÂãùÊï∞
                const minWins = team.wins;                   // „Åì„ÅÆ„ÉÅ„Éº„É†„ÅÆÊúÄÂ∞èÂèØËÉΩÂãùÊï∞ÔºàÁèæÂú®ÂãùÊï∞Ôºâ
                
                // ÊúÄÈ´òÈ†Ü‰ΩçË®àÁÆó: ‰ªñ„ÉÅ„Éº„É†„ÅåÊúÄÊÇ™ÊàêÁ∏æ„ÅßÁµÇ„Çè„Å£„ÅüÂ†¥Âêà
                let bestRank = 1;
                teams.forEach(other => {
                    if (other.team_id !== team.team_id) {
                        const otherMinWins = other.wins; // ‰ªñ„ÉÅ„Éº„É†„ÅÆÊúÄÂ∞èÂãùÊï∞ÔºàÁèæÂú®ÂãùÊï∞Ôºâ
                        if (otherMinWins > maxWins) {
                            bestRank++; // „Åì„ÅÆ„ÉÅ„Éº„É†„Çà„Çä‰∏ä‰ΩçÁ¢∫ÂÆö
                        }
                    }
                });
                
                // ÊúÄ‰ΩéÈ†Ü‰ΩçË®àÁÆó: ‰ªñ„ÉÅ„Éº„É†„ÅåÊúÄÈ´òÊàêÁ∏æ„ÅßÁµÇ„Çè„Å£„ÅüÂ†¥Âêà  
                let worstRank = 1;
                teams.forEach(other => {
                    if (other.team_id !== team.team_id) {
                        const otherMaxWins = other.wins + (TOTAL_GAMES - other.games_played);
                        if (otherMaxWins > minWins) {
                            worstRank++; // „Åì„ÅÆ„ÉÅ„Éº„É†„Çà„Çä‰∏ä‰ΩçÂèØËÉΩ
                        }
                    }
                });
                
                // CSÈÄ≤Âá∫/ËÑ±ËêΩÁä∂Ê≥Å„ÇíÁî®„ÅÑ„ÅüÁèæÂÆüÁöÑ„Å™ÁØÑÂõ≤Ë£úÊ≠£ÔºàÁ∞°ÊòìÔºâ
                // 4‰Ωç„ÅÆÊúÄÂ§ßÂèØËÉΩÂãùÊï∞ÔºàÂÖ®„ÉÅ„Éº„É†„ÅÆÊúÄÂ§ßÂèØËÉΩÂãùÊï∞„ÅÆ4Áï™ÁõÆÔºâ
                const allMaxWins = teams
                    .map(t => t.wins + (TOTAL_GAMES - t.games_played))
                    .sort((a, b) => b - a);
                const fourthHighestMaxWins = allMaxWins[3] ?? 0;
                const thirdPlace = teams[2];
                
                // CSÁ¢∫ÂÆö„Å™„ÇâÊúÄ‰ΩéÈ†Ü‰Ωç„ÅØ3‰Ωç‰ª•ÂÜÖ
                if (team.wins > fourthHighestMaxWins) {
                    worstRank = Math.min(worstRank, 3);
                }
                // 3‰Ωç„ÅÆÁèæÂú®ÂãùÊï∞„Å´ÊúÄÂ§ß„Åß„ÇÇÂ±ä„Åã„Å™„ÅÑ„Å™„ÇâÊúÄÈ´òÈ†Ü‰Ωç„ÅØ4‰Ωç‰ª•‰∏ã
                if (thirdPlace && (team.wins + remainingGames) < thirdPlace.wins) {
                    bestRank = Math.max(bestRank, 4);
                }

                // È†Ü‰Ωç„ÅØ1-6‰Ωç„Å´Âà∂Èôê
                bestRank = Math.min(bestRank, 6);
                worstRank = Math.min(worstRank, 6);
                
                return `
                    <tr class="${rankClass}">
                        <td class="center">${team.position_rank}</td>
                        <td>${renderTeamLabel(team.team_abbreviation, team.team_name)}</td>
                        <td class="center">${team.games_played}</td>
                        <td class="center win">${team.wins}</td>
                        <td class="center loss">${team.losses}</td>
                        <td class="center">${team.draws || 0}</td>
                        <td class="center pct">0.${team.win_percentage.toFixed(3).split('.')[1]}</td>
                        <td class="center">${remainingGames}</td>
                        <td class="center">${team.games_behind > 0 ? team.games_behind.toFixed(1) : '-'}</td>
                        <td class="center${streakClass ? ' ' + streakClass : ''}">${streakDisplay}</td>
                        <td class="center">${lastTenDisplay}</td>
                        <td class="center">${homeWins}-${homeLosses}</td>
                        <td class="center">${homeWinPct}</td>
                        <td class="center">${awayWins}-${awayLosses}</td>
                        <td class="center">${awayWinPct}</td>
                        <td class="center">${bestRank}</td>
                        <td class="center">${worstRank}</td>
                    </tr>
                `;
            }).join('');
        }

        // ===== ÂãùÁéá„Ç∑„Éä„É™„Ç™ÂàÜÊûêÊõ¥Êñ∞ =====
        function updateScenarios() {
            // Table references have been removed, only update matrix and detailed views
            renderScenarioMatrixFor('central');
            renderScenarioMatrixFor('pacific');
        }

        // ===== ÂãùÁéá„Ç∑„Éä„É™„Ç™„ÉÜ„Éº„Éñ„É´Êõ¥Êñ∞ÔºàÂÖ±ÈÄöÈñ¢Êï∞Ôºâ =====
        function updateScenariosTable(id, teams) {
            // This function is no longer needed since we removed the table view
            return;

            // Filter: show only teams still able to reach 3‰Ωç (CS)
            let displayTeams = teams;
            if (teams.length >= 3) {
                const thirdWins = teams[2]?.wins || 0;
                displayTeams = teams.filter(t => (t.wins + (TOTAL_GAMES - t.games_played)) >= thirdWins);
            }

            // Create NPB-style 4-row header
            if (header) {
                let headerHTML = `
                    <tr>
                        <td rowspan="4" style="background: #f8f9fa; font-weight: bold; vertical-align: middle; width: 60px;">ÏµúÏ¢ÖÏäπÎ•†</td>`;
                
                // Row 1: Team rankings
                displayTeams.forEach(team => {
                    headerHTML += `<td class="center" style="background: #f0f0f0; font-weight: bold; padding: 4px;">${team.position_rank}ÏúÑ</td>`;
                });
                headerHTML += `</tr><tr>`;
                
                // Row 2: Team names with logos
                displayTeams.forEach(team => {
                    headerHTML += `<td class="center" style="background: #f8f9fa; font-weight: bold; padding: 4px;">${renderTeamLabel(team.team_abbreviation, team.team_name)}</td>`;
                });
                headerHTML += `</tr><tr>`;
                
                // Row 3: Current records + games played
                displayTeams.forEach(team => {
                    headerHTML += `<td class="center" style="background: #f0f0f0; font-size: 12px; padding: 4px;">${team.wins}-${team.losses}-${team.draws || 0} (Ë©¶Âêà${team.games_played})</td>`;
                });
                headerHTML += `</tr><tr>`;
                
                // Row 4: Remaining games
                displayTeams.forEach(team => {
                    const remaining = TOTAL_GAMES - team.games_played;
                    headerHTML += `<td class="center" style="background: #f8f9fa; font-size: 12px; padding: 4px;">ÏûîÏó¨${remaining}</td>`;
                });
                headerHTML += `</tr>`;
                
                header.innerHTML = headerHTML;
            }

            // Ë°®Á§∫„Åô„ÇãÂãùÁéá„Çø„Éº„Ç≤„ÉÉ„ÉàÔºàÈ´ò„ÅÑÈ†Ü„Åã„ÇâÔºâ - ÂãïÁöÑË®≠ÂÆö
            const winRateTargets = seasonConfig?.scenario_config?.win_rate_targets || [0.700, 0.650, 0.600, 0.550, 0.500, 0.450, 0.400, 0.350, 0.300];
            
            tbody.innerHTML = winRateTargets.map(targetRate => {
                let row = `<td class="center" style="background: #f8f9fa; font-weight: bold; padding: 4px; font-size: 12px;">${(targetRate * 100).toFixed(0)}%</td>`;
                
                displayTeams.forEach(team => {
                    const remainingGames = TOTAL_GAMES - team.games_played;
                    const currentWins = team.wins;
                    const currentLosses = team.losses;
                    const currentDraws = team.draws || 0;
                    
                    // ÁõÆÊ®ôÂãùÁéáÈÅîÊàê„Å´ÂøÖË¶Å„Å™ÊÆã„ÇäÊàêÁ∏æË®àÁÆó
                    const totalGamesMinusDraws = TOTAL_GAMES - currentDraws;
                    const requiredTotalWins = Math.ceil(targetRate * totalGamesMinusDraws);
                    const requiredWins = Math.max(0, requiredTotalWins - currentWins);
                    const requiredLosses = remainingGames - requiredWins;
                    
                    let cellContent = '';
                    let cellStyle = 'text-align: center; padding: 4px; font-size: 10px; min-width: 40px;';
                    
                    if (requiredWins > remainingGames) {
                        // ÈÅîÊàê‰∏çÂèØËÉΩ
                        cellContent = '-';
                        cellStyle += 'background: #ffebee; color: #c62828;';
                    } else if (requiredWins <= 0) {
                        // Êó¢„Å´ÈÅîÊàê„Åæ„Åü„ÅØÂÆπÊòì
                        const finalRate = (currentWins / (TOTAL_GAMES - currentDraws)) * 100;
                        if (finalRate >= targetRate * 100) {
                            cellContent = '‚úì';
                            cellStyle += 'background: #e3f2fd; color: #0d47a1; font-weight: bold;';
                        } else {
                            cellContent = `${requiredWins}-${requiredLosses}`;
                            cellStyle += 'background: #e3f2fd; color: #0d47a1;';
                        }
                    } else {
                        // ÂøÖË¶ÅÊàêÁ∏æË°®Á§∫: Âãù-Êïó
                        cellContent = `${requiredWins}-${requiredLosses}`;
                        
                        // ÊúÄÁµÇÂãùÁéá„Çí0.500„Å®ÊØîËºÉ„Åó„Å¶Ëâ≤ÂàÜ„Åë
                        const finalRate = (currentWins + requiredWins) / (TOTAL_GAMES - currentDraws);
                        if (finalRate > 0.500) {
                            cellStyle += 'background: #e3f2fd; color: #0d47a1;'; // Blue - above .500
                        } else if (finalRate === 0.500) {
                            cellStyle += 'background: #eceff1; color: #37474f;'; // Blue-gray - exactly .500
                        } else {
                            cellStyle += 'background: #ffebee; color: #c62828;'; // Red - below .500
                        }
                    }
                    
                    row += `<td style="${cellStyle}">${cellContent}</td>`;
                });
                
                return `<tr>${row}</tr>`;
            }).join('');
        }

        // ====== „Ç∑„Éä„É™„Ç™„Éª„Éû„Éà„É™„ÇØ„ÇπÔºàÂ†¥Âêà„ÅÆÊï∞ÔºâÊ©üËÉΩ ======
        const NPB_TEAM_META = {
            YOG: { shortName: 'Â∑®‰∫∫',  fullName: 'Ë™≠Â£≤„Ç∏„É£„Ç§„Ç¢„É≥„ÉÑ',     color: '#FF6600' },
            HAN: { shortName: 'Èò™Á•û',  fullName: 'Èò™Á•û„Çø„Ç§„Ç¨„Éº„Çπ',       color: '#F6B300' },
            CHU: { shortName: '‰∏≠Êó•',  fullName: '‰∏≠Êó•„Éâ„É©„Ç¥„É≥„Ç∫',       color: '#0067C0' },
            HIR: { shortName: 'Â∫ÉÂ≥∂',  fullName: 'Â∫ÉÂ≥∂Êù±Ê¥ã„Ç´„Éº„Éó',       color: '#C70025' },
            YDB: { shortName: 'DeNA', fullName: 'Ê®™ÊµúDeNA„Éô„Ç§„Çπ„Çø„Éº„Ç∫', color: '#0056B8' },
            YAK: { shortName: '„É§„ÇØ',  fullName: 'Êù±‰∫¨„É§„ÇØ„É´„Éà„Çπ„ÉØ„É≠„Éº„Ç∫', color: '#1B9132' },
            SOF: { shortName: 'SB',   fullName: 'Á¶èÂ≤°„ÇΩ„Éï„Éà„Éê„É≥„ÇØ„Éõ„Éº„ÇØ„Çπ', color: '#FFCA08' },
            LOT: { shortName: '„É≠„ÉÉ„ÉÜ',fullName: 'ÂçÉËëâ„É≠„ÉÉ„ÉÜ„Éû„É™„Éº„É≥„Ç∫',   color: '#1D1D1B' },
            SEI: { shortName: 'Ë•øÊ≠¶', fullName: 'ÂüºÁéâË•øÊ≠¶„É©„Ç§„Ç™„É≥„Ç∫',     color: '#003E91' },
            ORI: { shortName: '„Ç™„É™', fullName: '„Ç™„É™„ÉÉ„ÇØ„Çπ„Éê„Éï„Ç°„É≠„Éº„Ç∫', color: '#002E5D' },
            NIP: { shortName: 'Êó•„Éè„É†', fullName: 'ÂåóÊµ∑ÈÅìÊó•Êú¨„Éè„É†„Éï„Ç°„Ç§„Çø„Éº„Ç∫', color: '#0077C8' },
            RAK: { shortName: 'Ê•ΩÂ§©', fullName: 'Êù±ÂåóÊ•ΩÂ§©„Ç¥„Éº„É´„Éá„É≥„Ç§„Éº„Ç∞„É´„Çπ', color: '#7F001C' },
        };

        // NPB Ï∞®Ìä∏ ÏÉÅÌÉú Í¥ÄÎ¶¨
        let npbChartInstances = {
            central: {
                ranking: null,
                winrate: null,
                gamesBehind: null,
                wins: null
            },
            pacific: {
                ranking: null,
                winrate: null,
                gamesBehind: null,
                wins: null
            }
        };

        // NPB Ïã§Ï†ú Îç∞Ïù¥ÌÑ∞ Î°úÎî© Ìï®Ïàò (KBO Ïä§ÌÉÄÏùº)
        function loadRealNPBData() {

            if (!gamesData || !gamesData.length) {
                return null;
            }


            const sortedGames = [...gamesData].sort((a, b) => {
                const dateA = new Date(a.game_date_jst || a.game_date || a.date || a.played_date);
                const dateB = new Date(b.game_date_jst || b.game_date || b.date || b.played_date);
                return dateA - dateB;
            });


            const teamStats = {};
            const dates = [];
            let currentDate = null;

            Object.keys(NPB_TEAM_META).forEach(teamCode => {
                teamStats[teamCode] = {
                    games: [],
                    wins: 0,
                    losses: 0,
                    draws: 0,
                    dailyData: []
                };
            });

            sortedGames.forEach(game => {
                const gameDate = new Date(game.game_date_jst || game.game_date || game.date || game.played_date);
                const dateStr = gameDate.toISOString().split('T')[0];

                if (currentDate !== dateStr) {
                    currentDate = dateStr;
                    if (!dates.includes(dateStr)) {
                        dates.push(dateStr);

                        Object.keys(teamStats).forEach(teamCode => {
                            const team = teamStats[teamCode];
                            const gamesPlayed = team.wins + team.losses + team.draws;
                            const winRate = gamesPlayed > 0 ? team.wins / gamesPlayed : 0;

                            team.dailyData.push({
                                date: dateStr,
                                wins: team.wins,
                                losses: team.losses,
                                draws: team.draws,
                                winRate: winRate,
                                gamesPlayed: gamesPlayed
                            });
                        });
                    }
                }

                const homeTeam = game.home_team_abbr || game.home_team;
                const awayTeam = game.away_team_abbr || game.away_team;
                const homeScore = parseInt(game.home_team_score || game.home_score) || 0;
                const awayScore = parseInt(game.away_team_score || game.away_score) || 0;

                // Ï≤´ Î≤àÏß∏ Í≤åÏûÑÏùò Í≤ΩÏö∞ ÏÉÅÏÑ∏ Î°úÍπÖ
                if (sortedGames.indexOf(game) === 0) {
                }

                if (teamStats[homeTeam] && teamStats[awayTeam]) {
                    if (homeScore > awayScore) {
                        teamStats[homeTeam].wins++;
                        teamStats[awayTeam].losses++;
                    } else if (awayScore > homeScore) {
                        teamStats[awayTeam].wins++;
                        teamStats[homeTeam].losses++;
                    } else {
                        teamStats[homeTeam].draws++;
                        teamStats[awayTeam].draws++;
                    }
                } else {
                    if (sortedGames.indexOf(game) < 10) { // Ï≤òÏùå 10Í∞ú Í≤åÏûÑÎßå Î°úÍπÖ
                        console.warn('ÌåÄ ÏΩîÎìú Î∂àÏùºÏπò:', {homeTeam, awayTeam, availableTeams: Object.keys(teamStats)});
                    }
                }
            });


            return { teamStats, dates };
        }

        // NPB ÏàúÏúÑ Í≥ÑÏÇ∞ Ìï®Ïàò
        function calculateNPBRankings(teamStats, date) {
            const teams = Object.keys(teamStats).map(teamCode => {
                const stats = teamStats[teamCode];
                const dayData = stats.dailyData.find(d => d.date === date) || { wins: 0, losses: 0, draws: 0, winRate: 0 };

                return {
                    teamCode,
                    wins: dayData.wins,
                    losses: dayData.losses,
                    draws: dayData.draws,
                    winRate: dayData.winRate,
                    gamesPlayed: dayData.gamesPlayed
                };
            });

            // Î¶¨Í∑∏Î≥ÑÎ°ú Î∂ÑÎ¶¨ÌïòÍ≥† ÏàúÏúÑ Í≥ÑÏÇ∞
            const leagues = { central: [], pacific: [] };

            teams.forEach(team => {
                const meta = NPB_TEAM_META[team.teamCode];
                if (!meta) return;

                // Î¶¨Í∑∏ ÌåêÎ≥Ñ (NPB_TEAM_META Í∏∞Î∞ò)
                const centralTeams = ['YOG', 'HAN', 'CHU', 'HIR', 'YDB', 'YAK'];
                const pacificTeams = ['SOF', 'LOT', 'SEI', 'ORI', 'NIP', 'RAK'];

                let league;
                if (centralTeams.includes(team.teamCode)) {
                    league = 'central';
                } else if (pacificTeams.includes(team.teamCode)) {
                    league = 'pacific';
                } else {
                    console.warn('Ïïå Ïàò ÏóÜÎäî ÌåÄ ÏΩîÎìú:', team.teamCode);
                    league = 'central'; // Í∏∞Î≥∏Í∞í
                }
                leagues[league].push(team);
            });

            // Í∞Å Î¶¨Í∑∏Î≥ÑÎ°ú ÏàúÏúÑ Í≥ÑÏÇ∞ (ÏäπÎ•† Ïö∞ÏÑ†, ÏäπÏàò Ï∞®Ïàú)
            Object.keys(leagues).forEach(league => {
                leagues[league].sort((a, b) => {
                    if (b.winRate !== a.winRate) return b.winRate - a.winRate;
                    return b.wins - a.wins;
                });

                leagues[league].forEach((team, index) => {
                    team.rank = index + 1;
                });
            });

            return leagues;
        }

        // Ïª§Ïä§ÌÖÄ HTML Î†àÏ†ÑÎìú ÏÉùÏÑ± Ìï®Ïàò (ÌåÄ Î°úÍ≥† Ìè¨Ìï®)
        function createCustomHTMLLegend(chartElement, teams, chartInstance) {
            const chartContainer = chartElement.parentElement;

            // Í∏∞Ï°¥ Ïª§Ïä§ÌÖÄ Î†àÏ†ÑÎìú Ï†úÍ±∞
            const existingLegend = chartContainer.querySelector('.custom-chart-legend');
            if (existingLegend) {
                existingLegend.remove();
            }

            // Ïª§Ïä§ÌÖÄ Î†àÏ†ÑÎìú Ïª®ÌÖåÏù¥ÎÑà ÏÉùÏÑ±
            const legendContainer = document.createElement('div');
            legendContainer.className = 'custom-chart-legend';
            legendContainer.style.cssText = `
                display: flex;
                justify-content: center;
                align-items: center;
                gap: 15px;
                margin: 10px 0;
                padding: 10px;
                flex-wrap: wrap;
            `;

            // ÌÜ†Í∏Ä Î≤ÑÌäº Ïª®ÌÖåÏù¥ÎÑà
            const controlContainer = document.createElement('div');
            controlContainer.style.cssText = `
                margin-right: 15px;
                border-right: 1px solid #e2e8f0;
                padding-right: 15px;
            `;

            // ÌÜ†Í∏Ä Î≤ÑÌäº
            const toggleBtn = document.createElement('button');
            toggleBtn.textContent = '„Åô„Åπ„Å¶ÈùûË°®Á§∫';
            toggleBtn.style.cssText = `
                padding: 5px 10px;
                font-size: 11px;
                background: #3182ce;
                border: none;
                border-radius: 4px;
                cursor: pointer;
                color: white;
                font-weight: 600;
                transition: all 0.2s ease;
            `;

            // Î≤ÑÌäº Ìò∏Î≤Ñ Ìö®Í≥º
            toggleBtn.addEventListener('mouseenter', function() {
                this.style.background = '#2c5aa0';
            });
            toggleBtn.addEventListener('mouseleave', function() {
                this.style.background = '#3182ce';
            });

            controlContainer.appendChild(toggleBtn);
            legendContainer.appendChild(controlContainer);

            // ÌåÄ ÏïÑÏù¥ÌÖúÎì§ÏùÑ Ï†ÄÏû•Ìï† Î∞∞Ïó¥
            const legendItems = [];

            // Í∞Å ÌåÄÎ≥Ñ Î†àÏ†ÑÎìú ÏïÑÏù¥ÌÖú ÏÉùÏÑ±
            teams.forEach((team, index) => {
                const meta = NPB_TEAM_META[team.teamCode];
                if (!meta) return;

                const logoPath = TEAM_LOGOS[team.teamCode] || '';

                // Î†àÏ†ÑÎìú ÏïÑÏù¥ÌÖú Ïª®ÌÖåÏù¥ÎÑà
                const legendItem = document.createElement('div');
                legendItem.className = 'legend-item';
                legendItem.style.cssText = `
                    display: flex;
                    align-items: center;
                    gap: 6px;
                    padding: 6px 10px;
                    cursor: pointer;
                    transition: all 0.2s ease;
                    font-size: 12px;
                    font-weight: 600;
                    border-radius: 4px;
                `;

                // ÌåÄ ÏÉâÏÉÅ Ïù∏ÎîîÏºÄÏù¥ÌÑ∞
                const colorIndicator = document.createElement('div');
                colorIndicator.style.cssText = `
                    width: 12px;
                    height: 12px;
                    background-color: ${meta.color};
                    border-radius: 50%;
                    flex-shrink: 0;
                    border: 2px solid white;
                    box-shadow: 0 0 0 1px rgba(0, 0, 0, 0.1);
                `;

                // ÌåÄ Î°úÍ≥†
                const logoImg = document.createElement('img');
                if (logoPath) {
                    logoImg.src = logoPath;
                    logoImg.alt = meta.shortName;
                    logoImg.style.cssText = `
                        width: 16px;
                        height: 16px;
                        object-fit: contain;
                        flex-shrink: 0;
                    `;
                    logoImg.onerror = function() {
                        this.style.display = 'none';
                    };
                }

                // ÌåÄ Ïù¥Î¶Ñ
                const teamName = document.createElement('span');
                teamName.textContent = meta.shortName;
                teamName.style.cssText = `
                    color: #2d3748;
                    font-weight: 600;
                    white-space: nowrap;
                `;

                // ÏöîÏÜåÎì§ Ï°∞Î¶Ω
                legendItem.appendChild(colorIndicator);
                if (logoPath) {
                    legendItem.appendChild(logoImg);
                }
                legendItem.appendChild(teamName);

                // ÌÅ¥Î¶≠ Ïù¥Î≤§Ìä∏ (ÏãúÎ¶¨Ï¶à ÌÜ†Í∏Ä)
                legendItem.addEventListener('click', function() {
                    try {
                        chartInstance.toggleSeries(meta.shortName);

                        // ÏãúÍ∞ÅÏ†Å ÌîºÎìúÎ∞±
                        const isHidden = this.style.opacity === '0.4';
                        this.style.opacity = isHidden ? '1' : '0.4';
                        this.style.textDecoration = isHidden ? 'none' : 'line-through';
                    } catch (error) {
                        console.warn('ÏãúÎ¶¨Ï¶à ÌÜ†Í∏Ä Ïã§Ìå®:', error);
                    }
                });

                // Ìò∏Î≤Ñ Ìö®Í≥º
                legendItem.addEventListener('mouseenter', function() {
                    if (this.style.opacity !== '0.4') {
                        this.style.background = 'rgba(248, 250, 252, 0.8)';
                    }
                });

                legendItem.addEventListener('mouseleave', function() {
                    if (this.style.opacity !== '0.4') {
                        this.style.background = 'transparent';
                    }
                });

                legendContainer.appendChild(legendItem);
                legendItems.push({element: legendItem, teamName: meta.shortName});
            });

            // ÌÜ†Í∏Ä Î≤ÑÌäº ÏÉÅÌÉú Ï∂îÏ†Å
            let allVisible = true;

            // ÌÜ†Í∏Ä Î≤ÑÌäº ÌÅ¥Î¶≠ Ïù¥Î≤§Ìä∏
            toggleBtn.addEventListener('click', function() {
                if (allVisible) {
                    // Ï†ÑÏ≤¥ Ìï¥Ï†ú
                    legendItems.forEach(item => {
                        try {
                            chartInstance.hideSeries(item.teamName);
                            item.element.style.opacity = '0.4';
                            item.element.style.textDecoration = 'line-through';
                        } catch (error) {
                            console.warn('Ï†ÑÏ≤¥Ìï¥Ï†ú Ïã§Ìå®:', error);
                        }
                    });
                    this.textContent = '„Åô„Åπ„Å¶Ë°®Á§∫';
                    this.style.background = '#38a169';
                    allVisible = false;
                } else {
                    // Ï†ÑÏ≤¥ ÏÑ†ÌÉù
                    legendItems.forEach(item => {
                        try {
                            chartInstance.showSeries(item.teamName);
                            item.element.style.opacity = '1';
                            item.element.style.textDecoration = 'none';
                        } catch (error) {
                            console.warn('Ï†ÑÏ≤¥ÏÑ†ÌÉù Ïã§Ìå®:', error);
                        }
                    });
                    this.textContent = '„Åô„Åπ„Å¶ÈùûË°®Á§∫';
                    this.style.background = '#3182ce';
                    allVisible = true;
                }
            });

            // Ï∞®Ìä∏ ÏúÑÏóê Î†àÏ†ÑÎìú ÏÇΩÏûÖ
            chartContainer.insertBefore(legendContainer, chartElement);
        }

        // ÎßàÏßÄÎßâ Ìè¨Ïù∏Ìä∏Ïóê ÌåÄ Î°úÍ≥† Ï∂îÍ∞Ä Ìï®Ïàò
        function addTeamLogosToLastPoint(chart, teams, data) {
            setTimeout(() => {
                // Í∏∞Ï°¥ Î°úÍ≥†Îì§ Ï†úÍ±∞
                const existingLogos = chart.el.parentElement.querySelectorAll('.chart-end-logo');
                existingLogos.forEach(logo => logo.remove());

                const chartConfig = chart.w.config;
                const globals = chart.w.globals;

                teams.forEach((team, index) => {
                    const meta = NPB_TEAM_META[team.teamCode];
                    const logoPath = TEAM_LOGOS[team.teamCode];

                    if (!meta || !logoPath) return;

                    // ÏãúÎ¶¨Ï¶à Îç∞Ïù¥ÌÑ∞ Í∞ÄÏ†∏Ïò§Í∏∞
                    const series = chartConfig.series[index];
                    if (!series || !series.data || series.data.length === 0) return;

                    const lastDataValue = series.data[series.data.length - 1];
                    const lastXIndex = series.data.length - 1;

                    // ApexCharts ÎÇ¥Î∂Ä Ï¢åÌëúÍ≥ÑÎ•º ÏÇ¨Ïö©ÌïòÏó¨ Ï†ïÌôïÌïú ÏúÑÏπò Í≥ÑÏÇ∞
                    const xAxisWidth = globals.gridWidth;
                    const yAxisHeight = globals.gridHeight;
                    const xAxisLeft = globals.translateX;
                    const yAxisTop = globals.translateY;

                    // X Ï¢åÌëú (ÎßàÏßÄÎßâ Îç∞Ïù¥ÌÑ∞ Ìè¨Ïù∏Ìä∏)
                    const xPos = xAxisLeft + (xAxisWidth * (lastXIndex / Math.max(1, data.dates.length - 1)));

                    // Y Ï¢åÌëú (Ïã§Ï†ú Îç∞Ïù¥ÌÑ∞ Í∞í Í∏∞Î∞ò)
                    const minValue = Math.min(...chartConfig.series.flatMap(s => s.data));
                    const maxValue = Math.max(...chartConfig.series.flatMap(s => s.data));
                    const valueRange = maxValue - minValue;
                    const yPos = yAxisTop + yAxisHeight - ((lastDataValue - minValue) / valueRange * yAxisHeight);

                    // Î°úÍ≥† HTML ÏöîÏÜå ÏÉùÏÑ±
                    const logoDiv = document.createElement('div');
                    logoDiv.className = 'chart-end-logo';
                    logoDiv.style.cssText = `
                        position: absolute;
                        width: 22px;
                        height: 22px;
                        background-image: url('${logoPath}');
                        background-size: 16px 16px;
                        background-repeat: no-repeat;
                        background-position: center;
                        border: 2px solid ${meta.color};
                        border-radius: 50%;
                        background-color: white;
                        box-shadow: 0 1px 4px rgba(0, 0, 0, 0.25);
                        z-index: 1000;
                        pointer-events: none;
                        left: ${xPos + 8}px;
                        top: ${yPos - 11}px;
                        transform: translate(0, 0);
                    `;

                    chart.el.appendChild(logoDiv);
                });
            }, 1000);
        }

        // Ï∞®Ìä∏ ÎÇ¥Î∂Ä HTML Ïò§Î≤ÑÎ†àÏù¥ Î†àÏ†ÑÎìú ÏÉùÏÑ± Ìï®Ïàò (Î∞±ÏóÖÏö©)
        function createInChartLegend(canvas, teams, chartInstance) {
            const chartContainer = canvas.parentElement;

            // Í∏∞Ï°¥ Î†àÏ†ÑÎìúÍ∞Ä ÏûàÏúºÎ©¥ Ï†úÍ±∞
            const existingLegend = chartContainer.querySelector('.in-chart-legend');
            if (existingLegend) {
                existingLegend.remove();
            }

            // Ïò§Î≤ÑÎ†àÏù¥ Î†àÏ†ÑÎìú Ïª®ÌÖåÏù¥ÎÑà ÏÉùÏÑ±
            const legendOverlay = document.createElement('div');
            legendOverlay.className = 'in-chart-legend';
            legendOverlay.style.cssText = `
                position: absolute;
                top: 15px;
                left: 15px;
                background: rgba(255, 255, 255, 0.95);
                border: 1px solid rgba(0, 0, 0, 0.1);
                border-radius: 8px;
                padding: 12px;
                display: flex;
                flex-wrap: wrap;
                gap: 8px;
                max-width: calc(100% - 30px);
                box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
                z-index: 10;
                font-size: 12px;
            `;

            teams.forEach((team, index) => {
                const meta = NPB_TEAM_META[team.teamCode];
                if (!meta) return;

                const logoPath = TEAM_LOGOS[team.teamCode] || '';

                const legendItem = document.createElement('div');
                legendItem.className = 'in-chart-legend-item';
                legendItem.style.cssText = `
                    display: flex;
                    align-items: center;
                    gap: 6px;
                    padding: 4px 8px;
                    border-radius: 4px;
                    cursor: pointer;
                    transition: all 0.2s ease;
                    background: rgba(255, 255, 255, 0.8);
                    border: 1px solid rgba(0, 0, 0, 0.1);
                `;

                // ÏÉâÏÉÅ Ï†ê
                const colorDot = document.createElement('div');
                colorDot.style.cssText = `
                    width: 10px;
                    height: 10px;
                    background-color: ${meta.color};
                    border-radius: 50%;
                    flex-shrink: 0;
                `;

                // ÌåÄ Î°úÍ≥†
                const logoImg = document.createElement('img');
                if (logoPath) {
                    logoImg.src = logoPath;
                    logoImg.alt = meta.shortName;
                    logoImg.style.cssText = `
                        width: 16px;
                        height: 16px;
                        object-fit: contain;
                        flex-shrink: 0;
                    `;
                }

                // ÌåÄ Ïù¥Î¶Ñ
                const teamName = document.createElement('span');
                teamName.textContent = meta.shortName;
                teamName.style.cssText = `
                    font-weight: 500;
                    color: #333;
                    white-space: nowrap;
                `;

                legendItem.appendChild(colorDot);
                if (logoPath) {
                    legendItem.appendChild(logoImg);
                }
                legendItem.appendChild(teamName);

                // ÌÅ¥Î¶≠ Ïù¥Î≤§Ìä∏
                legendItem.addEventListener('click', function() {
                    const datasetMeta = chartInstance.getDatasetMeta(index);
                    if (datasetMeta) {
                        datasetMeta.hidden = datasetMeta.hidden === null ? !chartInstance.data.datasets[index].hidden : !datasetMeta.hidden;
                        chartInstance.update();

                        // ÏãúÍ∞ÅÏ†Å ÌîºÎìúÎ∞±
                        if (datasetMeta.hidden) {
                            this.style.opacity = '0.4';
                            this.style.textDecoration = 'line-through';
                        } else {
                            this.style.opacity = '1';
                            this.style.textDecoration = 'none';
                        }
                    }
                });

                // Ìò∏Î≤Ñ Ìö®Í≥º
                legendItem.addEventListener('mouseenter', function() {
                    this.style.background = 'rgba(248, 249, 250, 0.9)';
                    this.style.transform = 'translateY(-1px)';
                });

                legendItem.addEventListener('mouseleave', function() {
                    this.style.background = 'rgba(255, 255, 255, 0.8)';
                    this.style.transform = 'translateY(0)';
                });

                legendOverlay.appendChild(legendItem);
            });

            // Ï∞®Ìä∏ Ïª®ÌÖåÏù¥ÎÑàÏóê Î†àÏ†ÑÎìú Ï∂îÍ∞Ä
            chartContainer.style.position = 'relative';
            chartContainer.appendChild(legendOverlay);
        }

        // NPB ApexCharts Ï∞®Ìä∏ ÏÉùÏÑ± Ìï®Ïàò
        function createNPBChart(canvasId, legendContainerId, data, type, league) {
            const chartElement = document.getElementById(canvasId);
            if (!chartElement) return null;

            // Í∏∞Ï°¥ Ï∞®Ìä∏ Ïù∏Ïä§ÌÑ¥Ïä§ Ï†ïÎ¶¨
            if (npbChartInstances[league] && npbChartInstances[league][type]) {
                npbChartInstances[league][type].destroy();
            }

            // ÌåÄÎ≥Ñ Îç∞Ïù¥ÌÑ∞ Ï†ïÎ†¨ (ÏàúÏúÑÎ≥ÑÎ°ú)
            const sortedTeams = data.teams.sort((a, b) => {
                const rankA = a.rankings[a.rankings.length - 1] || 6;
                const rankB = b.rankings[b.rankings.length - 1] || 6;
                return rankA - rankB;
            });

            // ApexCharts ÏãúÎ¶¨Ï¶à Îç∞Ïù¥ÌÑ∞ ÏÉùÏÑ±
            const series = sortedTeams.map(team => {
                const meta = NPB_TEAM_META[team.teamCode];
                if (!meta) return null;

                let chartData = [];
                switch (type) {
                    case 'ranking':
                        chartData = team.rankings;
                        break;
                    case 'winrate':
                        chartData = team.winRates.map(rate => rate.toFixed(3));
                        break;
                    case 'gamesBehind':
                        chartData = team.gamesBehind.map(gb => gb.toFixed(1));
                        break;
                    case 'wins':
                        chartData = team.wins;
                        break;
                }

                return {
                    name: meta.shortName,
                    data: chartData,
                    color: meta.color
                };
            }).filter(series => series !== null);

            // YÏ∂ï ÏÑ§Ï†ï
            const yAxisConfig = {
                title: {
                    text: (() => {
                        switch (type) {
                            case 'ranking': return 'È†Ü‰Ωç';
                            case 'winrate': return 'ÂãùÁéá';
                            case 'gamesBehind': return '„Ç≤„Éº„É†Â∑Æ';
                            case 'wins': return 'ÂãùÊï∞';
                            default: return '';
                        }
                    })()
                },
                reversed: type === 'ranking' || type === 'gamesBehind', // ÏàúÏúÑÏôÄ Í≤åÏûÑÏ∞®Îäî Ïó≠Ïàú (0Ïù¥ ÏúÑ)
                labels: {
                    formatter: function(value) {
                        switch (type) {
                            case 'ranking':
                                return value + '‰Ωç';
                            case 'winrate':
                                return value.toFixed(3);
                            case 'gamesBehind':
                                return value;
                            case 'wins':
                                return value + 'Âãù';
                            default:
                                return value;
                        }
                    }
                }
            };

            // ApexCharts ÏòµÏÖò ÏÑ§Ï†ï
            const options = {
                series: series,
                chart: {
                    type: 'line',
                    height: 400,
                    zoom: {
                        enabled: true
                    },
                    animations: {
                        enabled: true,
                        easing: 'easeinout',
                        speed: 800
                    }
                },
                dataLabels: {
                    enabled: false
                },
                stroke: {
                    curve: 'smooth',
                    width: 3
                },
                title: {
                    text: (() => {
                        const leagueName = league === 'central' ? '„Çª„É≥„Éà„É©„É´„É™„Éº„Ç∞' : '„Éë„Ç∑„Éï„Ç£„ÉÉ„ÇØ„É™„Éº„Ç∞';
                        switch (type) {
                            case 'ranking': return `${leagueName} È†Ü‰ΩçÊé®Áßª`;
                            case 'winrate': return `${leagueName} ÂãùÁéáÊé®Áßª`;
                            case 'gamesBehind': return `${leagueName} „Ç≤„Éº„É†Â∑ÆÊé®Áßª`;
                            case 'wins': return `${leagueName} ÂãùÊï∞Êé®Áßª`;
                            default: return leagueName;
                        }
                    })(),
                    align: 'left'
                },
                legend: {
                    show: false  // ApexCharts ÎÇ¥Ïû• Î†àÏ†ÑÎìú ÎπÑÌôúÏÑ±Ìôî, Ïª§Ïä§ÌÖÄ HTML Î†àÏ†ÑÎìú ÏÇ¨Ïö©
                },
                markers: {
                    size: 4,
                    strokeWidth: 2,
                    strokeColors: '#fff',
                    hover: {
                        size: 8
                    }
                },
                xaxis: {
                    categories: data.dates.map(date => {
                        const d = new Date(date);
                        return `${d.getMonth() + 1}/${d.getDate()}`;
                    }),
                    title: {
                        text: 'Êó•‰ªò'
                    },
                    labels: {
                        show: true,
                        maxHeight: 160,
                        style: {
                            fontSize: '11px'
                        },
                        formatter: function(value, timestamp, opts) {
                            return value;
                        }
                    },
                    tickAmount: Math.min(data.dates.length, 20), // ÏµúÎåÄ 20Í∞ú ÎÇ†Ïßú ÌëúÏãú
                    tooltip: {
                        enabled: true
                    }
                },
                yaxis: yAxisConfig,
                tooltip: {
                    shared: true,
                    intersect: false,
                    y: {
                        formatter: function(value, opts) {
                            const seriesName = opts.series[opts.seriesIndex][opts.dataPointIndex];
                            switch (type) {
                                case 'ranking':
                                    return value + '‰Ωç';
                                case 'winrate':
                                    return value.toFixed(3);
                                case 'gamesBehind':
                                    return value + '„Ç≤„Éº„É†Â∑Æ';
                                case 'wins':
                                    return value + 'Âãù';
                                default:
                                    return value;
                            }
                        }
                    }
                },
                grid: {
                    borderColor: '#e7e7e7',
                    row: {
                        colors: ['#f3f3f3', 'transparent'],
                        opacity: 0.5
                    }
                },
                annotations: {
                    points: []  // ÌåÄ Î°úÍ≥† Ìè¨Ïù∏Ìä∏Îì§Ïù¥ Ïó¨Í∏∞Ïóê Ï∂îÍ∞ÄÎê®
                }
            };

            // Ï∞®Ìä∏ ÏÉùÏÑ±
            const chart = new ApexCharts(chartElement, options);
            chart.render();

            // Ï∞®Ìä∏ Ïù∏Ïä§ÌÑ¥Ïä§ Ï†ÄÏû•
            npbChartInstances[league][type] = chart;

            // Ïª§Ïä§ÌÖÄ HTML Î†àÏ†ÑÎìú ÏÉùÏÑ± (Î°úÍ≥† Ìè¨Ìï®)
            createCustomHTMLLegend(chartElement, sortedTeams, chart);

            // ÎßàÏßÄÎßâ Ìè¨Ïù∏Ìä∏Ïóê ÌåÄ Î°úÍ≥† Ï∂îÍ∞Ä
            addTeamLogosToLastPoint(chart, sortedTeams, data);

            return chart;
        }

        // NPB Ïã§Ï†ú ÏãúÏ¶å Îç∞Ïù¥ÌÑ∞ Ï≤òÎ¶¨ Ìï®Ïàò (KBO Ïä§ÌÉÄÏùº)
        function processNPBRealSeasonData() {
            const npbData = loadRealNPBData();
            if (!npbData) {
                return null;
            }

            const { teamStats, dates } = npbData;
            const processedData = { central: {}, pacific: {} };

            // Í∞Å ÎÇ†ÏßúÎ≥Ñ ÏàúÏúÑ Í≥ÑÏÇ∞ Î∞è Îç∞Ïù¥ÌÑ∞ Ï†ïÎ¶¨
            dates.forEach(date => {
                const rankings = calculateNPBRankings(teamStats, date);

                Object.keys(rankings).forEach(league => {
                    if (!processedData[league].teams) {
                        processedData[league].teams = rankings[league].map(team => ({
                            teamCode: team.teamCode,
                            rankings: [],
                            winRates: [],
                            gamesBehind: [],
                            wins: []
                        }));
                        processedData[league].dates = [];
                    }

                    processedData[league].dates.push(date);

                    rankings[league].forEach((team, index) => {
                        const teamData = processedData[league].teams.find(t => t.teamCode === team.teamCode);
                        if (teamData) {
                            teamData.rankings.push(team.rank);
                            teamData.winRates.push(team.winRate);
                            teamData.wins.push(team.wins);

                            // Í≤åÏûÑÏ∞® Í≥ÑÏÇ∞ (1ÏúÑÌåÄ ÎåÄÎπÑ)
                            const firstPlace = rankings[league][0];
                            const gamesBehind = firstPlace ?
                                Math.max(0, (firstPlace.wins - team.wins + team.losses - firstPlace.losses) / 2) : 0;
                            teamData.gamesBehind.push(gamesBehind);
                        }
                    });
                });
            });

            return processedData;
        }

        // NPB ÏãúÏ¶å Î∂ÑÏÑù Ï∞®Ìä∏ ÏóÖÎç∞Ïù¥Ìä∏ Î©îÏù∏ Ìï®Ïàò
        function updateNPBSeasonAnalysis() {

            if (typeof ApexCharts === 'undefined') {
                console.error('ApexChartsÍ∞Ä Î°úÎìúÎêòÏßÄ ÏïäÏïòÏäµÎãàÎã§.');
                return;
            }

            // Ïã§Ï†ú Îç∞Ïù¥ÌÑ∞Í∞Ä ÏóÜÏúºÎ©¥ ÏÉòÌîå Îç∞Ïù¥ÌÑ∞Î°ú ÌÖåÏä§Ìä∏
            if (!gamesData || !gamesData.length) {
                console.warn('Ïã§Ï†ú Í≤åÏûÑ Îç∞Ïù¥ÌÑ∞Í∞Ä ÏóÜÏäµÎãàÎã§. ÏÉòÌîå Îç∞Ïù¥ÌÑ∞Î•º ÏÉùÏÑ±Ìï©ÎãàÎã§.');
                createNPBSampleData();
                return;
            }

            const processedData = processNPBRealSeasonData();

            if (!processedData) {
                console.error('Îç∞Ïù¥ÌÑ∞ Ï≤òÎ¶¨ Ïã§Ìå®');
                createNPBSampleData();
                return;
            }

            // ÏÑ∏Ìä∏Îü¥ Î¶¨Í∑∏ Ï∞®Ìä∏Îì§ ÏÉùÏÑ±
            if (processedData.central && processedData.central.teams && processedData.central.teams.length > 0) {
                createNPBChart('central-ranking-canvas', 'central-ranking-legend', processedData.central, 'ranking', 'central');
                createNPBChart('central-winrate-canvas', 'central-winrate-legend', processedData.central, 'winrate', 'central');
                createNPBChart('central-gamesbehind-canvas', 'central-gamesbehind-legend', processedData.central, 'gamesBehind', 'central');
                createNPBChart('central-wins-canvas', 'central-wins-legend', processedData.central, 'wins', 'central');
            } else {
                console.warn('ÏÑ∏Ìä∏Îü¥ Î¶¨Í∑∏ Îç∞Ïù¥ÌÑ∞ ÏóÜÏùå');
            }

            // ÌçºÏãúÌîΩ Î¶¨Í∑∏ Ï∞®Ìä∏Îì§ ÏÉùÏÑ±
            if (processedData.pacific && processedData.pacific.teams && processedData.pacific.teams.length > 0) {
                createNPBChart('pacific-ranking-canvas', 'pacific-ranking-legend', processedData.pacific, 'ranking', 'pacific');
                createNPBChart('pacific-winrate-canvas', 'pacific-winrate-legend', processedData.pacific, 'winrate', 'pacific');
                createNPBChart('pacific-gamesbehind-canvas', 'pacific-gamesbehind-legend', processedData.pacific, 'gamesBehind', 'pacific');
                createNPBChart('pacific-wins-canvas', 'pacific-wins-legend', processedData.pacific, 'wins', 'pacific');
            } else {
                console.warn('ÌçºÏãúÌîΩ Î¶¨Í∑∏ Îç∞Ïù¥ÌÑ∞ ÏóÜÏùå');
            }

        }

        // NPB ÏÉòÌîå Îç∞Ïù¥ÌÑ∞ ÏÉùÏÑ± Î∞è Ï∞®Ìä∏ ÌëúÏãú
        function createNPBSampleData() {

            // ÏÉòÌîå Îç∞Ïù¥ÌÑ∞ Íµ¨Ï°∞ ÏÉùÏÑ±
            const sampleData = {
                central: {
                    teams: [],
                    dates: []
                },
                pacific: {
                    teams: [],
                    dates: []
                }
            };

            // ÏµúÍ∑º 30Ïùº ÎÇ†Ïßú ÏÉùÏÑ±
            for (let i = 29; i >= 0; i--) {
                const date = new Date();
                date.setDate(date.getDate() - i);
                sampleData.central.dates.push(date.toISOString().split('T')[0]);
                sampleData.pacific.dates.push(date.toISOString().split('T')[0]);
            }

            // ÏÑ∏Ìä∏Îü¥ Î¶¨Í∑∏ ÌåÄÎì§
            const centralTeams = ['YOG', 'HAN', 'CHU', 'HIR', 'YDB', 'YAK'];
            centralTeams.forEach((teamCode, teamIndex) => {
                const rankings = [];
                const winRates = [];
                const gamesBehind = [];
                const wins = [];

                for (let day = 0; day < 30; day++) {
                    // ÏàúÏúÑ (1-6ÏúÑ, ÏïΩÍ∞ÑÏùò Î≥ÄÎèô)
                    const ranking = Math.max(1, Math.min(6, teamIndex + 1 + Math.floor(Math.random() * 3) - 1));
                    rankings.push(ranking);

                    // ÏäπÎ•† (0.3 ~ 0.7 ÏÇ¨Ïù¥)
                    const baseWinRate = 0.6 - (teamIndex * 0.05) + (Math.random() - 0.5) * 0.1;
                    const winRate = Math.max(0.3, Math.min(0.7, baseWinRate));
                    winRates.push(winRate);

                    // ÏäπÏàò (ÎÇ†ÏßúÏóê ÎπÑÎ°Ä)
                    const winCount = Math.floor((day + 1) * winRate * 0.5);
                    wins.push(winCount);

                    // Í≤åÏûÑÏ∞® (ÏàúÏúÑÏóê Îî∞Îùº)
                    const gb = Math.max(0, (ranking - 1) * 1.5 + Math.random() * 2);
                    gamesBehind.push(gb);
                }

                sampleData.central.teams.push({
                    teamCode,
                    rankings,
                    winRates,
                    gamesBehind,
                    wins
                });
            });

            // ÌçºÏãúÌîΩ Î¶¨Í∑∏ ÌåÄÎì§
            const pacificTeams = ['SOF', 'LOT', 'SEI', 'ORI', 'NIP', 'RAK'];
            pacificTeams.forEach((teamCode, teamIndex) => {
                const rankings = [];
                const winRates = [];
                const gamesBehind = [];
                const wins = [];

                for (let day = 0; day < 30; day++) {
                    const ranking = Math.max(1, Math.min(6, teamIndex + 1 + Math.floor(Math.random() * 3) - 1));
                    rankings.push(ranking);

                    const baseWinRate = 0.6 - (teamIndex * 0.05) + (Math.random() - 0.5) * 0.1;
                    const winRate = Math.max(0.3, Math.min(0.7, baseWinRate));
                    winRates.push(winRate);

                    const winCount = Math.floor((day + 1) * winRate * 0.5);
                    wins.push(winCount);

                    const gb = Math.max(0, (ranking - 1) * 1.5 + Math.random() * 2);
                    gamesBehind.push(gb);
                }

                sampleData.pacific.teams.push({
                    teamCode,
                    rankings,
                    winRates,
                    gamesBehind,
                    wins
                });
            });


            // Ï∞®Ìä∏ ÏÉùÏÑ±
            createNPBChart('central-ranking-canvas', 'central-ranking-legend', sampleData.central, 'ranking', 'central');
            createNPBChart('central-winrate-canvas', 'central-winrate-legend', sampleData.central, 'winrate', 'central');
            createNPBChart('central-gamesbehind-canvas', 'central-gamesbehind-legend', sampleData.central, 'gamesBehind', 'central');
            createNPBChart('central-wins-canvas', 'central-wins-legend', sampleData.central, 'wins', 'central');

            createNPBChart('pacific-ranking-canvas', 'pacific-ranking-legend', sampleData.pacific, 'ranking', 'pacific');
            createNPBChart('pacific-winrate-canvas', 'pacific-winrate-legend', sampleData.pacific, 'winrate', 'pacific');
            createNPBChart('pacific-gamesbehind-canvas', 'pacific-gamesbehind-legend', sampleData.pacific, 'gamesBehind', 'pacific');
            createNPBChart('pacific-wins-canvas', 'pacific-wins-legend', sampleData.pacific, 'wins', 'pacific');
        }

        function getLeagueScenarioTeams(league) {
            const teams = league === 'central'
                ? (standingsData?.central_league?.standings || [])
                : (standingsData?.pacific_league?.standings || []);
            return teams.map(t => ({
                team: t.team_abbreviation,
                teamName: t.team_name,
                rank: t.position_rank,
                displayRank: t.position_rank,
                wins: t.wins,
                losses: t.losses,
                draws: t.draws || 0,
                winRate: t.win_percentage,
                remainingGames: Math.max(0, TOTAL_GAMES - (t.games_played || (t.wins + t.losses + (t.draws || 0))))
            })).sort((a,b) => a.rank - b.rank);
        }

        function setScenarioView(league, view) {
            const prefix = league === 'central' ? 'central' : 'pacific';
            const btnMatrix = document.getElementById(`btn-${prefix}-matrix`);
            const btnDetailed = document.getElementById(`btn-${prefix}-detailed`);
            const elMatrix = document.getElementById(`${prefix}-scenario-matrix`);
            const elDetailed = document.getElementById(`${prefix}-scenario-detailed`);

            // Toggle buttons
            btnMatrix?.classList.toggle('active', view === 'matrix');
            btnMatrix?.setAttribute('aria-selected', String(view === 'matrix'));
            btnDetailed?.classList.toggle('active', view === 'detailed');
            btnDetailed?.setAttribute('aria-selected', String(view === 'detailed'));

            // Toggle sections
            if (elMatrix) elMatrix.style.display = (view === 'matrix') ? 'block' : 'none';
            if (elDetailed) elDetailed.style.display = (view === 'detailed') ? 'block' : 'none';

            // Render when needed
            if (view === 'matrix') {
                renderScenarioMatrixFor(league);
            } else if (view === 'detailed') {
                renderDetailedScenariosFor(league);
            }
        }

        function renderScenarioMatrixFor(league) {
            const teams = getLeagueScenarioTeams(league);
            // Show all teams (6 teams total)
            let contenders = teams;
            const top = contenders;
            const html = generateScenarioMatrixV2(top);
            const targetId = league === 'central' ? 'central-scenario-content' : 'pacific-scenario-content';
            const container = document.getElementById(targetId);
            if (container) container.innerHTML = html;
        }

        function renderDetailedScenariosFor(league) {
            const teams = getLeagueScenarioTeams(league);
            // Show all teams (6 teams total)
            let contenders = teams;
            const top = contenders;
            const html = generateDetailedScenarios(top);
            const targetId = league === 'central' ? 'central-scenario-detailed' : 'pacific-scenario-detailed';
            const container = document.getElementById(targetId);
            if (container) container.innerHTML = html;
        }

        function bindScenarioViewToggles() {
            // Central
            document.getElementById('btn-central-matrix')?.addEventListener('click', () => setScenarioView('central','matrix'));
            document.getElementById('btn-central-detailed')?.addEventListener('click', () => setScenarioView('central','detailed'));
            // Pacific
            document.getElementById('btn-pacific-matrix')?.addEventListener('click', () => setScenarioView('pacific','matrix'));
            document.getElementById('btn-pacific-detailed')?.addEventListener('click', () => setScenarioView('pacific','detailed'));
        }

        function generateScenarioMatrix(topTeams) {
            let html = `
                <div class="scenario-matrix-container" style="
                    overflow-x: auto; overflow-y: auto; border-radius: 12px; border: 1px solid #e0e0e0; box-shadow: 0 2px 8px rgba(0,0,0,0.1);
                    max-height: 80vh; width: 100%; position: relative;">
                    <table class="scenario-matrix-table" style="width: 100%; border-collapse: collapse; font-size: 0.75rem; background: white; min-width: ${window.innerWidth <= 768 ? '700px' : Math.max(900, 6 * (70 + 85) + 70 + 140) + 'px'};">
                        <thead style="position: sticky; top: 0; z-index: 100;">
                          <tr style="background: #1E88E5; color: white;">
                            <th style="position: sticky; left: 0; z-index: 110; min-width: 70px; width: 70px; padding: 4px 6px; text-align: center; font-weight: 600; border-right: 2px solid rgba(255,255,255,0.4); background: #1E88E5; font-size: 0.7rem;">ÂãùÁéá</th>`;

            // Header team columns
            topTeams.forEach((team, index) => {
                const isLast = index === topTeams.length - 1;
                const teamMeta = NPB_TEAM_META[team.team];
                const teamColor = teamMeta?.color || '#333';
                const totalColumnWidth = '140px';
                const logo = TEAM_LOGOS[team.team] ? `<img class=\"team-logo\" src=\"${TEAM_LOGOS[team.team]}\" alt=\"${teamMeta?.fullName || team.team}\" loading=\"lazy\">` : '';
                html += `<th colspan="2" style="min-width: ${totalColumnWidth}; width: ${totalColumnWidth}; padding: 6px 4px 3px 4px; text-align: center; font-weight: 700; background: #F0F2F5; color: ${teamColor}; ${index === 2 ? 'border-right: 4px solid #FF6B35;' : (!isLast ? 'border-right: 2px solid rgba(255,255,255,0.5);' : '')} font-size: 0.8rem; white-space: nowrap; line-height: 1.2;"> 
                    <div style="font-size: 0.85rem; font-weight: 800; color: ${teamColor};">${team.displayRank || team.rank}‰Ωç ${logo}${teamMeta?.shortName || team.team}</div>
                </th>`;
            });

            // Current record row
            html += `</tr><tr style="background: #1E88E5; color: white;">
                <th style="position: sticky; left: 0; z-index: 110; min-width: 70px; width: 70px; padding: 4px 6px; text-align: center; font-weight: 600; border-right: 2px solid rgba(255,255,255,0.4); background: #1E88E5; font-size: 0.7rem;">ÊàêÁ∏æ</th>`;
            topTeams.forEach((team, index) => {
                const isLast = index === topTeams.length - 1;
                html += `<th colspan="2" style="min-width: 140px; width: 140px; padding: 4px; text-align: center; font-weight: 600; background: rgba(255,255,255,0.9); color: #333; ${index === 2 ? 'border-right: 4px solid #FF6B35;' : (!isLast ? 'border-right: 2px solid rgba(255,255,255,0.5);' : '')} font-size: 0.7rem;">${team.wins}Âãù ${team.losses}Êïó ${team.draws || 0}ÂàÜ (0.${(team.winRate ?? (team.wins/(team.wins+team.losses))).toFixed(3).split('.')[1]})</th>`;
            });

            // Remaining row
            html += `</tr><tr style="background: #1E88E5; color: white;">
                <th style="position: sticky; left: 0; z-index: 110; min-width: 70px; width: 70px; padding: 4px 6px; text-align: center; font-weight: 600; border-right: 2px solid rgba(255,255,255,0.4); background: #1E88E5; font-size: 0.7rem;">ÊÆã„Çä</th>`;
            topTeams.forEach((team, index) => {
                const isLast = index === topTeams.length - 1;
                html += `<th colspan="2" style="min-width: 140px; width: 140px; padding: 4px; text-align: center; font-weight: 600; background: rgba(255,255,255,0.9); color: #333; ${index === 2 ? 'border-right: 4px solid #FF6B35;' : (!isLast ? 'border-right: 2px solid rgba(255,255,255,0.5);' : '')} font-size: 0.7rem;">ÊÆã„Çä: ${team.remainingGames}Ë©¶Âêà</th>`;
            });

            // Column split row
            html += `</tr><tr style="background: #1E88E5; color: white;">
                <th style="position: sticky; left: 0; z-index: 110; min-width: 70px; width: 70px; padding: 4px 6px; text-align: center; font-weight: 600; border-right: 2px solid rgba(255,255,255,0.4); background: #1E88E5; font-size: 0.7rem;">ÂãùÁéá</th>`;
            topTeams.forEach((team, index) => {
                const isLast = index === topTeams.length - 1;
                html += `
                    <th style="width: 70px; min-width: 70px; font-size: 0.7rem; padding: 2px 1px; background: rgba(255,255,255,0.1); border-right: 1px solid rgba(255,255,255,0.3); text-align: center; font-weight: 600;">ÊÆã„ÇäÊàêÁ∏æ<br><span style=\"font-size: 0.6rem;\">(Âãù-Êïó/ÂãùÁéá)</span></th>
                    <th style="width: 85px; min-width: 85px; font-size: 0.7rem; padding: 2px 1px; background: rgba(255,255,255,0.1); ${index === 2 ? 'border-right: 4px solid #FF6B35;' : (!isLast ? 'border-right: 2px solid rgba(255,255,255,0.5);' : '')} text-align: center; font-weight: 600;">ÊúÄÁµÇÊàêÁ∏æ<br><span style=\"font-size: 0.6rem;\">(Âãù-Êïó-ÂàÜ/ÂãùÁéá)</span></th>`;
            });

            html += `</tr></thead><tbody>`;

            const allScenarios = [];
            topTeams.forEach(team => {
                for (let wins = team.remainingGames; wins >= 0; wins--) {
                    const losses = team.remainingGames - wins;
                    const finalWins = team.wins + wins;
                    const finalLosses = team.losses + losses;
                    const finalWinRate = finalWins / (finalWins + finalLosses);
                    allScenarios.push({ team: team.team, wins, losses, finalWinRate, remainingWinRate: wins / (wins + losses) || 0 });
                }
            });

            const winRateGroups = {};
            allScenarios.forEach(s => {
                const key = s.finalWinRate.toFixed(3);
                (winRateGroups[key] ||= []).push(s);
            });

            Object.keys(winRateGroups).sort((a,b) => parseFloat(b) - parseFloat(a)).forEach(rateKey => {
                const scenarios = winRateGroups[rateKey];
                const winRate = parseFloat(rateKey);
                html += `<tr class="scenario-row">
                    <td style="font-size: 0.8rem; padding: 3px 2px; font-weight: 700; background: white; color: #2E7D32; border: 1px solid #dee2e6; text-align: center; position: sticky; left: 0; z-index: 5; width: 60px; box-shadow: 2px 0 4px rgba(0,0,0,0.1); line-height: 1.2;">0.${winRate.toFixed(3).split('.')[1]}</td>`;
                topTeams.forEach((team, teamIndex) => {
                    const isLast = teamIndex === topTeams.length - 1;
                    const teamScenario = scenarios.find(s => s.team === team.team);
                    if (teamScenario) {
                        const remainingWinRate = teamScenario.wins === 0 && teamScenario.losses > 0 ? 0.0 :
                                                 teamScenario.losses === 0 && teamScenario.wins > 0 ? 1.0 :
                                                 (teamScenario.wins / (teamScenario.wins + teamScenario.losses) || 0);
                        const finalWins = team.wins + teamScenario.wins;
                        const finalLosses = team.losses + teamScenario.losses;
                        const finalDraws = team.draws || 0;
                        const finalBg = getWinRateBackgroundColor(teamScenario.finalWinRate);
                        const finalFg = getWinRateTextColor(teamScenario.finalWinRate);
                        const remainBg = getWinRateBackgroundColor(remainingWinRate);
                        const remainFg = getWinRateTextColor(remainingWinRate);

                        html += `<td style="padding: 2px 0px; text-align: center; border: 1px solid #dee2e6; width: 70px; min-width: 70px; line-height: 1.1; background: ${remainBg}; color: ${remainFg};">
                            <div style="font-size: 0.8rem; font-weight: 600;">${teamScenario.wins}Âãù ${teamScenario.losses}Êïó</div>
                            <div style="font-size: 0.7rem;">${remainingWinRate === 1.0 ? '1.000' : '0.' + remainingWinRate.toFixed(3).split('.')[1]}</div>
                        </td>`;
                        html += `<td style="padding: 2px 1px; text-align: center; border: 1px solid #dee2e6; width: 85px; min-width: 85px; line-height: 1.1; white-space: nowrap; background: ${finalBg}; color: ${finalFg}; ${teamIndex === 2 ? 'border-right: 4px solid #FF6B35;' : (!isLast ? 'border-right: 2px solid #dee2e6;' : '')}"> 
                            <div style="font-size: 0.8rem; font-weight: 600;">${finalWins}Âãù ${finalLosses}Êïó ${finalDraws}ÂàÜ</div>
                            <div style="font-size: 0.7rem;">0.${teamScenario.finalWinRate.toFixed(3).split('.')[1]}</div>
                        </td>`;
                    } else {
                        html += `<td style="background: #f8f9fa; border: 1px solid #dee2e6;"></td><td style="background: #f8f9fa; border: 1px solid #dee2e6; ${teamIndex === 2 ? 'border-right: 4px solid #FF6B35;' : (!isLast ? 'border-right: 2px solid #dee2e6;' : '')}"></td>`;
                    }
                });
                html += `</tr>`;
            });

            html += `</tbody></table></div>`;
            return html;
        }

        // V2: Same as generateScenarioMatrix but with 3‰Ωç„Ç´„ÉÉ„Éà„É©„Ç§„É≥ after index 2
        function generateScenarioMatrixV2(topTeams) {
            const cutoffIndex = 2; // 0-based: after 3rd place
            let html = `
                <div class="scenario-matrix-container" style="
                    overflow-x: auto; overflow-y: auto; border-radius: 12px; border: 1px solid #e0e0e0; box-shadow: 0 2px 8px rgba(0,0,0,0.1);
                    max-height: 80vh; width: 100%; position: relative;">
                    <table class="scenario-matrix-table" style="width: 100%; border-collapse: collapse; font-size: 0.75rem; background: white; min-width: ${window.innerWidth <= 768 ? '700px' : Math.max(900, 6 * (70 + 85) + 70 + 140) + 'px'};">
                        <thead style="position: sticky; top: 0; z-index: 100;">
                          <tr style="background: #1E88E5; color: white;">
                            <th style="position: sticky; left: 0; z-index: 110; min-width: 70px; width: 70px; padding: 4px 6px; text-align: center; font-weight: 600; border-right: 2px solid rgba(255,255,255,0.4); background: #1E88E5; font-size: 0.7rem;">ÂãùÁéá</th>`;

            // Header team columns
            topTeams.forEach((team, index) => {
                const isLast = index === topTeams.length - 1;
                const teamMeta = NPB_TEAM_META[team.team];
                const teamColor = teamMeta?.color || '#333';
                const totalColumnWidth = '140px';
                const logo = TEAM_LOGOS[team.team] ? `<img class=\"team-logo\" src=\"${TEAM_LOGOS[team.team]}\" alt=\"${teamMeta?.fullName || team.team}\" loading=\"lazy\">` : '';
                html += `<th colspan="2" style="min-width: ${totalColumnWidth}; width: ${totalColumnWidth}; padding: 6px 4px 3px 4px; text-align: center; font-weight: 700; background: #F0F2F5; color: ${teamColor}; ${index === cutoffIndex ? 'border-right: 4px solid #FF6B35;' : (!isLast ? 'border-right: 2px solid rgba(255,255,255,0.5);' : '')} font-size: 0.8rem; white-space: nowrap; line-height: 1.2;"> 
                    <div style="font-size: 0.85rem; font-weight: 800; color: ${teamColor};">${team.displayRank || team.rank}‰Ωç ${logo}${teamMeta?.shortName || team.team}</div>
                </th>`;
            });

            // Current record row
            html += `</tr><tr style="background: #1E88E5; color: white;">
                <th style="position: sticky; left: 0; z-index: 110; min-width: 70px; width: 70px; padding: 4px 6px; text-align: center; font-weight: 600; border-right: 2px solid rgba(255,255,255,0.4); background: #1E88E5; font-size: 0.7rem;">ÊàêÁ∏æ</th>`;
            topTeams.forEach((team, index) => {
                const isLast = index === topTeams.length - 1;
                html += `<th colspan="2" style="min-width: 140px; width: 140px; padding: 4px; text-align: center; font-weight: 600; background: rgba(255,255,255,0.9); color: #333; ${index === cutoffIndex ? 'border-right: 4px solid #FF6B35;' : (!isLast ? 'border-right: 2px solid rgba(255,255,255,0.5);' : '')} font-size: 0.7rem;">${team.wins}Âãù ${team.losses}Êïó ${team.draws || 0}ÂàÜ (0.${(team.winRate ?? (team.wins/(team.wins+team.losses))).toFixed(3).split('.')[1]})</th>`;
            });

            // Remaining row
            html += `</tr><tr style="background: #1E88E5; color: white;">
                <th style="position: sticky; left: 0; z-index: 110; min-width: 70px; width: 70px; padding: 4px 6px; text-align: center; font-weight: 600; border-right: 2px solid rgba(255,255,255,0.4); background: #1E88E5; font-size: 0.7rem;">ÊÆã„Çä</th>`;
            topTeams.forEach((team, index) => {
                const isLast = index === topTeams.length - 1;
                html += `<th colspan="2" style="min-width: 140px; width: 140px; padding: 4px; text-align: center; font-weight: 600; background: rgba(255,255,255,0.9); color: #333; ${index === cutoffIndex ? 'border-right: 4px solid #FF6B35;' : (!isLast ? 'border-right: 2px solid rgba(255,255,255,0.5);' : '')} font-size: 0.7rem;">ÊÆã„Çä: ${team.remainingGames}Ë©¶Âêà</th>`;
            });

            // Column split row
            html += `</tr><tr style="background: #1E88E5; color: white;">
                <th style="position: sticky; left: 0; z-index: 110; min-width: 70px; width: 70px; padding: 4px 6px; text-align: center; font-weight: 600; border-right: 2px solid rgba(255,255,255,0.4); background: #1E88E5; font-size: 0.7rem;">ÂãùÁéá</th>`;
            topTeams.forEach((team, index) => {
                const isLast = index === topTeams.length - 1;
                html += `
                    <th style="width: 70px; min-width: 70px; font-size: 0.7rem; padding: 2px 1px; background: rgba(255,255,255,0.1); border-right: 1px solid rgba(255,255,255,0.3); text-align: center; font-weight: 600;">ÊÆã„ÇäÊàêÁ∏æ<br><span style=\"font-size: 0.6rem;\">(Âãù-Êïó/ÂãùÁéá)</span></th>
                    <th style="width: 85px; min-width: 85px; font-size: 0.7rem; padding: 2px 1px; background: rgba(255,255,255,0.1); ${index === cutoffIndex ? 'border-right: 4px solid #FF6B35;' : (!isLast ? 'border-right: 2px solid rgba(255,255,255,0.5);' : '')} text-align: center; font-weight: 600;">ÊúÄÁµÇÊàêÁ∏æ<br><span style=\"font-size: 0.6rem;\">(Âãù-Êïó-ÂàÜ/ÂãùÁéá)</span></th>`;
            });

            html += `</tr></thead><tbody>`;

            const allScenarios = [];
            topTeams.forEach(team => {
                for (let wins = team.remainingGames; wins >= 0; wins--) {
                    const losses = team.remainingGames - wins;
                    const finalWins = team.wins + wins;
                    const finalLosses = team.losses + losses;
                    const finalWinRate = finalWins / (finalWins + finalLosses);
                    allScenarios.push({ team: team.team, wins, losses, finalWinRate, remainingWinRate: wins / (wins + losses) || 0 });
                }
            });

            const winRateGroups = {};
            allScenarios.forEach(s => {
                const key = s.finalWinRate.toFixed(3);
                (winRateGroups[key] ||= []).push(s);
            });

            Object.keys(winRateGroups).sort((a,b) => parseFloat(b) - parseFloat(a)).forEach(rateKey => {
                const scenarios = winRateGroups[rateKey];
                const winRate = parseFloat(rateKey);
                html += `<tr class="scenario-row">
                    <td style="font-size: 0.8rem; padding: 3px 2px; font-weight: 700; background: white; color: #2E7D32; border: 1px solid #dee2e6; text-align: center; position: sticky; left: 0; z-index: 5; width: 60px; box-shadow: 2px 0 4px rgba(0,0,0,0.1); line-height: 1.2;">0.${winRate.toFixed(3).split('.')[1]}</td>`;
                topTeams.forEach((team, teamIndex) => {
                    const isLast = teamIndex === topTeams.length - 1;
                    const teamScenario = scenarios.find(s => s.team === team.team);
                    if (teamScenario) {
                        const remainingWinRate = teamScenario.wins === 0 && teamScenario.losses > 0 ? 0.0 :
                                                 teamScenario.losses === 0 && teamScenario.wins > 0 ? 1.0 :
                                                 (teamScenario.wins / (teamScenario.wins + teamScenario.losses) || 0);
                        const finalWins = team.wins + teamScenario.wins;
                        const finalLosses = team.losses + teamScenario.losses;
                        const finalDraws = team.draws || 0;
                        const finalBg = getWinRateBackgroundColor(teamScenario.finalWinRate);
                        const finalFg = getWinRateTextColor(teamScenario.finalWinRate);
                        const remainBg = getWinRateBackgroundColor(remainingWinRate);
                        const remainFg = getWinRateTextColor(remainingWinRate);

                        html += `<td style="padding: 2px 0px; text-align: center; border: 1px solid #dee2e6; width: 70px; min-width: 70px; line-height: 1.1; background: ${remainBg}; color: ${remainFg};">
                            <div style="font-size: 0.8rem; font-weight: 600;">${teamScenario.wins}Âãù ${teamScenario.losses}Êïó</div>
                            <div style="font-size: 0.7rem;">${remainingWinRate === 1.0 ? '1.000' : '0.' + remainingWinRate.toFixed(3).split('.')[1]}</div>
                        </td>`;
                        html += `<td style="padding: 2px 1px; text-align: center; border: 1px solid #dee2e6; width: 85px; min-width: 85px; line-height: 1.1; white-space: nowrap; background: ${finalBg}; color: ${finalFg}; ${teamIndex === cutoffIndex ? 'border-right: 4px solid #FF6B35;' : (!isLast ? 'border-right: 2px solid #dee2e6;' : '')}">
                            <div style="font-size: 0.8rem; font-weight: 600;">${finalWins}Âãù ${finalLosses}Êïó ${finalDraws}ÂàÜ</div>
                            <div style="font-size: 0.7rem;">0.${teamScenario.finalWinRate.toFixed(3).split('.')[1]}</div>
                        </td>`;
                    } else {
                        html += `<td style="background: #f8f9fa; border: 1px solid #dee2e6;"></td><td style="background: #f8f9fa; border: 1px solid #dee2e6; ${teamIndex === cutoffIndex ? 'border-right: 4px solid #FF6B35;' : (!isLast ? 'border-right: 2px solid #dee2e6;' : '')}"></td>`;
                    }
                });
                html += `</tr>`;
            });

            html += `</tbody></table></div>`;
            return html;
        }

        function generateDetailedScenarios(topTeams) {
            let html = `
                <div style="margin-bottom: 15px;">
                    <h5 style="color: #2E7D32; margin-bottom: 10px;">üèÜ Ë©≥Á¥∞„Ç∑„Éä„É™„Ç™ÂàÜÊûê</h5>
                    <p style="font-size: 0.9rem; color: #666; margin-bottom: 15px;">CSÈÄ≤Âá∫ÂèØËÉΩÊÄß„ÅÆ„ÅÇ„ÇãÂÖ®„ÉÅ„Éº„É†„ÅÆÊÆã„ÇäË©¶Âêà„ÅÆÂãùÊïó„Éë„Çø„Éº„É≥„Å®„ÄÅ„Åù„Çå„Åû„Çå„ÅÆÊúÄÁµÇÊàêÁ∏æ„ÉªÂãùÁéá„ÇíË°®Á§∫„Åó„Åæ„Åô„ÄÇ</p>
                </div>
                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px;">`;

            topTeams.forEach((team, index) => {
                const colors = ['#e3f2fd', '#e8f5e8', '#fff3e0', '#f3e5f5', '#fce4ec'];
                const bgColor = colors[index] || '#f8f9fa';
                const meta = NPB_TEAM_META[team.team] || {};
                const logo = TEAM_LOGOS[team.team] ? `<img class=\"team-logo\" src=\"${TEAM_LOGOS[team.team]}\" alt=\"${meta.fullName || team.team}\">` : '';
                html += `
                    <div style="background: ${bgColor}; border: 1px solid #dee2e6; border-radius: 8px; padding: 15px;">
                        <h6 style="margin: 0 0 10px 0; color: #333; text-align: center; font-size: 1.1rem; font-weight: bold;">${team.rank}‰Ωç ${logo}${meta.fullName || team.team}</h6>
                        <div style="text-align: center; margin-bottom: 10px; font-size: 0.9rem; color: #666;">
                            ÁèæÂú®: ${team.wins}Âãù ${team.losses}Êïó ${team.draws || 0}ÂàÜ 0.${(team.winRate ?? (team.wins/(team.wins+team.losses))).toFixed(3).split('.')[1]}<br>
                            ÊÆã„Çä: ${team.remainingGames}Ë©¶Âêà
                        </div>
                        <table style="width: 100%; border-collapse: collapse; font-size: 0.8rem;">
                            <thead>
                                <tr style="background: rgba(0,0,0,0.05);">
                                    <th style="padding: 2px; border: 1px solid #ccc; width: 25px; text-align: center;">Âãù</th>
                                    <th style="padding: 2px; border: 1px solid #ccc; width: 25px; text-align: center;">Êïó</th>
                                    <th style="padding: 2px; border: 1px solid #ccc; width: 80px; text-align: center;">ÊúÄÁµÇÊàêÁ∏æ</th>
                                    <th style="padding: 2px; border: 1px solid #ccc; width: 50px; text-align: center;">ÊúÄÁµÇÂãùÁéá</th>
                                </tr>
                            </thead>
                            <tbody>`;

                for (let wins = team.remainingGames; wins >= 0; wins--) {
                    const losses = team.remainingGames - wins;
                    const finalWins = team.wins + wins;
                    const finalLosses = team.losses + losses;
                    const finalGames = finalWins + finalLosses + (team.draws || 0);
                    const finalWinRate = finalWins / finalGames;
                    const rowBg = getWinRateColor(finalWinRate);
                    html += `
                        <tr style="background: ${rowBg};">
                            <td style="padding: 2px; border: 1px solid #ccc; text-align: center; width: 25px;">${wins}</td>
                            <td style="padding: 2px; border: 1px solid #ccc; text-align: center; width: 25px;">${losses}</td>
                            <td style="padding: 2px; border: 1px solid #ccc; text-align: center; width: 80px; font-size: 0.75rem;">${finalWins}-${finalLosses}-${team.draws || 0}</td>
                            <td style="padding: 2px; border: 1px solid #ccc; text-align: center; font-weight: 600; width: 50px;">0.${(finalWinRate).toFixed(3).split('.')[1]}</td>
                        </tr>`;
                }

                html += `
                            </tbody>
                        </table>
                    </div>`;
            });

            html += `</div>`;
            return html;
        }

        function getWinRateColor(winRate) {
            // Light blue tones for higher win rates, light red for lower
            if (winRate >= 0.700) return '#BBDEFB';
            if (winRate >= 0.650) return '#CDE5FD';
            if (winRate >= 0.600) return '#E3F2FD';
            if (winRate >= 0.550) return '#F1F8FF';
            if (winRate >= 0.500) return '#F6FAFF';
            if (winRate >= 0.450) return '#FFECEC';
            if (winRate >= 0.400) return '#FFE3E3';
            return '#FFD9D9';
        }

        function getWinRateBackgroundColor(winRate) {
            // Solid colors for readability (no gradients)
            if (winRate > 0.5) return '#E3F2FD';   // light blue
            if (winRate < 0.5) return '#FFEBEE';   // light red
            return '#ECEFF1';                      // blue-gray for exactly .500
        }

        function getWinRateTextColor(winRate) {
            if (winRate > 0.5) return '#0D47A1';  // dark blue text on light blue
            if (winRate < 0.5) return '#C62828';  // dark red text on light red
            return '#37474F';                    // blue-gray text on neutral
        }

        // ===== ÊÆã„ÇäË©¶ÂêàÊï∞Êõ¥Êñ∞ =====
        function updateRemainingGames() {
            updateRemainingMatrix('central-remaining-matrix', standingsData.central_league?.standings || [], 'central');
            updateRemainingMatrix('pacific-remaining-matrix', standingsData.pacific_league?.standings || [], 'pacific');
        }

        // ===== ÂØæÊà¶ÊàêÁ∏æÊõ¥Êñ∞ =====
        function updateH2HRecords() {
            // Ï∫êÏãú Ï¥àÍ∏∞Ìôî (ÏÉàÎ°úÏö¥ Îç∞Ïù¥ÌÑ∞Î°ú Îã§Ïãú Í≥ÑÏÇ∞ÌïòÍ∏∞ ÏúÑÌï¥)
            cachedH2HData = null;

            updateH2HMatrix('central-h2h-matrix', standingsData.central_league?.standings || [], 'central');
            updateH2HMatrix('pacific-h2h-matrix', standingsData.pacific_league?.standings || [], 'pacific');
        }

        // ===== Ïã§Ï†ú Í≤ΩÍ∏∞ Í≤∞Í≥ºÏóêÏÑú ÎåÄÏ†ÑÏÑ±Ï†Å Í≥ÑÏÇ∞ (Ï∫êÏãúÎêú Í≤∞Í≥º ÏÇ¨Ïö©) =====
        let cachedH2HData = null;

        function calculateH2HRecords() {
            // Ïù¥ÎØ∏ Í≥ÑÏÇ∞Îêú Í≤∞Í≥ºÍ∞Ä ÏûàÏúºÎ©¥ Ï∫êÏãúÎêú Í≤∞Í≥º Î∞òÌôò
            if (cachedH2HData) {
                return cachedH2HData;
            }

            const h2hData = {};

            // Î™®Îì† ÌåÄÏóê ÎåÄÌï¥ Ï¥àÍ∏∞Ìôî (Î¶¨Í∑∏ ÌïÑÌÑ∞ÎßÅ ÏóÜÏù¥)
            const allTeamCodes = ['YOG', 'YAK', 'YDB', 'HAN', 'HIR', 'CHU', 'SOF', 'NIP', 'SEI', 'RAK', 'ORI', 'LOT'];

            allTeamCodes.forEach(teamCode => {
                h2hData[teamCode] = {};
                allTeamCodes.forEach(opponentCode => {
                    if (teamCode !== opponentCode) {
                        h2hData[teamCode][opponentCode] = {
                            wins: 0,
                            losses: 0,
                            draws: 0
                        };
                    }
                });
            });

            // games.json Îç∞Ïù¥ÌÑ∞ ÏÇ¨Ïö©
            if (window.gamesData && Array.isArray(window.gamesData)) {
                window.gamesData.forEach(game => {
                    // Ïó∞Í∏∞Îêú Í≤ΩÍ∏∞Îäî Í±¥ÎÑàÎõ∞Í∏∞
                    if (game.game_status === 'postponed') {
                        return;
                    }

                    const homeTeam = game.home_team_abbr;
                    const awayTeam = game.away_team_abbr;
                    const homeScore = game.home_score;
                    const awayScore = game.away_score;

                    if (h2hData[homeTeam] && h2hData[awayTeam]) {
                        if (game.is_draw) {
                            // Î¨¥ÏäπÎ∂Ä
                            h2hData[homeTeam][awayTeam].draws++;
                            h2hData[awayTeam][homeTeam].draws++;
                        } else if (homeScore > awayScore) {
                            // ÌôàÌåÄ ÏäπÎ¶¨
                            h2hData[homeTeam][awayTeam].wins++;
                            h2hData[awayTeam][homeTeam].losses++;
                        } else {
                            // ÏõêÏ†ïÌåÄ ÏäπÎ¶¨
                            h2hData[homeTeam][awayTeam].losses++;
                            h2hData[awayTeam][homeTeam].wins++;
                        }
                    }
                });
            }
            // gamesRawDataÍ∞Ä ÏûàÎã§Î©¥ Ïã§Ï†ú Í≤ΩÍ∏∞ Í≤∞Í≥º ÌååÏã± (Ìè¥Î∞±)
            else if (window.gamesRawData) {
                const teamNameMap = {
                    'Â∑®‰∫∫': 'YOG', '„É§„ÇØ„É´„Éà': 'YAK', 'Ôº§ÔΩÖÔºÆÔº°': 'YDB', 'Èò™Á•û': 'HAN', 'Â∫ÉÂ≥∂': 'HIR', '‰∏≠Êó•': 'CHU',
                    '„ÇΩ„Éï„Éà„Éê„É≥„ÇØ': 'SOF', 'Êó•Êú¨„Éè„É†': 'NIP', 'Ë•øÊ≠¶': 'SEI', 'Ê•ΩÂ§©': 'RAK', '„Ç™„É™„ÉÉ„ÇØ„Çπ': 'ORI', '„É≠„ÉÉ„ÉÜ': 'LOT'
                };

                const gameLines = window.gamesRawData.split('\n');
                gameLines.forEach(line => {
                    line = line.trim();
                    if (line.includes('[POSTPONED]') || line.startsWith('#') || line === '') {
                        return;
                    }

                    const gameMatch = line.match(/^(.+?)\s+(\d+)-(\d+)\s+(.+?)\s+\(.*?\)/);
                    if (gameMatch) {
                        const [, team1Name, score1, score2, team2Name] = gameMatch;
                        const team1Code = teamNameMap[team1Name.trim()];
                        const team2Code = teamNameMap[team2Name.trim()];

                        if (team1Code && team2Code && h2hData[team1Code] && h2hData[team2Code]) {
                            const team1Score = parseInt(score1);
                            const team2Score = parseInt(score2);

                            if (team1Score > team2Score) {
                                h2hData[team1Code][team2Code].wins++;
                                h2hData[team2Code][team1Code].losses++;
                            } else if (team2Score > team1Score) {
                                h2hData[team1Code][team2Code].losses++;
                                h2hData[team2Code][team1Code].wins++;
                            } else {
                                h2hData[team1Code][team2Code].draws++;
                                h2hData[team2Code][team1Code].draws++;
                            }
                        }
                    }
                });
            }

            // Í≥ÑÏÇ∞Îêú Í≤∞Í≥ºÎ•º Ï∫êÏãúÏóê Ï†ÄÏû•
            cachedH2HData = h2hData;
            return h2hData;
        }

        // ===== ÂØæÊà¶ÊàêÁ∏æ„Éû„Éà„É™„ÇØ„ÇπÊõ¥Êñ∞ÔºàÂÖ±ÈÄöÈñ¢Êï∞Ôºâ =====
        function updateH2HMatrix(containerId, teams, leagueType) {
            const container = document.getElementById(containerId);
            if (!teams.length) {
                container.innerHTML = '<div class="loading">„Éá„Éº„Çø„Åå„ÅÇ„Çä„Åæ„Åõ„Çì</div>';
                return;
            }

            // ‰∏°„É™„Éº„Ç∞„ÅÆÂÖ®„ÉÅ„Éº„É†„ÇíÂèñÂæó
            const allTeams = [
                ...(standingsData.central_league?.standings || []),
                ...(standingsData.pacific_league?.standings || [])
            ];

            // ÁèæÂú®„ÅÆ„É™„Éº„Ç∞„ÅÆ„ÉÅ„Éº„É†„ÇíÈ†Ü‰ΩçÈ†Ü„Å´„ÇΩ„Éº„Éà
            const sortedCurrentLeagueTeams = [...teams].sort((a, b) => a.rank - b.rank);

            // Áõ∏Êâã„ÉÅ„Éº„É†ÔºàÂÖ®12„ÉÅ„Éº„É†Ôºâ„ÇíÊ∫ñÂÇô
            const currentLeague = leagueType === 'central' ? 'Central' : 'Pacific';
            const sameLeagueTeams = allTeams.filter(t => t.league === currentLeague).sort((a, b) => a.rank - b.rank);
            const otherLeagueTeams = allTeams.filter(t => t.league !== currentLeague).sort((a, b) => a.rank - b.rank);
            const opponentTeams = [...sameLeagueTeams, ...otherLeagueTeams];

            // „Ç∞„É™„ÉÉ„Éâ„ÅÆ„Ç´„É©„É†Êï∞„ÇíË®≠ÂÆö („ÉÅ„Éº„É†Âêç + ÂÖ®12„ÉÅ„Éº„É† + ÂêàË®à)
            container.style.gridTemplateColumns = `180px repeat(12, 70px) 80px`;

            let matrixHTML = '';

            // „Éò„ÉÉ„ÉÄ„ÉºË°å - Áõ∏Êâã„ÉÅ„Éº„É†Âêç (ÂÖ®12„ÉÅ„Éº„É†)
            matrixHTML += '<div class="matrix-cell matrix-corner" style="font-weight: bold; font-size: 12px; display: flex; justify-content: center;">vs Áõ∏Êâã„ÉÅ„Éº„É†</div>';
            opponentTeams.forEach(team => {
                const isInterleague = team.league !== currentLeague;
                const teamAbbr = team.team_abbreviation;

                // ÏùºÎ≥∏Ïñ¥ Ï∂ïÏïΩÌòï Îß§Ìïë
                const japaneseNames = {
                    'YOG': 'Â∑®‰∫∫', 'YAK': '„É§„ÇØ„É´„Éà', 'YDB': 'DeNA', 'HAN': 'Èò™Á•û', 'HIR': 'Â∫ÉÂ≥∂', 'CHU': '‰∏≠Êó•',
                    'SOF': '„ÇΩ„Éï„Éà„Éê„É≥„ÇØ', 'NIP': 'Êó•Êú¨„Éè„É†', 'SEI': 'Ë•øÊ≠¶', 'RAK': 'Ê•ΩÂ§©', 'ORI': '„Ç™„É™„ÉÉ„ÇØ„Çπ', 'LOT': '„É≠„ÉÉ„ÉÜ'
                };

                const teamLogo = TEAM_LOGOS[teamAbbr] ? `<img class="team-logo" src="${TEAM_LOGOS[teamAbbr]}" alt="${teamAbbr}" loading="lazy">` : '';
                const japaneseShort = japaneseNames[teamAbbr] || teamAbbr;
                const bgStyle = isInterleague ? 'background: #fff3e0;' : '';

                matrixHTML += `<div class="matrix-cell matrix-header-opponent" style="${bgStyle} font-size: 12px; padding: 4px;">
                    ${teamLogo}<br>
                    <span style="font-weight: bold;">${japaneseShort}</span>
                </div>`;
            });
            matrixHTML += '<div class="matrix-cell matrix-corner" style="font-weight: bold; font-size: 12px; display: flex; justify-content: center;">ÂêàË®à</div>';

            // Ïã§Ï†ú Í≤ΩÍ∏∞ Í≤∞Í≥ºÏóêÏÑú ÎåÄÏ†ÑÏÑ±Ï†Å Í≥ÑÏÇ∞
            const h2hData = calculateH2HRecords();

            // Í∞Å ÌåÄ Ìñâ ÏÉùÏÑ±
            sortedCurrentLeagueTeams.forEach(homeTeam => {
                let rowTotalWins = 0;
                let rowTotalLosses = 0;
                let rowTotalDraws = 0;

                // ÌåÄÎ™Ö ÌëúÏãú
                const teamLogo = TEAM_LOGOS[homeTeam.team_abbreviation] ? `<img class="team-logo" src="${TEAM_LOGOS[homeTeam.team_abbreviation]}" alt="${homeTeam.team_name}" loading="lazy">` : '';
                const japaneseNames = {
                    'YOG': 'Ë™≠Â£≤„Ç∏„É£„Ç§„Ç¢„É≥„ÉÑ', 'YAK': 'Êù±‰∫¨„É§„ÇØ„É´„Éà„Çπ„ÉØ„É≠„Éº„Ç∫', 'YDB': 'Ê®™ÊµúDeNA„Éô„Ç§„Çπ„Çø„Éº„Ç∫',
                    'HAN': 'Èò™Á•û„Çø„Ç§„Ç¨„Éº„Çπ', 'HIR': 'Â∫ÉÂ≥∂Êù±Ê¥ã„Ç´„Éº„Éó', 'CHU': '‰∏≠Êó•„Éâ„É©„Ç¥„É≥„Ç∫',
                    'SOF': '„ÇΩ„Éï„Éà„Éê„É≥„ÇØ„Éõ„Éº„ÇØ„Çπ', 'NIP': 'ÂåóÊµ∑ÈÅìÊó•Êú¨„Éè„É†', 'SEI': 'ÂüºÁéâË•øÊ≠¶„É©„Ç§„Ç™„É≥„Ç∫',
                    'RAK': 'Êù±ÂåóÊ•ΩÂ§©', 'ORI': '„Ç™„É™„ÉÉ„ÇØ„Çπ', 'LOT': 'ÂçÉËëâ„É≠„ÉÉ„ÉÜ„Éû„É™„Éº„É≥„Ç∫'
                };

                const japaneseShort = japaneseNames[homeTeam.team_abbreviation] || homeTeam.team_name;

                matrixHTML += `<div class="matrix-cell matrix-header-team" style="font-size: 12px; padding: 4px; display: flex; align-items: center;">
                    ${teamLogo}<span style="font-weight: bold;">${japaneseShort}</span>
                </div>`;

                // Í∞Å ÏÉÅÎåÄÌåÄÍ≥ºÏùò ÏÑ±Ï†Å ÌëúÏãú
                opponentTeams.forEach(awayTeam => {
                    if (homeTeam.team_abbreviation === awayTeam.team_abbreviation) {
                        // ÏûêÌåÄ
                        matrixHTML += '<div class="matrix-cell matrix-data-cell" style="background: #f5f5f5; color: #999; font-weight: bold; display: flex; justify-content: center;">-</div>';
                    } else {
                        // ÎåÄÏ†ÑÏÑ±Ï†Å ÌëúÏãú (Ïäπ-Ìå®-Î¨¥)
                        const record = h2hData[homeTeam.team_abbreviation]?.[awayTeam.team_abbreviation] || {wins: 0, losses: 0, draws: 0};
                        const isInterleague = homeTeam.league !== awayTeam.league;

                        // ÏÑ±Ï†ÅÏóê Îî∞Î•∏ Î∞∞Í≤ΩÏÉâ Í≤∞Ï†ï
                        let bgColor = '';
                        const totalGames = record.wins + record.losses + record.draws;

                        if (totalGames > 0) {
                            if (record.wins > record.losses) {
                                // Ïö∞ÏÑ∏ (Ïäπ > Ìå®) - ÎÖπÏÉâ Í≥ÑÏó¥
                                bgColor = isInterleague ? 'background: #e8f5e8;' : 'background: #f0f8f0;';
                            } else if (record.wins < record.losses) {
                                // Ïó¥ÏÑ∏ (Ïäπ < Ìå®) - Îπ®Í∞ÑÏÉâ Í≥ÑÏó¥
                                bgColor = isInterleague ? 'background: #fdeaea;' : 'background: #fdf2f2;';
                            } else {
                                // ÎèôÎ•† - Í∏∞Î≥∏ÏÉâ
                                bgColor = isInterleague ? 'background: #fff8e1;' : '';
                            }
                        } else {
                            // Í≤ΩÍ∏∞ ÏóÜÏùå - Í∏∞Î≥∏ÏÉâ
                            bgColor = isInterleague ? 'background: #fff8e1;' : '';
                        }

                        matrixHTML += `<div class="matrix-cell matrix-data-cell" style="${bgColor} font-weight: bold; display: flex; justify-content: center; font-size: 12px;">${record.wins} - ${record.losses} - ${record.draws}</div>`;
                        rowTotalWins += record.wins;
                        rowTotalLosses += record.losses;
                        rowTotalDraws += record.draws;
                    }
                });

                // ÌñâÏùò Ï¥ù Í≤ΩÍ∏∞Ïàò
                const rowTotalGames = rowTotalWins + rowTotalLosses + rowTotalDraws;
                matrixHTML += `<div class="matrix-cell matrix-total-cell" style="font-weight: bold; color: #1976d2; display: flex; justify-content: center; font-size: 12px;">${rowTotalGames}</div>`;
            });

            // ÏµúÏ¢ÖÌñâ: Í∞Å Ïó¥Ïùò Ìï©Í≥Ñ (ÏÉÅÎåÄÌåÄÎ≥Ñ Ï¥ù ÏÑ±Ï†Å)
            matrixHTML += '<div class="matrix-cell matrix-corner" style="font-weight: bold; font-size: 12px; display: flex; justify-content: center;">ÂêàË®à</div>';
            opponentTeams.forEach(awayTeam => {
                let columnTotalWins = 0;
                let columnTotalLosses = 0;
                let columnTotalDraws = 0;
                sortedCurrentLeagueTeams.forEach(homeTeam => {
                    if (homeTeam.team_abbreviation !== awayTeam.team_abbreviation) {
                        columnTotalWins += h2hData[homeTeam.team_abbreviation]?.[awayTeam.team_abbreviation]?.wins || 0;
                        columnTotalLosses += h2hData[homeTeam.team_abbreviation]?.[awayTeam.team_abbreviation]?.losses || 0;
                        columnTotalDraws += h2hData[homeTeam.team_abbreviation]?.[awayTeam.team_abbreviation]?.draws || 0;
                    }
                });
                const isInterleague = awayTeam.league !== currentLeague;
                const bgStyle = isInterleague ? 'background: #fff3e0;' : '';
                const columnTotalGames = columnTotalWins + columnTotalLosses + columnTotalDraws;
                matrixHTML += `<div class="matrix-cell matrix-total-cell" style="${bgStyle} font-weight: bold; color: #1976d2; display: flex; justify-content: center; font-size: 12px;">${columnTotalGames}</div>`;
            });

            // Ï¥ùÌï©Í≥Ñ (Ï†ÑÏ≤¥ Ïäπ-Ìå®-Î¨¥)
            let grandTotalWins = 0;
            let grandTotalLosses = 0;
            let grandTotalDraws = 0;
            sortedCurrentLeagueTeams.forEach(homeTeam => {
                opponentTeams.forEach(awayTeam => {
                    if (homeTeam.team_abbreviation !== awayTeam.team_abbreviation) {
                        grandTotalWins += h2hData[homeTeam.team_abbreviation]?.[awayTeam.team_abbreviation]?.wins || 0;
                        grandTotalLosses += h2hData[homeTeam.team_abbreviation]?.[awayTeam.team_abbreviation]?.losses || 0;
                        grandTotalDraws += h2hData[homeTeam.team_abbreviation]?.[awayTeam.team_abbreviation]?.draws || 0;
                    }
                });
            });
            const grandTotalGames = grandTotalWins + grandTotalLosses + grandTotalDraws;
            matrixHTML += `<div class="matrix-cell matrix-corner" style="font-weight: bold; color: white; font-size: 14px; display: flex; justify-content: center;">${grandTotalGames}</div>`;

            container.innerHTML = matrixHTML;
        }

        // ===== „Ç∑„Éº„Ç∫„É≥ÈÄ≤Ë°åÁä∂Ê≥ÅÊõ¥Êñ∞ =====
        function updateProgress() {
            updateOverallProgress();
            updateTeamProgress('central-progress', standingsData.central_league?.standings || []);
            updateTeamProgress('pacific-progress', standingsData.pacific_league?.standings || []);
            updateProgressStats();
        }

        function updateOverallProgress() {
            const allTeams = [
                ...(standingsData.central_league?.standings || []),
                ...(standingsData.pacific_league?.standings || [])
            ];
            
            if (!allTeams.length) return;
            
            // Ïã§Ï†ú ÏãúÏ¶å Ï¥ù Í≤ΩÍ∏∞ Ïàò: Í∞Å ÌåÄ 143Í≤ΩÍ∏∞ √ó 12ÌåÄ √∑ 2 (Í∞Å Í≤ΩÍ∏∞Îäî 2ÌåÄ Ï∞∏Ïó¨)
            const totalSeasonGames = (allTeams.length * TOTAL_GAMES) / 2;  // 858Í≤ΩÍ∏∞
            
            // ÌòÑÏû¨ÍπåÏßÄ ÏôÑÎ£åÎêú Í≤ΩÍ∏∞ Ïàò: Î™®Îì† ÌåÄÏùò Í≤ΩÍ∏∞ Ïàò Ìï©Í≥Ñ √∑ 2
            const totalGamesPlayed = allTeams.reduce((sum, team) => sum + (team.games_played || 0), 0) / 2;
            
            const progressPercentage = (totalGamesPlayed / totalSeasonGames) * 100;
            const remainingGames = totalSeasonGames - totalGamesPlayed;
            
            // UI ÏóÖÎç∞Ïù¥Ìä∏
            const percentageEl = document.getElementById('overall-percentage');
            const progressFillEl = document.getElementById('overall-progress-fill');
            const completedEl = document.getElementById('completed-games');
            const remainingEl = document.getElementById('remaining-total');
            const totalEl = document.getElementById('total-season-games');
            
            if (percentageEl) percentageEl.textContent = `${progressPercentage.toFixed(1)}%`;
            if (progressFillEl) progressFillEl.style.width = `${progressPercentage}%`;
            if (completedEl) completedEl.textContent = totalGamesPlayed.toLocaleString();
            if (remainingEl) remainingEl.textContent = remainingGames.toLocaleString();
            if (totalEl) totalEl.textContent = totalSeasonGames.toLocaleString();
        }

        function updateTeamProgress(containerId, teams) {
            const container = document.getElementById(containerId);
            if (!container || !teams.length) return;
            
            let html = '';
            
            // ÌåÄÏùÑ ÏßÑÌñâÎ•† ÏàúÏúºÎ°ú Ï†ïÎ†¨
            const sortedTeams = teams.slice().sort((a, b) => (b.games_played || 0) - (a.games_played || 0));
            
            sortedTeams.forEach(team => {
                const gamesPlayed = team.games_played || 0;
                const progressPercentage = (gamesPlayed / TOTAL_GAMES) * 100;
                const remaining = TOTAL_GAMES - gamesPlayed;

                const teamMeta = NPB_TEAM_META[team.team_abbreviation] || {};
                let barColor = teamMeta.color || '#4caf50';
                if (!teamMeta.color) {
                    if (progressPercentage < 50) {
                        barColor = '#ff9800';
                    } else if (progressPercentage < 70) {
                        barColor = '#ffeb3b';
                    } else if (progressPercentage > 90) {
                        barColor = '#2e7d32';
                    }
                }
                
                html += `
                    <div class="team-progress-item">
                        <div class="team-progress-header">
                            <div class="team-progress-name" style="color: ${barColor};">${renderTeamLabel(team.team_abbreviation, team.team_name, true)}</div>
                            <div class="team-progress-text" style="color: ${barColor};">${progressPercentage.toFixed(1)}%</div>
                        </div>
                        <div class="team-progress-bar">
                            <div class="team-progress-fill" style="width: ${progressPercentage}%; background: ${barColor};"></div>
                        </div>
                        <div class="team-progress-summary">
                            <span class="summary-completed">ÂÆå‰∫Ü: ${gamesPlayed.toLocaleString()}Ë©¶Âêà</span>
                            <span class="summary-remaining">ÊÆã„Çä: ${remaining.toLocaleString()}Ë©¶Âêà</span>
                            <span class="summary-total">Á∑èË©¶ÂêàÊï∞: ${TOTAL_GAMES.toLocaleString()}Ë©¶Âêà</span>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        function updateProgressStats() {
            const allTeams = [
                ...(standingsData.central_league?.standings || []),
                ...(standingsData.pacific_league?.standings || [])
            ];
            
            if (!allTeams.length) return;
            
            const progressRates = allTeams.map(team => (team.games_played || 0) / TOTAL_GAMES * 100);
            const averageProgress = progressRates.reduce((sum, rate) => sum + rate, 0) / progressRates.length;
            
            const maxProgress = Math.max(...progressRates);
            const minProgress = Math.min(...progressRates);
            
            const highestTeam = allTeams.find(team => (team.games_played || 0) / TOTAL_GAMES * 100 === maxProgress);
            const lowestTeam = allTeams.find(team => (team.games_played || 0) / TOTAL_GAMES * 100 === minProgress);
            
            const maxGames = Math.max(...allTeams.map(team => team.games_played || 0));
            const minGames = Math.min(...allTeams.map(team => team.games_played || 0));
            const progressGap = maxGames - minGames;
            
            // UI ÏóÖÎç∞Ïù¥Ìä∏
            const averageEl = document.getElementById('average-progress');
            const highestEl = document.getElementById('highest-team');
            const lowestEl = document.getElementById('lowest-team');
            const gapEl = document.getElementById('progress-gap');
            
            if (averageEl) averageEl.textContent = `${averageProgress.toFixed(1)}%`;
            if (highestEl) highestEl.innerHTML = renderTeamLabel(highestTeam?.team_abbreviation, highestTeam?.team_name, true) || '‚Äî';
            if (lowestEl) lowestEl.innerHTML = renderTeamLabel(lowestTeam?.team_abbreviation, lowestTeam?.team_name, true) || '‚Äî';
            if (gapEl) gapEl.textContent = `${progressGap}Ë©¶Âêà`;
        }

        // ===== ÊÆã„ÇäË©¶Âêà„Éû„Éà„É™„ÇØ„ÇπÊõ¥Êñ∞ÔºàÂÖ±ÈÄöÈñ¢Êï∞Ôºâ =====
        function updateRemainingMatrix(containerId, teams, leagueType) {
            const container = document.getElementById(containerId);
            if (!teams.length) {
                container.innerHTML = '<div class="loading">„Éá„Éº„Çø„Åå„ÅÇ„Çä„Åæ„Åõ„Çì</div>';
                return;
            }

            // ‰∏°„É™„Éº„Ç∞„ÅÆÂÖ®„ÉÅ„Éº„É†„ÇíÂèñÂæó
            const allTeams = [
                ...(standingsData.central_league?.standings || []),
                ...(standingsData.pacific_league?.standings || [])
            ];

            // ÁèæÂú®„ÅÆ„É™„Éº„Ç∞„ÅÆ„ÉÅ„Éº„É†„ÇíÈ†Ü‰ΩçÈ†Ü„Å´„ÇΩ„Éº„Éà
            const sortedCurrentLeagueTeams = [...teams].sort((a, b) => a.rank - b.rank);

            // Áõ∏Êâã„ÉÅ„Éº„É†ÔºàÂÖ®12„ÉÅ„Éº„É†Ôºâ„ÇíÊ∫ñÂÇô - ÁèæÂú®„ÅÆ„É™„Éº„Ç∞ÂÑ™ÂÖà„ÄÅÊ¨°„Å´‰ªñ„É™„Éº„Ç∞
            // leagueTypeÏù¥ 'central' ÎòêÎäî 'pacific'Ïù∏ÏßÄ ÌôïÏù∏ÌïòÍ≥† league ÌïÑÎìúÏôÄ Îß§Ïπ≠
            const currentLeague = leagueType === 'central' ? 'Central' : 'Pacific';
            const sameLeagueTeams = allTeams.filter(t => t.league === currentLeague).sort((a, b) => a.rank - b.rank);
            const otherLeagueTeams = allTeams.filter(t => t.league !== currentLeague).sort((a, b) => a.rank - b.rank);
            const opponentTeams = [...sameLeagueTeams, ...otherLeagueTeams];

            // „Ç∞„É™„ÉÉ„Éâ„ÅÆ„Ç´„É©„É†Êï∞„ÇíË®≠ÂÆö („ÉÅ„Éº„É†Âêç + ÂÖ®12„ÉÅ„Éº„É† + ÂêàË®à)
            container.style.gridTemplateColumns = `180px repeat(12, 70px) 80px`;

            let matrixHTML = '';

            // „Éò„ÉÉ„ÉÄ„ÉºË°å - Áõ∏Êâã„ÉÅ„Éº„É†Âêç (ÂÖ®12„ÉÅ„Éº„É†)
            matrixHTML += '<div class="matrix-cell matrix-corner" style="font-weight: bold; font-size: 12px; display: flex; justify-content: center;">vs Áõ∏Êâã„ÉÅ„Éº„É†</div>';
            opponentTeams.forEach(team => {
                const isInterleague = team.league !== currentLeague;
                const teamAbbr = team.team_abbreviation;

                // ÏùºÎ≥∏Ïñ¥ Ï∂ïÏïΩÌòï Îß§Ìïë
                const japaneseNames = {
                    'YOG': 'Â∑®‰∫∫', 'YAK': '„É§„ÇØ„É´„Éà', 'YDB': 'DeNA', 'HAN': 'Èò™Á•û', 'HIR': 'Â∫ÉÂ≥∂', 'CHU': '‰∏≠Êó•',
                    'SOF': '„ÇΩ„Éï„Éà„Éê„É≥„ÇØ', 'NIP': 'Êó•Êú¨„Éè„É†', 'SEI': 'Ë•øÊ≠¶', 'RAK': 'Ê•ΩÂ§©', 'ORI': '„Ç™„É™„ÉÉ„ÇØ„Çπ', 'LOT': '„É≠„ÉÉ„ÉÜ'
                };

                const teamLogo = TEAM_LOGOS[teamAbbr] ?
                    `<img class="team-logo" src="${TEAM_LOGOS[teamAbbr]}" alt="${teamAbbr}" style="width: 16px; height: 16px; margin-bottom: 2px;" loading="lazy">` : '';

                const japaneseShort = japaneseNames[teamAbbr] || teamAbbr;
                const bgStyle = isInterleague ? 'background: #fff3e0;' : '';

                matrixHTML += `<div class="matrix-cell matrix-header-opponent" style="${bgStyle} font-size: 12px; padding: 4px;">
                    ${teamLogo}<br>
                    <span style="font-weight: bold;">${japaneseShort}</span>
                </div>`;
            });
            matrixHTML += '<div class="matrix-cell matrix-corner" style="font-weight: bold; font-size: 12px; display: flex; justify-content: center;">ÂêàË®à</div>';

            // ÊÆã„ÇäË©¶Âêà„Éû„Éà„É™„ÇØ„Çπ„Éá„Éº„Çø„ÇíÊßãÁØâ (Ìôà+ÏõêÏ†ï Î™®Îì† Í≤ΩÍ∏∞)
            const matrixData = {};
            if (upcomingGamesData && Array.isArray(upcomingGamesData)) {
                upcomingGamesData.forEach(game => {
                    if (game.game_status !== 'scheduled') return;

                    const homeAbbr = game.home_team_abbr;
                    const awayAbbr = game.away_team_abbr;

                    // ÌôàÌåÄ Í¥ÄÏ†êÏóêÏÑú ÏõêÏ†ïÌåÄÍ≥ºÏùò Í≤ΩÍ∏∞
                    if (!matrixData[homeAbbr]) matrixData[homeAbbr] = {};
                    if (!matrixData[homeAbbr][awayAbbr]) matrixData[homeAbbr][awayAbbr] = 0;
                    matrixData[homeAbbr][awayAbbr]++;

                    // ÏõêÏ†ïÌåÄ Í¥ÄÏ†êÏóêÏÑú ÌôàÌåÄÍ≥ºÏùò Í≤ΩÍ∏∞ (Í∞ôÏùÄ Í≤ΩÍ∏∞Î•º ÏñëÎ∞©Ìñ•ÏúºÎ°ú Ïπ¥Ïö¥Ìä∏)
                    if (!matrixData[awayAbbr]) matrixData[awayAbbr] = {};
                    if (!matrixData[awayAbbr][homeAbbr]) matrixData[awayAbbr][homeAbbr] = 0;
                    matrixData[awayAbbr][homeAbbr]++;
                });
            }

            // „Éá„Éº„ÇøË°å
            sortedCurrentLeagueTeams.forEach(homeTeam => {
                // „ÉÅ„Éº„É†ÂêçÔºàÏôºÏ™ΩÔºâ
                const teamAbbr = homeTeam.team_abbreviation;

                // ÏùºÎ≥∏Ïñ¥ Ï∂ïÏïΩÌòï Îß§Ìïë
                const japaneseNames = {
                    'YOG': 'Â∑®‰∫∫', 'YAK': '„É§„ÇØ„É´„Éà', 'YDB': 'DeNA', 'HAN': 'Èò™Á•û', 'HIR': 'Â∫ÉÂ≥∂', 'CHU': '‰∏≠Êó•',
                    'SOF': '„ÇΩ„Éï„Éà„Éê„É≥„ÇØ', 'NIP': 'Êó•Êú¨„Éè„É†', 'SEI': 'Ë•øÊ≠¶', 'RAK': 'Ê•ΩÂ§©', 'ORI': '„Ç™„É™„ÉÉ„ÇØ„Çπ', 'LOT': '„É≠„ÉÉ„ÉÜ'
                };

                const teamLogo = TEAM_LOGOS[teamAbbr] ?
                    `<img class="team-logo" src="${TEAM_LOGOS[teamAbbr]}" alt="${teamAbbr}" style="width: 18px; height: 18px; vertical-align: middle; margin-right: 4px;" loading="lazy">` : '';

                const japaneseShort = japaneseNames[teamAbbr] || teamAbbr;

                matrixHTML += `<div class="matrix-cell matrix-header-team" style="font-size: 12px; padding: 4px; display: flex; align-items: center;">
                    ${teamLogo}<span style="font-weight: bold;">${japaneseShort}</span>
                </div>`;

                let rowTotal = 0;

                // ÂÖ®12„ÉÅ„Éº„É†„Å®„ÅÆÂØæÊà¶Êï∞
                opponentTeams.forEach(awayTeam => {
                    if (homeTeam.team_abbreviation === awayTeam.team_abbreviation) {
                        // Ëá™„ÉÅ„Éº„É†
                        matrixHTML += '<div class="matrix-cell matrix-data-cell" style="background: #f5f5f5; color: #999; font-weight: bold; display: flex; justify-content: center;">-</div>';
                    } else {
                        // ÊÆã„ÇäË©¶ÂêàÊï∞„ÇíÂèñÂæó (Ìôà+ÏõêÏ†ï Î™®Îì† Í≤ΩÍ∏∞)
                        const remainingGames = matrixData[homeTeam.team_abbreviation]?.[awayTeam.team_abbreviation] || 0;

                        const isInterleague = homeTeam.league !== awayTeam.league;
                        const cellClass = remainingGames > 0 ? 'has-games' : 'zero';
                        const cellStyle = isInterleague ? 'background: #fff8e1;' : '';

                        matrixHTML += `<div class="matrix-cell matrix-data-cell ${cellClass}" style="${cellStyle} font-weight: bold; display: flex; justify-content: center;">${remainingGames}</div>`;
                        rowTotal += remainingGames;
                    }
                });

                // ÌñâÏùò Ìï©Í≥Ñ - Ïã§Ï†ú ÎÇ®ÏùÄ Í≤ΩÍ∏∞ Ïàò (Ïä§ÌÉ†Îî© Í∏∞Î∞ò)
                const trueRemaining = Math.max(0, TOTAL_GAMES - (homeTeam.games_played || (homeTeam.wins + homeTeam.losses + (homeTeam.draws || 0))));
                const needsNote = rowTotal !== trueRemaining;
                const noteHtml = needsNote ? `<div style="font-size: 10px; color: #555;">‰∫àÂÆö:${rowTotal}</div>` : '';

                matrixHTML += `<div class="matrix-cell matrix-total-cell" style="font-weight: bold; color: #1976d2; justify-content: center; line-height: 1.1;">${trueRemaining}${noteHtml}</div>`;
            });

            // ÊúÄÁµÇË°å: ÂêÑÂàó„ÅÆÂêàË®àÔºàÏïÑÏõ®Ïù¥ Í≤ΩÍ∏∞ÏàòÔºâ
            matrixHTML += '<div class="matrix-cell matrix-corner" style="font-weight: bold; font-size: 12px; display: flex; justify-content: center;">ÂêàË®à</div>';
            opponentTeams.forEach(awayTeam => {
                let columnTotal = 0;
                sortedCurrentLeagueTeams.forEach(homeTeam => {
                    if (homeTeam.team_abbreviation !== awayTeam.team_abbreviation) {
                        columnTotal += matrixData[homeTeam.team_abbreviation]?.[awayTeam.team_abbreviation] || 0;
                    }
                });
                const isInterleague = awayTeam.league !== currentLeague;
                const bgStyle = isInterleague ? 'background: #fff3e0;' : '';
                matrixHTML += `<div class="matrix-cell matrix-total-cell" style="${bgStyle} font-weight: bold; color: #1976d2; justify-content: center;">${columnTotal}</div>`;
            });

            // Ï¥ùÌï©Í≥Ñ - Ïã§Ï†ú Ìñâ Ìï©Í≥ÑÎì§Ïùò Ï¥ùÌï©
            const grandTotal = sortedCurrentLeagueTeams.reduce((sum, homeTeam) => {
                return sum + Math.max(0, TOTAL_GAMES - (homeTeam.games_played || (homeTeam.wins + homeTeam.losses + (homeTeam.draws || 0))));
            }, 0);
            matrixHTML += `<div class="matrix-cell matrix-corner" style="font-weight: bold; color: white; font-size: 14px; display: flex; flex-direction: column; align-items: center; justify-content: center; line-height: 1.1;">${grandTotal}</div>`;

            container.innerHTML = matrixHTML;
        }

        // ===== „Ç®„É©„ÉºË°®Á§∫Ê©üËÉΩ =====
        function showError(errorMsg = '„Éá„Éº„ÇøË™≠„ÅøËæº„Åø„Å´Â§±Êïó„Åó„Åæ„Åó„Åü') {
            const errorHtml = `<tr><td colspan="15" class="loading">‚ùå ${errorMsg}</td></tr>`;
            document.querySelectorAll('tbody').forEach(tbody => {
                tbody.innerHTML = errorHtml;
            });
            
            // ÏóêÎü¨ ÏÉÅÏÑ∏ Ï†ïÎ≥¥ ÌëúÏãú
            const errorDetail = document.createElement('div');
            errorDetail.style.cssText = 'position: fixed; top: 10px; right: 10px; background: #ffebee; color: #c62828; padding: 10px; border: 1px solid #e57373; border-radius: 4px; z-index: 1000; max-width: 300px;';
            errorDetail.innerHTML = `
                <strong>„Ç®„É©„ÉºË©≥Á¥∞:</strong><br>
                ${errorMsg}<br>
                <small>„Éñ„É©„Ç¶„Ç∂„ÅÆ„Ç≥„É≥„ÇΩ„Éº„É´(F12)„ÅßË©≥Á¥∞„ÇíÁ¢∫Ë™ç„Åó„Å¶„Åè„Å†„Åï„ÅÑ</small>
                <button onclick="this.parentNode.remove()" style="float: right; margin-left: 10px;">√ó</button>
            `;
            document.body.appendChild(errorDetail);
            
            // 5Áßí ÌõÑ ÏûêÎèô Ï†úÍ±∞
            setTimeout(() => {
                if (errorDetail.parentNode) {
                    errorDetail.remove();
                }
            }, 5000); // 5ÁßíÂæå„Å´Ëá™ÂãïÈô§Âéª
        }
        
        // ===== „Éá„Éº„Çø„Éë„ÇπÂèñÂæóÔºàGitHub PagesÂØæÂøúÔºâ =====
        function getDataPath() {
            const hostname = window.location.hostname;
            const isGitHubPages = hostname.endsWith('.github.io') || hostname.includes('github');
            
            if (isGitHubPages) {
                // GitHub Pages: Ï†àÎåÄ Í≤ΩÎ°ú ÏÇ¨Ïö©
                const basePath = window.location.pathname.replace('/index.html', '').replace('/', '');
                return basePath ? `/${basePath}/data/standings.json` : '/data/standings.json';
            } else {
                // Î°úÏª¨: ÏÉÅÎåÄ Í≤ΩÎ°ú ÏÇ¨Ïö©  
                return './data/standings.json';
            }
        }
        
        // ===== „Éá„Éº„ÇøÂûãÊ≠£Ë¶èÂåñÂá¶ÁêÜ =====
        function normalizeStandingsData(data) {
            if (!data) return data;
            
            // Í∞Å Î¶¨Í∑∏Ïùò ÌåÄ Îç∞Ïù¥ÌÑ∞ Ï†ïÍ∑úÌôî
            ['central_league', 'pacific_league'].forEach(league => {
                if (data[league]?.standings) {
                    data[league].standings = data[league].standings.map(team => ({
                        ...team,
                        // Î¨∏ÏûêÏó¥ÏùÑ Ïà´ÏûêÎ°ú Î≥ÄÌôò
                        win_percentage: parseFloat(team.win_percentage) || 0,
                        games_behind: parseFloat(team.games_behind) || 0,
                        wins: parseInt(team.wins) || 0,
                        losses: parseInt(team.losses) || 0,
                        draws: parseInt(team.draws) || 0,
                        games_played: parseInt(team.games_played) || 0,
                        runs_scored: parseInt(team.runs_scored) || 0,
                        runs_allowed: parseInt(team.runs_allowed) || 0,
                        run_differential: parseInt(team.run_differential) || 0
                    }));
                }
            });
            
            return data;
        }
        
        // ===== Home/Away ÏûîÏó¨ Í≥ÑÏÇ∞ (Ïã§Ï†ú Ïä§ÏºÄÏ§Ñ Îç∞Ïù¥ÌÑ∞ ÏÇ¨Ïö©) =====
        function computeHomeAwayRemaining() {
            homeAwayRemainingByTeam = {};
            if (!standingsData) return;

            const allTeams = [...(standingsData.central_league?.standings || []), ...(standingsData.pacific_league?.standings || [])];
            const teamIds = allTeams.map(t => t.team_id);

            // Í∏∞Î≥∏Í∞í: 0ÏúºÎ°ú Ï¥àÍ∏∞Ìôî
            teamIds.forEach(id => { homeAwayRemainingByTeam[id] = { home: 0, away: 0, opponents: {} }; });

            // Ïã§Ï†ú Ïä§ÏºÄÏ§Ñ Îç∞Ïù¥ÌÑ∞Í∞Ä ÏûàÏúºÎ©¥ ÏÇ¨Ïö©
            if (upcomingGamesData && Array.isArray(upcomingGamesData)) {
                upcomingGamesData.forEach(game => {
                    if (game.game_status !== 'scheduled') return;
                    
                    const homeId = game.home_team_id;
                    const awayId = game.away_team_id;
                    
                    // ÌôàÌåÄ ÏûîÏó¨ Ìôà Í≤åÏûÑ Ï¶ùÍ∞Ä
                    if (homeAwayRemainingByTeam[homeId]) {
                        homeAwayRemainingByTeam[homeId].home++;
                        // ÏÉÅÎåÄÌåÄ Ï†ïÎ≥¥ Ï∂îÍ∞Ä
                        const opponentAbbr = game.away_team_abbr;
                        homeAwayRemainingByTeam[homeId].opponents[opponentAbbr] = (homeAwayRemainingByTeam[homeId].opponents[opponentAbbr] || 0) + 1;
                    }
                    
                    // ÏõêÏ†ïÌåÄ ÏûîÏó¨ ÏõêÏ†ï Í≤åÏûÑ Ï¶ùÍ∞Ä
                    if (homeAwayRemainingByTeam[awayId]) {
                        homeAwayRemainingByTeam[awayId].away++;
                        // ÏÉÅÎåÄÌåÄ Ï†ïÎ≥¥ Ï∂îÍ∞Ä
                        const opponentAbbr = game.home_team_abbr;
                        homeAwayRemainingByTeam[awayId].opponents[opponentAbbr] = (homeAwayRemainingByTeam[awayId].opponents[opponentAbbr] || 0) + 1;
                    }
                });
            } else {
                // Ïä§ÏºÄÏ§Ñ Îç∞Ïù¥ÌÑ∞Í∞Ä ÏóÜÏúºÎ©¥ Í∑†Îì± Î∂ÑÎ∞∞Î°ú Ìè¥Î∞±
                allTeams.forEach(t => {
                    const remaining = Math.max(0, TOTAL_GAMES - t.games_played);
                    const home = Math.floor(remaining / 2);
                    const away = remaining - home;
                    homeAwayRemainingByTeam[t.team_id] = { home, away, opponents: {} };
                });
            }
        }

        function calculateCurrentStreak(entries) {
            if (!Array.isArray(entries) || !entries.length) {
                return { type: 'none', count: 0 };
            }

            const latestResult = entries[entries.length - 1]?.result;
            if (latestResult === 'W' || latestResult === 'L') {
                let count = 0;
                for (let i = entries.length - 1; i >= 0; i--) {
                    if (entries[i].result === latestResult) {
                        count++;
                    } else {
                        break;
                    }
                }
                return { type: latestResult === 'W' ? 'win' : 'loss', count };
            }

            if (latestResult === 'D') {
                let draws = 0;
                for (let i = entries.length - 1; i >= 0; i--) {
                    if (entries[i].result === 'D') {
                        draws++;
                    } else {
                        break;
                    }
                }
                return { type: 'draw', count: draws };
            }

            return { type: 'none', count: 0 };
        }

        function computeLastTenRecords() {
            lastTenRecordsByTeam = {};
            if (!Array.isArray(gamesData) || !gamesData.length) return;

            const resultsByTeam = {};

            gamesData.forEach(game => {
                const status = (game.game_status || game.status || '').toLowerCase();
                if (status !== 'completed') return;

                const homeId = game.home_team_id;
                const awayId = game.away_team_id;
                if (!homeId || !awayId) return;

                const homeScore = Number(game.home_score);
                const awayScore = Number(game.away_score);
                if (!Number.isFinite(homeScore) || !Number.isFinite(awayScore)) return;

                const rawDate = game.game_date || game.date || '';
                let timestamp = Date.parse(rawDate);
                if (Number.isNaN(timestamp) && rawDate) {
                    timestamp = Date.parse(`${rawDate}T00:00:00`);
                }
                if (Number.isNaN(timestamp)) {
                    timestamp = 0;
                }

                const homeKey = String(homeId);
                const awayKey = String(awayId);
                if (!resultsByTeam[homeKey]) resultsByTeam[homeKey] = [];
                if (!resultsByTeam[awayKey]) resultsByTeam[awayKey] = [];

                let homeResult = 'D';
                let awayResult = 'D';
                if (homeScore > awayScore) {
                    homeResult = 'W';
                    awayResult = 'L';
                } else if (homeScore < awayScore) {
                    homeResult = 'L';
                    awayResult = 'W';
                }

                resultsByTeam[homeKey].push({ ts: timestamp, result: homeResult });
                resultsByTeam[awayKey].push({ ts: timestamp, result: awayResult });
            });

            Object.entries(resultsByTeam).forEach(([teamId, entries]) => {
                entries.sort((a, b) => a.ts - b.ts);
                const recent = entries.slice(-10);
                let wins = 0;
                let losses = 0;
                let draws = 0;
                recent.forEach(entry => {
                    if (entry.result === 'W') wins++;
                    else if (entry.result === 'L') losses++;
                    else draws++;
                });
                const record = `${wins} - ${losses} - ${draws}`;
                const streak = calculateCurrentStreak(entries);
                lastTenRecordsByTeam[teamId] = { record, wins, losses, draws, games: recent.length, streak };
            });
        }

        // ===== ÏãúÏ¶å Î∂ÑÏÑù Ï∞®Ìä∏ ÏóÖÎç∞Ïù¥Ìä∏ =====
        function updateSeasonAnalysis() {
            updateNPBSeasonAnalysis();
        }

        function displayFallbackMessage() {
            const leagues = ['central', 'pacific'];
            leagues.forEach(league => {
                const container = document.querySelector(`#${league}-season-analysis`);
                if (container) {
                    container.innerHTML = `
                        <div style="padding: 40px; text-align: center; background: #f8f9fa; border-radius: 8px; margin: 20px 0;">
                            <h3>üìä ÏãúÏ¶å Î∂ÑÏÑù Ï§ÄÎπÑ Ï§ë...</h3>
                            <p>Í≤ΩÍ∏∞ Îç∞Ïù¥ÌÑ∞Î•º Î∂àÎü¨Ïò§Îäî Ï§ëÏûÖÎãàÎã§. Ïû†ÏãúÎßå Í∏∞Îã§Î†§Ï£ºÏÑ∏Ïöî.</p>
                            <div style="margin-top: 20px;">
                                <small>Îç∞Ïù¥ÌÑ∞ Î°úÎìú ÏÉÅÌÉú: ${gamesData ? `${gamesData.length}Í∞ú Í≤ΩÍ∏∞` : 'Îç∞Ïù¥ÌÑ∞ ÏóÜÏùå'}</small>
                            </div>
                        </div>
                    `;
                }
            });
        }

        function drawSimpleTestCharts() {

            const canvasIds = [
                'central-ranking-canvas', 'central-winrate-canvas', 'central-gamesbehind-canvas', 'central-wins-canvas',
                'pacific-ranking-canvas', 'pacific-winrate-canvas', 'pacific-gamesbehind-canvas', 'pacific-wins-canvas'
            ];

            canvasIds.forEach(canvasId => {
                const canvas = document.getElementById(canvasId);
                if (canvas) {
                    const ctx = canvas.getContext('2d');

                    // Î∞∞Í≤Ω Ï±ÑÏö∞Í∏∞
                    ctx.fillStyle = '#f0f8ff';
                    ctx.fillRect(0, 0, canvas.width, canvas.height);

                    // ÌÖåÏä§Ìä∏ ÌÖçÏä§Ìä∏
                    ctx.fillStyle = '#333';
                    ctx.font = 'bold 20px Arial';
                    ctx.textAlign = 'center';
                    ctx.fillText('Ï∞®Ìä∏ ÌÖåÏä§Ìä∏', canvas.width / 2, 50);

                    ctx.font = '16px Arial';
                    ctx.fillText(canvasId, canvas.width / 2, 80);
                    ctx.fillText('Ï∞®Ìä∏Í∞Ä Ïó¨Í∏∞Ïóê ÌëúÏãúÎê©ÎãàÎã§', canvas.width / 2, 110);

                    // Í∞ÑÎã®Ìïú ÏÑ† Í∑∏Î¶¨Í∏∞
                    ctx.strokeStyle = '#ff6b6b';
                    ctx.lineWidth = 3;
                    ctx.beginPath();
                    ctx.moveTo(50, 150);
                    ctx.lineTo(canvas.width - 50, 150);
                    ctx.stroke();

                    // Ïõê Í∑∏Î¶¨Í∏∞
                    ctx.fillStyle = '#4ecdc4';
                    ctx.beginPath();
                    ctx.arc(canvas.width / 2, 200, 30, 0, 2 * Math.PI);
                    ctx.fill();

                } else {
                    console.error(`Canvas ${canvasId} not found!`);
                }
            });
        }

        // Ï†ÑÏó≠ ÌÖåÏä§Ìä∏ Ìï®ÏàòÎì§ (Î∏åÎùºÏö∞Ï†Ä ÏΩòÏÜîÏóêÏÑú Ìò∏Ï∂ú Í∞ÄÎä•)
        window.testCharts = function() {
            drawSimpleTestCharts();
        };

        window.testSeasonAnalysis = function() {
            updateSeasonAnalysis();
        };

        // ÎîîÎ≤ÑÍπÖÏö© Ìï®ÏàòÎì§
        window.debugChartStatus = function() {

            // Ï∫îÎ≤ÑÏä§ ÏÉÅÌÉú ÌôïÏù∏
            const canvases = ['central-ranking-canvas', 'central-winrate-canvas', 'pacific-ranking-canvas', 'pacific-winrate-canvas'];
            canvases.forEach(id => {
                const canvas = document.getElementById(id);
            });
        };

        window.forceChartJS = function() {
            if (typeof Chart !== 'undefined') {
                processRealSeasonData();
            } else {
                console.error('Chart.js Ïó¨Ï†ÑÌûà Î°úÎìúÎêòÏßÄ ÏïäÏùå');
            }
        };

        function processRealSeasonData() {

            // Chart.js Î°úÎìú ÌôïÏù∏
            if (typeof Chart === 'undefined') {
                drawSampleSeasonCharts();
                return;
            }

            if (!gamesData || !gamesData.length) {
                drawSampleSeasonCharts();
                return;
            }

            const seasonData = {
                central: {},
                pacific: {}
            };

            const teamMapping = {
                'YOG': { name: 'Â∑®‰∫∫', league: 'central' },
                'YAK': { name: '„É§„ÇØ„É´„Éà', league: 'central' },
                'YDB': { name: 'DeNA', league: 'central' },
                'HAN': { name: 'Èò™Á•û', league: 'central' },
                'HIR': { name: 'Â∫ÉÂ≥∂', league: 'central' },
                'CHU': { name: '‰∏≠Êó•', league: 'central' },
                'SOF': { name: '„ÇΩ„Éï„Éà„Éê„É≥„ÇØ', league: 'pacific' },
                'NIP': { name: 'Êó•Êú¨„Éè„É†', league: 'pacific' },
                'SEI': { name: 'Ë•øÊ≠¶', league: 'pacific' },
                'RAK': { name: 'Ê•ΩÂ§©', league: 'pacific' },
                'ORI': { name: '„Ç™„É™„ÉÉ„ÇØ„Çπ', league: 'pacific' },
                'LOT': { name: '„É≠„ÉÉ„ÉÜ', league: 'pacific' }
            };

            // ÌåÄÎ≥Ñ ÎÇ†ÏßúÏàú ÎàÑÏ†Å Ïä§ÌÉØ Í≥ÑÏÇ∞
            Object.keys(teamMapping).forEach(abbr => {
                const league = teamMapping[abbr].league;
                seasonData[league][abbr] = {
                    name: teamMapping[abbr].name,
                    games: [],
                    winRate: [],
                    ranking: [],
                    gamesBehind: [],
                    wins: []
                };
            });

            // ÎÇ†ÏßúÎ≥ÑÎ°ú Ï†ïÎ†¨Îêú Í≤åÏûÑ Îç∞Ïù¥ÌÑ∞
            const sortedGames = [...gamesData].sort((a, b) => new Date(a.game_date) - new Date(b.game_date));
            const dateMap = {};

            // Í∞Å ÎÇ†ÏßúÎ≥ÑÎ°ú ÎàÑÏ†Å Ïä§ÌÉØ Í≥ÑÏÇ∞
            sortedGames.forEach(game => {
                const date = game.game_date;
                if (!dateMap[date]) {
                    dateMap[date] = {};
                    Object.keys(teamMapping).forEach(abbr => {
                        dateMap[date][abbr] = { wins: 0, losses: 0, draws: 0, games: 0 };
                    });
                }

                // ÏäπÌå® Í∏∞Î°ù
                const homeWin = game.home_score > game.away_score;
                const awayWin = game.away_score > game.home_score;
                const isDraw = game.home_score === game.away_score;

                if (homeWin) {
                    dateMap[date][game.home_team_abbr].wins++;
                    dateMap[date][game.away_team_abbr].losses++;
                } else if (awayWin) {
                    dateMap[date][game.away_team_abbr].wins++;
                    dateMap[date][game.home_team_abbr].losses++;
                } else if (isDraw) {
                    dateMap[date][game.home_team_abbr].draws++;
                    dateMap[date][game.away_team_abbr].draws++;
                }

                dateMap[date][game.home_team_abbr].games++;
                dateMap[date][game.away_team_abbr].games++;
            });

            // ÎàÑÏ†Å Ïä§ÌÉØ Í≥ÑÏÇ∞ Î∞è ÏàúÏúÑ Îß§Í∏∞Í∏∞
            const dates = Object.keys(dateMap).sort();
            const cumulativeStats = {};

            Object.keys(teamMapping).forEach(abbr => {
                cumulativeStats[abbr] = { wins: 0, losses: 0, draws: 0, games: 0 };
            });

            dates.forEach(date => {
                Object.keys(teamMapping).forEach(abbr => {
                    cumulativeStats[abbr].wins += dateMap[date][abbr].wins;
                    cumulativeStats[abbr].losses += dateMap[date][abbr].losses;
                    cumulativeStats[abbr].draws += dateMap[date][abbr].draws;
                    cumulativeStats[abbr].games += dateMap[date][abbr].games;

                    const league = teamMapping[abbr].league;
                    const winRate = cumulativeStats[abbr].games > 0 ? cumulativeStats[abbr].wins / cumulativeStats[abbr].games : 0;

                    seasonData[league][abbr].winRate.push(winRate);
                    seasonData[league][abbr].wins.push(cumulativeStats[abbr].wins);
                });

                // Î¶¨Í∑∏Î≥Ñ ÏàúÏúÑ Í≥ÑÏÇ∞
                ['central', 'pacific'].forEach(league => {
                    const leagueTeams = Object.keys(teamMapping).filter(abbr => teamMapping[abbr].league === league);
                    const sorted = leagueTeams.sort((a, b) => {
                        const aRate = cumulativeStats[a].games > 0 ? cumulativeStats[a].wins / cumulativeStats[a].games : 0;
                        const bRate = cumulativeStats[b].games > 0 ? cumulativeStats[b].wins / cumulativeStats[b].games : 0;
                        return bRate - aRate; // ÏäπÎ•† ÎÇ¥Î¶ºÏ∞®Ïàú
                    });

                    sorted.forEach((abbr, index) => {
                        seasonData[league][abbr].ranking.push(index + 1);
                    });

                    // Í≤åÏûÑÏ∞® Í≥ÑÏÇ∞ (1ÏúÑ ÌåÄÍ≥ºÏùò Ï∞®Ïù¥)
                    const leader = sorted[0];
                    const leaderWins = cumulativeStats[leader].wins;
                    const leaderLosses = cumulativeStats[leader].losses;

                    sorted.forEach(abbr => {
                        const teamWins = cumulativeStats[abbr].wins;
                        const teamLosses = cumulativeStats[abbr].losses;
                        const gamesBehind = ((leaderWins - teamWins) + (teamLosses - leaderLosses)) / 2;
                        seasonData[league][abbr].gamesBehind.push(Math.max(0, gamesBehind));
                    });
                });
            });

            drawRealSeasonCharts(seasonData);
        }

        function drawRealSeasonCharts(seasonData) {
            const colors = [
                'rgba(255, 107, 107, 0.8)',
                'rgba(78, 205, 196, 0.8)',
                'rgba(69, 183, 209, 0.8)',
                'rgba(150, 206, 180, 0.8)',
                'rgba(254, 202, 87, 0.8)',
                'rgba(255, 159, 243, 0.8)'
            ];
            const borderColors = [
                'rgba(255, 107, 107, 1)',
                'rgba(78, 205, 196, 1)',
                'rgba(69, 183, 209, 1)',
                'rgba(150, 206, 180, 1)',
                'rgba(254, 202, 87, 1)',
                'rgba(255, 159, 243, 1)'
            ];

            ['central', 'pacific'].forEach(league => {
                const teams = Object.keys(seasonData[league]);
                if (teams.length === 0) return;

                // Chart titles Í∞úÏÑ†
                const leagueName = league === 'central' ? '„Çª„É≥„Éà„É©„É´„É™„Éº„Ç∞' : '„Éë„Ç∑„Éï„Ç£„ÉÉ„ÇØ„É™„Éº„Ç∞';

                // ÏàúÏúÑ Î≥ÄÎèô Ï∞®Ìä∏
                drawChartJS(`${league}-ranking-canvas`, `${leagueName} È†Ü‰ΩçÊé®Áßª„ÉÅ„É£„Éº„Éà üìä`, seasonData[league], 'ranking', colors, borderColors, true);
                // ÏäπÎ•† Î≥ÄÎèô Ï∞®Ìä∏
                drawChartJS(`${league}-winrate-canvas`, `${leagueName} ÂãùÁéáÊé®Áßª„ÉÅ„É£„Éº„Éà üìà`, seasonData[league], 'winRate', colors, borderColors);
                // Í≤åÏûÑÏ∞® Î≥ÄÎèô Ï∞®Ìä∏
                drawChartJS(`${league}-gamesbehind-canvas`, `${leagueName} „Ç≤„Éº„É†Â∑ÆÊé®Áßª„ÉÅ„É£„Éº„Éà üìâ`, seasonData[league], 'gamesBehind', colors, borderColors);
                // ÏäπÏàò Î≥ÄÎèô Ï∞®Ìä∏
                drawChartJS(`${league}-wins-canvas`, `${leagueName} ÂãùÂà©Êï∞Êé®Áßª„ÉÅ„É£„Éº„Éà üèÜ`, seasonData[league], 'wins', colors, borderColors);
            });
        }

        // Chart.js Ï∞®Ìä∏ Ïù∏Ïä§ÌÑ¥Ïä§ Ï†ÄÏû•ÏÜå
        const chartInstances = {};
        // Ï∞®Ìä∏ ÏÉùÏÑ± Ï§ëÏù∏ÏßÄ Ï∂îÏ†ÅÌïòÎäî ÌîåÎûòÍ∑∏
        const chartCreating = {};

        function drawChartJS(canvasId, title, leagueData, dataType, colors, borderColors, invertY = false) {
            // Ï∞®Ìä∏Í∞Ä Ïù¥ÎØ∏ ÏÉùÏÑ± Ï§ëÏù¥Í±∞ÎÇò Ï°¥Ïû¨ÌïòÎ©¥ Í±¥ÎÑàÎõ∞Í∏∞
            if (chartCreating[canvasId] || chartInstances[canvasId]) {
                return;
            }

            const canvas = document.getElementById(canvasId);
            if (!canvas) {
                return;
            }

            // Chart.jsÍ∞Ä ÏóÜÏúºÎ©¥ Í∞ÑÎã®Ìïú canvas Ï∞®Ìä∏Î°ú ÎåÄÏ≤¥
            if (typeof Chart === 'undefined') {
                drawSimpleCanvasChart(canvasId, title, leagueData, dataType, colors, invertY);
                return;
            }

            // Ï∞®Ìä∏ ÏÉùÏÑ± Ï§ë ÌîåÎûòÍ∑∏ ÏÑ§Ï†ï
            chartCreating[canvasId] = true;

            // Í∏∞Ï°¥ Ï∞®Ìä∏ Ïù∏Ïä§ÌÑ¥Ïä§Í∞Ä ÏûàÏúºÎ©¥ ÏôÑÏ†ÑÌûà ÏÇ≠Ï†ú
            if (chartInstances[canvasId]) {
                try {
                    chartInstances[canvasId].destroy();
                    delete chartInstances[canvasId];
                } catch (e) {}
            }

            // Chart.jsÏùò Ï†ÑÏó≠ Ï∞®Ìä∏ Î†àÏßÄÏä§Ìä∏Î¶¨ÏóêÏÑúÎèÑ Ï†úÍ±∞
            try {
                Chart.getChart(canvasId)?.destroy();
            } catch (e) {}

            // Ï∫îÎ≤ÑÏä§ Ïª®ÌÖçÏä§Ìä∏Î•º ÏÉàÎ°ú Í∞ÄÏ†∏Ïò§Í∏∞
            const ctx = canvas.getContext('2d');

            // Ï∫îÎ≤ÑÏä§ ÏôÑÏ†Ñ Ï¥àÍ∏∞Ìôî
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // ÏïΩÍ∞ÑÏùò ÏßÄÏó∞ÏùÑ ÎëêÍ≥† Ï∞®Ìä∏ ÏÉùÏÑ± (DOM ÏïàÏ†ïÌôî)
            setTimeout(() => {
                createChart(canvasId, canvas, ctx, title, leagueData, dataType, colors, borderColors, invertY);
                // ÏÉùÏÑ± ÏôÑÎ£å ÌõÑ ÌîåÎûòÍ∑∏ Ìï¥Ï†ú
                chartCreating[canvasId] = false;
            }, 100);
        }

        function createChart(canvasId, canvas, ctx, title, leagueData, dataType, colors, borderColors, invertY) {
            const allTeams = Object.keys(leagueData);
            if (allTeams.length === 0) {
                return;
            }

            // ÌåÄÏùÑ ÌòÑÏû¨ ÏàúÏúÑÎåÄÎ°ú Ï†ïÎ†¨ (ÎßàÏßÄÎßâ ÏàúÏúÑ Îç∞Ïù¥ÌÑ∞ Í∏∞Ï§Ä)
            const teams = allTeams.sort((a, b) => {
                const aData = leagueData[a];
                const bData = leagueData[b];

                if (dataType === 'ranking') {
                    // ÏàúÏúÑÎäî ÎÇÆÏùÄ Ïà´ÏûêÍ∞Ä ÏÉÅÏúÑ
                    const aLastRank = aData.ranking && aData.ranking.length > 0 ?
                        aData.ranking[aData.ranking.length - 1] : 6;
                    const bLastRank = bData.ranking && bData.ranking.length > 0 ?
                        bData.ranking[bData.ranking.length - 1] : 6;
                    return aLastRank - bLastRank;
                } else {
                    // ÏäπÎ•†, ÏäπÏàòÎäî ÎÜíÏùÄ Í∞íÏù¥ ÏÉÅÏúÑ, Í≤åÏûÑÏ∞®Îäî ÎÇÆÏùÄ Í∞íÏù¥ ÏÉÅÏúÑ
                    const aLastValue = aData[dataType] && aData[dataType].length > 0 ?
                        aData[dataType][aData[dataType].length - 1] : 0;
                    const bLastValue = bData[dataType] && bData[dataType].length > 0 ?
                        bData[dataType][bData[dataType].length - 1] : 0;

                    if (dataType === 'gamesBehind') {
                        return aLastValue - bLastValue; // Í≤åÏûÑÏ∞®Îäî ÎÇÆÏùÄ Í∞íÏù¥ ÏÉÅÏúÑ
                    } else {
                        return bLastValue - aLastValue; // ÏäπÎ•†, ÏäπÏàòÎäî ÎÜíÏùÄ Í∞íÏù¥ ÏÉÅÏúÑ
                    }
                }
            });

            const maxDataLength = Math.max(...teams.map(team => leagueData[team][dataType].length));
            if (maxDataLength === 0) {
                return;
            }

            // Îçî ÎÇòÏùÄ ÎùºÎ≤® ÏÉùÏÑ± (ÎÇ†Ïßú ÌëúÏãú)
            const today = new Date();
            const labels = Array.from({length: maxDataLength}, (_, i) => {
                const date = new Date(today);
                date.setDate(date.getDate() - (maxDataLength - i - 1));
                return `${date.getMonth() + 1}/${date.getDate()}`;
            });

            // Îç∞Ïù¥ÌÑ∞ÏÖã ÏÉùÏÑ± (ÏàúÏúÑÎåÄÎ°ú Ï†ïÎ†¨Îêú ÌåÄ Îç∞Ïù¥ÌÑ∞ ÏÇ¨Ïö©)
            const datasets = teams.map((team, index) => {
                const teamMeta = NPB_TEAM_META[team] || { fullName: leagueData[team].name, color: '#666666' };
                return {
                    label: teamMeta.shortName || teamMeta.fullName || leagueData[team].name,
                    data: leagueData[team][dataType],
                    borderColor: teamMeta.color,
                    backgroundColor: teamMeta.color + '20', // Ìà¨Î™ÖÎèÑ Ï∂îÍ∞Ä
                    borderWidth: 3,
                    fill: dataType === 'gamesBehind' ? '+origin' : false,
                    tension: 0.4,
                    pointRadius: 2,
                    pointHoverRadius: 6,
                    pointBackgroundColor: '#fff',
                    pointBorderWidth: 2,
                    pointHoverBorderWidth: 3,
                    pointBorderColor: teamMeta.color
                };
            });

            // YÏ∂ï ÏÑ§Ï†ï
            let yAxisConfig = {
                beginAtZero: false,
                grid: {
                    color: 'rgba(0, 0, 0, 0.1)'
                },
                ticks: {
                    color: '#666'
                }
            };

            // Îç∞Ïù¥ÌÑ∞ ÌÉÄÏûÖÎ≥Ñ YÏ∂ï ÏÑ§Ï†ï
            if (dataType === 'ranking') {
                yAxisConfig.reverse = true; // ÏàúÏúÑÎäî ÎÇÆÏùÄ Ïà´ÏûêÍ∞Ä ÏúÑÏ™Ω
                yAxisConfig.min = 1;
                yAxisConfig.max = 6;
                yAxisConfig.ticks.stepSize = 1;
            } else if (dataType === 'winRate') {
                yAxisConfig.min = 0;
                yAxisConfig.max = 1;
                yAxisConfig.ticks.callback = function(value) {
                    return value.toFixed(3);
                };
            } else if (dataType === 'gamesBehind') {
                yAxisConfig.min = 0;
                yAxisConfig.ticks.callback = function(value) {
                    return value.toFixed(1);
                };
            }

            // Chart.js 3.x Ï∞®Ìä∏ ÏÉùÏÑ± (Ï†ÑÎ¨∏Ï†ÅÏù∏ Ïä§ÌÉÄÏùºÎßÅ)
            try {
                chartInstances[canvasId] = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: datasets
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    animation: {
                        duration: 1500,
                        easing: 'easeInOutQuart'
                    },
                    layout: {
                        padding: {
                            left: 10,
                            right: 20,
                            top: 10,
                            bottom: 10
                        }
                    },
                    plugins: {
                        title: {
                            display: true,
                            text: title,
                            font: {
                                size: 20,
                                weight: 'bold',
                                family: "'Noto Sans JP', 'Helvetica Neue', Arial, sans-serif"
                            },
                            color: '#2c3e50',
                            padding: {
                                top: 10,
                                bottom: 20
                            }
                        },
                        legend: {
                            display: false  // Ïª§Ïä§ÌÖÄ Î†àÏ†ÑÎìú ÏÇ¨Ïö©
                        },
                        tooltip: {
                            enabled: true,
                            backgroundColor: 'rgba(0, 0, 0, 0.9)',
                            titleColor: '#fff',
                            titleFont: {
                                size: 14,
                                weight: 'bold'
                            },
                            bodyColor: '#fff',
                            bodyFont: {
                                size: 13
                            },
                            padding: 12,
                            cornerRadius: 8,
                            displayColors: true,
                            mode: 'index',
                            intersect: false,
                            callbacks: {
                                title: function(tooltipItems) {
                                    return 'Êó•‰ªò: ' + tooltipItems[0].label;
                                },
                                label: function(context) {
                                    let label = context.dataset.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (dataType === 'winRate') {
                                        const winRateValue = context.parsed.y.toFixed(3);
                                        label += winRateValue;
                                        // ÂãùÁéá„Å´Âøú„Åò„Å¶ÁµµÊñáÂ≠óËøΩÂä†
                                        if (context.parsed.y > 0.6) label += ' üî•';
                                        else if (context.parsed.y < 0.4) label += ' ‚ùÑÔ∏è';
                                    } else if (dataType === 'ranking') {
                                        label += context.parsed.y + '‰Ωç';
                                        if (context.parsed.y === 1) label += ' üëë';
                                        else if (context.parsed.y === 2) label += ' ü•à';
                                        else if (context.parsed.y === 3) label += ' ü•â';
                                    } else if (dataType === 'gamesBehind') {
                                        const gb = context.parsed.y.toFixed(1);
                                        label += gb + '„Ç≤„Éº„É†Â∑Æ';
                                        if (context.parsed.y === 0) label += ' (È¶ñ‰Ωç)';
                                    } else {
                                        label += context.parsed.y + 'Âãù';
                                        if (context.parsed.y >= 50) label += ' ‚öæ';
                                    }
                                    return label;
                                }
                            }
                        }
                    },
                    interaction: {
                        mode: 'index',
                        axis: 'x',
                        intersect: false
                    },
                    scales: {
                        x: {
                            display: true,
                            title: {
                                display: true,
                                text: dataType === 'ranking' ? 'Ë©¶ÂêàÊó•Á®ã' : '2025Âπ¥„Ç∑„Éº„Ç∫„É≥',
                                font: {
                                    size: 14,
                                    weight: '600'
                                },
                                color: '#4a5568'
                            },
                            grid: {
                                display: true,
                                color: 'rgba(0, 0, 0, 0.05)',
                                drawBorder: false
                            },
                            ticks: {
                                color: '#718096',
                                font: {
                                    size: 11
                                },
                                autoSkip: true,
                                maxTicksLimit: 15,
                                maxRotation: 45,
                                minRotation: 0
                            }
                        },
                        y: {
                            ...yAxisConfig,
                            title: {
                                display: true,
                                text: dataType === 'ranking' ? 'È†Ü‰Ωç' :
                                      dataType === 'winRate' ? 'ÂãùÁéá' :
                                      dataType === 'gamesBehind' ? '„Ç≤„Éº„É†Â∑Æ' : 'ÂãùÂà©Êï∞',
                                font: {
                                    size: 14,
                                    weight: '600'
                                },
                                color: '#4a5568'
                            },
                            grid: {
                                display: true,
                                color: 'rgba(0, 0, 0, 0.05)',
                                drawBorder: false
                            },
                            ticks: {
                                ...yAxisConfig.ticks,
                                font: {
                                    size: 12
                                },
                                padding: 8
                            }
                        }
                    },
                    elements: {
                        line: {
                            borderJoinStyle: 'round'
                        },
                        point: {
                            radius: 4,
                            hitRadius: 10,
                            hoverRadius: 7,
                            hoverBackgroundColor: '#fff',
                            hoverBorderWidth: 3
                        }
                    },
                    // ÌåÄ Î°úÍ≥† ÌîåÎü¨Í∑∏Ïù∏
                    plugins: [{
                        id: 'teamLogoAtEndPoints',
                        afterDatasetsDraw: function(chart) {
                            const ctx = chart.ctx;
                            const meta = chart.getDatasetMeta(0);

                            // Î™®Îì† ÌåÄ Î°úÍ≥†Î•º ÎØ∏Î¶¨ Î°úÎìúÌïòÍ≥† Î†åÎçîÎßÅ
                            const logoPromises = [];
                            chart.data.datasets.forEach((dataset, datasetIndex) => {
                                const teamCode = teams[datasetIndex];
                                const teamLogo = TEAM_LOGOS[teamCode];

                                if (teamLogo) {
                                    const promise = new Promise((resolve) => {
                                        const img = new Image();
                                        img.onload = () => resolve({ img, datasetIndex });
                                        img.onerror = () => resolve({ img: null, datasetIndex });
                                        img.src = teamLogo;
                                    });
                                    logoPromises.push(promise);
                                } else {
                                    logoPromises.push(Promise.resolve({ img: null, datasetIndex }));
                                }
                            });

                            Promise.all(logoPromises).then(results => {
                                results.forEach(({ img, datasetIndex }) => {
                                    const dataset = chart.data.datasets[datasetIndex];
                                    const teamCode = teams[datasetIndex];
                                    const teamMeta = NPB_TEAM_META[teamCode];
                                    const datasetMeta = chart.getDatasetMeta(datasetIndex);

                                    if (datasetMeta.data.length > 0) {
                                        const lastPoint = datasetMeta.data[datasetMeta.data.length - 1];
                                        const x = lastPoint.x;
                                        const y = lastPoint.y;

                                        ctx.save();

                                        // Î∞∞Í≤Ω Ïõê Í∑∏Î¶¨Í∏∞
                                        ctx.beginPath();
                                        ctx.arc(x + 20, y, 14, 0, 2 * Math.PI);
                                        ctx.fillStyle = 'white';
                                        ctx.fill();
                                        ctx.strokeStyle = teamMeta?.color || dataset.borderColor;
                                        ctx.lineWidth = 2;
                                        ctx.stroke();

                                        if (img) {
                                            // SVG Î°úÍ≥† Í∑∏Î¶¨Í∏∞
                                            ctx.drawImage(img, x + 20 - 10, y - 10, 20, 20);
                                        } else {
                                            // ÌåÄ ÏïΩÏûê ÌëúÏãú
                                            ctx.font = 'bold 10px Arial';
                                            ctx.textAlign = 'center';
                                            ctx.textBaseline = 'middle';
                                            ctx.fillStyle = teamMeta?.color || dataset.borderColor;
                                            const shortName = teamMeta?.shortName || teamCode;
                                            ctx.fillText(shortName, x + 20, y);
                                        }

                                        ctx.restore();
                                    }
                                });
                            });
                        }
                    }]
                }
            });

            // HTML Î†àÏ†ÑÎìú ÏÉùÏÑ± Î∞è Ï∞®Ìä∏ Ïª®ÌÖåÏù¥ÎÑàÏóê Ï∂îÍ∞Ä
            createInlineHtmlLegend(canvasId, datasets, teams);

            } catch (error) {
                // ÏóêÎü¨ Î∞úÏÉùÏãú Ï∞®Ìä∏ Ïù∏Ïä§ÌÑ¥Ïä§ Ï†ïÎ¶¨
                if (chartInstances[canvasId]) {
                    delete chartInstances[canvasId];
                }
            }
        }

        // Ïù∏ÎùºÏù∏ HTML Î†àÏ†ÑÎìú ÏÉùÏÑ± Ìï®Ïàò
        function createInlineHtmlLegend(canvasId, datasets, teams) {
            const canvas = document.getElementById(canvasId);
            if (!canvas) return;

            // Ï∫îÎ≤ÑÏä§ Î∂ÄÎ™® Ïª®ÌÖåÏù¥ÎÑàÎ•º relative positionÏúºÎ°ú ÏÑ§Ï†ï
            const parentContainer = canvas.parentElement;
            if (parentContainer.style.position !== 'relative') {
                parentContainer.style.position = 'relative';
            }

            // Í∏∞Ï°¥ Î†àÏ†ÑÎìú Ï†úÍ±∞
            const existingLegend = parentContainer.querySelector('.inline-legend');
            if (existingLegend) {
                existingLegend.remove();
            }

            // ÏÉà Î†àÏ†ÑÎìú Ïª®ÌÖåÏù¥ÎÑà ÏÉùÏÑ±
            const legendContainer = document.createElement('div');
            legendContainer.className = 'inline-legend';
            legendContainer.style.cssText = `
                position: absolute;
                top: 20px;
                right: 10px;
                background: rgba(255, 255, 255, 0.95);
                border: 1px solid #ddd;
                border-radius: 6px;
                padding: 12px 8px;
                font-size: 11px;
                box-shadow: 0 2px 4px rgba(0,0,0,0.1);
                z-index: 1000;
                max-width: 120px;
            `;

            datasets.forEach((dataset, index) => {
                const teamCode = teams[index];
                const teamMeta = NPB_TEAM_META[teamCode];
                const teamLogo = TEAM_LOGOS[teamCode];

                const legendItem = document.createElement('div');
                legendItem.style.cssText = `
                    display: flex;
                    align-items: center;
                    gap: 6px;
                    margin-bottom: 6px;
                    cursor: pointer;
                    padding: 2px 4px;
                    border-radius: 3px;
                    transition: background-color 0.2s;
                `;

                legendItem.onmouseover = () => {
                    legendItem.style.backgroundColor = 'rgba(0,0,0,0.05)';
                };
                legendItem.onmouseout = () => {
                    legendItem.style.backgroundColor = 'transparent';
                };

                // ÏÉâÏÉÅ ÌëúÏãú
                const colorBox = document.createElement('div');
                colorBox.style.cssText = `
                    width: 10px;
                    height: 10px;
                    background-color: ${teamMeta?.color || dataset.borderColor};
                    border-radius: 2px;
                    flex-shrink: 0;
                `;

                // ÌåÄ Î°úÍ≥†
                let logoElement;
                if (teamLogo) {
                    logoElement = document.createElement('img');
                    logoElement.src = teamLogo;
                    logoElement.alt = teamMeta?.fullName || teamCode;
                    logoElement.style.cssText = `
                        width: 14px;
                        height: 14px;
                        object-fit: contain;
                        flex-shrink: 0;
                    `;
                } else {
                    logoElement = document.createElement('span');
                    logoElement.textContent = '‚öæ';
                    logoElement.style.cssText = `
                        font-size: 10px;
                        flex-shrink: 0;
                    `;
                }

                // ÌåÄÎ™Ö
                const teamName = document.createElement('span');
                teamName.textContent = teamMeta?.shortName || teamCode;
                teamName.style.cssText = `
                    color: #4a5568;
                    font-weight: 500;
                    font-size: 10px;
                    line-height: 1.2;
                `;

                legendItem.appendChild(colorBox);
                legendItem.appendChild(logoElement);
                legendItem.appendChild(teamName);
                legendContainer.appendChild(legendItem);
            });

            // Ïª®ÌÖåÏù¥ÎÑàÏóê Î†àÏ†ÑÎìú Ï∂îÍ∞Ä
            parentContainer.appendChild(legendContainer);
        }

        // HTML Î†àÏ†ÑÎìú ÏÉùÏÑ± Ìï®Ïàò (Í∏∞Ï°¥ - ÏÇ¨Ïö©ÌïòÏßÄ ÏïäÏùå)
        function createHtmlLegend(canvasId, datasets, teams) {
            const canvas = document.getElementById(canvasId);
            if (!canvas) return;

            // Í∏∞Ï°¥ Î†àÏ†ÑÎìú Ï†úÍ±∞
            const existingLegend = canvas.parentElement.querySelector('.custom-legend');
            if (existingLegend) {
                existingLegend.remove();
            }

            // ÏÉà Î†àÏ†ÑÎìú Ïª®ÌÖåÏù¥ÎÑà ÏÉùÏÑ±
            const legendContainer = document.createElement('div');
            legendContainer.className = 'custom-legend';
            legendContainer.style.cssText = `
                display: flex;
                flex-wrap: wrap;
                justify-content: center;
                gap: 15px;
                margin-top: 15px;
                padding: 10px;
                font-size: 13px;
            `;

            datasets.forEach((dataset, index) => {
                const teamCode = teams[index];
                const teamMeta = NPB_TEAM_META[teamCode];
                const teamLogo = TEAM_LOGOS[teamCode];

                const legendItem = document.createElement('div');
                legendItem.style.cssText = `
                    display: flex;
                    align-items: center;
                    gap: 6px;
                    cursor: pointer;
                    padding: 4px 8px;
                    border-radius: 4px;
                    transition: background-color 0.2s;
                `;

                legendItem.onmouseover = () => {
                    legendItem.style.backgroundColor = '#f0f0f0';
                };
                legendItem.onmouseout = () => {
                    legendItem.style.backgroundColor = 'transparent';
                };

                // ÏÉâÏÉÅ ÌëúÏãú
                const colorBox = document.createElement('div');
                colorBox.style.cssText = `
                    width: 12px;
                    height: 12px;
                    background-color: ${dataset.borderColor};
                    border-radius: 2px;
                `;

                // ÌåÄ Î°úÍ≥†
                let logoElement;
                if (teamLogo) {
                    logoElement = document.createElement('img');
                    logoElement.src = teamLogo;
                    logoElement.alt = teamMeta?.fullName || teamCode;
                    logoElement.style.cssText = `
                        width: 16px;
                        height: 16px;
                        object-fit: contain;
                    `;
                } else {
                    logoElement = document.createElement('span');
                    logoElement.textContent = teamMeta?.shortName || teamCode;
                    logoElement.style.cssText = `
                        font-size: 10px;
                        font-weight: bold;
                        color: ${dataset.borderColor};
                    `;
                }

                // ÌåÄÎ™Ö
                const teamName = document.createElement('span');
                teamName.textContent = teamMeta?.fullName || dataset.label;
                teamName.style.cssText = `
                    color: #4a5568;
                    font-weight: 500;
                `;

                legendItem.appendChild(colorBox);
                legendItem.appendChild(logoElement);
                legendItem.appendChild(teamName);
                legendContainer.appendChild(legendItem);
            });

            // Ï∫îÎ≤ÑÏä§ Î∂ÄÎ™®Ïóê Î†àÏ†ÑÎìú Ï∂îÍ∞Ä
            canvas.parentElement.appendChild(legendContainer);
        }

        // Chart.js ÏóÜÏùÑ Îïå ÏÇ¨Ïö©Ìï† Í∞ÑÎã®Ìïú canvas Ï∞®Ìä∏
        function drawSimpleCanvasChart(canvasId, title, leagueData, dataType, colors, invertY = false) {
            const canvas = document.getElementById(canvasId);
            if (!canvas) return;

            const ctx = canvas.getContext('2d');
            canvas.width = canvas.parentElement.clientWidth - 20;
            canvas.height = 400;

            // Î∞∞Í≤Ω Î∞è Ï†úÎ™©
            ctx.fillStyle = '#ffffff';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            ctx.fillStyle = '#333';
            ctx.font = 'bold 16px Arial';
            ctx.textAlign = 'center';
            ctx.fillText(title, canvas.width / 2, 30);

            const teams = Object.keys(leagueData);
            if (teams.length === 0) return;

            const maxDataLength = Math.max(...teams.map(team => leagueData[team][dataType].length));
            if (maxDataLength === 0) return;

            const chartArea = { x: 80, y: 50, width: canvas.width - 200, height: 300 };
            const xStep = chartArea.width / Math.max(1, maxDataLength - 1);

            // Í∞ÑÎã®Ìïú Í∑∏Î¶¨Îìú
            ctx.strokeStyle = '#e0e0e0';
            ctx.lineWidth = 1;
            for (let i = 0; i <= 5; i++) {
                const y = chartArea.y + (chartArea.height * i / 5);
                ctx.beginPath();
                ctx.moveTo(chartArea.x, y);
                ctx.lineTo(chartArea.x + chartArea.width, y);
                ctx.stroke();
            }

            // ÌåÄÎ≥Ñ Îç∞Ïù¥ÌÑ∞ Í∑∏Î¶¨Í∏∞
            teams.forEach((team, index) => {
                const data = leagueData[team][dataType];
                if (data.length < 2) return;

                const color = typeof colors[index] === 'string' ? colors[index] : '#4ECDC4';
                ctx.strokeStyle = color;
                ctx.lineWidth = 2;
                ctx.beginPath();

                // Îç∞Ïù¥ÌÑ∞ Î≤îÏúÑ Í≥ÑÏÇ∞
                let minValue = Math.min(...data);
                let maxValue = Math.max(...data);
                if (dataType === 'ranking') {
                    minValue = 1;
                    maxValue = 6;
                } else if (dataType === 'winRate') {
                    minValue = 0;
                    maxValue = 1;
                }
                const valueRange = maxValue - minValue || 1;

                data.forEach((value, dataIndex) => {
                    const x = chartArea.x + (dataIndex * xStep);
                    let y = chartArea.y + chartArea.height - ((value - minValue) / valueRange * chartArea.height);

                    if (invertY && dataType === 'ranking') {
                        y = chartArea.y + ((value - minValue) / valueRange * chartArea.height);
                    }

                    if (dataIndex === 0) {
                        ctx.moveTo(x, y);
                    } else {
                        ctx.lineTo(x, y);
                    }
                });

                ctx.stroke();

                // Î≤îÎ°Ä
                const legendY = 370 + (index * 20);
                ctx.fillStyle = color;
                ctx.fillRect(20, legendY - 8, 15, 15);
                ctx.fillStyle = '#333';
                ctx.font = '12px Arial';
                ctx.textAlign = 'left';
                ctx.fillText(leagueData[team].name, 45, legendY + 4);
            });

            // Ï†úÎ™© Îã§Ïãú Í∑∏Î¶¨Í∏∞
            ctx.fillStyle = '#333';
            ctx.font = 'bold 16px Arial';
            ctx.textAlign = 'center';
            ctx.fillText(title + ' (Í∞ÑÎã® Ï∞®Ìä∏)', canvas.width / 2, 30);
        }

        function drawSampleSeasonCharts() {

            const leagues = {
                central: ['Â∑®‰∫∫', '„É§„ÇØ„É´„Éà', 'DeNA', 'Èò™Á•û', 'Â∫ÉÂ≥∂', '‰∏≠Êó•'],
                pacific: ['„ÇΩ„Éï„Éà„Éê„É≥„ÇØ', 'Êó•Êú¨„Éè„É†', 'Ë•øÊ≠¶', 'Ê•ΩÂ§©', '„Ç™„É™„ÉÉ„ÇØ„Çπ', '„É≠„ÉÉ„ÉÜ']
            };

            const colors = ['#FF6B6B', '#4ECDC4', '#45B7D1', '#96CEB4', '#FECA57', '#FF9FF3'];

            ['central', 'pacific'].forEach(league => {
                const teams = leagues[league];

                // ÏàúÏúÑ Ï∞®Ìä∏
                drawSampleChart(`${league}-ranking-canvas`, 'ÏàúÏúÑ Î≥ÄÎèô', teams, colors,
                    (teamIndex, dataIndex) => Math.max(1, Math.min(6, teamIndex + 1 + Math.sin(dataIndex * 0.3) * 2)));

                // ÏäπÎ•† Ï∞®Ìä∏
                drawSampleChart(`${league}-winrate-canvas`, 'ÏäπÎ•† Î≥ÄÌôî', teams, colors,
                    (teamIndex, dataIndex) => Math.max(0.3, Math.min(0.7, 0.5 + (3 - teamIndex) * 0.05 + Math.sin(dataIndex * 0.2) * 0.1)));

                // Í≤åÏûÑÏ∞® Ï∞®Ìä∏
                drawSampleChart(`${league}-gamesbehind-canvas`, 'Í≤åÏûÑÏ∞® Î≥ÄÌôî', teams, colors,
                    (teamIndex, dataIndex) => Math.max(0, teamIndex * 1.5 + Math.sin(dataIndex * 0.25) * 3));

                // ÏäπÏàò Ï∞®Ìä∏
                drawSampleChart(`${league}-wins-canvas`, 'ÏäπÏàò Î≥ÄÌôî', teams, colors,
                    (teamIndex, dataIndex) => Math.floor(dataIndex * (0.5 + (3 - teamIndex) * 0.03)));
            });
        }

        function drawSampleChart(canvasId, title, teams, colors, dataGenerator) {
            const canvas = document.getElementById(canvasId);
            if (!canvas) {
                console.error(`Canvas ${canvasId} not found`);
                return;
            }

            const ctx = canvas.getContext('2d');
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            const margin = { top: 50, right: 180, bottom: 80, left: 70 };
            const width = canvas.width - margin.left - margin.right;
            const height = canvas.height - margin.top - margin.bottom;

            // Î∞∞Í≤Ω
            ctx.fillStyle = '#ffffff';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // Ï†úÎ™©
            ctx.fillStyle = '#333';
            ctx.font = 'bold 16px Arial';
            ctx.textAlign = 'center';
            ctx.fillText(title, canvas.width / 2, 25);

            // Îç∞Ïù¥ÌÑ∞ Ìè¨Ïù∏Ìä∏ Ïàò (30Ïùº)
            const dataPoints = 30;

            // YÏ∂ï Î≤îÏúÑ ÏÑ§Ï†ï
            let minY = Infinity, maxY = -Infinity;
            teams.forEach((team, teamIndex) => {
                for (let i = 0; i < dataPoints; i++) {
                    const value = dataGenerator(teamIndex, i);
                    minY = Math.min(minY, value);
                    maxY = Math.max(maxY, value);
                }
            });

            // ÏàúÏúÑ Ï∞®Ìä∏Îäî YÏ∂ï Îí§ÏßëÍ∏∞
            const isRanking = title.includes('ÏàúÏúÑ');
            if (isRanking) {
                [minY, maxY] = [1, 6];
            }

            const yRange = maxY - minY;

            // Í≤©ÏûêÏÑ†
            ctx.strokeStyle = '#e0e0e0';
            ctx.lineWidth = 1;

            for (let i = 0; i <= 5; i++) {
                const y = margin.top + i * height / 5;
                ctx.beginPath();
                ctx.moveTo(margin.left, y);
                ctx.lineTo(margin.left + width, y);
                ctx.stroke();

                // YÏ∂ï Î†àÏù¥Î∏î
                const value = isRanking ?
                    (i + 1) :
                    (maxY - i * yRange / 5);

                ctx.fillStyle = '#666';
                ctx.font = '12px Arial';
                ctx.textAlign = 'right';
                ctx.fillText(
                    title.includes('ÏäπÎ•†') ? `${value.toFixed(3)}` :
                    title.includes('ÏäπÏàò') ? `${Math.round(value)}Ïäπ` :
                    title.includes('Í≤åÏûÑÏ∞®') ? `${value.toFixed(1)}G` :
                    `${Math.round(value)}ÏúÑ`,
                    margin.left - 10, y + 4
                );
            }

            // XÏ∂ï Í≤©ÏûêÏÑ†
            for (let i = 0; i <= 6; i++) {
                const x = margin.left + i * width / 6;
                ctx.beginPath();
                ctx.moveTo(x, margin.top);
                ctx.lineTo(x, margin.top + height);
                ctx.stroke();

                // XÏ∂ï Î†àÏù¥Î∏î
                if (i <= 6) {
                    ctx.fillStyle = '#666';
                    ctx.font = '11px Arial';
                    ctx.textAlign = 'center';
                    const date = new Date();
                    date.setDate(date.getDate() - (6 - i) * 5);
                    const dateStr = `${date.getMonth() + 1}/${date.getDate()}`;
                    ctx.fillText(dateStr, x, margin.top + height + 20);
                }
            }

            // ÌåÄÎ≥Ñ ÎùºÏù∏ Í∑∏Î¶¨Í∏∞
            teams.forEach((team, teamIndex) => {
                ctx.strokeStyle = colors[teamIndex];
                ctx.lineWidth = 2.5;
                ctx.beginPath();

                for (let i = 0; i < dataPoints; i++) {
                    const value = dataGenerator(teamIndex, i);
                    const x = margin.left + (i * width / (dataPoints - 1));
                    const y = isRanking ?
                        margin.top + ((value - 1) * height / 5) :
                        margin.top + ((maxY - value) * height / yRange);

                    if (i === 0) {
                        ctx.moveTo(x, y);
                    } else {
                        ctx.lineTo(x, y);
                    }
                }
                ctx.stroke();

                // Îç∞Ïù¥ÌÑ∞ Ìè¨Ïù∏Ìä∏
                ctx.fillStyle = colors[teamIndex];
                for (let i = 0; i < dataPoints; i += 5) { // 5Í∞úÎßàÎã§ Ï†ê ÌëúÏãú
                    const value = dataGenerator(teamIndex, i);
                    const x = margin.left + (i * width / (dataPoints - 1));
                    const y = isRanking ?
                        margin.top + ((value - 1) * height / 5) :
                        margin.top + ((maxY - value) * height / yRange);

                    ctx.beginPath();
                    ctx.arc(x, y, 3, 0, 2 * Math.PI);
                    ctx.fill();
                }

                // Î≤îÎ°Ä
                const legendY = margin.top + teamIndex * 22;
                ctx.fillStyle = colors[teamIndex];
                ctx.fillRect(margin.left + width + 20, legendY - 8, 15, 15);
                ctx.fillStyle = '#333';
                ctx.font = '13px Arial';
                ctx.textAlign = 'left';
                ctx.fillText(team, margin.left + width + 40, legendY + 4);
            });

        }

        // ===== Ïã§Ï†ú ÏãúÏ¶å Î∂ÑÏÑù Îç∞Ïù¥ÌÑ∞ Ï≤òÎ¶¨ =====
        function processSeasonAnalysisData() {

            if (!gamesData || gamesData.length === 0) {
                return createSampleSeasonData();
            }

            // ÌåÄ Îß§Ìïë (ÏïΩÏûê -> ÏùºÎ≥∏Ïñ¥ Ïù¥Î¶Ñ)
            const teamMapping = {
                'YOG': 'Â∑®‰∫∫', 'YAK': '„É§„ÇØ„É´„Éà', 'YDB': 'DeNA', 'HAN': 'Èò™Á•û', 'HIR': 'Â∫ÉÂ≥∂', 'CHU': '‰∏≠Êó•',
                'SOF': '„ÇΩ„Éï„Éà„Éê„É≥„ÇØ', 'NIP': 'Êó•Êú¨„Éè„É†', 'SEI': 'Ë•øÊ≠¶', 'RAK': 'Ê•ΩÂ§©', 'ORI': '„Ç™„É™„ÉÉ„ÇØ„Çπ', 'LOT': '„É≠„ÉÉ„ÉÜ'
            };

            const leagues = {
                central: ['Â∑®‰∫∫', '„É§„ÇØ„É´„Éà', 'DeNA', 'Èò™Á•û', 'Â∫ÉÂ≥∂', '‰∏≠Êó•'],
                pacific: ['„ÇΩ„Éï„Éà„Éê„É≥„ÇØ', 'Êó•Êú¨„Éè„É†', 'Ë•øÊ≠¶', 'Ê•ΩÂ§©', '„Ç™„É™„ÉÉ„ÇØ„Çπ', '„É≠„ÉÉ„ÉÜ']
            };

            const seasonData = {
                central: {},
                pacific: {}
            };

            // Í∞Å Î¶¨Í∑∏Î≥ÑÎ°ú ÌåÄ Îç∞Ïù¥ÌÑ∞ Ï¥àÍ∏∞Ìôî
            Object.keys(leagues).forEach(league => {
                leagues[league].forEach(team => {
                    seasonData[league][team] = {
                        dailyStats: [],
                        rankings: [],
                        winRates: [],
                        gamesBehind: [],
                        wins: [],
                        dates: []
                    };
                });
            });

            // ÏôÑÎ£åÎêú Í≤ΩÍ∏∞Îßå ÌïÑÌÑ∞ÎßÅÌïòÍ≥† ÎÇ†ÏßúÎ≥ÑÎ°ú Í∑∏Î£πÌôî
            const completedGames = gamesData.filter(game => {
                const status = (game.game_status || game.status || '').toLowerCase();
                return status === 'completed' && game.home_score !== undefined && game.away_score !== undefined;
            });

            const gamesByDate = {};
            completedGames.forEach(game => {
                const dateStr = game.game_date;
                if (!gamesByDate[dateStr]) {
                    gamesByDate[dateStr] = [];
                }
                gamesByDate[dateStr].push({
                    date: dateStr,
                    home: teamMapping[game.home_team_abbr] || game.home_team_abbr,
                    away: teamMapping[game.away_team_abbr] || game.away_team_abbr,
                    homeScore: parseInt(game.home_score),
                    awayScore: parseInt(game.away_score)
                });
            });

            const sortedDates = Object.keys(gamesByDate).sort();

            // Í∞Å ÎÇ†ÏßúÍπåÏßÄÏùò ÎàÑÏ†Å ÌÜµÍ≥Ñ Í≥ÑÏÇ∞
            sortedDates.forEach(date => {
                const currentStats = calculateStandingsAtDate(date, gamesByDate);

                Object.keys(leagues).forEach(league => {
                    const leagueTeams = leagues[league];
                    const leagueStandings = currentStats.filter(stat =>
                        leagueTeams.includes(stat.team)
                    ).sort((a, b) => {
                        if (b.winRate !== a.winRate) return b.winRate - a.winRate;
                        if (b.wins !== a.wins) return b.wins - a.wins;
                        return a.losses - b.losses;
                    });

                    leagueStandings.forEach((stat, index) => {
                        const team = stat.team;
                        const teamData = seasonData[league][team];

                        if (teamData) {
                            teamData.dates.push(date);
                            teamData.rankings.push(index + 1);
                            teamData.winRates.push(stat.winRate);
                            teamData.wins.push(stat.wins);

                            // Í≤åÏûÑÏ∞® Í≥ÑÏÇ∞ (1ÏúÑÏôÄÏùò Ï∞®Ïù¥)
                            const firstPlace = leagueStandings[0];
                            const gamesBehind = calculateGamesBehind(stat, firstPlace);
                            teamData.gamesBehind.push(gamesBehind);
                        }
                    });
                });
            });

            return seasonData;
        }

        function createSampleSeasonData() {

            const leagues = {
                central: ['Â∑®‰∫∫', '„É§„ÇØ„É´„Éà', 'DeNA', 'Èò™Á•û', 'Â∫ÉÂ≥∂', '‰∏≠Êó•'],
                pacific: ['„ÇΩ„Éï„Éà„Éê„É≥„ÇØ', 'Êó•Êú¨„Éè„É†', 'Ë•øÊ≠¶', 'Ê•ΩÂ§©', '„Ç™„É™„ÉÉ„ÇØ„Çπ', '„É≠„ÉÉ„ÉÜ']
            };

            const seasonData = {
                central: {},
                pacific: {}
            };

            // ÏÉòÌîå ÎÇ†Ïßú ÏÉùÏÑ± (ÏßÄÎÇú 30Ïùº)
            const dates = [];
            for (let i = 29; i >= 0; i--) {
                const date = new Date();
                date.setDate(date.getDate() - i);
                dates.push(date.toISOString().split('T')[0]);
            }

            Object.keys(leagues).forEach(league => {
                leagues[league].forEach((team, teamIndex) => {
                    const rankings = [];
                    const winRates = [];
                    const gamesBehind = [];
                    const wins = [];

                    // Í∞Å ÎÇ†ÏßúÎ≥ÑÎ°ú ÏÉòÌîå Îç∞Ïù¥ÌÑ∞ ÏÉùÏÑ±
                    dates.forEach((date, dateIndex) => {
                        // ÏàúÏúÑ: ÌåÄ Ïù∏Îç±Ïä§ + ÎûúÎç§ Î≥ÄÎèô
                        const ranking = Math.max(1, Math.min(6, teamIndex + 1 + Math.floor(Math.random() * 3) - 1));
                        rankings.push(ranking);

                        // ÏäπÎ•†: 0.3 ~ 0.7 ÏÇ¨Ïù¥ÏóêÏÑú Î≥ÄÎèô
                        const baseWinRate = 0.5 + (3 - teamIndex) * 0.03;
                        const winRate = Math.max(0.3, Math.min(0.7, baseWinRate + (Math.random() - 0.5) * 0.2));
                        winRates.push(winRate);

                        // Í≤åÏûÑÏ∞®: ÏàúÏúÑÏóê Îî∞Îùº Í≤∞Ï†ï
                        const gb = Math.max(0, (ranking - 1) * 2 + Math.random() * 3);
                        gamesBehind.push(gb);

                        // ÏäπÏàò: ÎÇ†ÏßúÏóê ÎπÑÎ°ÄÌïòÏó¨ Ï¶ùÍ∞Ä
                        const winCount = Math.floor(dateIndex * winRate);
                        wins.push(winCount);
                    });

                    seasonData[league][team] = {
                        dates: [...dates],
                        rankings,
                        winRates,
                        gamesBehind,
                        wins
                    };
                });
            });

            return seasonData;
        }

        function calculateStandingsAtDate(targetDate, gamesByDate) {
            const stats = {};

            // Î™®Îì† ÌåÄ Ï¥àÍ∏∞Ìôî
            const allTeams = ['Â∑®‰∫∫', '„É§„ÇØ„É´„Éà', 'DeNA', 'Èò™Á•û', 'Â∫ÉÂ≥∂', '‰∏≠Êó•',
                             '„ÇΩ„Éï„Éà„Éê„É≥„ÇØ', 'Êó•Êú¨„Éè„É†', 'Ë•øÊ≠¶', 'Ê•ΩÂ§©', '„Ç™„É™„ÉÉ„ÇØ„Çπ', '„É≠„ÉÉ„ÉÜ'];
            allTeams.forEach(team => {
                stats[team] = { wins: 0, losses: 0, draws: 0 };
            });

            // Ìï¥Îãπ ÎÇ†ÏßúÍπåÏßÄÏùò Î™®Îì† Í≤åÏûÑ Í≤∞Í≥º ÎàÑÏ†Å
            Object.keys(gamesByDate).forEach(date => {
                if (date <= targetDate) {
                    const games = gamesByDate[date];
                    games.forEach(game => {
                        const homeTeam = game.home;
                        const awayTeam = game.away;

                        if (!stats[homeTeam]) stats[homeTeam] = { wins: 0, losses: 0, draws: 0 };
                        if (!stats[awayTeam]) stats[awayTeam] = { wins: 0, losses: 0, draws: 0 };

                        if (game.homeScore > game.awayScore) {
                            stats[homeTeam].wins++;
                            stats[awayTeam].losses++;
                        } else if (game.homeScore < game.awayScore) {
                            stats[awayTeam].wins++;
                            stats[homeTeam].losses++;
                        } else {
                            stats[homeTeam].draws++;
                            stats[awayTeam].draws++;
                        }
                    });
                }
            });

            // ÏäπÎ•† Í≥ÑÏÇ∞ÌïòÏó¨ Î∞òÌôò
            return Object.keys(stats).map(team => {
                const { wins, losses, draws } = stats[team];
                const totalGames = wins + losses + draws;
                const winRate = totalGames > 0 ? wins / (wins + losses) : 0;

                return {
                    team,
                    wins,
                    losses,
                    draws,
                    winRate,
                    totalGames
                };
            });
        }

        function calculateGamesBehind(teamStat, firstPlaceStat) {
            const teamWins = teamStat.wins;
            const teamLosses = teamStat.losses;
            const firstWins = firstPlaceStat.wins;
            const firstLosses = firstPlaceStat.losses;

            return Math.max(0, ((firstWins - teamWins) + (teamLosses - firstLosses)) / 2);
        }

        // ===== Í∞úÏÑ†Îêú Ï∞®Ìä∏ Í∑∏Î¶¨Í∏∞ Ìï®ÏàòÎì§ =====
        function drawRealRankingChart(league, teamData) {

            const canvas = document.getElementById(`${league}-ranking-canvas`);
            if (!canvas) {
                console.error(`Canvas not found: ${league}-ranking-canvas`);
                return;
            }

            const ctx = canvas.getContext('2d');
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            const margin = { top: 40, right: 180, bottom: 80, left: 50 };
            const width = canvas.width - margin.left - margin.right;
            const height = canvas.height - margin.top - margin.bottom;

            // Î∞∞Í≤Ω
            ctx.fillStyle = '#ffffff';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            const teams = Object.keys(teamData);
            const colors = generateTeamColors(teams);

            if (teams.length === 0) {
                drawTestChart(canvas, ctx, 'ÏàúÏúÑ Î≥ÄÎèô Ï∞®Ìä∏');
                return;
            }

            // Ï≤´ Î≤àÏß∏ ÌåÄÏùò ÎÇ†Ïßú Î∞∞Ïó¥ÏùÑ Í∏∞Ï§ÄÏúºÎ°ú ÏÇ¨Ïö©
            const dates = teamData[teams[0]]?.dates || [];
            if (dates.length === 0) {
                drawTestChart(canvas, ctx, 'ÏàúÏúÑ Î≥ÄÎèô Ï∞®Ìä∏');
                return;
            }

            // Í≤©ÏûêÏÑ† Í∑∏Î¶¨Í∏∞
            drawGrid(ctx, margin, width, height, 6, dates.length);

            // YÏ∂ï Î†àÏù¥Î∏î (ÏàúÏúÑ)
            drawYAxisLabels(ctx, margin, height, 6, (i) => `${i}ÏúÑ`, true);

            // XÏ∂ï Î†àÏù¥Î∏î (ÎÇ†Ïßú)
            drawXAxisLabels(ctx, margin, width, height, dates, 10);

            // Í∞Å ÌåÄÏùò ÏàúÏúÑ Î≥ÄÎèô ÎùºÏù∏ Í∑∏Î¶¨Í∏∞
            teams.forEach((team, teamIndex) => {
                const rankings = teamData[team].rankings;
                if (rankings.length === 0) return;

                ctx.strokeStyle = colors[teamIndex];
                ctx.lineWidth = 2.5;
                ctx.beginPath();

                rankings.forEach((ranking, dateIndex) => {
                    const x = margin.left + (dateIndex * width / Math.max(1, dates.length - 1));
                    const y = margin.top + ((ranking - 1) * height / 5);

                    if (dateIndex === 0) {
                        ctx.moveTo(x, y);
                    } else {
                        ctx.lineTo(x, y);
                    }
                });
                ctx.stroke();

                // Îç∞Ïù¥ÌÑ∞ Ìè¨Ïù∏Ìä∏ Í∑∏Î¶¨Í∏∞
                ctx.fillStyle = colors[teamIndex];
                rankings.forEach((ranking, dateIndex) => {
                    const x = margin.left + (dateIndex * width / Math.max(1, dates.length - 1));
                    const y = margin.top + ((ranking - 1) * height / 5);

                    ctx.beginPath();
                    ctx.arc(x, y, 3, 0, 2 * Math.PI);
                    ctx.fill();
                });
            });

            // Î≤îÎ°Ä
            drawLegend(ctx, margin, width, teams, colors);

            // Ï†úÎ™©
            drawTitle(ctx, canvas.width, 'ÏàúÏúÑ Î≥ÄÎèô (ÎÇÆÏùÄ Ïà´ÏûêÏùºÏàòÎ°ù ÏÉÅÏúÑ)');
        }

        function drawRealWinRateChart(league, teamData) {
            const canvas = document.getElementById(`${league}-winrate-canvas`);
            if (!canvas) return;

            const ctx = canvas.getContext('2d');
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            const margin = { top: 40, right: 180, bottom: 80, left: 70 };
            const width = canvas.width - margin.left - margin.right;
            const height = canvas.height - margin.top - margin.bottom;

            // Î∞∞Í≤Ω
            ctx.fillStyle = '#ffffff';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            const teams = Object.keys(teamData);
            const colors = generateTeamColors(teams);

            if (teams.length === 0) return;

            const dates = teamData[teams[0]]?.dates || [];
            if (dates.length === 0) return;

            // ÏäπÎ•† Î≤îÏúÑ Í≥ÑÏÇ∞
            let minWinRate = 1, maxWinRate = 0;
            teams.forEach(team => {
                const winRates = teamData[team].winRates;
                if (winRates.length > 0) {
                    minWinRate = Math.min(minWinRate, ...winRates);
                    maxWinRate = Math.max(maxWinRate, ...winRates);
                }
            });

            // Ï†ÅÏ†àÌïú YÏ∂ï Î≤îÏúÑ ÏÑ§Ï†ï
            const yMin = Math.max(0, Math.floor((minWinRate - 0.05) * 10) / 10);
            const yMax = Math.min(1, Math.ceil((maxWinRate + 0.05) * 10) / 10);
            const yRange = yMax - yMin;

            // Í≤©ÏûêÏÑ†
            const ySteps = 5;
            for (let i = 0; i <= ySteps; i++) {
                const y = margin.top + (i * height / ySteps);
                ctx.strokeStyle = '#e0e0e0';
                ctx.lineWidth = 1;
                ctx.beginPath();
                ctx.moveTo(margin.left, y);
                ctx.lineTo(margin.left + width, y);
                ctx.stroke();

                // YÏ∂ï Î†àÏù¥Î∏î
                const winRate = yMax - (i * yRange / ySteps);
                ctx.fillStyle = '#666';
                ctx.font = '12px Arial';
                ctx.textAlign = 'right';
                ctx.fillText(winRate.toFixed(3), margin.left - 10, y + 4);
            }

            // XÏ∂ï Î†àÏù¥Î∏î
            drawXAxisLabels(ctx, margin, width, height, dates, 10);

            // Í∞Å ÌåÄÏùò ÏäπÎ•† Î≥ÄÌôî ÎùºÏù∏ Í∑∏Î¶¨Í∏∞
            teams.forEach((team, teamIndex) => {
                const winRates = teamData[team].winRates;
                if (winRates.length === 0) return;

                ctx.strokeStyle = colors[teamIndex];
                ctx.lineWidth = 2.5;
                ctx.beginPath();

                winRates.forEach((winRate, dateIndex) => {
                    const x = margin.left + (dateIndex * width / Math.max(1, dates.length - 1));
                    const y = margin.top + ((yMax - winRate) * height / yRange);

                    if (dateIndex === 0) {
                        ctx.moveTo(x, y);
                    } else {
                        ctx.lineTo(x, y);
                    }
                });
                ctx.stroke();

                // Îç∞Ïù¥ÌÑ∞ Ìè¨Ïù∏Ìä∏
                ctx.fillStyle = colors[teamIndex];
                winRates.forEach((winRate, dateIndex) => {
                    const x = margin.left + (dateIndex * width / Math.max(1, dates.length - 1));
                    const y = margin.top + ((yMax - winRate) * height / yRange);

                    ctx.beginPath();
                    ctx.arc(x, y, 3, 0, 2 * Math.PI);
                    ctx.fill();
                });
            });

            // Î≤îÎ°Ä
            drawLegend(ctx, margin, width, teams, colors);

            // Ï†úÎ™©
            drawTitle(ctx, canvas.width, 'ÏäπÎ•† Î≥ÄÌôî');
        }

        function drawRealGamesBehindChart(league, teamData) {
            const canvas = document.getElementById(`${league}-gamesbehind-canvas`);
            if (!canvas) return;

            const ctx = canvas.getContext('2d');
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            const margin = { top: 40, right: 180, bottom: 80, left: 70 };
            const width = canvas.width - margin.left - margin.right;
            const height = canvas.height - margin.top - margin.bottom;

            // Î∞∞Í≤Ω
            ctx.fillStyle = '#ffffff';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            const teams = Object.keys(teamData);
            const colors = generateTeamColors(teams);

            if (teams.length === 0) return;

            const dates = teamData[teams[0]]?.dates || [];
            if (dates.length === 0) return;

            // Í≤åÏûÑÏ∞® Î≤îÏúÑ Í≥ÑÏÇ∞
            let maxGB = 0;
            teams.forEach(team => {
                const gbs = teamData[team].gamesBehind;
                if (gbs.length > 0) {
                    maxGB = Math.max(maxGB, ...gbs);
                }
            });

            maxGB = Math.ceil(maxGB + 1);

            // Í≤©ÏûêÏÑ†
            const ySteps = Math.min(maxGB, 10);
            for (let i = 0; i <= ySteps; i++) {
                const y = margin.top + (i * height / ySteps);
                ctx.strokeStyle = '#e0e0e0';
                ctx.lineWidth = 1;
                ctx.beginPath();
                ctx.moveTo(margin.left, y);
                ctx.lineTo(margin.left + width, y);
                ctx.stroke();

                // YÏ∂ï Î†àÏù¥Î∏î
                const gb = maxGB - (i * maxGB / ySteps);
                ctx.fillStyle = '#666';
                ctx.font = '12px Arial';
                ctx.textAlign = 'right';
                ctx.fillText(gb.toFixed(1), margin.left - 10, y + 4);
            }

            // XÏ∂ï Î†àÏù¥Î∏î
            drawXAxisLabels(ctx, margin, width, height, dates, 10);

            // Í∞Å ÌåÄÏùò Í≤åÏûÑÏ∞® Î≥ÄÌôî ÎùºÏù∏ Í∑∏Î¶¨Í∏∞
            teams.forEach((team, teamIndex) => {
                const gamesBehind = teamData[team].gamesBehind;
                if (gamesBehind.length === 0) return;

                ctx.strokeStyle = colors[teamIndex];
                ctx.lineWidth = 2.5;
                ctx.beginPath();

                gamesBehind.forEach((gb, dateIndex) => {
                    const x = margin.left + (dateIndex * width / Math.max(1, dates.length - 1));
                    const y = margin.top + ((maxGB - gb) * height / maxGB);

                    if (dateIndex === 0) {
                        ctx.moveTo(x, y);
                    } else {
                        ctx.lineTo(x, y);
                    }
                });
                ctx.stroke();

                // Îç∞Ïù¥ÌÑ∞ Ìè¨Ïù∏Ìä∏
                ctx.fillStyle = colors[teamIndex];
                gamesBehind.forEach((gb, dateIndex) => {
                    const x = margin.left + (dateIndex * width / Math.max(1, dates.length - 1));
                    const y = margin.top + ((maxGB - gb) * height / maxGB);

                    ctx.beginPath();
                    ctx.arc(x, y, 3, 0, 2 * Math.PI);
                    ctx.fill();
                });
            });

            // Î≤îÎ°Ä
            drawLegend(ctx, margin, width, teams, colors);

            // Ï†úÎ™©
            drawTitle(ctx, canvas.width, 'Í≤åÏûÑÏ∞® Î≥ÄÌôî (1ÏúÑÏôÄÏùò Ï∞®Ïù¥)');
        }

        function drawRealWinsChart(league, teamData) {
            const canvas = document.getElementById(`${league}-wins-canvas`);
            if (!canvas) return;

            const ctx = canvas.getContext('2d');
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            const margin = { top: 40, right: 180, bottom: 80, left: 70 };
            const width = canvas.width - margin.left - margin.right;
            const height = canvas.height - margin.top - margin.bottom;

            // Î∞∞Í≤Ω
            ctx.fillStyle = '#ffffff';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            const teams = Object.keys(teamData);
            const colors = generateTeamColors(teams);

            if (teams.length === 0) return;

            const dates = teamData[teams[0]]?.dates || [];
            if (dates.length === 0) return;

            // ÏäπÏàò Î≤îÏúÑ Í≥ÑÏÇ∞
            let maxWins = 0;
            teams.forEach(team => {
                const wins = teamData[team].wins;
                if (wins.length > 0) {
                    maxWins = Math.max(maxWins, ...wins);
                }
            });

            maxWins = Math.ceil(maxWins / 10) * 10; // 10 Îã®ÏúÑÎ°ú Ïò¨Î¶º

            // Í≤©ÏûêÏÑ†
            const ySteps = Math.min(maxWins / 10, 10);
            for (let i = 0; i <= ySteps; i++) {
                const y = margin.top + (i * height / ySteps);
                ctx.strokeStyle = '#e0e0e0';
                ctx.lineWidth = 1;
                ctx.beginPath();
                ctx.moveTo(margin.left, y);
                ctx.lineTo(margin.left + width, y);
                ctx.stroke();

                // YÏ∂ï Î†àÏù¥Î∏î
                const wins = maxWins - (i * maxWins / ySteps);
                ctx.fillStyle = '#666';
                ctx.font = '12px Arial';
                ctx.textAlign = 'right';
                ctx.fillText(wins.toString(), margin.left - 10, y + 4);
            }

            // XÏ∂ï Î†àÏù¥Î∏î
            drawXAxisLabels(ctx, margin, width, height, dates, 10);

            // Í∞Å ÌåÄÏùò ÏäπÏàò Î≥ÄÌôî ÎùºÏù∏ Í∑∏Î¶¨Í∏∞
            teams.forEach((team, teamIndex) => {
                const wins = teamData[team].wins;
                if (wins.length === 0) return;

                ctx.strokeStyle = colors[teamIndex];
                ctx.lineWidth = 2.5;
                ctx.beginPath();

                wins.forEach((winCount, dateIndex) => {
                    const x = margin.left + (dateIndex * width / Math.max(1, dates.length - 1));
                    const y = margin.top + ((maxWins - winCount) * height / maxWins);

                    if (dateIndex === 0) {
                        ctx.moveTo(x, y);
                    } else {
                        ctx.lineTo(x, y);
                    }
                });
                ctx.stroke();

                // Îç∞Ïù¥ÌÑ∞ Ìè¨Ïù∏Ìä∏
                ctx.fillStyle = colors[teamIndex];
                wins.forEach((winCount, dateIndex) => {
                    const x = margin.left + (dateIndex * width / Math.max(1, dates.length - 1));
                    const y = margin.top + ((maxWins - winCount) * height / maxWins);

                    ctx.beginPath();
                    ctx.arc(x, y, 3, 0, 2 * Math.PI);
                    ctx.fill();
                });
            });

            // Î≤îÎ°Ä
            drawLegend(ctx, margin, width, teams, colors);

            // Ï†úÎ™©
            drawTitle(ctx, canvas.width, 'ÏäπÏàò Î≥ÄÌôî');
        }

        // ===== Ï∞®Ìä∏ Ìó¨Ìçº Ìï®ÏàòÎì§ =====
        function generateTeamColors(teams) {
            const baseColors = [
                '#FF6B6B', '#4ECDC4', '#45B7D1', '#96CEB4', '#FECA57', '#FF9FF3',
                '#A8E6CF', '#FFD93D', '#6C5CE7', '#FD79A8', '#00B894', '#FDCB6E'
            ];
            return teams.map((_, index) => baseColors[index % baseColors.length]);
        }

        function drawGrid(ctx, margin, width, height, ySteps, xSteps) {
            ctx.strokeStyle = '#e0e0e0';
            ctx.lineWidth = 1;

            // YÏ∂ï Í≤©ÏûêÏÑ†
            for (let i = 0; i <= ySteps; i++) {
                const y = margin.top + (i * height / ySteps);
                ctx.beginPath();
                ctx.moveTo(margin.left, y);
                ctx.lineTo(margin.left + width, y);
                ctx.stroke();
            }

            // XÏ∂ï Í≤©ÏûêÏÑ†
            const xStep = Math.max(1, Math.floor(xSteps / 10));
            for (let i = 0; i <= xSteps; i += xStep) {
                const x = margin.left + (i * width / Math.max(1, xSteps - 1));
                ctx.beginPath();
                ctx.moveTo(x, margin.top);
                ctx.lineTo(x, margin.top + height);
                ctx.stroke();
            }
        }

        function drawYAxisLabels(ctx, margin, height, steps, labelFunc, reverse = false) {
            ctx.fillStyle = '#666';
            ctx.font = '12px Arial';
            ctx.textAlign = 'right';

            for (let i = 0; i <= steps; i++) {
                const y = margin.top + (i * height / steps);
                const labelIndex = reverse ? i + 1 : steps - i;
                ctx.fillText(labelFunc(labelIndex), margin.left - 10, y + 4);
            }
        }

        function drawXAxisLabels(ctx, margin, width, height, dates, maxLabels) {
            if (dates.length === 0) return;

            ctx.fillStyle = '#666';
            ctx.font = '11px Arial';
            ctx.textAlign = 'center';

            const step = Math.max(1, Math.floor(dates.length / maxLabels));

            for (let i = 0; i < dates.length; i += step) {
                const x = margin.left + (i * width / Math.max(1, dates.length - 1));
                const y = margin.top + height + 20;

                // ÎÇ†Ïßú ÌòïÏãù Î≥ÄÌôò (YYYY-MM-DD ‚Üí MM/DD)
                const dateStr = dates[i];
                const formattedDate = dateStr.substring(5).replace('-', '/');

                ctx.save();
                ctx.translate(x, y);
                ctx.rotate(-Math.PI / 6); // -30ÎèÑ ÌöåÏ†Ñ
                ctx.fillText(formattedDate, 0, 0);
                ctx.restore();
            }
        }

        function drawLegend(ctx, margin, width, teams, colors) {
            const legendX = margin.left + width + 20;
            let legendY = margin.top;

            ctx.font = '13px Arial';
            ctx.textAlign = 'left';

            teams.forEach((team, index) => {
                // ÏÉâÏÉÅ Î∞ïÏä§
                ctx.fillStyle = colors[index];
                ctx.fillRect(legendX, legendY - 8, 15, 15);

                // ÌåÄ Ïù¥Î¶Ñ
                ctx.fillStyle = '#333';
                ctx.fillText(team, legendX + 20, legendY + 4);

                legendY += 22;
            });
        }

        function drawTitle(ctx, canvasWidth, title) {
            ctx.fillStyle = '#333';
            ctx.font = 'bold 16px Arial';
            ctx.textAlign = 'center';
            ctx.fillText(title, canvasWidth / 2, 25);
        }

        function drawTestChart(canvas, ctx, title) {

            // Î∞∞Í≤Ω
            ctx.fillStyle = '#ffffff';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // ÌÖåÏä§Ìä∏ Î©îÏãúÏßÄ
            ctx.fillStyle = '#333';
            ctx.font = '16px Arial';
            ctx.textAlign = 'center';
            ctx.fillText(title, canvas.width / 2, 50);

            ctx.font = '14px Arial';
            ctx.fillText('Îç∞Ïù¥ÌÑ∞ Ï§ÄÎπÑ Ï§ë...', canvas.width / 2, 80);
            ctx.fillText('Í≤ΩÍ∏∞ Îç∞Ïù¥ÌÑ∞Î•º Ï≤òÎ¶¨ÌïòÍ≥† ÏûàÏäµÎãàÎã§', canvas.width / 2, 100);

            // Í∞ÑÎã®Ìïú Í∑∏Î¶¨Îìú Í∑∏Î¶¨Í∏∞
            ctx.strokeStyle = '#e0e0e0';
            ctx.lineWidth = 1;

            for (let i = 0; i < 5; i++) {
                const y = 150 + i * 40;
                ctx.beginPath();
                ctx.moveTo(50, y);
                ctx.lineTo(canvas.width - 50, y);
                ctx.stroke();
            }

            for (let i = 0; i < 10; i++) {
                const x = 50 + i * (canvas.width - 100) / 9;
                ctx.beginPath();
                ctx.moveTo(x, 150);
                ctx.lineTo(x, 310);
                ctx.stroke();
            }

            // ÏÉòÌîå ÎùºÏù∏ Í∑∏Î¶¨Í∏∞
            ctx.strokeStyle = '#FF6B6B';
            ctx.lineWidth = 2;
            ctx.beginPath();
            for (let i = 0; i < 10; i++) {
                const x = 50 + i * (canvas.width - 100) / 9;
                const y = 150 + Math.random() * 160;
                if (i === 0) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }
            }
            ctx.stroke();
        }

        // ===== Í≥†Í∏â ÏãúÏ¶å Î∂ÑÏÑù Í∏∞Îä• =====
        function addAdvancedAnalytics() {
            try {
                addStreakAnalysis();
                addMomentumIndicators();
                addChartInteractivity();
                addTeamPerformanceMetrics();
            } catch (error) {
                console.warn('Advanced analytics failed:', error);
            }
        }

        function addStreakAnalysis() {
            const streakData = calculateTeamStreaks();
            displayStreakSummary(streakData);
        }

        function calculateTeamStreaks() {
            if (!gamesData || gamesData.length === 0) {
                return {};
            }

            const streaks = {};
            const allTeams = ['Â∑®‰∫∫', '„É§„ÇØ„É´„Éà', 'DeNA', 'Èò™Á•û', 'Â∫ÉÂ≥∂', '‰∏≠Êó•',
                             '„ÇΩ„Éï„Éà„Éê„É≥„ÇØ', 'Êó•Êú¨„Éè„É†', 'Ë•øÊ≠¶', 'Ê•ΩÂ§©', '„Ç™„É™„ÉÉ„ÇØ„Çπ', '„É≠„ÉÉ„ÉÜ'];

            // ÌåÄ Îß§Ìïë
            const teamMapping = {
                'YOG': 'Â∑®‰∫∫', 'YAK': '„É§„ÇØ„É´„Éà', 'YDB': 'DeNA', 'HAN': 'Èò™Á•û', 'HIR': 'Â∫ÉÂ≥∂', 'CHU': '‰∏≠Êó•',
                'SOF': '„ÇΩ„Éï„Éà„Éê„É≥„ÇØ', 'NIP': 'Êó•Êú¨„Éè„É†', 'SEI': 'Ë•øÊ≠¶', 'RAK': 'Ê•ΩÂ§©', 'ORI': '„Ç™„É™„ÉÉ„ÇØ„Çπ', 'LOT': '„É≠„ÉÉ„ÉÜ'
            };

            allTeams.forEach(team => {
                // Ìï¥Îãπ ÌåÄÏùò Î™®Îì† Í≤ΩÍ∏∞Î•º ÎÇ†ÏßúÏàúÏúºÎ°ú Ï†ïÎ†¨
                const teamGames = gamesData
                    .filter(game => {
                        const status = (game.game_status || game.status || '').toLowerCase();
                        if (status !== 'completed') return false;

                        const homeTeam = teamMapping[game.home_team_abbr] || game.home_team_abbr;
                        const awayTeam = teamMapping[game.away_team_abbr] || game.away_team_abbr;
                        return homeTeam === team || awayTeam === team;
                    })
                    .sort((a, b) => new Date(a.game_date) - new Date(b.game_date))
                    .map(game => ({
                        date: game.game_date,
                        home: teamMapping[game.home_team_abbr] || game.home_team_abbr,
                        away: teamMapping[game.away_team_abbr] || game.away_team_abbr,
                        homeScore: parseInt(game.home_score),
                        awayScore: parseInt(game.away_score)
                    }));

                const recentGames = teamGames.slice(-10);

                let currentStreak = 0;
                let streakType = 'N/A';
                let longestWinStreak = 0;
                let longestLoseStreak = 0;

                // ÌòÑÏû¨ Ïó∞ÏÜç Í∏∞Î°ù Í≥ÑÏÇ∞
                for (let i = recentGames.length - 1; i >= 0; i--) {
                    const game = recentGames[i];
                    const result = getGameResult(game, team);

                    if (i === recentGames.length - 1) {
                        if (result === 'W') {
                            currentStreak = 1;
                            streakType = 'W';
                        } else if (result === 'L') {
                            currentStreak = 1;
                            streakType = 'L';
                        } else {
                            currentStreak = 1;
                            streakType = 'D';
                        }
                    } else {
                        if (result === streakType) {
                            currentStreak++;
                        } else {
                            break;
                        }
                    }
                }

                // ÏµúÏû• Ïó∞Ïäπ/Ïó∞Ìå® Í∏∞Î°ù Í≥ÑÏÇ∞
                let tempWinStreak = 0;
                let tempLoseStreak = 0;

                teamGames.forEach(game => {
                    const result = getGameResult(game, team);
                    if (result === 'W') {
                        tempWinStreak++;
                        tempLoseStreak = 0;
                        longestWinStreak = Math.max(longestWinStreak, tempWinStreak);
                    } else if (result === 'L') {
                        tempLoseStreak++;
                        tempWinStreak = 0;
                        longestLoseStreak = Math.max(longestLoseStreak, tempLoseStreak);
                    } else {
                        tempWinStreak = 0;
                        tempLoseStreak = 0;
                    }
                });

                streaks[team] = {
                    current: { length: currentStreak, type: streakType },
                    longestWin: longestWinStreak,
                    longestLose: longestLoseStreak,
                    recent10: recentGames.length
                };
            });

            return streaks;
        }

        function getGameResult(game, team) {
            if (game.home === team) {
                if (game.homeScore > game.awayScore) return 'W';
                if (game.homeScore < game.awayScore) return 'L';
                return 'D';
            } else if (game.away === team) {
                if (game.awayScore > game.homeScore) return 'W';
                if (game.awayScore < game.homeScore) return 'L';
                return 'D';
            }
            return 'N/A';
        }

        function addMomentumIndicators() {
            const momentumData = calculateMomentumIndicators();
            displayMomentumIndicators(momentumData);
        }

        function calculateMomentumIndicators() {
            if (!gamesData || gamesData.length === 0) {
                return {};
            }

            const momentum = {};
            const allTeams = ['Â∑®‰∫∫', '„É§„ÇØ„É´„Éà', 'DeNA', 'Èò™Á•û', 'Â∫ÉÂ≥∂', '‰∏≠Êó•',
                             '„ÇΩ„Éï„Éà„Éê„É≥„ÇØ', 'Êó•Êú¨„Éè„É†', 'Ë•øÊ≠¶', 'Ê•ΩÂ§©', '„Ç™„É™„ÉÉ„ÇØ„Çπ', '„É≠„ÉÉ„ÉÜ'];

            // ÌåÄ Îß§Ìïë
            const teamMapping = {
                'YOG': 'Â∑®‰∫∫', 'YAK': '„É§„ÇØ„É´„Éà', 'YDB': 'DeNA', 'HAN': 'Èò™Á•û', 'HIR': 'Â∫ÉÂ≥∂', 'CHU': '‰∏≠Êó•',
                'SOF': '„ÇΩ„Éï„Éà„Éê„É≥„ÇØ', 'NIP': 'Êó•Êú¨„Éè„É†', 'SEI': 'Ë•øÊ≠¶', 'RAK': 'Ê•ΩÂ§©', 'ORI': '„Ç™„É™„ÉÉ„ÇØ„Çπ', 'LOT': '„É≠„ÉÉ„ÉÜ'
            };

            allTeams.forEach(team => {
                // Ìï¥Îãπ ÌåÄÏùò Î™®Îì† Í≤ΩÍ∏∞Î•º ÎÇ†ÏßúÏàúÏúºÎ°ú Ï†ïÎ†¨
                const teamGames = gamesData
                    .filter(game => {
                        const status = (game.game_status || game.status || '').toLowerCase();
                        if (status !== 'completed') return false;

                        const homeTeam = teamMapping[game.home_team_abbr] || game.home_team_abbr;
                        const awayTeam = teamMapping[game.away_team_abbr] || game.away_team_abbr;
                        return homeTeam === team || awayTeam === team;
                    })
                    .sort((a, b) => new Date(a.game_date) - new Date(b.game_date))
                    .map(game => ({
                        date: game.game_date,
                        home: teamMapping[game.home_team_abbr] || game.home_team_abbr,
                        away: teamMapping[game.away_team_abbr] || game.away_team_abbr,
                        homeScore: parseInt(game.home_score),
                        awayScore: parseInt(game.away_score)
                    }));

                const recent20 = teamGames.slice(-20);
                const recent10 = teamGames.slice(-10);
                const recent5 = teamGames.slice(-5);

                const calculate20 = calculateWinRate(recent20, team);
                const calculate10 = calculateWinRate(recent10, team);
                const calculate5 = calculateWinRate(recent5, team);

                const momentumScore = (calculate5.winRate * 0.5) + (calculate10.winRate * 0.3) + (calculate20.winRate * 0.2);

                let trend = 'stable';
                if (calculate5.winRate > calculate10.winRate + 0.1) trend = 'rising';
                else if (calculate5.winRate < calculate10.winRate - 0.1) trend = 'falling';

                momentum[team] = {
                    score: momentumScore,
                    trend,
                    recent5: calculate5,
                    recent10: calculate10,
                    recent20: calculate20
                };
            });

            return momentum;
        }

        function calculateWinRate(games, team) {
            let wins = 0, losses = 0, draws = 0;

            games.forEach(game => {
                const result = getGameResult(game, team);
                if (result === 'W') wins++;
                else if (result === 'L') losses++;
                else if (result === 'D') draws++;
            });

            const totalDecisiveGames = wins + losses;
            const winRate = totalDecisiveGames > 0 ? wins / totalDecisiveGames : 0;

            return { wins, losses, draws, winRate, total: games.length };
        }

        function addChartInteractivity() {
            ['central', 'pacific'].forEach(league => {
                ['ranking', 'winrate', 'gamesbehind', 'wins'].forEach(chartType => {
                    const canvas = document.getElementById(`${league}-${chartType}-canvas`);
                    if (canvas) {
                        addCanvasTooltip(canvas, league, chartType);
                    }
                });
            });
        }

        function addCanvasTooltip(canvas, league, chartType) {
            const tooltip = document.createElement('div');
            tooltip.style.cssText = `
                position: absolute;
                background: rgba(0,0,0,0.8);
                color: white;
                padding: 8px 12px;
                border-radius: 4px;
                font-size: 12px;
                pointer-events: none;
                z-index: 1000;
                display: none;
                max-width: 200px;
            `;
            document.body.appendChild(tooltip);

            canvas.addEventListener('mouseleave', () => {
                tooltip.style.display = 'none';
            });
        }

        function displayStreakSummary(streakData) {
            const leagues = {
                central: ['Â∑®‰∫∫', '„É§„ÇØ„É´„Éà', 'DeNA', 'Èò™Á•û', 'Â∫ÉÂ≥∂', '‰∏≠Êó•'],
                pacific: ['„ÇΩ„Éï„Éà„Éê„É≥„ÇØ', 'Êó•Êú¨„Éè„É†', 'Ë•øÊ≠¶', 'Ê•ΩÂ§©', '„Ç™„É™„ÉÉ„ÇØ„Çπ', '„É≠„ÉÉ„ÉÜ']
            };

            Object.keys(leagues).forEach(league => {
                const container = document.querySelector(`#${league}-season-analysis`);
                if (!container) return;

                let streakSection = container.querySelector('.streak-summary');
                if (!streakSection) {
                    streakSection = document.createElement('div');
                    streakSection.className = 'streak-summary';
                    streakSection.style.cssText = `
                        margin: 20px 0;
                        padding: 15px;
                        background: #f8f9fa;
                        border-radius: 8px;
                        border-left: 4px solid #007bff;
                    `;
                    container.insertBefore(streakSection, container.firstChild);
                }

                const leagueTeams = leagues[league];
                let html = '<h4 style="margin-top: 0; color: #333;">üî• Ïó∞ÏÜç Í∏∞Î°ù ÌòÑÌô©</h4>';
                html += '<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 10px;">';

                leagueTeams.forEach(team => {
                    const streak = streakData[team];
                    if (!streak) return;

                    const currentStreakText = streak.current.type === 'W' ? `${streak.current.length}Ïó∞Ïäπ` :
                                            streak.current.type === 'L' ? `${streak.current.length}Ïó∞Ìå®` :
                                            streak.current.type === 'D' ? `${streak.current.length}Ïó∞Î¨¥` : '-';

                    const streakColor = streak.current.type === 'W' ? '#28a745' :
                                      streak.current.type === 'L' ? '#dc3545' : '#6c757d';

                    html += `
                        <div style="background: white; padding: 10px; border-radius: 6px; border: 1px solid #dee2e6;">
                            <div style="font-weight: bold; margin-bottom: 5px;">${team}</div>
                            <div style="color: ${streakColor}; font-weight: bold; margin-bottom: 3px;">
                                ÌòÑÏû¨: ${currentStreakText}
                            </div>
                            <div style="font-size: 12px; color: #666;">
                                ÏµúÎåÄ Ïó∞Ïäπ: ${streak.longestWin}Í≤ΩÍ∏∞<br>
                                ÏµúÎåÄ Ïó∞Ìå®: ${streak.longestLose}Í≤ΩÍ∏∞
                            </div>
                        </div>
                    `;
                });

                html += '</div>';
                streakSection.innerHTML = html;
            });
        }

        function displayMomentumIndicators(momentumData) {
            const leagues = {
                central: ['Â∑®‰∫∫', '„É§„ÇØ„É´„Éà', 'DeNA', 'Èò™Á•û', 'Â∫ÉÂ≥∂', '‰∏≠Êó•'],
                pacific: ['„ÇΩ„Éï„Éà„Éê„É≥„ÇØ', 'Êó•Êú¨„Éè„É†', 'Ë•øÊ≠¶', 'Ê•ΩÂ§©', '„Ç™„É™„ÉÉ„ÇØ„Çπ', '„É≠„ÉÉ„ÉÜ']
            };

            Object.keys(leagues).forEach(league => {
                const container = document.querySelector(`#${league}-season-analysis`);
                if (!container) return;

                let momentumSection = container.querySelector('.momentum-indicators');
                if (!momentumSection) {
                    momentumSection = document.createElement('div');
                    momentumSection.className = 'momentum-indicators';
                    momentumSection.style.cssText = `
                        margin: 20px 0;
                        padding: 15px;
                        background: #f8f9fa;
                        border-radius: 8px;
                        border-left: 4px solid #28a745;
                    `;
                    const streakSection = container.querySelector('.streak-summary');
                    if (streakSection) {
                        container.insertBefore(momentumSection, streakSection.nextSibling);
                    } else {
                        container.insertBefore(momentumSection, container.firstChild);
                    }
                }

                const leagueTeams = leagues[league];
                let html = '<h4 style="margin-top: 0; color: #333;">üìà ÌåÄ Î™®Î©òÌÖÄ ÏßÄÌëú</h4>';
                html += '<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 10px;">';

                const sortedTeams = leagueTeams.sort((a, b) => {
                    const scoreA = momentumData[a]?.score || 0;
                    const scoreB = momentumData[b]?.score || 0;
                    return scoreB - scoreA;
                });

                sortedTeams.forEach(team => {
                    const momentum = momentumData[team];
                    if (!momentum) return;

                    const trendIcon = momentum.trend === 'rising' ? 'üî•' :
                                    momentum.trend === 'falling' ? 'üìâ' : '‚û°Ô∏è';

                    const trendColor = momentum.trend === 'rising' ? '#28a745' :
                                     momentum.trend === 'falling' ? '#dc3545' : '#6c757d';

                    const momentumBar = (momentum.score * 100).toFixed(0);

                    html += `
                        <div style="background: white; padding: 12px; border-radius: 6px; border: 1px solid #dee2e6;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                <span style="font-weight: bold;">${team}</span>
                                <span style="color: ${trendColor};">${trendIcon}</span>
                            </div>
                            <div style="background: #e9ecef; height: 8px; border-radius: 4px; margin-bottom: 8px;">
                                <div style="background: linear-gradient(90deg, #dc3545 0%, #ffc107 50%, #28a745 100%);
                                           height: 100%; width: ${momentumBar}%; border-radius: 4px;"></div>
                            </div>
                            <div style="font-size: 11px; color: #666; line-height: 1.3;">
                                ÏµúÍ∑º 5Í≤ΩÍ∏∞: ${momentum.recent5.wins}-${momentum.recent5.losses}-${momentum.recent5.draws}
                                (${(momentum.recent5.winRate * 100).toFixed(0)}%)<br>
                                ÏµúÍ∑º 10Í≤ΩÍ∏∞: ${momentum.recent10.wins}-${momentum.recent10.losses}-${momentum.recent10.draws}
                                (${(momentum.recent10.winRate * 100).toFixed(0)}%)
                            </div>
                        </div>
                    `;
                });

                html += '</div>';
                momentumSection.innerHTML = html;
            });
        }

        function addTeamPerformanceMetrics() {
            const performanceData = calculateTeamPerformanceMetrics();
            displayTeamPerformanceMetrics(performanceData);
        }

        function calculateTeamPerformanceMetrics() {
            if (!gamesData || gamesData.length === 0) {
                return {};
            }

            const metrics = {};
            const allTeams = ['Â∑®‰∫∫', '„É§„ÇØ„É´„Éà', 'DeNA', 'Èò™Á•û', 'Â∫ÉÂ≥∂', '‰∏≠Êó•',
                             '„ÇΩ„Éï„Éà„Éê„É≥„ÇØ', 'Êó•Êú¨„Éè„É†', 'Ë•øÊ≠¶', 'Ê•ΩÂ§©', '„Ç™„É™„ÉÉ„ÇØ„Çπ', '„É≠„ÉÉ„ÉÜ'];

            // ÌåÄ Îß§Ìïë
            const teamMapping = {
                'YOG': 'Â∑®‰∫∫', 'YAK': '„É§„ÇØ„É´„Éà', 'YDB': 'DeNA', 'HAN': 'Èò™Á•û', 'HIR': 'Â∫ÉÂ≥∂', 'CHU': '‰∏≠Êó•',
                'SOF': '„ÇΩ„Éï„Éà„Éê„É≥„ÇØ', 'NIP': 'Êó•Î≥∏„Éè„É†', 'SEI': 'Ë•øÊ≠¶', 'RAK': 'Ê•ΩÂ§©', 'ORI': '„Ç™„É™„ÉÉ„ÇØ„Çπ', 'LOT': '„É≠„ÉÉ„ÉÜ'
            };

            allTeams.forEach(team => {
                // Ìï¥Îãπ ÌåÄÏùò Î™®Îì† Í≤ΩÍ∏∞Î•º Í∞ÄÏ†∏Ïò§Í∏∞
                const teamGames = gamesData
                    .filter(game => {
                        const status = (game.game_status || game.status || '').toLowerCase();
                        if (status !== 'completed') return false;

                        const homeTeam = teamMapping[game.home_team_abbr] || game.home_team_abbr;
                        const awayTeam = teamMapping[game.away_team_abbr] || game.away_team_abbr;
                        return homeTeam === team || awayTeam === team;
                    })
                    .map(game => ({
                        date: game.game_date,
                        home: teamMapping[game.home_team_abbr] || game.home_team_abbr,
                        away: teamMapping[game.away_team_abbr] || game.away_team_abbr,
                        homeScore: parseInt(game.home_score),
                        awayScore: parseInt(game.away_score)
                    }));

                let homeWins = 0, homeLosses = 0, homeDraws = 0;
                let awayWins = 0, awayLosses = 0, awayDraws = 0;
                let totalRuns = 0, totalRunsAllowed = 0;
                let closeGames = 0;
                let blowouts = 0;

                teamGames.forEach(game => {
                    const isHome = game.home === team;
                    const result = getGameResult(game, team);
                    const scoreDiff = Math.abs(game.homeScore - game.awayScore);

                    if (isHome) {
                        if (result === 'W') homeWins++;
                        else if (result === 'L') homeLosses++;
                        else homeDraws++;
                        totalRuns += game.homeScore;
                        totalRunsAllowed += game.awayScore;
                    } else {
                        if (result === 'W') awayWins++;
                        else if (result === 'L') awayLosses++;
                        else awayDraws++;
                        totalRuns += game.awayScore;
                        totalRunsAllowed += game.homeScore;
                    }

                    if (scoreDiff === 1) closeGames++;
                    if (scoreDiff >= 5) blowouts++;
                });

                const totalGames = teamGames.length;

                metrics[team] = {
                    home: { wins: homeWins, losses: homeLosses, draws: homeDraws },
                    away: { wins: awayWins, losses: awayLosses, draws: awayDraws },
                    runsPerGame: totalGames > 0 ? (totalRuns / totalGames).toFixed(2) : 0,
                    runsAllowedPerGame: totalGames > 0 ? (totalRunsAllowed / totalGames).toFixed(2) : 0,
                    runDifferential: totalRuns - totalRunsAllowed,
                    closeGames,
                    blowouts
                };
            });

            return metrics;
        }

        function displayTeamPerformanceMetrics(performanceData) {
        }

        // ===== Î∞òÏùëÌòï Ï∞®Ìä∏ Î∞è ÌíàÏßà Í∞úÏÑ† =====
        function makeChartsResponsive() {
            const canvases = document.querySelectorAll('#season-analysis canvas');
            canvases.forEach(canvas => {
                resizeCanvas(canvas);
            });

            window.addEventListener('resize', () => {
                setTimeout(() => {
                    canvases.forEach(canvas => {
                        resizeCanvas(canvas);
                    });
                    updateSeasonAnalysis();
                }, 100);
            });
        }

        function resizeCanvas(canvas) {
            const container = canvas.parentElement;
            if (!container) return;

            const containerWidth = container.clientWidth - 20;
            const aspectRatio = 400 / 800;
            const newHeight = Math.max(300, containerWidth * aspectRatio);

            canvas.width = containerWidth;
            canvas.height = newHeight;
            canvas.style.width = containerWidth + 'px';
            canvas.style.height = newHeight + 'px';
        }


        function drawRankingChart(league, teams, colors) {
            const canvas = document.getElementById(`${league}-ranking-canvas`);
            if (!canvas) return;

            const ctx = canvas.getContext('2d');
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Ï∞®Ìä∏ ÏòÅÏó≠ ÏÑ§Ï†ï
            const margin = { top: 40, right: 150, bottom: 60, left: 50 };
            const width = canvas.width - margin.left - margin.right;
            const height = canvas.height - margin.top - margin.bottom;

            // Î∞∞Í≤Ω
            ctx.fillStyle = '#ffffff';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // Í≤©ÏûêÏÑ† Í∑∏Î¶¨Í∏∞ (ÏàúÏúÑ 1-6ÏúÑ)
            ctx.strokeStyle = '#e0e0e0';
            ctx.lineWidth = 1;

            for (let i = 1; i <= 6; i++) {
                const y = margin.top + (i - 1) * (height / 5);
                ctx.beginPath();
                ctx.moveTo(margin.left, y);
                ctx.lineTo(margin.left + width, y);
                ctx.stroke();

                // YÏ∂ï Î†àÏù¥Î∏î (ÏàúÏúÑ)
                ctx.fillStyle = '#666';
                ctx.font = '12px Arial';
                ctx.textAlign = 'right';
                ctx.fillText(`${i}‰Ωç`, margin.left - 10, y + 4);
            }

            // XÏ∂ï Î†àÏù¥Î∏î (Ïõî)
            const months = ['3Êúà', '4Êúà', '5Ïõî', '6Êúà', '7Êúà', '8Êúà', '9Êúà'];
            months.forEach((month, i) => {
                const x = margin.left + (i * width / (months.length - 1));
                ctx.fillStyle = '#666';
                ctx.font = '12px Arial';
                ctx.textAlign = 'center';
                ctx.fillText(month, x, canvas.height - 15);
            });

            // ÏÉòÌîå ÏàúÏúÑ Îç∞Ïù¥ÌÑ∞Î°ú ÎùºÏù∏ Í∑∏Î¶¨Í∏∞
            teams.forEach((team, teamIndex) => {
                ctx.strokeStyle = colors[teamIndex];
                ctx.lineWidth = 2;
                ctx.beginPath();

                // Í∞Å ÌåÄÏùò ÏÉòÌîå ÏàúÏúÑ Î≥ÄÎèô (ÎûúÎç§ÌïòÏßÄÎßå ÏùºÍ¥ÄÏÑ± ÏûàÎäî Ìå®ÌÑ¥)
                const rankingData = generateSampleRankingData(teamIndex, months.length);

                rankingData.forEach((rank, monthIndex) => {
                    const x = margin.left + (monthIndex * width / (months.length - 1));
                    const y = margin.top + (rank - 1) * (height / 5);

                    if (monthIndex === 0) {
                        ctx.moveTo(x, y);
                    } else {
                        ctx.lineTo(x, y);
                    }
                });

                ctx.stroke();

                // Î≤îÎ°Ä
                const legendY = margin.top + teamIndex * 25;
                ctx.fillStyle = colors[teamIndex];
                ctx.fillRect(margin.left + width + 20, legendY - 8, 15, 15);
                ctx.fillStyle = '#333';
                ctx.font = '14px Arial';
                ctx.textAlign = 'left';
                ctx.fillText(team, margin.left + width + 40, legendY + 4);
            });

            // Ï†úÎ™©
            ctx.fillStyle = '#333';
            ctx.font = 'bold 16px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('È†Ü‰ΩçÂ§âÂãï (È†Ü‰Ωç„ÅåÎÇÆÏùÑÏàòÎ°ù ‰∏ä‰Ωç)', canvas.width / 2, 25);
        }

        function drawWinRateChart(league, teams, colors) {
            const canvas = document.getElementById(`${league}-winrate-canvas`);
            if (!canvas) return;

            const ctx = canvas.getContext('2d');
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Ï∞®Ìä∏ ÏòÅÏó≠ ÏÑ§Ï†ï
            const margin = { top: 40, right: 150, bottom: 60, left: 70 };
            const width = canvas.width - margin.left - margin.right;
            const height = canvas.height - margin.top - margin.bottom;

            // Î∞∞Í≤Ω
            ctx.fillStyle = '#ffffff';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // YÏ∂ï Í≤©ÏûêÏÑ† (ÏäπÎ•† 0.3-0.7)
            ctx.strokeStyle = '#e0e0e0';
            ctx.lineWidth = 1;

            for (let rate = 0.3; rate <= 0.7; rate += 0.1) {
                const y = margin.top + (0.7 - rate) * height / 0.4;
                ctx.beginPath();
                ctx.moveTo(margin.left, y);
                ctx.lineTo(margin.left + width, y);
                ctx.stroke();

                // YÏ∂ï Î†àÏù¥Î∏î
                ctx.fillStyle = '#666';
                ctx.font = '12px Arial';
                ctx.textAlign = 'right';
                ctx.fillText(rate.toFixed(3), margin.left - 10, y + 4);
            }

            // ÏÉòÌîå Îç∞Ïù¥ÌÑ∞Î°ú Ï∞®Ìä∏ Í∑∏Î¶¨Í∏∞
            teams.forEach((team, teamIndex) => {
                ctx.strokeStyle = colors[teamIndex];
                ctx.lineWidth = 2;
                ctx.beginPath();

                const winRateData = generateSampleWinRateData(teamIndex, 20);

                winRateData.forEach((rate, gameIndex) => {
                    const x = margin.left + (gameIndex * width / (winRateData.length - 1));
                    const y = margin.top + (0.7 - rate) * height / 0.4;

                    if (gameIndex === 0) {
                        ctx.moveTo(x, y);
                    } else {
                        ctx.lineTo(x, y);
                    }
                });

                ctx.stroke();

                // Î≤îÎ°Ä
                const legendY = margin.top + teamIndex * 25;
                ctx.fillStyle = colors[teamIndex];
                ctx.fillRect(margin.left + width + 20, legendY - 8, 15, 15);
                ctx.fillStyle = '#333';
                ctx.font = '14px Arial';
                ctx.textAlign = 'left';
                ctx.fillText(team, margin.left + width + 40, legendY + 4);
            });

            // Ï†úÎ™©
            ctx.fillStyle = '#333';
            ctx.font = 'bold 16px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('ÏäπÎ•† Î≥ÄÌôî (ÏãúÏ¶å ÏßÑÌñâ)', canvas.width / 2, 25);
        }

        function drawGamesBehindChart(league, teams, colors) {
            const canvas = document.getElementById(`${league}-gamesbehind-canvas`);
            if (!canvas) return;

            const ctx = canvas.getContext('2d');
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Ï∞®Ìä∏ ÏòÅÏó≠ ÏÑ§Ï†ï
            const margin = { top: 40, right: 150, bottom: 60, left: 70 };
            const width = canvas.width - margin.left - margin.right;
            const height = canvas.height - margin.top - margin.bottom;

            // Î∞∞Í≤Ω
            ctx.fillStyle = '#ffffff';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // YÏ∂ï Í≤©ÏûêÏÑ† (Í≤åÏûÑÏ∞® 0-15)
            ctx.strokeStyle = '#e0e0e0';
            ctx.lineWidth = 1;

            for (let gb = 0; gb <= 15; gb += 3) {
                const y = margin.top + (15 - gb) * height / 15;
                ctx.beginPath();
                ctx.moveTo(margin.left, y);
                ctx.lineTo(margin.left + width, y);
                ctx.stroke();

                // YÏ∂ï Î†àÏù¥Î∏î
                ctx.fillStyle = '#666';
                ctx.font = '12px Arial';
                ctx.textAlign = 'right';
                ctx.fillText(`${gb}G`, margin.left - 10, y + 4);
            }

            // ÏÉòÌîå Îç∞Ïù¥ÌÑ∞Î°ú Ï∞®Ìä∏ Í∑∏Î¶¨Í∏∞
            teams.forEach((team, teamIndex) => {
                ctx.strokeStyle = colors[teamIndex];
                ctx.lineWidth = 2;
                ctx.beginPath();

                const gbData = generateSampleGamesBehindData(teamIndex, 20);

                gbData.forEach((gb, gameIndex) => {
                    const x = margin.left + (gameIndex * width / (gbData.length - 1));
                    const y = margin.top + (15 - gb) * height / 15;

                    if (gameIndex === 0) {
                        ctx.moveTo(x, y);
                    } else {
                        ctx.lineTo(x, y);
                    }
                });

                ctx.stroke();

                // Î≤îÎ°Ä
                const legendY = margin.top + teamIndex * 25;
                ctx.fillStyle = colors[teamIndex];
                ctx.fillRect(margin.left + width + 20, legendY - 8, 15, 15);
                ctx.fillStyle = '#333';
                ctx.font = '14px Arial';
                ctx.textAlign = 'left';
                ctx.fillText(team, margin.left + width + 40, legendY + 4);
            });

            // Ï†úÎ™©
            ctx.fillStyle = '#333';
            ctx.font = 'bold 16px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('Í≤åÏûÑÏ∞® Î≥ÄÌôî (1ÏúÑÏôÄÏùò Ï∞®Ïù¥)', canvas.width / 2, 25);
        }

        function drawWinsChart(league, teams, colors) {
            const canvas = document.getElementById(`${league}-wins-canvas`);
            if (!canvas) return;

            const ctx = canvas.getContext('2d');
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Ï∞®Ìä∏ ÏòÅÏó≠ ÏÑ§Ï†ï
            const margin = { top: 40, right: 150, bottom: 60, left: 70 };
            const width = canvas.width - margin.left - margin.right;
            const height = canvas.height - margin.top - margin.bottom;

            // Î∞∞Í≤Ω
            ctx.fillStyle = '#ffffff';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // YÏ∂ï Í≤©ÏûêÏÑ† (ÏäπÏàò 0-100)
            ctx.strokeStyle = '#e0e0e0';
            ctx.lineWidth = 1;

            for (let wins = 0; wins <= 100; wins += 20) {
                const y = margin.top + (100 - wins) * height / 100;
                ctx.beginPath();
                ctx.moveTo(margin.left, y);
                ctx.lineTo(margin.left + width, y);
                ctx.stroke();

                // YÏ∂ï Î†àÏù¥Î∏î
                ctx.fillStyle = '#666';
                ctx.font = '12px Arial';
                ctx.textAlign = 'right';
                ctx.fillText(`${wins}Ïäπ`, margin.left - 10, y + 4);
            }

            // ÏÉòÌîå Îç∞Ïù¥ÌÑ∞Î°ú Ï∞®Ìä∏ Í∑∏Î¶¨Í∏∞
            teams.forEach((team, teamIndex) => {
                ctx.strokeStyle = colors[teamIndex];
                ctx.lineWidth = 2;
                ctx.beginPath();

                const winsData = generateSampleWinsData(teamIndex, 100);

                winsData.forEach((wins, gameIndex) => {
                    const x = margin.left + (gameIndex * width / (winsData.length - 1));
                    const y = margin.top + (100 - wins) * height / 100;

                    if (gameIndex === 0) {
                        ctx.moveTo(x, y);
                    } else {
                        ctx.lineTo(x, y);
                    }
                });

                ctx.stroke();

                // Î≤îÎ°Ä
                const legendY = margin.top + teamIndex * 25;
                ctx.fillStyle = colors[teamIndex];
                ctx.fillRect(margin.left + width + 20, legendY - 8, 15, 15);
                ctx.fillStyle = '#333';
                ctx.font = '14px Arial';
                ctx.textAlign = 'left';
                ctx.fillText(team, margin.left + width + 40, legendY + 4);
            });

            // Ï†úÎ™©
            ctx.fillStyle = '#333';
            ctx.font = 'bold 16px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('ÎàÑÏ†Å ÏäπÏàò Î≥ÄÌôî', canvas.width / 2, 25);
        }

        // ÏÉòÌîå Îç∞Ïù¥ÌÑ∞ ÏÉùÏÑ± Ìï®ÏàòÎì§
        function generateSampleRankingData(teamIndex, length) {
            const baseRank = teamIndex + 1;
            const data = [baseRank];

            for (let i = 1; i < length; i++) {
                let change = (Math.random() - 0.5) * 2; // -1 to 1
                let newRank = data[i-1] + change;
                newRank = Math.max(1, Math.min(6, Math.round(newRank)));
                data.push(newRank);
            }

            return data;
        }

        function generateSampleWinRateData(teamIndex, length) {
            const baseRate = 0.5 + (3 - teamIndex) * 0.03; // ÏÉÅÏúÑÌåÄÏùºÏàòÎ°ù ÎÜíÏùÄ ÏäπÎ•†
            const data = [0.5]; // ÏãúÏ¶å Ï¥àÍ∏∞ ÏäπÎ•†

            for (let i = 1; i < length; i++) {
                let change = (Math.random() - 0.5) * 0.1;
                let newRate = data[i-1] + change;
                newRate = Math.max(0.3, Math.min(0.7, newRate));
                data.push(newRate);
            }

            return data;
        }

        function generateSampleGamesBehindData(teamIndex, length) {
            if (teamIndex === 0) {
                return new Array(length).fill(0); // 1ÏúÑÌåÄÏùÄ Ìï≠ÏÉÅ 0Í≤åÏûÑÏ∞®
            }

            const data = [0];

            for (let i = 1; i < length; i++) {
                let change = (Math.random() - 0.3) * 2; // ÏïΩÍ∞Ñ Îí§Ï≤òÏßÄÎäî Í≤ΩÌñ•
                let newGB = Math.max(0, data[i-1] + change);
                newGB = Math.min(15, newGB);
                data.push(newGB);
            }

            return data;
        }

        function generateSampleWinsData(teamIndex, maxGames) {
            const winRate = 0.5 + (3 - teamIndex) * 0.03;
            const data = [0];

            for (let game = 1; game < maxGames; game++) {
                const prevWins = data[game - 1];
                const shouldWin = Math.random() < winRate;
                data.push(prevWins + (shouldWin ? 1 : 0));
            }

            return data;
        }

        // ===== Ï†ÑÏ≤¥ Í≤ΩÍ∏∞ Í≤∞Í≥º ÌëúÏãú =====
        function updateAllGames() {
            if (!gamesData || !gamesData.length) {
                document.getElementById('all-games-body').innerHTML = '<tr><td colspan="7">„Éá„Éº„Çø„Åå„ÅÇ„Çä„Åæ„Åõ„Çì</td></tr>';
                return;
            }

            // Í≤ΩÍ∏∞Î•º ÎÇ†ÏßúÎ≥ÑÎ°ú Ï†ïÎ†¨ (ÏµúÏã†Ïàú)
            const sortedGames = [...gamesData].sort((a, b) => new Date(b.game_date) - new Date(a.game_date));

            // ÌÜµÌï© ÌÖåÏù¥Î∏î Î†åÎçîÎßÅ
            renderGamesTable('all-games-body', sortedGames);
        }

        function renderGamesTable(containerId, games) {
            const container = document.getElementById(containerId);
            if (!container) return;

            // Î™®Îì† ÌïÑÌÑ∞ Ï†ÅÏö©
            const selectedTeam = document.getElementById('team-filter')?.value || '';
            const selectedMonth = document.getElementById('month-filter')?.value || '';
            const selectedLeague = document.getElementById('league-filter')?.value || '';
            const selectedInning = document.getElementById('inning-filter')?.value || '';
            const selectedStadium = document.getElementById('stadium-filter')?.value || '';
            const selectedTime = document.getElementById('time-filter')?.value || '';
            const dateFrom = document.getElementById('date-from')?.value || '';
            const dateTo = document.getElementById('date-to')?.value || '';

            let filteredGames = games;

            // ÌåÄ ÌïÑÌÑ∞
            if (selectedTeam) {
                filteredGames = filteredGames.filter(game =>
                    game.away_team_abbr === selectedTeam || game.home_team_abbr === selectedTeam
                );
            }

            // Ïõî ÌïÑÌÑ∞
            if (selectedMonth) {
                filteredGames = filteredGames.filter(game => {
                    const gameMonth = new Date(game.game_date).getMonth() + 1; // 0-based month to 1-based
                    return gameMonth === parseInt(selectedMonth);
                });
            }

            // Î¶¨Í∑∏ ÌïÑÌÑ∞
            if (selectedLeague) {
                filteredGames = filteredGames.filter(game => game.league === selectedLeague);
            }

            // Ïù¥Îãù ÌïÑÌÑ∞
            if (selectedInning) {
                if (selectedInning === '9') {
                    filteredGames = filteredGames.filter(game => (game.final_inning || 9) === 9);
                } else if (selectedInning === 'extra') {
                    filteredGames = filteredGames.filter(game => (game.final_inning || 9) > 9);
                }
            }

            // Í≤ΩÍ∏∞Ïû• ÌïÑÌÑ∞
            if (selectedStadium) {
                filteredGames = filteredGames.filter(game => {
                    // stadium ÌïÑÎìúÏóêÏÑú Í≤ΩÍ∏∞Ïû• Ïù¥Î¶Ñ Ï∂îÏ∂ú
                    let stadium = game.stadium || '';
                    stadium = stadium.replace(/‚óáÈñãÂßã\d{1,2}ÊôÇ\d{1,2}ÂàÜ‚óá/, '').trim();
                    return stadium.includes(selectedStadium);
                });
            }

            // ÏãúÍ∞Ñ ÌïÑÌÑ∞
            if (selectedTime) {
                filteredGames = filteredGames.filter(game => {
                    // stadium ÌïÑÎìúÏóêÏÑú ÏãúÍ∞Ñ Ï∂îÏ∂ú
                    let gameTime = '';
                    const rawStadium = game.stadium || '';
                    const timeMatch = rawStadium.match(/‚óáÈñãÂßã(\d{1,2})ÊôÇ(\d{1,2})ÂàÜ‚óá/);

                    if (timeMatch) {
                        const hour = parseInt(timeMatch[1]);
                        const minute = parseInt(timeMatch[2]);
                        gameTime = `${hour}:${minute.toString().padStart(2, '0')}`;

                        if (selectedTime === 'day') {
                            return hour < 16;
                        } else if (selectedTime === 'night') {
                            return hour >= 16;
                        } else {
                            return hour === parseInt(selectedTime);
                        }
                    } else {
                        // ÏãúÍ∞Ñ Ï†ïÎ≥¥Í∞Ä ÏóÜÏúºÎ©¥ ÏöîÏùºÎ°ú Ï∂îÏ†ï
                        const gameDate = new Date(game.game_date);
                        const dayOfWeek = gameDate.getDay();
                        const isWeekend = dayOfWeek === 0 || dayOfWeek === 6;

                        if (selectedTime === 'day') {
                            return isWeekend; // Ï£ºÎßêÏùÄ Ï£ºÎ°ú Îç∞Ïù¥Í≤åÏûÑ
                        } else if (selectedTime === 'night') {
                            return !isWeekend; // ÌèâÏùºÏùÄ Ï£ºÎ°ú ÎÇòÏù¥Ìä∏Í≤åÏûÑ
                        } else if (selectedTime === '14') {
                            return isWeekend;
                        } else if (selectedTime === '18') {
                            return !isWeekend;
                        }
                    }
                    return true;
                });
            }

            // ÎÇ†Ïßú Î≤îÏúÑ ÌïÑÌÑ∞
            if (dateFrom || dateTo) {
                filteredGames = filteredGames.filter(game => {
                    const gameDate = game.game_date;
                    if (dateFrom && gameDate < dateFrom) return false;
                    if (dateTo && gameDate > dateTo) return false;
                    return true;
                });
            }

            // ÌïÑÌÑ∞ Í≤∞Í≥º ÏöîÏïΩ ÌëúÏãú
            updateFilterSummary(filteredGames, games);

            if (!filteredGames.length) {
                container.innerHTML = '<tr><td colspan="7">„Éá„Éº„Çø„Åå„ÅÇ„Çä„Åæ„Åõ„Çì</td></tr>';
                return;
            }

            const html = filteredGames.map(game => {
                const gameDate = new Date(game.game_date);
                const dateDisplay = gameDate.toLocaleDateString('ja-JP', {
                    month: 'numeric',
                    day: 'numeric'
                });

                // ÏöîÏùº ÌëúÏãú Î∞è Ï£ºÎßê Ï≤¥ÌÅ¨
                const dayOfWeek = gameDate.toLocaleDateString('ja-JP', { weekday: 'short' });
                const isWeekend = gameDate.getDay() === 0 || gameDate.getDay() === 6; // ÏùºÏöîÏùº(0) ÎòêÎäî ÌÜ†ÏöîÏùº(6)
                const weekendClass = isWeekend ? 'weekend-game' : '';

                // ÌåÄ Î°úÍ≥† Í∞ÄÏ†∏Ïò§Í∏∞
                const awayLogo = TEAM_LOGOS[game.away_team_abbr] ?
                    `<img class="team-logo" src="${TEAM_LOGOS[game.away_team_abbr]}" alt="${game.away_team_abbr}" loading="lazy">` : '';
                const homeLogo = TEAM_LOGOS[game.home_team_abbr] ?
                    `<img class="team-logo" src="${TEAM_LOGOS[game.home_team_abbr]}" alt="${game.home_team_abbr}" loading="lazy">` : '';

                // ÏäπÎ¶¨ ÌåÄ ÌëúÏãúÎ•º ÏúÑÌïú ÌÅ¥ÎûòÏä§
                const awayWin = game.away_score > game.home_score;
                const homeWin = game.home_score > game.away_score;
                const isDraw = game.is_draw || (game.away_score === game.home_score);

                // Ï†êÏàò ÌëúÏãú
                const scoreDisplay = isDraw ?
                    `<span class="draw-game">${game.away_score} - ${game.home_score} (ÂºïÂàÜ)</span>` :
                    `${game.away_score} - ${game.home_score}`;

                // Ïù¥Îãù ÌëúÏãú (Ïó∞Ïû•Ï†Ñ Í∞ïÏ°∞)
                const finalInning = game.final_inning || 9;
                const inningDisplay = finalInning > 9 ?
                    `<span class="extended-inning">${finalInning}Âõû</span>` :
                    `${finalInning}Âõû`;

                // Í≤ΩÍ∏∞ ÏãúÍ∞ÑÍ≥º Íµ¨Ïû•Î™Ö Î∂ÑÎ¶¨
                let rawStadium = game.stadium || '';
                let gameTime = '';
                let stadium = '';

                // ÏãúÍ∞Ñ Ï†ïÎ≥¥ Ï∂îÏ∂ú (‚óáÈñãÂßã18ÊôÇ19ÂàÜ‚óá ÌòïÌÉú)
                const timeMatch = rawStadium.match(/‚óáÈñãÂßã(\d{1,2}ÊôÇ\d{1,2}ÂàÜ)‚óá/);
                if (timeMatch) {
                    gameTime = timeMatch[1].replace('ÊôÇ', ':').replace('ÂàÜ', '');
                    stadium = rawStadium.replace(/‚óáÈñãÂßã\d{1,2}ÊôÇ\d{1,2}ÂàÜ‚óá/, '').trim();
                } else {
                    // Îã§Î•∏ ÏãúÍ∞Ñ ÌòïÌÉú Ï≤òÎ¶¨ (18:00, 14:00 Îì±)
                    const timeMatch2 = rawStadium.match(/(\d{1,2}:\d{2})/);
                    if (timeMatch2) {
                        gameTime = timeMatch2[1];
                        stadium = rawStadium.replace(/\d{1,2}:\d{2}/, '').trim();
                    } else {
                        stadium = rawStadium;

                        // ÏãúÍ∞Ñ Ï†ïÎ≥¥Í∞Ä ÏóÜÏùÑ Îïå Í∏∞Î≥∏ ÏãúÍ∞Ñ Ï∂îÏ†ï
                        // game_time ÌïÑÎìú Ï≤¥ÌÅ¨
                        if (game.game_time) {
                            gameTime = game.game_time;
                        } else if (game.time) {
                            gameTime = game.time;
                        } else {
                            // Ï£ºÎßê Ïó¨Î∂ÄÏóê Îî∞Îùº Í∏∞Î≥∏ ÏãúÍ∞Ñ ÏÑ§Ï†ï
                            const gameDate = new Date(game.game_date);
                            const dayOfWeek = gameDate.getDay();
                            if (dayOfWeek === 0 || dayOfWeek === 6) {
                                // Ï£ºÎßê(ÌÜ†/Ïùº) - Ïò§ÌõÑ Í≤ΩÍ∏∞
                                gameTime = '14:00';
                            } else {
                                // ÌèâÏùº - Ï†ÄÎÖÅ Í≤ΩÍ∏∞
                                gameTime = '18:00';
                            }
                        }
                    }
                }

                // Íµ¨Ïû•Î™Ö Í∞ÑÏÜåÌôî
                stadium = stadium
                    .replace('„Çπ„Çø„Ç∏„Ç¢„É†', '')
                    .replace('ÁêÉÂ†¥', '')
                    .replace('„Éâ„Éº„É†', '')
                    .replace('MAZDA Zoom-Zoom ', '')
                    .replace('PayPay', '')
                    .trim();

                // Î¶¨Í∑∏ ÌëúÏãú
                const leagueDisplay = game.league === 'Central' ?
                    '<span style="color: #2e7d32; font-weight: bold;">„Çª</span>' :
                    '<span style="color: #1976d2; font-weight: bold;">„Éë</span>';

                // Í≤ΩÍ∏∞ ÏãúÍ∞Ñ ÌëúÏãú (ÌÜµÏùºÎêú Ïä§ÌÉÄÏùº)
                const timeDisplay = gameTime ?
                    `<span style="font-size: 12px; color: #666;">${gameTime}</span>` :
                    '<span style="font-size: 12px; color: #999;">-</span>';

                return `
                    <tr class="${weekendClass}">
                        <td style="text-align: center;">
                            <span>${dateDisplay}</span>
                            <span style="margin-left: 4px; font-size: 12px; color: ${isWeekend ? '#d32f2f' : '#666'}; font-weight: ${isWeekend ? 'bold' : 'normal'};">(${dayOfWeek})</span>
                        </td>
                        <td style="text-align: center;">${leagueDisplay}</td>
                        <td class="${awayWin ? 'win-team' : ''}">
                            <div class="team-info">
                                ${awayLogo}
                                <span>${game.away_team_name}</span>
                            </div>
                        </td>
                        <td>${scoreDisplay}</td>
                        <td class="${homeWin ? 'win-team' : ''}">
                            <div class="team-info">
                                ${homeLogo}
                                <span>${game.home_team_name}</span>
                            </div>
                        </td>
                        <td style="text-align: center;">${timeDisplay}</td>
                        <td style="font-size: 12px; text-align: center;">${stadium}</td>
                        <td style="text-align: center;">${inningDisplay}</td>
                    </tr>
                `;
            }).join('');

            container.innerHTML = html;

            // ÌïÑÌÑ∞ ÏöîÏïΩ ÏóÖÎç∞Ïù¥Ìä∏
            updateFilterSummary(games.length, filteredGames.length);
        }

        // ===== Í≤åÏûÑ ÌïÑÌÑ∞ Í∏∞Îä• =====
        function resetAllFilters() {
            document.getElementById('team-filter').value = '';
            document.getElementById('month-filter').value = '';
            document.getElementById('league-filter').value = '';
            document.getElementById('inning-filter').value = '';
            document.getElementById('stadium-filter').value = '';
            document.getElementById('time-filter').value = '';
            document.getElementById('date-from').value = '';
            document.getElementById('date-to').value = '';
            updateAllGames(); // Î™®Îì† ÌïÑÌÑ∞ Î¶¨ÏÖã ÌõÑ Îã§Ïãú Î†åÎçîÎßÅ
        }

        // Íµ¨Î≤ÑÏ†Ñ Ìò∏ÌôòÏÑ±ÏùÑ ÏúÑÌïú Ìï®Ïàò
        function resetGameFilter() {
            resetAllFilters();
        }

        // Î™®Îì† ÌïÑÌÑ∞ Ïù¥Î≤§Ìä∏ Î¶¨Ïä§ÎÑà ÏÑ§Ï†ï
        function setupGameFilters() {
            const filters = ['team-filter', 'month-filter', 'league-filter', 'inning-filter',
                           'stadium-filter', 'time-filter'];

            filters.forEach(filterId => {
                const filter = document.getElementById(filterId);
                if (filter) {
                    filter.addEventListener('change', () => {
                        updateAllGames(); // ÌïÑÌÑ∞ Î≥ÄÍ≤Ω Ïãú Îã§Ïãú Î†åÎçîÎßÅ
                    });
                }
            });

            // ÎÇ†Ïßú ÌïÑÌÑ∞ Ïù¥Î≤§Ìä∏ Î¶¨Ïä§ÎÑà
            ['date-from', 'date-to'].forEach(dateId => {
                const dateInput = document.getElementById(dateId);
                if (dateInput) {
                    dateInput.addEventListener('change', () => {
                        updateAllGames(); // ÎÇ†Ïßú Î≥ÄÍ≤Ω Ïãú Îã§Ïãú Î†åÎçîÎßÅ
                    });
                }
            });
        }

        // ÌïÑÌÑ∞ Í≤∞Í≥º ÏöîÏïΩ ÌëúÏãú Ìï®Ïàò
        function updateFilterSummary(totalGames, filteredGames) {
            const summaryElement = document.getElementById('filter-summary');
            if (!summaryElement) return;

            const selectedTeam = document.getElementById('team-filter')?.value || '';
            const selectedMonth = document.getElementById('month-filter')?.value || '';
            const selectedLeague = document.getElementById('league-filter')?.value || '';
            const selectedInning = document.getElementById('inning-filter')?.value || '';
            const selectedStadium = document.getElementById('stadium-filter')?.value || '';
            const selectedTime = document.getElementById('time-filter')?.value || '';
            const dateFrom = document.getElementById('date-from')?.value || '';
            const dateTo = document.getElementById('date-to')?.value || '';

            // ÌôúÏÑ±ÌôîÎêú ÌïÑÌÑ∞Îì§ ÏàòÏßë
            const activeFilters = [];

            if (selectedTeam) {
                const teamOption = document.querySelector(`#team-filter option[value="${selectedTeam}"]`);
                activeFilters.push(`„ÉÅ„Éº„É†: ${teamOption ? teamOption.textContent : selectedTeam}`);
            }

            if (selectedMonth) {
                activeFilters.push(`Êúà: ${selectedMonth}Êúà`);
            }

            if (selectedLeague) {
                const leagueText = selectedLeague === 'Central' ? '„Çª„É≥„Éà„É©„É´„É™„Éº„Ç∞' : '„Éë„Ç∑„Éï„Ç£„ÉÉ„ÇØ„É™„Éº„Ç∞';
                activeFilters.push(`„É™„Éº„Ç∞: ${leagueText}`);
            }

            if (selectedInning) {
                const inningText = selectedInning === '9' ? '9ÂõûÊà¶' : 'Âª∂Èï∑Êà¶';
                activeFilters.push(`„Ç§„Éã„É≥„Ç∞: ${inningText}`);
            }

            if (selectedStadium) {
                const stadiumOption = document.querySelector(`#stadium-filter option[value="${selectedStadium}"]`);
                activeFilters.push(`ÁêÉÂ†¥: ${stadiumOption ? stadiumOption.textContent : selectedStadium}`);
            }

            if (selectedTime) {
                const timeOption = document.querySelector(`#time-filter option[value="${selectedTime}"]`);
                activeFilters.push(`ÊôÇÈñì: ${timeOption ? timeOption.textContent : selectedTime}`);
            }

            if (dateFrom || dateTo) {
                if (dateFrom && dateTo) {
                    activeFilters.push(`ÊúüÈñì: ${dateFrom} „Äú ${dateTo}`);
                } else if (dateFrom) {
                    activeFilters.push(`ÊúüÈñì: ${dateFrom} ‰ª•Èôç`);
                } else {
                    activeFilters.push(`ÊúüÈñì: ${dateTo} „Åæ„Åß`);
                }
            }

            // ÏöîÏïΩ ÌÖçÏä§Ìä∏ ÏÉùÏÑ±
            let summaryText = '';

            if (activeFilters.length === 0) {
                summaryText = `ÂÖ®Ë©¶Âêà„ÇíË°®Á§∫‰∏≠ <strong>${filteredGames}Ë©¶Âêà</strong>`;
            } else {
                const filterText = activeFilters.join(' | ');
                summaryText = `„Éï„Ç£„É´„Çø„ÉºÈÅ©Áî®: ${filterText} ‚Üí <strong>${filteredGames}/${totalGames}Ë©¶Âêà</strong>`;
            }

            const resultTextElement = document.getElementById('filter-result-text');
            if (resultTextElement) {
                resultTextElement.innerHTML = summaryText;
            }

            // Summary elementÎ•º Ìï≠ÏÉÅ ÌëúÏãú
            summaryElement.style.display = 'block';
        }

        // ===== „É°„Ç§„É≥„Éá„Éº„ÇøË™≠„ÅøËæº„ÅøÂá¶ÁêÜ =====
        async function loadDataEnhanced() {
            try {
                
                // ÏàúÏúÑ Îç∞Ïù¥ÌÑ∞ Î°úÎî© (cache-busting)
                const basePath = getDataPath();
                const cacheBust = `v=${Date.now()}`;
                const dataUrl = basePath + (basePath.includes('?') ? '&' : '?') + cacheBust;
                const response = await fetch(dataUrl, { cache: 'no-store' });
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${dataPath}`);
                }
                
                const rawData = await response.json();

                // Í≤ΩÍ∏∞ Í≤∞Í≥º JSON ÌååÏùº Î°úÎî©
                try {
                    const gamesJsonPath = './data/games.json';
                    const gamesJsonUrl = gamesJsonPath + '?' + cacheBust;
                    const gamesJsonResponse = await fetch(gamesJsonUrl, { cache: 'no-store' });
                    if (gamesJsonResponse.ok) {
                        window.gamesData = await gamesJsonResponse.json();
                    }
                } catch (gamesJsonError) {
                    console.warn('games.json Î°úÎìú Ïã§Ìå®, ÌÖçÏä§Ìä∏ ÌååÏùºÎ°ú Ìè¥Î∞±:', gamesJsonError);
                    // Í≤ΩÍ∏∞ Í≤∞Í≥º ÌÖçÏä§Ìä∏ ÌååÏùº Î°úÎî© (Ìè¥Î∞±)
                    try {
                        const gamesRawPath = './data/simple/games_raw.txt';
                        const gamesRawUrl = gamesRawPath + '?' + cacheBust;
                        const gamesRawResponse = await fetch(gamesRawUrl, { cache: 'no-store' });
                        if (gamesRawResponse.ok) {
                            window.gamesRawData = await gamesRawResponse.text();
                        }
                    } catch (gamesRawError) {
                        console.warn('games_raw.txt Î°úÎìú Ïã§Ìå®:', gamesRawError);
                    }
                }

                // ÏãúÏ¶å ÏÑ§Ï†ï Îç∞Ïù¥ÌÑ∞ Î°úÎî© (dashboard.json, cache-busting ÎèôÏùº Ï†ÅÏö©)
                try {
                    const dashboardBase = basePath.replace('standings.json', 'dashboard.json');
                    const dashboardUrl = dashboardBase + (dashboardBase.includes('?') ? '&' : '?') + cacheBust;
                    const dashboardResponse = await fetch(dashboardUrl, { cache: 'no-store' });
                    if (dashboardResponse.ok) {
                        seasonConfig = await dashboardResponse.json();
                        // NPB Ï†ïÍ∑úÏãúÏ¶åÏùÄ ÌåÄÎãπ 143Ë©¶Âêà. ÎåÄÏãúÎ≥¥ÎìúÍ∞Ä ÏûàÎçîÎùºÎèÑ TOTAL_GAMESÎäî 143ÏúºÎ°ú Í≥†Ï†ï.
                        if (seasonConfig.season_stats) {
                            const allTeams = [...(rawData.central_league?.standings || []), ...(rawData.pacific_league?.standings || [])];
                            const maxGamesPlayed = Math.max(...allTeams.map(t => t.games_played));
                            TOTAL_GAMES = 143;
                        }
                    }
                } catch (dashboardError) {
                    // „ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„Éâ„Éá„Éº„Çø„Å™„Åó„ÄÅ„Éá„Éï„Ç©„É´„ÉàÂÄ§‰ΩøÁî®
                }
                
                // Í≤ΩÍ∏∞ Îç∞Ïù¥ÌÑ∞ Î°úÎî© (home/away ÏûîÏó¨ Í≥ÑÏÇ∞Ïö©)
                try {
                    const gamesBase = basePath.replace('standings.json', 'games.json');
                    const gamesUrl = gamesBase + (gamesBase.includes('?') ? '&' : '?') + cacheBust;
                    const gamesResp = await fetch(gamesUrl, { cache: 'no-store' });
                    if (gamesResp.ok) {
                        gamesData = await gamesResp.json();
                    }
                } catch (gamesError) {}

                // ÏûîÏó¨ Í≤ΩÍ∏∞ Îç∞Ïù¥ÌÑ∞ Î°úÎî©
                try {
                    const upcomingBase = basePath.replace('standings.json', 'upcoming.json');
                    const upcomingUrl = upcomingBase + (upcomingBase.includes('?') ? '&' : '?') + cacheBust;
                    const upcomingResp = await fetch(upcomingUrl, { cache: 'no-store' });
                    if (upcomingResp.ok) {
                        upcomingGamesData = await upcomingResp.json();
                    }
                } catch (upcomingError) {}

                // Îç∞Ïù¥ÌÑ∞ ÌÉÄÏûÖ Ï†ïÍ∑úÌôî
                standingsData = normalizeStandingsData(rawData);

                if (standingsData.updated_at) {
                    const updated = new Date(standingsData.updated_at).toLocaleString('ja-JP', {
                        timeZone: 'Asia/Tokyo', year: 'numeric', month: '2-digit', day: '2-digit',
                        hour: '2-digit', minute: '2-digit', second: '2-digit'
                    });
                    const lastEl = document.getElementById('last-update');
                    if (lastEl) lastEl.textContent = `${updated} JST`;
                }


                // Ïã§Ï†ú ÌÜµÍ≥Ñ Îç∞Ïù¥ÌÑ∞ ÌëúÏãú
                if (seasonConfig && seasonConfig.season_stats) {
                    const stats = seasonConfig.season_stats;
                    if (typeof stats.total_games === 'number') {
                        document.getElementById('total-games').textContent = `${stats.total_games}Ë©¶Âêà`;
                    }
                    // Ïò§Îäò Í≤ΩÍ∏∞ ÏàòÎäî Ìó§Îçî(‰ªäÊó•„ÅÆË©¶Âêà) ÏòÜÏóêÎßå ÌëúÍ∏∞
                    // dashboardÏùò today_gamesÎäî Î¨¥Ïãú - Ïã§Ï†ú Í≥ÑÏÇ∞Í∞í ÏÇ¨Ïö©
                }
                
                computeLastTenRecords();
                computeHomeAwayRemaining();
                updateMagicRegular();
                updateMagicPlayoff();
                updateScenarios();
                updateDetailedStandings();
                updateH2HRecords();
                updateRemainingGames();
                updateProgress();
                updateSeasonAnalysis();
                updateAllGames();
                setupGameFilters();
                // Initialize 'ÁµåË∑Ø„ÅÆÊï∞' sub-views (matrix/detailed/table) and default to matrix
                bindScenarioViewToggles();
                setScenarioView('central','matrix');
                setScenarioView('pacific','matrix');
                
            } catch (error) {
                showError(`„Éá„Éº„ÇøË™≠„ÅøËæº„Åø„Ç®„É©„Éº: ${error.message}`);
            }
        }
        
        // ===== „Éö„Éº„Ç∏Áä∂ÊÖã„ÅÆ‰øùÂ≠ò„Å®Âæ©ÂÖÉ =====
        function savePageState() {
            // „Çπ„ÇØ„É≠„Éº„É´‰ΩçÁΩÆ„Çí‰øùÂ≠ò
            sessionStorage.setItem('npb-scroll-position', window.scrollY.toString());
        }

        function restorePageState() {
            // ‰øùÂ≠ò„Åï„Çå„Åü„Çø„Éñ„Åå„ÅÇ„Çå„Å∞Âæ©ÂÖÉ
            const savedTab = sessionStorage.getItem('npb-current-tab');
            if (savedTab) {
                const tabElement = document.querySelector(`.nav-tab[onclick*="'${savedTab}'"]`);
                if (tabElement) {
                    showTab(savedTab, tabElement);
                }
            }

            // ‰øùÂ≠ò„Åï„Çå„Åü„Çπ„ÇØ„É≠„Éº„É´‰ΩçÁΩÆ„Åå„ÅÇ„Çå„Å∞Âæ©ÂÖÉ
            const savedScrollPosition = sessionStorage.getItem('npb-scroll-position');
            if (savedScrollPosition) {
                const scrollPosition = parseInt(savedScrollPosition, 10);
                // DOM„ÅåÂÆåÂÖ®„Å´Ë™≠„ÅøËæº„Åæ„Çå„ÅüÂæå„Å´„Çπ„ÇØ„É≠„Éº„É´
                setTimeout(() => {
                    window.scrollTo(0, scrollPosition);
                }, 100);
            }
        }

        // „Çπ„ÇØ„É≠„Éº„É´‰ΩçÁΩÆ„ÇíÂÆöÊúüÁöÑ„Å´‰øùÂ≠ò
        let scrollSaveTimer;
        window.addEventListener('scroll', () => {
            clearTimeout(scrollSaveTimer);
            scrollSaveTimer = setTimeout(savePageState, 200);
        });

        // „Éö„Éº„Ç∏Èõ¢ËÑ±ÊôÇ„Å´Áä∂ÊÖã„Çí‰øùÂ≠ò
        window.addEventListener('beforeunload', savePageState);

        // Handle browser back/forward buttons
        window.addEventListener('hashchange', () => {
            const hash = window.location.hash.slice(1);
            const validTabs = ['magic-regular', 'magic-playoff', 'progress', 'scenarios', 'standings', 'h2h-records', 'remaining', 'season-analysis', 'all-games'];
            if (hash && validTabs.includes(hash)) {
                showTab(hash);
            }
        });

        document.addEventListener('DOMContentLoaded', () => {
            // Restore tab from URL hash or saved session state
            const hash = window.location.hash.slice(1); // Remove #
            const validTabs = ['magic-regular', 'magic-playoff', 'progress', 'scenarios', 'standings', 'h2h-records', 'remaining', 'season-analysis', 'all-games'];
            const savedTab = sessionStorage.getItem('npb-current-tab');

            if (hash && validTabs.includes(hash)) {
                showTab(hash);
            } else if (savedTab && validTabs.includes(savedTab)) {
                const tabElement = document.querySelector(`.nav-tab[onclick*="'${savedTab}'"]`);
                showTab(savedTab, tabElement || null);
            } else {
                // Default to first tab
                showTab('magic-regular');
            }

            loadDataEnhanced();
            restorePageState();

            // AdSense Ï¥àÍ∏∞ÌôîÎäî HTMLÏùò Í∞úÎ≥Ñ script ÌÉúÍ∑∏Í∞Ä Îã¥Îãπ
        });
        window.reloadData = loadDataEnhanced;

        // ===== ‰ªäÊó•/ÊòéÊó•„ÅÆË©¶ÂêàÊèèÁîª =====
        function formatJSTDateISO(date = new Date()) {
            // Returns YYYY-MM-DD in Asia/Tokyo
            return new Intl.DateTimeFormat('en-CA', {
                timeZone: 'Asia/Tokyo', year: 'numeric', month: '2-digit', day: '2-digit'
            }).format(date);
        }

        // (Removed) JS-driven footer logic. Footer is now static HTML-only.
        function getJSTDate(offsetDays = 0) {
            // Compute date in JST adding offset days
            const now = new Date();
            const ts = now.getTime() + offsetDays * 24 * 60 * 60 * 1000;
            return new Date(ts);
        }

        // ÌåÄ ÏïΩÏûêÎ°ú Î¶¨Í∑∏ ÌåêÎã®ÌïòÎäî Ìó¨Ìçº Ìï®Ïàò
        function getTeamLeague(teamAbbr) {
            // Use canonical abbreviations (YOG, HAN, CHU, YDB, HIR, YAK)
            const centralTeams = ['YOG', 'HAN', 'CHU', 'YDB', 'HIR', 'YAK'];
            const pacificTeams = ['SOF', 'LOT', 'SEI', 'ORI', 'NIP', 'RAK'];
            
            if (centralTeams.includes(teamAbbr)) return 'Central';
            if (pacificTeams.includes(teamAbbr)) return 'Pacific';
            return 'Unknown';
        }

        // ===== Ïñ∏Ïñ¥ Î≥ÄÌôò Í∏∞Îä• =====
        const SUPPORTED_LANGUAGES = ['ja', 'ko', 'en'];
        const LANGUAGE_URL_MAP = {
            'ja': 'https://npb-dashboard.com/',
            'ko': 'https://npb-dashboard.com/?lang=ko',
            'en': 'https://npb-dashboard.com/?lang=en',
            'x-default': 'https://npb-dashboard.com/'
        };
        let currentLanguage = 'ja';

        function getLanguageFromUrl() {
            try {
                const params = new URLSearchParams(window.location.search);
                const langParam = params.get('lang');
                if (langParam && SUPPORTED_LANGUAGES.includes(langParam)) {
                    return langParam;
                }
            } catch (err) {
                console.error('Failed to parse language from URL', err);
            }
            return null;
        }

        function syncUrlWithLanguage(lang) {
            try {
                const url = new URL(window.location.href);
                if (lang === 'ja') {
                    url.searchParams.delete('lang');
                } else {
                    url.searchParams.set('lang', lang);
                }
                window.history.replaceState({}, '', url);
            } catch (err) {
                console.error('Failed to sync URL with language', err);
            }
        }

        function updateLanguageLinks(lang) {
            const canonicalEl = document.getElementById('canonical-link');
            const canonicalHref = LANGUAGE_URL_MAP[lang] || LANGUAGE_URL_MAP['ja'];
            if (canonicalEl) {
                canonicalEl.setAttribute('href', canonicalHref);
            }
            document.querySelectorAll('link[data-hreflang]').forEach(link => {
                const code = link.getAttribute('data-hreflang');
                if (LANGUAGE_URL_MAP[code]) {
                    link.setAttribute('href', LANGUAGE_URL_MAP[code]);
                }
            });
        }

        // ÌòÑÏû¨ Ïñ∏Ïñ¥ Ï¥àÍ∏∞Ìôî (localStorageÏóêÏÑú ÏùΩÍ∏∞)
        function initLanguage() {
            const urlLang = getLanguageFromUrl();
            const savedLang = localStorage.getItem('npb-language');
            if (urlLang && translations[urlLang]) {
                currentLanguage = urlLang;
            } else if (savedLang && translations[savedLang]) {
                currentLanguage = savedLang;
            }
            localStorage.setItem('npb-language', currentLanguage);
            updateLanguage();
            updateActiveLanguageButton();
            updateMetaTags(currentLanguage);
            syncUrlWithLanguage(currentLanguage);
        }
        
        // Ïñ∏Ïñ¥ Î≥ÄÍ≤Ω Ìï®Ïàò
        function changeLanguage(lang) {
            if (!translations[lang]) return;
            
            currentLanguage = lang;
            localStorage.setItem('npb-language', lang);
            updateLanguage();
            updateActiveLanguageButton();
            
            // Î©îÌÉÄ ÌÉúÍ∑∏ÎèÑ ÏóÖÎç∞Ïù¥Ìä∏
            updateMetaTags(lang);
            syncUrlWithLanguage(lang);
        }
        
        // ÌÖçÏä§Ìä∏ ÏóÖÎç∞Ïù¥Ìä∏ Ìï®Ïàò
        function updateLanguage() {
            // ÏùºÎ∞ò ÌÖçÏä§Ìä∏ Î≤àÏó≠
            const elements = document.querySelectorAll('[data-i18n]');
            elements.forEach(element => {
                const key = element.getAttribute('data-i18n');
                if (translations[currentLanguage] && translations[currentLanguage][key]) {
                    element.textContent = translations[currentLanguage][key];
                }
            });
            
            // HTML ÏΩòÌÖêÏ∏† Î≤àÏó≠ (ÎèÑÏõÄÎßê Îì±)
            const htmlElements = document.querySelectorAll('[data-i18n-html]');
            htmlElements.forEach(element => {
                const key = element.getAttribute('data-i18n-html');
                if (translations[currentLanguage] && translations[currentLanguage][key]) {
                    element.innerHTML = translations[currentLanguage][key];
                }
            });

            applyFloatingActionTranslations();
        }
        
        // Ïñ∏Ïñ¥ Î≤ÑÌäº ÌôúÏÑ±Ìôî ÏÉÅÌÉú ÏóÖÎç∞Ïù¥Ìä∏
        function updateActiveLanguageButton() {
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.getAttribute('data-lang') === currentLanguage) {
                    btn.classList.add('active');
                }
            });
        }
        
        // Î©îÌÉÄ ÌÉúÍ∑∏ ÏóÖÎç∞Ïù¥Ìä∏ (SEOÏö©)
        function updateMetaTags(lang) {
            const titleMap = {
                'ja': 'NPB 2025È†Ü‰ΩçË°®„Éª„Éû„Ç∏„ÉÉ„ÇØ„Éä„É≥„Éê„Éº„Éª„ÇØ„É™„É≥„ÉÅ„ÉªCSÈÄ≤Âá∫Á¢∫Áéá„ÉªÂÑ™Âãù‰∫àÊÉ≥ | „Éó„É≠ÈáéÁêÉ„Éá„Éº„Çø„Éô„Éº„Çπ',
                'ko': '„ÄêÎß§Ïùº ÏûêÎèô ÏóÖÎç∞Ïù¥Ìä∏„ÄëNPB 2025 ÏàúÏúÑÌëú¬∑Îß§ÏßÅÎÑòÎ≤Ñ¬∑ÌÅ¥Î¶∞Ïπò¬∑CSÏßÑÏ∂úÌôïÎ•†¬∑Ïö∞ÏäπÏòàÏÉÅ | ÌîÑÎ°úÏïºÍµ¨ Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§',
                'en': '„ÄêDaily Auto-Update„ÄëNPB 2025 Standings„ÉªMagic Numbers„ÉªClinch„ÉªCS Playoff Probability„ÉªChampionship Prediction | Baseball Database'
            };
            
            const descriptionMap = {
                'ja': '„Äê2025Âπ¥ÊúÄÊñ∞„ÄëNPBÈ†Ü‰ΩçË°®„Éª„Éû„Ç∏„ÉÉ„ÇØ„Éä„É≥„Éê„Éº„Éª„ÇØ„É™„É≥„ÉÅ„ÉªCSÈÄ≤Âá∫Á¢∫Áéá„ÉªÂÑ™Âãù‰∫àÊÉ≥„ÄÇ„Çª„É™„Éº„Ç∞„Éª„Éë„É™„Éº„Ç∞ÂÖ®12ÁêÉÂõ£„ÅÆÂãùÁéáÂàÜÊûê„ÄÅÊÆã„ÇäË©¶ÂêàÊï∞„ÄÅ„Éù„Çπ„Éà„Ç∑„Éº„Ç∫„É≥„Ç∑„Éä„É™„Ç™„Åæ„ÅßÂÆåÂÖ®Á∂≤ÁæÖ„ÄÇÂ∑®‰∫∫„ÉªÈò™Á•û„Éª„ÇΩ„Éï„Éà„Éê„É≥„ÇØ„Å™„Å©ÂÖ®„ÉÅ„Éº„É†ÂØæÂøú„ÄÇ',
                'ko': '„Äê2025ÎÖÑ ÏµúÏã†„ÄëNPB ÏàúÏúÑÌëú¬∑Îß§ÏßÅÎÑòÎ≤Ñ¬∑ÌÅ¥Î¶∞Ïπò¬∑CSÏßÑÏ∂úÌôïÎ•†¬∑Ïö∞ÏäπÏòàÏÉÅÏùÑ Îß§Ïùº ÏûêÎèôÏóÖÎç∞Ïù¥Ìä∏. ÏÑºÌä∏Îü¥¬∑ÌçºÏãúÌîΩÎ¶¨Í∑∏ Ï†Ñ12Íµ¨Îã®Ïùò ÏäπÎ•†Î∂ÑÏÑù, ÎÇ®ÏùÄÍ≤ΩÍ∏∞Ïàò, ÌîåÎ†àÏù¥Ïò§ÌîÑ ÏãúÎÇòÎ¶¨Ïò§ÍπåÏßÄ ÏôÑÏ†ÑÎßùÎùº. ÏûêÏù¥Ïñ∏Ï∏†¬∑ÌÉÄÏù¥Í±∞Ïä§¬∑Ìò∏ÌÅ¨Ïä§ Îì± Ï†ÑÌåÄ ÏßÄÏõê.',
                'en': '„Äê2025 Latest„ÄëDaily auto-update of NPB standings, magic numbers, clinch, CS playoff probability, championship predictions. Complete coverage of all 12 teams from Central & Pacific leagues including win rate analysis, remaining games, playoff scenarios. Giants, Tigers, Hawks and all teams supported.'
            };
            const ogLocaleMap = {
                'ja': 'ja_JP',
                'ko': 'ko_KR',
                'en': 'en_US'
            };
            
            // Title ÏóÖÎç∞Ïù¥Ìä∏
            if (titleMap[lang]) {
                document.title = titleMap[lang];
            }
            const ogTitle = document.querySelector('meta[property="og:title"]');
            if (ogTitle && titleMap[lang]) {
                ogTitle.setAttribute('content', titleMap[lang]);
            }
            const twitterTitle = document.querySelector('meta[name="twitter:title"]');
            if (twitterTitle && titleMap[lang]) {
                twitterTitle.setAttribute('content', titleMap[lang]);
            }
            
            // Description ÏóÖÎç∞Ïù¥Ìä∏  
            const metaDesc = document.querySelector('meta[name="description"]');
            if (metaDesc && descriptionMap[lang]) {
                metaDesc.setAttribute('content', descriptionMap[lang]);
            }
            const ogDesc = document.querySelector('meta[property="og:description"]');
            if (ogDesc && descriptionMap[lang]) {
                ogDesc.setAttribute('content', descriptionMap[lang]);
            }
            const twitterDesc = document.querySelector('meta[name="twitter:description"]');
            if (twitterDesc && descriptionMap[lang]) {
                twitterDesc.setAttribute('content', descriptionMap[lang]);
            }
            const ogLocale = document.querySelector('meta[property="og:locale"]');
            if (ogLocale) {
                ogLocale.setAttribute('content', ogLocaleMap[lang] || ogLocaleMap['ja']);
            }
            
            // HTML lang ÏÜçÏÑ± ÏóÖÎç∞Ïù¥Ìä∏
            document.documentElement.setAttribute('lang', lang);
            const languageMeta = document.querySelector('meta[name="language"]');
            if (languageMeta) {
                languageMeta.setAttribute('content', lang);
            }
            updateLanguageLinks(lang);
        }
        
        // ÎèôÏ†Å ÏΩòÌÖêÏ∏† Î≤àÏó≠ Ïú†Ìã∏Î¶¨Ìã∞ Ìï®Ïàò
        function getTranslation(key) {
            return translations[currentLanguage] && translations[currentLanguage][key] ? 
                   translations[currentLanguage][key] : key;
        }

        function applyFloatingActionTranslations() {
            const container = document.querySelector('.floating-actions');
            if (container) {
                container.setAttribute('aria-label', getTranslation('action-quick-actions'));
            }

            const topButton = document.getElementById('scrollTopButton');
            if (topButton) {
                topButton.setAttribute('aria-label', getTranslation('action-go-top'));
            }

            const shareButton = document.getElementById('shareButton');
            const shareMenu = document.getElementById('shareMenu');
            if (shareMenu) {
                shareMenu.setAttribute('aria-label', getTranslation('action-share-menu'));
            }
            if (shareButton) {
                shareButton.setAttribute('aria-label', getTranslation('action-share'));
                if (shareMenu) {
                    const expanded = shareMenu.classList.contains('is-visible');
                    shareButton.setAttribute('aria-expanded', expanded ? 'true' : 'false');
                }
            }
        }

        function initFloatingActions() {
            const container = document.querySelector('.floating-actions');
            if (!container) {
                return;
            }

            const topButton = document.getElementById('scrollTopButton');
            const shareButton = document.getElementById('shareButton');
            const shareMenu = document.getElementById('shareMenu');
            const feedbackEl = document.getElementById('floatingActionFeedback');
            let feedbackTimeoutId = null;
            const SCROLL_THRESHOLD = 240;
            let shareMenuVisible = shareMenu ? shareMenu.classList.contains('is-visible') : false;

            function updateTopButtonVisibility() {
                if (!topButton) return;
                const shouldShow = window.scrollY > SCROLL_THRESHOLD;
                if (shouldShow) {
                    topButton.classList.remove('is-hidden');
                    topButton.tabIndex = 0;
                } else {
                    topButton.classList.add('is-hidden');
                    topButton.tabIndex = -1;
                }
            }

            function showFeedback(messageKey) {
                if (!feedbackEl) return;
                feedbackEl.textContent = getTranslation(messageKey);
                feedbackEl.classList.add('visible');
                if (feedbackTimeoutId) {
                    clearTimeout(feedbackTimeoutId);
                }
                feedbackTimeoutId = setTimeout(() => {
                    feedbackEl.classList.remove('visible');
                }, 2400);
            }

            async function copyLinkToClipboard(text) {
                if (navigator.clipboard && window.isSecureContext) {
                    await navigator.clipboard.writeText(text);
                    return;
                }

                const textarea = document.createElement('textarea');
                textarea.value = text;
                textarea.setAttribute('readonly', '');
                textarea.style.position = 'fixed';
                textarea.style.top = '-1000px';
                textarea.style.opacity = '0';
                document.body.appendChild(textarea);
                textarea.focus();
                textarea.select();

                let succeeded = false;
                try {
                    succeeded = document.execCommand('copy');
                } catch (err) {
                    succeeded = false;
                }

                document.body.removeChild(textarea);

                if (!succeeded) {
                    throw new Error('Copy command was rejected');
                }
            }

            function handleShareMenuOutside(event) {
                if (!shareMenuVisible) return;
                if (shareMenu && shareMenu.contains(event.target)) return;
                if (shareButton && shareButton.contains(event.target)) return;
                closeShareMenu({ returnFocus: false });
            }

            function handleShareMenuKeydown(event) {
                if (!shareMenuVisible) return;
                if (event.key === 'Escape') {
                    event.preventDefault();
                    event.stopPropagation();
                    closeShareMenu({ returnFocus: true });
                }
            }

            function openShareMenu({ focusFirstOption = true } = {}) {
                if (!shareMenu || !shareButton) return;
                if (shareMenuVisible) return;

                shareMenu.classList.add('is-visible');
                shareMenu.setAttribute('aria-hidden', 'false');
                shareButton.setAttribute('aria-expanded', 'true');
                shareMenuVisible = true;

                document.addEventListener('click', handleShareMenuOutside);
                document.addEventListener('keydown', handleShareMenuKeydown, true);

                if (focusFirstOption) {
                    const firstOption = shareMenu.querySelector('.floating-share-option');
                    if (firstOption) {
                        setTimeout(() => firstOption.focus(), 0);
                    }
                }
            }

            function closeShareMenu({ returnFocus = true } = {}) {
                if (!shareMenu || !shareButton) return;
                if (!shareMenuVisible) return;

                shareMenu.classList.remove('is-visible');
                shareMenu.setAttribute('aria-hidden', 'true');
                shareButton.setAttribute('aria-expanded', 'false');
                shareMenuVisible = false;

                document.removeEventListener('click', handleShareMenuOutside);
                document.removeEventListener('keydown', handleShareMenuKeydown, true);

                if (returnFocus) {
                    shareButton.focus();
                }
            }

            function openShareTarget(url) {
                const newWindow = window.open(url, '_blank', 'noopener,noreferrer');
                if (!newWindow) {
                    window.location.href = url;
                }
            }

            function buildShareUrl(action, url, text) {
                const combined = `${text} ${url}`.trim();
                switch (action) {
                    case 'line':
                        return `https://social-plugins.line.me/lineit/share?url=${encodeURIComponent(url)}`;
                    case 'threads':
                        return `https://www.threads.net/intent/post?text=${encodeURIComponent(combined)}`;
                    case 'facebook':
                        return `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(url)}`;
                    case 'x':
                        return `https://x.com/intent/post?text=${encodeURIComponent(combined)}`;
                    default:
                        return url;
                }
            }

            if (shareMenu) {
                const shareOptions = Array.from(shareMenu.querySelectorAll('[data-share-action]'));
                shareOptions.forEach(option => {
                    option.addEventListener('click', async event => {
                        event.preventDefault();
                        event.stopPropagation();
                        const action = option.getAttribute('data-share-action');
                        const pageUrl = window.location.href;
                        const shareText = getTranslation('action-share-message');

                        try {
                            if (action === 'copy') {
                                await copyLinkToClipboard(pageUrl);
                                showFeedback('action-share-copied');
                            } else {
                                const targetUrl = buildShareUrl(action, pageUrl, shareText);
                                openShareTarget(targetUrl);
                                showFeedback('action-share-opened');
                            }
                        } catch (err) {
                            console.error('Share action failed', err);
                            showFeedback('action-share-error');
                        } finally {
                            closeShareMenu({ returnFocus: true });
                        }
                    });
                });
            }

            if (shareButton) {
                shareButton.addEventListener('click', event => {
                    event.preventDefault();
                    event.stopPropagation();
                    const focusFirstOption = event.detail === 0;
                    if (shareMenuVisible) {
                        closeShareMenu({ returnFocus: true });
                    } else {
                        openShareMenu({ focusFirstOption });
                    }
                });

                shareButton.addEventListener('keydown', event => {
                    if (event.key === 'ArrowDown') {
                        event.preventDefault();
                        if (!shareMenuVisible) {
                            openShareMenu({ focusFirstOption: true });
                        } else if (shareMenu) {
                            const firstOption = shareMenu.querySelector('.floating-share-option');
                            firstOption?.focus();
                        }
                    } else if (event.key === 'Escape' && shareMenuVisible) {
                        event.preventDefault();
                        closeShareMenu({ returnFocus: true });
                    }
                });
            }

            function handleWindowScroll() {
                updateTopButtonVisibility();
                if (shareMenuVisible) {
                    closeShareMenu({ returnFocus: false });
                }
            }

            updateTopButtonVisibility();
            window.addEventListener('scroll', handleWindowScroll, { passive: true });

            if (topButton) {
                topButton.addEventListener('click', () => {
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                });
            }

            applyFloatingActionTranslations();
        }

        // Ï°∞Í±¥ Î©îÏãúÏßÄ Î≤àÏó≠ Ìï®Ïàò
        function translateCondition(condition) {
            if (!condition) return condition;
            
            // Ï†ïÍ∑úÌëúÌòÑÏãùÏùÑ ÏÇ¨Ïö©ÌïòÏó¨ ÎèôÏ†Å Î©îÏãúÏßÄ Î≤àÏó≠
            if (condition.includes('ÂãùÂøÖË¶Å')) {
                const match = condition.match(/(\d+)ÂãùÂøÖË¶Å/);
                if (match) {
                    return `${match[1]} ${getTranslation('wins-needed')}`;
                }
            }
            
            if (condition.includes('CSÈÄ≤Âá∫„Åæ„Åß') && condition.includes('Âãù')) {
                const match = condition.match(/CSÈÄ≤Âá∫„Åæ„Åß(\d+)Âãù/);
                if (match) {
                    return `${match[1]} ${getTranslation('wins-needed')} for CS`;
                }
            }
            
            // Í≥†Ï†ï Î©îÏãúÏßÄ Î≤àÏó≠
            const conditionMap = {
                'Á¢∫ÂÆö': getTranslation('championship-secured'),
                'ÂÑ™ÂãùÁ¢∫ÂÆöÊ∏à„Åø': getTranslation('championship-secured'),
                'CSÈÄ≤Âá∫Á¢∫ÂÆö': getTranslation('playoff-advancement-secured'),
                '„Éï„Ç°„Ç§„Éä„É´Áõ¥Ë°å': currentLanguage === 'ja' ? '„Éï„Ç°„Ç§„Éä„É´Áõ¥Ë°å' : 
                               currentLanguage === 'ko' ? 'ÌååÏù¥ÎÑê ÏßÅÌñâ' : 'Final Direct',
                '„Éï„Ç°„Éº„Çπ„Éà„Çπ„ÉÜ„Éº„Ç∏': currentLanguage === 'ja' ? '„Éï„Ç°„Éº„Çπ„Éà„Çπ„ÉÜ„Éº„Ç∏' :
                                   currentLanguage === 'ko' ? 'ÌçºÏä§Ìä∏ Ïä§ÌÖåÏù¥ÏßÄ' : 'First Stage',
                '‰∏çÂèØËÉΩ': currentLanguage === 'ja' ? '‰∏çÂèØËÉΩ' :
                         currentLanguage === 'ko' ? 'Î∂àÍ∞ÄÎä•' : 'Impossible'
            };
            
            return conditionMap[condition] || condition;
        }
        
        // ÏÉÅÌÉú Î≤àÏó≠ Ìï®Ïàò
        function translateStatus(status) {
            const statusMap = {
                'ÂÑ™ÂãùÊ±∫ÂÆö': getTranslation('championship-decided'),
                'CSÁ¢∫ÂÆö': getTranslation('playoff-secured'),
                'ÂúèÂ§ñÁ¢∫ÂÆö': getTranslation('eliminated'),
                'ÂèØËÉΩÊÄß„ÅÇ„Çä': getTranslation('still-possible')
            };
            return statusMap[status] || status;
        }
        
        // ÌåÄÎ™Ö Î≤àÏó≠ Ìï®Ïàò
        function translateTeamName(teamName, isShort = false) {
            if (!teamName) return teamName;
            
            // ÌåÄÎ™ÖÏùÑ ÌÇ§Î°ú Î≥ÄÌôòÌïòÎäî Îß§Ìïë ÌÖåÏù¥Î∏î
            const teamKeyMap = {
                // ÏùºÎ≥∏Ïñ¥ ÌåÄÎ™Ö -> ÌÇ§
                'Ë™≠Â£≤„Ç∏„É£„Ç§„Ç¢„É≥„ÉÑ': 'giants',
                '„Ç∏„É£„Ç§„Ç¢„É≥„ÉÑ': 'giants',
                'Èò™Á•û„Çø„Ç§„Ç¨„Éº„Çπ': 'tigers', 
                '„Çø„Ç§„Ç¨„Éº„Çπ': 'tigers',
                '‰∏≠Êó•„Éâ„É©„Ç¥„É≥„Ç∫': 'dragons',
                '„Éâ„É©„Ç¥„É≥„Ç∫': 'dragons',
                'Â∫ÉÂ≥∂Êù±Ê¥ã„Ç´„Éº„Éó': 'carp',
                '„Ç´„Éº„Éó': 'carp',
                'Êù±‰∫¨„É§„ÇØ„É´„Éà„Çπ„ÉØ„É≠„Éº„Ç∫': 'swallows',
                '„Çπ„ÉØ„É≠„Éº„Ç∫': 'swallows',
                'Ê®™ÊµúDeNA„Éô„Ç§„Çπ„Çø„Éº„Ç∫': 'baystars',
                '„Éô„Ç§„Çπ„Çø„Éº„Ç∫': 'baystars',
                '„ÇΩ„Éï„Éà„Éê„É≥„ÇØ„Éõ„Éº„ÇØ„Çπ': 'hawks',
                '„Éõ„Éº„ÇØ„Çπ': 'hawks',
                'Êù±ÂåóÊ•ΩÂ§©„Ç¥„Éº„É´„Éá„É≥„Ç§„Éº„Ç∞„É´„Çπ': 'eagles',
                '„Ç§„Éº„Ç∞„É´„Çπ': 'eagles',
                'ÂüºÁéâË•øÊ≠¶„É©„Ç§„Ç™„É≥„Ç∫': 'lions',
                '„É©„Ç§„Ç™„É≥„Ç∫': 'lions',
                'ÂçÉËëâ„É≠„ÉÉ„ÉÜ„Éû„É™„Éº„É≥„Ç∫': 'marines',
                '„Éû„É™„Éº„É≥„Ç∫': 'marines',
                'ÂåóÊµ∑ÈÅìÊó•Êú¨„Éè„É†„Éï„Ç°„Ç§„Çø„Éº„Ç∫': 'fighters',
                '„Éï„Ç°„Ç§„Çø„Éº„Ç∫': 'fighters',
                '„Ç™„É™„ÉÉ„ÇØ„Çπ„Éê„Éï„Ç°„É≠„Éº„Ç∫': 'buffaloes',
                '„Éê„Éï„Ç°„É≠„Éº„Ç∫': 'buffaloes',
                
                // ÏòÅÏñ¥ ÌåÄÎ™Ö -> ÌÇ§
                'Giants': 'giants',
                'Tigers': 'tigers',
                'Dragons': 'dragons',
                'Carp': 'carp', 
                'Swallows': 'swallows',
                'BayStars': 'baystars',
                'Hawks': 'hawks',
                'Eagles': 'eagles',
                'Lions': 'lions',
                'Marines': 'marines',
                'Fighters': 'fighters',
                'Buffaloes': 'buffaloes'
            };
            
            // ÌåÄÎ™ÖÏóêÏÑú ÌÇ§ Ï∞æÍ∏∞
            let teamKey = teamKeyMap[teamName];
            if (!teamKey) {
                // Î∂ÄÎ∂Ñ Îß§Ïπ≠ ÏãúÎèÑ
                for (const [name, key] of Object.entries(teamKeyMap)) {
                    if (teamName.includes(name) || name.includes(teamName)) {
                        teamKey = key;
                        break;
                    }
                }
            }
            
            if (teamKey) {
                const suffix = isShort ? '-short' : '';
                return getTranslation(teamKey + suffix);
            }
            
            return teamName; // Îß§Ïπ≠ÎêòÏßÄ ÏïäÏúºÎ©¥ ÏõêÎûò Ïù¥Î¶Ñ Î∞òÌôò
        }
        
        // Ïñ∏Ïñ¥ Î≥ÄÍ≤ΩÏãú ÎèôÏ†Å ÏΩòÌÖêÏ∏†ÎèÑ Ïû¨ÏÉùÏÑ±
        function refreshDynamicContent() {
            if (standingsData) {
                // ÌÖåÏù¥Î∏î Îç∞Ïù¥ÌÑ∞ Ïû¨ÏÉùÏÑ±
                updateAllTables();
            }
        }
        
        // Î™®Îì† ÌÖåÏù¥Î∏î ÏóÖÎç∞Ïù¥Ìä∏ Ìï®Ïàò (Í∏∞Ï°¥ Ìï®ÏàòÎì§ Ìò∏Ï∂ú)
        function updateAllTables() {
            // Îß§ÏßÅÎÑòÎ≤Ñ ÌÖåÏù¥Î∏î
            if (standingsData?.central_league?.standings) {
                updateMagicTable('central-magic-regular', standingsData.central_league.standings, true);
                updateMagicTable('central-magic-playoff', standingsData.central_league.standings, false);
            }
            if (standingsData?.pacific_league?.standings) {
                updateMagicTable('pacific-magic-regular', standingsData.pacific_league.standings, true);
                updateMagicTable('pacific-magic-playoff', standingsData.pacific_league.standings, false);
            }
            
            // ÏÉÅÏÑ∏ ÏàúÏúÑÌëú
            if (standingsData?.central_league?.standings) {
                updateDetailedTable('central-detailed', standingsData.central_league.standings);
            }
            if (standingsData?.pacific_league?.standings) {
                updateDetailedTable('pacific-detailed', standingsData.pacific_league.standings);
            }
        }
        
        // Í∏∞Ï°¥ changeLanguage Ìï®Ïàò ÏàòÏ†ï
        const originalChangeLanguage = changeLanguage;
        changeLanguage = function(lang) {
            originalChangeLanguage(lang);
            refreshDynamicContent();
        }
        
        // ÌéòÏù¥ÏßÄ Î°úÎìúÏãú Ïñ∏Ïñ¥ Ï¥àÍ∏∞Ìôî
        document.addEventListener('DOMContentLoaded', function() {
            initLanguage();
            initFloatingActions();
        });


        // No JS footer init required; footer is static in HTML.
    </script>

    <!-- AdSense Ad - Mobile -->
    <div style="margin: 20px 0; text-align: center; overflow: visible; min-width: 320px; width: 100%; max-width: 100%;">
        <ins class="adsbygoogle"
             style="display:block !important; min-width: 300px; width: 100%; max-width: 100%; visibility: visible;"
             data-ad-client="ca-pub-5508768187151867"
             data-ad-slot="7298546648"
             data-ad-format="auto"
             data-full-width-responsive="true"></ins>
        <script>
                        (adsbygoogle = window.adsbygoogle || []).push({});
                    </script>
    </div>

    <!-- Site footer (static) -->
    <footer class="site-footer" role="contentinfo">
        <div class="footer-content">
            <span>¬© 2025 NPB Statistics</span>
            <span>|</span>
            <a href="https://npb-dashboard.com" target="_blank" rel="noopener noreferrer">npb-dashboard.com</a>
        </div>
    </footer>


    <script>
    document.addEventListener('DOMContentLoaded', function() {
        const gameTicker = document.getElementById('game-ticker');
        if (!gameTicker) return;

        const prevDayBtn = document.getElementById('ticker-prev-day');
        const nextDayBtn = document.getElementById('ticker-next-day');
        const dateDisplay = document.getElementById('ticker-date');
        const gamesContainer = document.getElementById('ticker-games');

        let currentDate = new Date();
        let allGames = [];
        let teamData = {};
        const dateKeyFormatter = new Intl.DateTimeFormat('en-CA', {
            timeZone: 'Asia/Tokyo',
            year: 'numeric',
            month: '2-digit',
            day: '2-digit'
        });
        let minDateKey = null;
        let maxDateKey = null;

        const getDateKey = date => dateKeyFormatter.format(date);
        const parseDateKey = key => new Date(`${key}T12:00:00+09:00`);

        function clampCurrentDate() {
            if (!minDateKey || !maxDateKey) return;
            const key = getDateKey(currentDate);
            if (key < minDateKey) {
                currentDate = parseDateKey(minDateKey);
            } else if (key > maxDateKey) {
                currentDate = parseDateKey(maxDateKey);
            }
        }

        async function fetchGameData() {
            try {
                const [gamesResponse, upcomingResponse, teamsResponse] = await Promise.all([
                    fetch('./data/games.json'),
                    fetch('./data/upcoming.json'),
                    fetch('./data/teams.json')
                ]);
                const games = await gamesResponse.json();
                const upcoming = await upcomingResponse.json();
                const teams = await teamsResponse.json();

                allGames = [...games, ...upcoming];

                const dateKeys = [...new Set(allGames
                    .map(game => game.date || game.game_date)
                    .filter(Boolean)
                )].sort();

                if (dateKeys.length) {
                    minDateKey = dateKeys[0];
                    maxDateKey = dateKeys[dateKeys.length - 1];

                    const currentKey = getDateKey(currentDate);
                    if (currentKey < minDateKey || currentKey > maxDateKey) {
                        currentDate = parseDateKey(currentKey < minDateKey ? minDateKey : maxDateKey);
                    }
                } else {
                    minDateKey = null;
                    maxDateKey = null;
                }

                // Create a team map for easy lookup
                if (teams.central_league) {
                    teams.central_league.forEach(team => {
                        teamData[team.team_id] = team;
                    });
                }
                if (teams.pacific_league) {
                    teams.pacific_league.forEach(team => {
                        teamData[team.team_id] = team;
                    });
                }

                updateTicker();
            } catch (error) {
                console.error('Error fetching game data:', error);
                gamesContainer.innerHTML = '<span>Error loading games.</span>';
            }
        }

        function formatDate(date) {
            const today = new Date();
            const yesterday = new Date(today);
            yesterday.setDate(today.getDate() - 1);
            const tomorrow = new Date(today);
            tomorrow.setDate(today.getDate() + 1);

            const isToday = date.toDateString() === today.toDateString();
            const isYesterday = date.toDateString() === yesterday.toDateString();
            const isTomorrow = date.toDateString() === tomorrow.toDateString();

            const dateOptions = { month: 'long', day: 'numeric', timeZone: 'Asia/Tokyo' };
            const dayOptions = { weekday: 'short', timeZone: 'Asia/Tokyo' };
            const dateStr = date.toLocaleDateString('ja-JP', dateOptions);
            const dayStr = date.toLocaleDateString('ja-JP', dayOptions);

            if (isToday) {
                return `${dateStr}<br><span style="font-size: 11px; color: #0066cc;">‰ªäÊó• (${dayStr})</span>`;
            } else if (isYesterday) {
                return `${dateStr}<br><span style="font-size: 11px; color: #666;">Êò®Êó• (${dayStr})</span>`;
            } else if (isTomorrow) {
                return `${dateStr}<br><span style="font-size: 11px; color: #666;">ÊòéÊó• (${dayStr})</span>`;
            }

            return `${dateStr}<br><span style="font-size: 11px; color: #666;">${dayStr}</span>`;
        }

        function getGamesForDate(date) {
            const dateString = date.toISOString().split('T')[0];
            const gamesForDate = allGames.filter(game => (game.date === dateString || game.game_date === dateString));

            // Group games by team matchup
            const gamesByMatchup = new Map();

            gamesForDate.forEach(game => {
                // Create normalized key regardless of home/away order
                const teams = [game.home_team_abbr, game.away_team_abbr].sort();
                const key = `${teams[0]}-${teams[1]}`;
                const status = game.status || game.game_status || 'scheduled';

                if (!gamesByMatchup.has(key)) {
                    gamesByMatchup.set(key, []);
                }
                gamesByMatchup.get(key).push({ ...game, resolved_status: status });
            });

            // For each matchup, prefer completed games over scheduled ones
            const uniqueGames = [];
            gamesByMatchup.forEach(games => {
                // Sort by status priority: completed > postponed > scheduled
                games.sort((a, b) => {
                    const statusPriority = { 'completed': 0, 'postponed': 1, 'scheduled': 2 };
                    return (statusPriority[a.resolved_status] || 2) - (statusPriority[b.resolved_status] || 2);
                });

                // Take the highest priority game
                uniqueGames.push(games[0]);
            });

            return uniqueGames;
        }

        function getTeamShortName(teamId) {
            return teamData[teamId]?.team_abbreviation || teamId;
        }

        function getTeamLogo(teamId) {
            const abbr = getTeamShortName(teamId);
            const src = TEAM_LOGOS[abbr] || '';
            return src ? `<img class="ticker-team-logo" src="${src}" alt="${abbr}">` : '';
        }

        function renderGames(games) {
            if (games.length === 0) {
                gamesContainer.innerHTML = '<span style="color: #666; font-size: 13px;">Êú¨Êó•„ÅÆË©¶Âêà„ÅØ„ÅÇ„Çä„Åæ„Åõ„Çì</span>';
                return;
            }

            // Sort games: completed games first, then scheduled games
            games.sort((a, b) => {
                const statusA = a.status || a.game_status || 'scheduled';
                const statusB = b.status || b.game_status || 'scheduled';

                // Completed games come first
                if (statusA === 'completed' && statusB !== 'completed') return -1;
                if (statusA !== 'completed' && statusB === 'completed') return 1;

                // Within same status, sort by league (Central first, then Pacific)
                const leagueA = a.league || 'Unknown';
                const leagueB = b.league || 'Unknown';
                return leagueA.localeCompare(leagueB);
            });

            const html = games.map(game => {
                // Use team abbreviations directly since they're always available
                const homeTeamAbbr = game.home_team_abbr;
                const awayTeamAbbr = game.away_team_abbr;

                // Convert to Japanese short names (first 2-3 characters)
                const teamShortNames = {
                    'YOG': 'Â∑®‰∫∫',
                    'HAN': 'Èò™Á•û',
                    'CHU': '‰∏≠Êó•',
                    'HIR': 'Â∫ÉÂ≥∂',
                    'YDB': 'Ê®™Êµú',
                    'YAK': '„É§„ÇØ„É´„Éà',
                    'SOF': '„ÇΩ„Éï„Éà„Éê„É≥„ÇØ',
                    'LOT': '„É≠„ÉÉ„ÉÜ',
                    'SEI': 'Ë•øÊ≠¶',
                    'ORI': '„Ç™„É™„ÉÉ„ÇØ„Çπ',
                    'NIP': 'Êó•„Éè„É†',
                    'RAK': 'Ê•ΩÂ§©'
                };

                const homeTeamName = teamShortNames[homeTeamAbbr] || homeTeamAbbr;
                const awayTeamName = teamShortNames[awayTeamAbbr] || awayTeamAbbr;
                const homeScore = game.home_score;
                const awayScore = game.away_score;
                const status = game.status || game.game_status || 'scheduled';

                // Extract time and venue from stadium field
                let gameTime = '';
                let venue = game.stadium || '';

                // Parse time from stadium field if it contains time (e.g., "Êù±‰∫¨„Éâ„Éº„É† 18Ôºö00")
                // Only for scheduled games (upcoming.json has time, games.json doesn't)
                if (status === 'scheduled' && venue && venue.includes(' ')) {
                    const parts = venue.split(' ');
                    if (parts[parts.length - 1].includes('Ôºö')) {
                        gameTime = parts.pop();
                        venue = parts.join(' ');
                    }
                }

                // Get team logo directly using abbreviation
                const homeTeamLogo = TEAM_LOGOS[homeTeamAbbr] ?
                    `<img class="ticker-team-logo" src="${TEAM_LOGOS[homeTeamAbbr]}" alt="${homeTeamName}">` : '';
                const awayTeamLogo = TEAM_LOGOS[awayTeamAbbr] ?
                    `<img class="ticker-team-logo" src="${TEAM_LOGOS[awayTeamAbbr]}" alt="${awayTeamName}">` : '';

                if (status === 'completed') {
                    const isDraw = game.is_draw || (homeScore === awayScore);
                    const awayWin = awayScore > homeScore;
                    const homeWin = homeScore > awayScore;

                    return `
                        <div class="ticker-game">
                            <div style="display: flex; align-items: center; gap: 4px;">
                                <div class="ticker-team${awayWin ? ' winner' : ''}">
                                    ${awayTeamLogo}
                                    <span class="ticker-team-name">${awayTeamName}</span>
                                    <span class="ticker-score">${awayScore}</span>
                                </div>
                                <span style="margin: 0 2px; color: #999;">-</span>
                                <div class="ticker-team${homeWin ? ' winner' : ''}">
                                    <span class="ticker-score">${homeScore}</span>
                                    <span class="ticker-team-name">${homeTeamName}</span>
                                    ${homeTeamLogo}
                                </div>
                                <div class="ticker-status" style="margin-left: 8px; color: ${isDraw ? '#666' : '#d32f2f'}; font-weight: bold; text-align: center; display: flex; flex-direction: column; justify-content: center; line-height: 1;">
                                    <div>${isDraw ? 'ÂºïÂàÜ' : 'ÁµÇ‰∫Ü'}</div>
                                    <div style="font-size: 11px; color: #666; font-weight: normal; margin-top: -2px;">${game.final_inning || '9'}Âõû</div>
                                </div>
                            </div>
                            <div class="ticker-venue" style="display: flex; justify-content: center; font-size: 10px; color: #888; margin-top: 1px;">
                                ${venue ? `<span>${venue.replace('„Çπ„Çø„Ç∏„Ç¢„É†', '').replace('ÁêÉÂ†¥', '').replace('„Éâ„Éº„É†', '').replace('MAZDA Zoom-Zoom ', '').replace('PayPay', '').trim()}</span>` : ''}
                            </div>
                        </div>
                    `;
                } else if (status === 'postponed') {
                    return `
                        <div class="ticker-game">
                            <div style="display: flex; align-items: center; gap: 4px;">
                                <div class="ticker-team">
                                    ${awayTeamLogo}
                                    <span class="ticker-team-name">${awayTeamName}</span>
                                </div>
                                <span style="margin: 0 2px;">vs</span>
                                <div class="ticker-team">
                                    <span class="ticker-team-name">${homeTeamName}</span>
                                    ${homeTeamLogo}
                                </div>
                                <span class="ticker-status" style="margin-left: 8px; color: #f57c00; font-weight: bold;">Âª∂Êúü</span>
                            </div>
                            <div class="ticker-venue" style="display: flex; justify-content: center; font-size: 10px; color: #888; margin-top: 1px;">
                                ${venue ? `<span>${venue.replace('„Çπ„Çø„Ç∏„Ç¢„É†', '').replace('ÁêÉÂ†¥', '').replace('„Éâ„Éº„É†', '').replace('MAZDA Zoom-Zoom ', '').replace('PayPay', '').trim()}</span>` : ''}
                            </div>
                        </div>
                    `;
                } else {
                    // Scheduled game
                    return `
                        <div class="ticker-game">
                            <div style="display: flex; align-items: center; gap: 4px;">
                                <div class="ticker-team">
                                    ${awayTeamLogo}
                                    <span class="ticker-team-name">${awayTeamName}</span>
                                </div>
                                <span style="margin: 0 2px;">vs</span>
                                <div class="ticker-team">
                                    <span class="ticker-team-name">${homeTeamName}</span>
                                    ${homeTeamLogo}
                                </div>
                            </div>
                            <div class="ticker-venue" style="display: flex; justify-content: center; font-size: 11px; color: #666; margin-top: 1px;">
                                ${gameTime ? `<span style="color: #0066cc; font-weight: bold; margin-right: 3px; font-size: 11px;">${gameTime}</span>` : ''}
                                ${venue ? `<span>${venue.replace('„Çπ„Çø„Ç∏„Ç¢„É†', '').replace('ÁêÉÂ†¥', '').trim()}</span>` : ''}
                            </div>
                        </div>
                    `;
                }
            }).join('');

            gamesContainer.innerHTML = html;
        }

        function updateTicker() {
            clampCurrentDate();
            dateDisplay.innerHTML = formatDate(currentDate);
            const games = getGamesForDate(currentDate);
            renderGames(games);

            const currentKey = getDateKey(currentDate);
            const hasPrev = !minDateKey || currentKey > minDateKey;
            const hasNext = !maxDateKey || currentKey < maxDateKey;

            prevDayBtn.classList.toggle('disabled', !hasPrev);
            nextDayBtn.classList.toggle('disabled', !hasNext);
            prevDayBtn.setAttribute('aria-disabled', (!hasPrev).toString());
            nextDayBtn.setAttribute('aria-disabled', (!hasNext).toString());

            // Check if content overflows and apply scrolling animation
            setTimeout(() => {
                const container = document.querySelector('.ticker-games-container');
                const content = document.querySelector('.ticker-games');

                if (container && content) {
                    const containerWidth = container.clientWidth;
                    const contentWidth = content.scrollWidth;

                    if (contentWidth > containerWidth) {
                        content.classList.add('scrolling');
                    } else {
                        content.classList.remove('scrolling');
                    }
                }
            }, 100);
        }

        window.goToToday = function() {
            currentDate = new Date();
            clampCurrentDate();
            updateTicker();
        }

        prevDayBtn.addEventListener('click', () => {
            if (minDateKey && getDateKey(currentDate) <= minDateKey) return;
            currentDate.setDate(currentDate.getDate() - 1);
            clampCurrentDate();
            updateTicker();
        });

        nextDayBtn.addEventListener('click', () => {
            if (maxDateKey && getDateKey(currentDate) >= maxDateKey) return;
            currentDate.setDate(currentDate.getDate() + 1);
            clampCurrentDate();
            updateTicker();
        });

        fetchGameData();
    });
    </script>
</body>
</html>
