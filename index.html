<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="ã€æ¯æ—¥è‡ªå‹•æ›´æ–°ã€‘NPB(æ—¥æœ¬ãƒ—ãƒ­é‡çƒ)2025å¹´ã‚·ãƒ¼ã‚ºãƒ³ã®æœ€æ–°é †ä½è¡¨ã¨ãƒã‚¸ãƒƒã‚¯ãƒŠãƒ³ãƒãƒ¼ã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§è¿½è·¡ã€‚ã‚»ãƒ³ãƒˆãƒ©ãƒ«ãƒ»ãƒ‘ã‚·ãƒ•ã‚£ãƒƒã‚¯ä¸¡ãƒªãƒ¼ã‚°ã®è©³ç´°æˆç¸¾ã€å‹ç‡åˆ†æã€ãƒ—ãƒ¬ãƒ¼ã‚ªãƒ•é€²å‡ºç¢ºç‡ã‚’å®Œå…¨ç¶²ç¾…ã€‚ç„¡æ–™ã§ã”åˆ©ç”¨ã„ãŸã ã‘ã¾ã™ã€‚">
    <meta name="keywords" content="ãƒ—ãƒ­é‡çƒ, NPB, é †ä½è¡¨, ãƒã‚¸ãƒƒã‚¯, å„ªå‹, ãƒ—ãƒ¬ãƒ¼ã‚ªãƒ•, CS, ã‚¯ãƒ©ã‚¤ãƒãƒƒã‚¯ã‚¹ã‚·ãƒªãƒ¼ã‚º, ã‚»ãƒªãƒ¼ã‚°, ãƒ‘ãƒªãƒ¼ã‚°, æ—¥æœ¬ã‚·ãƒªãƒ¼ã‚º, é‡çƒé€Ÿå ±, é‡çƒçµæœ, æ®‹ã‚Šè©¦åˆ, å‹ç‡, å·¨äºº, é˜ªç¥, ä¸­æ—¥, åºƒå³¶, ãƒ¤ã‚¯ãƒ«ãƒˆ, æ¨ªæµœ, ã‚½ãƒ•ãƒˆãƒãƒ³ã‚¯, æ¥½å¤©, è¥¿æ­¦, ãƒ­ãƒƒãƒ†, æ—¥ãƒãƒ , ã‚ªãƒªãƒƒã‚¯ã‚¹, é‡çƒãƒ‹ãƒ¥ãƒ¼ã‚¹, ã‚¹ãƒãƒ¼ãƒ„, 2025å¹´">
    <meta name="author" content="NPB Statistics">
    <meta name="robots" content="index, follow">
    <meta name="language" content="ja">
    <link rel="canonical" href="https://npb-dashboard.com/">
    <link rel="sitemap" type="application/xml" href="https://npb-dashboard.com/sitemap.xml">
    <meta name="theme-color" content="#333">
    <meta name="application-name" content="NPB Dashboard">
    <meta name="msapplication-TileColor" content="#333">
    <meta name="google-site-verification" content="placeholder-verification-code">
    
    <title>ã€ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°ã€‘NPB 2025é †ä½è¡¨ãƒ»ãƒã‚¸ãƒƒã‚¯ãƒŠãƒ³ãƒãƒ¼ãƒ»ãƒ—ãƒ¬ãƒ¼ã‚ªãƒ•é€²å‡ºçŠ¶æ³ | NPB Dashboard</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" sizes="32x32" href="20250902_2341_NPB ëŒ€ì‹œë³´ë“œ ì•„ì´ì½˜_simple_compose_01k45dz9pjetvtptav6rv4m473.png">
    <link rel="icon" type="image/png" sizes="16x16" href="20250902_2341_NPB ëŒ€ì‹œë³´ë“œ ì•„ì´ì½˜_simple_compose_01k45dz9pjetvtptav6rv4m473.png">
    <link rel="apple-touch-icon" href="20250902_2341_NPB ëŒ€ì‹œë³´ë“œ ì•„ì´ì½˜_simple_compose_01k45dz9pjetvtptav6rv4m473.png">
    <link rel="shortcut icon" href="20250902_2341_NPB ëŒ€ì‹œë³´ë“œ ì•„ì´ì½˜_simple_compose_01k45dz9pjetvtptav6rv4m473.png">
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://npb-dashboard.com/">
    <meta property="og:title" content="ã€ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°ã€‘NPB 2025é †ä½è¡¨ãƒ»ãƒã‚¸ãƒƒã‚¯ãƒŠãƒ³ãƒãƒ¼ãƒ»ãƒ—ãƒ¬ãƒ¼ã‚ªãƒ•é€²å‡ºçŠ¶æ³">
    <meta property="og:description" content="NPB(æ—¥æœ¬ãƒ—ãƒ­é‡çƒ)2025å¹´ã‚·ãƒ¼ã‚ºãƒ³ã®æœ€æ–°é †ä½è¡¨ã¨ãƒã‚¸ãƒƒã‚¯ãƒŠãƒ³ãƒãƒ¼ã‚’æ¯æ—¥è‡ªå‹•æ›´æ–°ã€‚ã‚»ãƒªãƒ¼ã‚°ãƒ»ãƒ‘ãƒªãƒ¼ã‚°ä¸¡ãƒªãƒ¼ã‚°ã®è©³ç´°æˆç¸¾ã¨å‹ç‡åˆ†æã‚’å®Œå…¨ç¶²ç¾…ã€‚">
    <meta property="og:image" content="https://sanghunbruceham.github.io/npb/images/npb-og-image.jpg">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:site_name" content="NPB Statistics">
    <meta property="og:locale" content="ja_JP">
    <meta property="article:publisher" content="https://npb-dashboard.com">
    <meta property="article:section" content="Sports">
    
    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:url" content="https://npb-dashboard.com/">
    <meta name="twitter:title" content="ã€ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã€‘NPB 2025é †ä½è¡¨ãƒ»ãƒã‚¸ãƒƒã‚¯">
    <meta name="twitter:description" content="NPB 2025å¹´ã‚·ãƒ¼ã‚ºãƒ³ã®æœ€æ–°é †ä½è¡¨ã¨ãƒã‚¸ãƒƒã‚¯ãƒŠãƒ³ãƒãƒ¼ã‚’æ¯æ—¥è‡ªå‹•æ›´æ–°ã€‚ç„¡æ–™ã§ã”åˆ©ç”¨ã„ãŸã ã‘ã¾ã™ã€‚">
    <meta name="twitter:image" content="https://sanghunbruceham.github.io/npb/images/npb-og-image.jpg">
    <meta name="twitter:site" content="@npb_dashboard">
    <meta name="twitter:creator" content="@npb_dashboard">
    
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-LFKN46L0P6"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);} 
      gtag('js', new Date());
      gtag('config', 'G-LFKN46L0P6');
    </script>
    
    <!-- Structured Data -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": ["WebApplication", "SportsOrganization"],
      "name": "NPB Statistics Dashboard",
      "description": "NPB(æ—¥æœ¬ãƒ—ãƒ­é‡çƒ)2025å¹´ã‚·ãƒ¼ã‚ºãƒ³ã®é †ä½è¡¨ã¨ãƒã‚¸ãƒƒã‚¯ãƒŠãƒ³ãƒãƒ¼æƒ…å ±ã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§è¿½è·¡ã™ã‚‹ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰",
      "url": "https://npb-dashboard.com/",
      "applicationCategory": "Sports Statistics",
      "operatingSystem": "Any",
      "browserRequirements": "Modern web browser",
      "sport": "Baseball",
      "foundingDate": "2025",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD"
      },
      "featureList": [
        "ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é †ä½è¡¨",
        "ãƒã‚¸ãƒƒã‚¯ãƒŠãƒ³ãƒãƒ¼è¨ˆç®—",
        "ãƒ—ãƒ¬ãƒ¼ã‚ªãƒ•é€²å‡ºçŠ¶æ³",
        "å‹ç‡ã‚·ãƒŠãƒªã‚ªåˆ†æ",
        "æ®‹ã‚Šè©¦åˆæ•°çµ±è¨ˆ"
      ],
      "keywords": "æ—¥æœ¬ãƒ—ãƒ­é‡çƒ,NPB,é †ä½è¡¨,ãƒã‚¸ãƒƒã‚¯,å„ªå‹,ãƒ—ãƒ¬ãƒ¼ã‚ªãƒ•,CS,é‡çƒçµ±è¨ˆ",
      "inLanguage": "ja",
      "audience": {
        "@type": "Audience",
        "audienceType": "Baseball fans",
        "geographicArea": {
          "@type": "Country",
          "name": "Japan"
        }
      },
      "about": {
        "@type": "SportsEvent",
        "name": "NPB 2025 Regular Season",
        "startDate": "2025-03-29",
        "endDate": "2025-10-31",
        "sport": "Baseball",
        "location": {
          "@type": "Country",
          "name": "Japan"
        },
        "organizer": {
          "@type": "SportsOrganization",
          "name": "Nippon Professional Baseball",
          "url": "https://npb.jp"
        },
        "subEvent": [
          {
            "@type": "SportsEvent",
            "name": "ã‚»ãƒ³ãƒˆãƒ©ãƒ«ãƒ»ãƒªãƒ¼ã‚°",
            "sport": "Baseball"
          },
          {
            "@type": "SportsEvent", 
            "name": "ãƒ‘ã‚·ãƒ•ã‚£ãƒƒã‚¯ãƒ»ãƒªãƒ¼ã‚°",
            "sport": "Baseball"
          }
        ]
      },
      "provider": {
        "@type": "Organization",
        "name": "NPB Statistics"
      },
      "dateModified": "2025-01-01",
      "isAccessibleForFree": true
    }
    </script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body { 
            font-family: Arial, sans-serif; 
            background: white; 
            color: black; 
            font-size: 14px; 
            line-height: 1.4;
            min-width: 320px;
        }
        
        .header { 
            background: #333; 
            color: white; 
            padding: 10px 20px;
        }
        
        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .site-name {
            font-size: 16px;
            font-weight: bold;
            color: white;
            text-decoration: none;
        }
        
        h1 { 
            font-size: 18px; 
            margin: 0; 
            font-weight: bold;
        }
        
        .nav { 
            background: #f5f5f5; 
            border-bottom: 2px solid #ddd;
            width: 100%;
        }
        
        .nav-tabs { 
            display: flex; 
            max-width: 1200px; 
            margin: 0 auto;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .nav-tab { 
            padding: 12px 20px; 
            cursor: pointer; 
            border-right: 1px solid #ddd; 
            font-size: 14px; 
            background: #f5f5f5; 
            border: none; 
            font-family: inherit;
            flex: 1;
            min-width: 150px;
            text-align: center;
        }
        
        .nav-tab:hover { 
            background: #e9e9e9; 
        }
        
        .nav-tab.active { 
            background: white; 
            font-weight: bold; 
            border-bottom: 2px solid #0066cc; 
        }
        
        .container { 
            max-width: 1200px; 
            margin: 0 auto; 
            padding: 20px;
            width: 100%;
        }
        
        .tab-content { 
            display: none; 
        }
        
        .tab-content.active { 
            display: block; 
        }
        
        h2 { 
            font-size: 16px; 
            margin: 15px 0 8px 0; 
            font-weight: bold; 
        }
        
        h3 {
            font-size: 14px;
            margin: 10px 0;
            font-weight: bold;
        }
        
        table { 
            border-collapse: collapse; 
            width: 100%; 
            margin: 10px 0; 
        }
        
        th, td { 
            border: 1px solid #ddd; 
            padding: 6px 8px; 
            text-align: left; 
            font-size: 13px; 
            white-space: nowrap; 
        }
        
        th { 
            background: #f5f5f5; 
            font-weight: bold; 
        }
        
        tr:nth-child(even) { 
            background: #f9f9f9; 
        }
        
        .leagues { 
            display: grid; 
            /* Always stack leagues vertically (Central above Pacific) */
            grid-template-columns: 1fr; 
            gap: 30px; 
            margin: 20px 0; 
        }
        
        .center { 
            text-align: center; 
        }
        
        .right { 
            text-align: right; 
        }
        
        .rank1 { 
            background: #fff3cd; 
        }
        
        .rank2 { 
            background: #f0f0f0; 
        }
        
        .rank3 { 
            background: #ffeedd; 
        }
        
        .win { 
            color: #0066cc; 
        }
        
        .loss { 
            color: #cc0000; 
        }
        
        .pct { 
            font-weight: bold; 
        }
        
        .info { 
            font-size: 12px; 
            color: #333; 
            margin: 10px 0;
            text-align: center;
        }
        
        .loading { 
            text-align: center; 
            padding: 20px; 
            color: #444; 
        }
        
        .magic-number { 
            font-size: 24px; 
            font-weight: bold; 
            color: #0066cc; 
        }
        
        .eliminated { 
            color: #cc0000; 
        }
        
        .clinched { 
            color: #00aa00; 
        }

        .scroll-table { 
            overflow-x: auto; 
        }

        /* Today schedule */
        .today-section {
            background: #fffef8;
            border: 1px solid #eee0b3;
            border-radius: 6px;
            padding: 12px;
            margin: 16px 0 10px 0;
        }
        .today-section h2 {
            display: flex;
            align-items: baseline;
            gap: 8px;
        }
        .today-date {
            font-size: 12px;
            color: #666;
            font-weight: normal;
        }
        .games-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-top: 10px;
        }
        .game-card {
            border: 1px solid #e6e6e6;
            border-radius: 6px;
            padding: 8px 10px;
            background: #fff;
        }
        .game-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 6px;
            font-weight: bold;
        }
        .game-sub {
            margin-top: 4px;
            font-size: 12px;
            color: #444;
        }
        .league-tag {
            display: inline-block;
            font-size: 11px;
            padding: 2px 6px;
            border-radius: 10px;
            border: 1px solid #bbb;
            background: #f7f7f7;
        }
        .league-central { background: #e8f2ff; border-color: #b7d3ff; }
        .league-pacific { background: #e9fff0; border-color: #b9efcd; }

        /* Toggle */
        .schedule-toggle { margin-top: 8px; }
        .toggle-group {
            display: inline-flex;
            border: 1px solid #ddd;
            border-radius: 999px;
            overflow: hidden;
            background: #fafafa;
        }
        .toggle-btn {
            padding: 6px 12px;
            font-size: 12px;
            border: none;
            background: transparent;
            cursor: pointer;
        }
        .toggle-btn.active {
            background: white;
            color: #000;
            font-weight: bold;
        }
        
        @media (max-width: 768px) { 
            .leagues { 
                grid-template-columns: 1fr; 
                gap: 20px; 
            } 
            
            .container { 
                padding: 10px; 
            }
            
            .nav-tabs {
                flex-direction: column;
            }
            
            .nav-tab {
                width: 100%;
                border-right: none;
                border-bottom: 1px solid #ddd;
            }
            
            table { 
                font-size: 11px; 
            }
            
            th, td { 
                padding: 4px 6px; 
            }
            
            .nav-tab { 
                padding: 10px 12px; 
                font-size: 12px; 
            }
            
            .scroll-table {
                width: 100%;
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
            }

            .scroll-table table {
                min-width: 600px;
            }

            .games-grid { grid-template-columns: 1fr; }
        }

        /* Layout: sticky footer without JS (flex column) */
        html, body { height: 100%; }
        body { display: flex; flex-direction: column; min-height: 100vh; }
        main { flex: 1 0 auto; }
        
        /* Simple site footer (flow layout; pushed to bottom by flex) */
        .site-footer {
            margin-top: auto;
            background: #ffffff; border-top: 1px solid #cfcfcf;
            box-shadow: 0 -2px 8px rgba(0,0,0,0.06);
        }
        .site-footer .footer-content {
            max-width: 1200px; margin: 0 auto; padding: 12px 20px;
            color: #222; font-size: 13px; line-height: 1.5;
            display: flex; justify-content: space-between; align-items: center; gap: 8px; flex-wrap: wrap;
        }
        .site-footer a { color: #0066cc; text-decoration: none; }
        .site-footer a:hover { text-decoration: underline; }
        .site-footer { padding-bottom: env(safe-area-inset-bottom); }
        .today-date { color: #444; }

        /* Team logo before name */
        .team-logo {
            height: 1.2em;
            width: auto;
            vertical-align: text-bottom;
            margin-right: 0.35em;
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-content">
            <a href="/npb/" class="site-name">NPB Dashboard</a>
            <h1>NPB 2025 ã‚·ãƒ¼ã‚ºãƒ³</h1>
        </div>
    </div>
    
    <div class="nav">
        <div class="nav-tabs">
            <div class="nav-tab active" onclick="showTab('magic-regular', this)">æ­£è¦ã‚·ãƒ¼ã‚ºãƒ³å„ªå‹ãƒã‚¸ãƒƒã‚¯</div>
            <div class="nav-tab" onclick="showTab('magic-playoff', this)">ãƒ—ãƒ¬ãƒ¼ã‚ªãƒ•ãƒã‚¸ãƒƒã‚¯</div>
            <div class="nav-tab" onclick="showTab('scenarios', this)">çµŒè·¯ã®æ•°</div>
            <div class="nav-tab" onclick="showTab('standings', this)">ãƒãƒ¼ãƒ é †ä½</div>
            <div class="nav-tab" onclick="showTab('remaining', this)">æ®‹ã‚Šè©¦åˆæ•°</div>
        </div>
    </div>

    <main role="main">
    <div class="container">
        <!-- Today Schedule (Top of the page) -->
        <section id="today-section" class="today-section">
            <h2>
                ä»Šæ—¥ã®è©¦åˆ
                <span id="today-date" class="today-date"></span>
            </h2>
            <div class="schedule-toggle">
                <div class="toggle-group" role="tablist" aria-label="Schedule Toggle">
                    <button id="btn-today" class="toggle-btn active" role="tab" aria-selected="true">ä»Šæ—¥</button>
                    <button id="btn-tomorrow" class="toggle-btn" role="tab" aria-selected="false">æ˜æ—¥</button>
                </div>
            </div>
            <div id="today-games-container" class="games-grid">
                <div class="game-card"><div class="game-row">èª­ã¿è¾¼ã¿ä¸­...</div></div>
            </div>
        </section>

        <div class="info">
            æœ€çµ‚æ›´æ–°: <span id="last-update">èª­ã¿è¾¼ã¿ä¸­...</span> | 
            ç·è©¦åˆæ•°: <span id="total-games">758è©¦åˆ</span> |
            ä»Šæ—¥ã®è©¦åˆ: <span id="today-games">5è©¦åˆ</span>
        </div>
        
        <!-- Regular Season Magic Numbers -->
        <div id="magic-regular" class="tab-content active">
            <h2>æ­£è¦ã‚·ãƒ¼ã‚ºãƒ³å„ªå‹ãƒã‚¸ãƒƒã‚¯ãƒŠãƒ³ãƒãƒ¼</h2>
            
            <div class="leagues">
                <div>
                    <h3>ã‚»ãƒ³ãƒˆãƒ©ãƒ«ãƒªãƒ¼ã‚°</h3>
                    <table>
                        <thead>
                            <tr>
                                <th class="center">é †ä½</th>
                                <th>ãƒãƒ¼ãƒ </th>
                                <th class="center">è©¦åˆ</th>
                                <th class="center">å‹</th>
                                <th class="center">æ•—</th>
                                <th class="center">åˆ†</th>
                                <th class="center">å‹ç‡</th>
                                <th class="center">ã‚²ãƒ¼ãƒ å·®</th>
                                <th class="center">æ®‹ã‚Šè©¦åˆ</th>
                                <th class="center">æœ€å¤§å‹</th>
                                <th class="center">1ä½æ¡ä»¶</th>
                                <th class="center">ãƒã‚¸ãƒƒã‚¯</th>
                                <th class="center">ã‚¨ãƒªãƒŸãƒãƒ¼ãƒˆ</th>
                                <th class="center">é€²å‡ºçŠ¶æ³</th>
                            </tr>
                        </thead>
                        <tbody id="central-magic-regular">
                            <tr><td colspan="14" class="loading">èª­ã¿è¾¼ã¿ä¸­...</td></tr>
                        </tbody>
                    </table>
                </div>
                <div>
                    <h3>ãƒ‘ã‚·ãƒ•ã‚£ãƒƒã‚¯ãƒªãƒ¼ã‚°</h3>
                    <table>
                        <thead>
                            <tr>
                                <th class="center">é †ä½</th>
                                <th>ãƒãƒ¼ãƒ </th>
                                <th class="center">è©¦åˆ</th>
                                <th class="center">å‹</th>
                                <th class="center">æ•—</th>
                                <th class="center">åˆ†</th>
                                <th class="center">å‹ç‡</th>
                                <th class="center">ã‚²ãƒ¼ãƒ å·®</th>
                                <th class="center">æ®‹ã‚Šè©¦åˆ</th>
                                <th class="center">æœ€å¤§å‹</th>
                                <th class="center">1ä½æ¡ä»¶</th>
                                <th class="center">ãƒã‚¸ãƒƒã‚¯</th>
                                <th class="center">ã‚¨ãƒªãƒŸãƒãƒ¼ãƒˆ</th>
                                <th class="center">é€²å‡ºçŠ¶æ³</th>
                            </tr>
                        </thead>
                        <tbody id="pacific-magic-regular">
                            <tr><td colspan="14" class="loading">èª­ã¿è¾¼ã¿ä¸­...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
            
            <div class="tab-help tab-help-magic-regular" style="background: #f8f9fa; border: 1px solid #dee2e6; border-radius: 4px; padding: 12px; margin: 15px 0; font-size: 13px; color: #333;">
                <strong>ğŸ“Š ãƒã‚¸ãƒƒã‚¯ / ã‚¨ãƒªãƒŸãƒãƒ¼ã‚·ãƒ§ãƒ³ã®å®šç¾©</strong><br>
                <div style="margin-top: 8px; line-height: 1.5;">
                â€¢ <strong>ç·è©¦åˆæ•°</strong>: NPBã¯å„ãƒãƒ¼ãƒ <strong>143è©¦åˆ</strong><br>
                â€¢ <strong>å‹ç‡</strong>: å‹ / (å‹ + æ•—)ï¼ˆåˆ†ã¯å‹ç‡ã«å«ã‚ãªã„ï¼‰<br>
                â€¢ <strong>å„ªå‹ãƒã‚¸ãƒƒã‚¯</strong>: (2ä½ã®<strong>æœ€å¤§å¯èƒ½å‹æ•°</strong>) âˆ’ (1ä½ã®ç¾åœ¨å‹æ•°) + 1ï¼ˆ0ä»¥ä¸‹ã§âœ“ï¼‰<br>
                â€¢ <strong>ã‚¨ãƒªãƒŸãƒãƒ¼ãƒˆ(E)</strong>: 1ä½å‹æ•° ï¼ ãƒãƒ¼ãƒ æœ€å¤§å¯èƒ½å‹æ•°, ã¾ãŸã¯ <code>(143+1) âˆ’ 1ä½å‹ âˆ’ ãƒãƒ¼ãƒ æ•— â‰¤ 0</code><br>
                â€¢ <strong>è¨˜å·</strong>: <strong>âœ“</strong>ï¼ç¢ºå®š, <strong>E</strong>ï¼ä¸å¯èƒ½, <strong>-</strong>ï¼è©²å½“ãªã—
                </div>
            </div>
        </div>

        <!-- Playoff Magic Numbers -->
        <div id="magic-playoff" class="tab-content">
            <h2>ãƒ—ãƒ¬ãƒ¼ã‚ªãƒ•é€²å‡ºãƒã‚¸ãƒƒã‚¯ãƒŠãƒ³ãƒãƒ¼</h2>
            <div class="leagues">
                <div>
                    <h3>ã‚»ãƒ³ãƒˆãƒ©ãƒ«ãƒªãƒ¼ã‚° (ä¸Šä½3ãƒãƒ¼ãƒ )</h3>
                    <table>
                        <thead>
                            <tr>
                                <th class="center">é †ä½</th>
                                <th>ãƒãƒ¼ãƒ </th>
                                <th class="center">å‹</th>
                                <th class="center">æ•—</th>
                                <th class="center">åˆ†</th>
                                <th class="center">å‹ç‡</th>
                                <th class="center">è©¦åˆ</th>
                                <th class="center">ã‚²ãƒ¼ãƒ å·®</th>
                                <th class="center">æ®‹ã‚Šè©¦åˆ</th>
                                <th class="center">æœ€å¤§å‹</th>
                                <th class="center">3ä½æ¡ä»¶</th>
                                <th class="center">ãƒã‚¸ãƒƒã‚¯</th>
                                <th class="center">ã‚¨ãƒªãƒŸãƒãƒ¼ãƒˆ</th>
                                <th class="center">é€²å‡ºçŠ¶æ³</th>
                            </tr>
                        </thead>
                        <tbody id="central-magic-playoff">
                            <tr><td colspan="14" class="loading">èª­ã¿è¾¼ã¿ä¸­...</td></tr>
                        </tbody>
                    </table>
                </div>
                <div>
                    <h3>ãƒ‘ã‚·ãƒ•ã‚£ãƒƒã‚¯ãƒªãƒ¼ã‚° (ä¸Šä½3ãƒãƒ¼ãƒ )</h3>
                    <table>
                        <thead>
                            <tr>
                                <th class="center">é †ä½</th>
                                <th>ãƒãƒ¼ãƒ </th>
                                <th class="center">å‹</th>
                                <th class="center">æ•—</th>
                                <th class="center">åˆ†</th>
                                <th class="center">å‹ç‡</th>
                                <th class="center">è©¦åˆ</th>
                                <th class="center">ã‚²ãƒ¼ãƒ å·®</th>
                                <th class="center">æ®‹ã‚Šè©¦åˆ</th>
                                <th class="center">æœ€å¤§å‹</th>
                                <th class="center">3ä½æ¡ä»¶</th>
                                <th class="center">ãƒã‚¸ãƒƒã‚¯</th>
                                <th class="center">ã‚¨ãƒªãƒŸãƒãƒ¼ãƒˆ</th>
                                <th class="center">é€²å‡ºçŠ¶æ³</th>
                            </tr>
                        </thead>
                        <tbody id="pacific-magic-playoff">
                            <tr><td colspan="14" class="loading">èª­ã¿è¾¼ã¿ä¸­...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="tab-help tab-help-magic-playoff" style="background: #fff3cd; border: 1px solid #ffeaa7; border-radius: 4px; padding: 12px; margin: 15px 0; font-size: 13px; color: #533f03;">
                <strong>ğŸ† ãƒ—ãƒ¬ãƒ¼ã‚ªãƒ• (CS) é€²å‡ºã®åˆ¤å®š</strong><br>
                <div style="margin-top: 8px; line-height: 1.5;">
                â€¢ <strong>é€²å‡ºæ </strong>: å„ãƒªãƒ¼ã‚°<strong>ä¸Šä½3ä½</strong>ãŒCSé€²å‡º<br>
                â€¢ <strong>ãƒã‚¸ãƒƒã‚¯</strong>: 4ä½ã®<strong>æœ€å¤§å¯èƒ½å‹æ•°</strong>ã‚’åŸºæº–ã«ã€å¯¾è±¡ãƒãƒ¼ãƒ ãŒåˆ°é”ã™ã¹ãå‹æ•°ï¼ˆ0ä»¥ä¸‹ã§âœ“ï¼‰<br>
                â€¢ <strong>ã‚¨ãƒªãƒŸãƒãƒ¼ãƒˆ(E)</strong>: <code>(143+1) âˆ’ 3ä½å‹ âˆ’ ãƒãƒ¼ãƒ æ•— â‰¤ 0</code> ã¾ãŸã¯ ãƒãƒ¼ãƒ æœ€å¤§å¯èƒ½å‹æ•° ï¼œ 3ä½å‹æ•°
                </div>
            </div>
        </div>

        <!-- Scenarios -->
        <div id="scenarios" class="tab-content">
            <h2>çµŒè·¯ã®æ•° - ç›®æ¨™å‹ç‡é”æˆã«å¿…è¦ãªå‹æ•°</h2>
            <div style="margin-bottom: 20px;">
                <h3>ã‚»ãƒ³ãƒˆãƒ©ãƒ«ãƒªãƒ¼ã‚°</h3>
                <div class="scroll-table">
                    <table style="font-size: 11px; border-collapse: collapse;">
                        <thead id="central-scenarios-header">
                            <!-- NPB ìŠ¤íƒ€ì¼ 4ì¤„ í—¤ë” -->
                        </thead>
                        <tbody id="central-scenarios">
                            <tr><td colspan="20" class="loading">èª­ã¿è¾¼ã¿ä¸­...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div>
                <h3>ãƒ‘ã‚·ãƒ•ã‚£ãƒƒã‚¯ãƒªãƒ¼ã‚°</h3>
                <div class="scroll-table">
                    <table style="font-size: 11px; border-collapse: collapse;">
                        <thead id="pacific-scenarios-header">
                            <!-- NPB ìŠ¤íƒ€ì¼ 4ì¤„ í—¤ë” -->
                        </thead>
                        <tbody id="pacific-scenarios">
                            <tr><td colspan="20" class="loading">èª­ã¿è¾¼ã¿ä¸­...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="tab-help tab-help-scenarios" style="background: #e7f3ff; border: 1px solid #b3d7ff; border-radius: 4px; padding: 12px; margin: 15px 0; font-size: 13px; color: #003566;">
                <strong>ğŸ“ˆ å‹ç‡åˆ¥ã‚·ãƒŠãƒªã‚ªåˆ†æ</strong><br>
                <div style="margin-top: 8px; line-height: 1.5;">
                â€¢ <strong>ç›®æ¨™å‹ç‡</strong>: æ®‹ã‚Šè©¦åˆã‚’30%ã€œ90%ã®å‹ç‡ã§é€²ã‚ãŸå ´åˆã®æœ€çµ‚æˆç¸¾ã‚’äºˆæ¸¬<br>
                â€¢ <strong>å¿…è¦å‹æ•°</strong>: å„å‹ç‡ã‚’é”æˆã™ã‚‹ãŸã‚ã«æ®‹ã‚Šè©¦åˆã§å¿…è¦ãªå‹åˆ©æ•°<br>
                â€¢ <strong>æœ€çµ‚å‹ç‡</strong>: ã‚·ãƒ¼ã‚ºãƒ³çµ‚äº†æ™‚ç‚¹ã®å‹ç‡äºˆæƒ³ï¼ˆåˆ†ã¯å‹ç‡ã«å«ã‚ãªã„ï¼‰<br>
                â€¢ <strong>æ®‹ã‚Šè©¦åˆ</strong>: <code>143 âˆ’ ç¾åœ¨ã®è©¦åˆæ•°</code> ã‚’ä½¿ç”¨
                </div>
            </div>
        </div>

        <!-- Detailed Standings -->
        <div id="standings" class="tab-content">
            <h2>è©³ç´°é †ä½è¡¨</h2>
            <div class="scroll-table">
                <h3>ã‚»ãƒ³ãƒˆãƒ©ãƒ«ãƒªãƒ¼ã‚°</h3>
                <table>
                    <thead>
                        <tr>
                            <th class="center">é †ä½</th>
                            <th>ãƒãƒ¼ãƒ </th>
                            <th class="center">è©¦åˆ</th>
                            <th class="center">å‹</th>
                            <th class="center">æ•—</th>
                            <th class="center">åˆ†</th>
                            <th class="center">å‹ç‡</th>
                            <th class="center">æ®‹ã‚Š</th>
                            <th class="center">å·®</th>
                            <th class="center">ãƒ›ãƒ¼ãƒ </th>
                            <th class="center">ãƒ›ãƒ¼ãƒ ç‡</th>
                            <th class="center">ã‚¢ã‚¦ã‚§ãƒ¼</th>
                            <th class="center">ã‚¢ã‚¦ã‚§ãƒ¼ç‡</th>
                            <th class="center">æœ€é«˜é †ä½</th>
                            <th class="center">æœ€ä½é †ä½</th>
                        </tr>
                    </thead>
                    <tbody id="central-detailed">
                        <tr><td colspan="15" class="loading">èª­ã¿è¾¼ã¿ä¸­...</td></tr>
                    </tbody>
                </table>
            </div>
            <div class="scroll-table" style="margin-top: 30px;">
                <h3>ãƒ‘ã‚·ãƒ•ã‚£ãƒƒã‚¯ãƒªãƒ¼ã‚°</h3>
                <table>
                    <thead>
                        <tr>
                            <th class="center">é †ä½</th>
                            <th>ãƒãƒ¼ãƒ </th>
                            <th class="center">è©¦åˆ</th>
                            <th class="center">å‹</th>
                            <th class="center">æ•—</th>
                            <th class="center">åˆ†</th>
                            <th class="center">å‹ç‡</th>
                            <th class="center">æ®‹ã‚Š</th>
                            <th class="center">å·®</th>
                            <th class="center">ãƒ›ãƒ¼ãƒ </th>
                            <th class="center">ãƒ›ãƒ¼ãƒ ç‡</th>
                            <th class="center">ã‚¢ã‚¦ã‚§ãƒ¼</th>
                            <th class="center">ã‚¢ã‚¦ã‚§ãƒ¼ç‡</th>
                            <th class="center">æœ€é«˜é †ä½</th>
                            <th class="center">æœ€ä½é †ä½</th>
                        </tr>
                    </thead>
                    <tbody id="pacific-detailed">
                        <tr><td colspan="15" class="loading">èª­ã¿è¾¼ã¿ä¸­...</td></tr>
                    </tbody>
                </table>
            </div>
            <div class="tab-help tab-help-standings" style="background: #f1f3f5; border: 1px solid #dee2e6; border-radius: 4px; padding: 10px; margin: 10px 0; font-size: 12px; color: #333;">
                â€¢ <strong>å‹ç‡</strong>= å‹ / (å‹+æ•—), <strong>æ®‹ã‚Š</strong>= 143 âˆ’ è©¦åˆ, <strong>å·®</strong>= é¦–ä½ã‹ã‚‰ã®ã‚²ãƒ¼ãƒ å·®<br>
                â€¢ <strong>åˆ†</strong>ã¯å‹ç‡ã«å«ã¾ã‚Œã¾ã›ã‚“ã€‚è¡¨ç¤ºã¯æœ€æ–°JSONã«åŸºã¥ãã¾ã™ã€‚
            </div>
        </div>

        <!-- Remaining Games -->
        <div id="remaining" class="tab-content">
            <h2>ãƒãƒ¼ãƒ åˆ¥æ®‹ã‚Šè©¦åˆæ•°</h2>
            <div class="leagues">
                <div>
                    <h3>ã‚»ãƒ³ãƒˆãƒ©ãƒ«ãƒªãƒ¼ã‚°</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>ãƒãƒ¼ãƒ </th>
                                <th class="center">è©¦åˆ</th>
                                <th class="center">æ®‹ã‚Šè©¦åˆ</th>
                                <th class="center">ãƒ›ãƒ¼ãƒ </th>
                                <th class="center">ã‚¢ã‚¦ã‚§ãƒ¼</th>
                                <th class="center">å¯¾æˆ¦ç›¸æ‰‹</th>
                            </tr>
                        </thead>
                        <tbody id="central-remaining">
                            <tr><td colspan="6" class="loading">èª­ã¿è¾¼ã¿ä¸­...</td></tr>
                        </tbody>
                    </table>
                </div>
                <div>
                    <h3>ãƒ‘ã‚·ãƒ•ã‚£ãƒƒã‚¯ãƒªãƒ¼ã‚°</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>ãƒãƒ¼ãƒ </th>
                                <th class="center">è©¦åˆ</th>
                                <th class="center">æ®‹ã‚Šè©¦åˆ</th>
                                <th class="center">ãƒ›ãƒ¼ãƒ </th>
                                <th class="center">ã‚¢ã‚¦ã‚§ãƒ¼</th>
                                <th class="center">å¯¾æˆ¦ç›¸æ‰‹</th>
                            </tr>
                        </thead>
                        <tbody id="pacific-remaining">
                            <tr><td colspan="6" class="loading">èª­ã¿è¾¼ã¿ä¸­...</td></tr>
                        </tbody>
                    </table>
            </div>
            <div class="tab-help tab-help-remaining" style="background: #f1f3f5; border: 1px solid #dee2e6; border-radius: 4px; padding: 10px; margin: 10px 0; font-size: 12px; color: #333;">
                â€¢ <strong>æ®‹ã‚Šè©¦åˆ</strong>= 143 âˆ’ ç¾åœ¨ã®è©¦åˆæ•°<br>
                â€¢ <strong>ãƒ›ãƒ¼ãƒ /ã‚¢ã‚¦ã‚§ãƒ¼</strong>: å®Ÿéš›ã®ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ãƒ‡ãƒ¼ã‚¿ã«åŸºã¥ã„ã¦æ­£ç¢ºã«è¨ˆç®—<br>
                â€¢ <strong>å¯¾æˆ¦ç›¸æ‰‹</strong>: ä»Šå¾Œäºˆå®šã•ã‚Œã¦ã„ã‚‹è©¦åˆã®å®Ÿéš›ã®ç›¸æ‰‹ãƒãƒ¼ãƒ ã¨å›æ•°ã‚’è¡¨ç¤º
            </div>
        </div>
        </section>
    </main>

    <script>
        // ===== ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•° =====
        let standingsData = null;      // é †ä½è¡¨ãƒ‡ãƒ¼ã‚¿
        let seasonConfig = null;       // ã‚·ãƒ¼ã‚ºãƒ³è¨­å®šãƒ‡ãƒ¼ã‚¿  
        let gamesData = null;          // å…¨è©¦åˆï¼ˆå®Œäº†åˆ†ï¼‰ãƒ‡ãƒ¼ã‚¿
        let upcomingGamesData = null;  // æ®‹ã‚Šè©¦åˆãƒ‡ãƒ¼ã‚¿
        let homeAwayRemainingByTeam = {}; // { team_id: { home: n, away: n, opponents: {} } }
        let TOTAL_GAMES = 143;         // NPB æ­£è¦ã‚·ãƒ¼ã‚ºãƒ³: 1ãƒãƒ¼ãƒ 143è©¦åˆ

        // ===== ãƒãƒ¼ãƒ ãƒ­ã‚´ï¼ˆç•¥ç§°â†’ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ï¼‰ =====
        const TEAM_LOGOS = {
            YOG: 'assets/npb-logos/svg/yomiuri-giants.svg',
            HAN: 'assets/npb-logos/svg/hanshin-tigers.svg',
            CHU: 'assets/npb-logos/svg/chunichi-dragons.svg',
            HIR: 'assets/npb-logos/svg/hiroshima-toyo-carp.svg',
            YDB: 'assets/npb-logos/svg/yokohama-dena-baystars.svg',
            YAK: 'assets/npb-logos/svg/tokyo-yakult-swallows.svg',
            SOF: 'assets/npb-logos/svg/fukuoka-softbank-hawks.svg',
            LOT: 'assets/npb-logos/svg/chiba-lotte-marines.svg',
            SEI: 'assets/npb-logos/svg/saitama-seibu-lions.svg',
            ORI: 'assets/npb-logos/svg/orix-buffaloes.svg',
            NIP: 'assets/npb-logos/svg/hokkaido-nippon-ham-fighters.svg',
            RAK: 'assets/npb-logos/svg/tohoku-rakuten-golden-eagles.svg'
        };

        function renderTeamLabel(abbr, name) {
            const src = TEAM_LOGOS[abbr] || '';
            const safeName = name || abbr || '';
            const img = src ? `<img class="team-logo" src="${src}" alt="${safeName}">` : '';
            return `${img}${safeName}`;
        }

        // ===== ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆæ©Ÿèƒ½ =====
        function showTab(tabId, el) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
                tab.setAttribute('aria-hidden', 'true');
            });
            
            // Reset all nav buttons
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
                tab.setAttribute('aria-selected', 'false');
            });
            
            // Show selected tab
            const selectedTab = document.getElementById(tabId);
            selectedTab.classList.add('active');
            selectedTab.setAttribute('aria-hidden', 'false');
            
            // Activate nav button
            if (el) {
                el.classList.add('active');
                el.setAttribute('aria-selected', 'true');
            }

            // Static footer: no dynamic updates needed
        }


        // ===== æ­£è¦ã‚·ãƒ¼ã‚ºãƒ³å„ªå‹ãƒã‚¸ãƒƒã‚¯æ›´æ–° =====
        function updateMagicRegular() {
            updateMagicTable('central-magic-regular', standingsData.central_league?.standings || [], true);
            updateMagicTable('pacific-magic-regular', standingsData.pacific_league?.standings || [], true);
        }

        // ===== ãƒ—ãƒ¬ãƒ¼ã‚ªãƒ•ãƒã‚¸ãƒƒã‚¯æ›´æ–° =====
        function updateMagicPlayoff() {
            updateMagicTable('central-magic-playoff', standingsData.central_league?.standings || [], false);
            updateMagicTable('pacific-magic-playoff', standingsData.pacific_league?.standings || [], false);
        }

        // ===== ãƒã‚¸ãƒƒã‚¯ãƒŠãƒ³ãƒãƒ¼ãƒ†ãƒ¼ãƒ–ãƒ«æ›´æ–°ï¼ˆå…±é€šé–¢æ•°ï¼‰ =====
        function updateMagicTable(id, teams, isRegular) {
            const tbody = document.getElementById(id);
            if (!teams.length) {
                tbody.innerHTML = '<tr><td colspan="13" class="loading">ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“</td></tr>';
                return;
            }

            const leader = teams[0];
            const thirdPlace = teams[2] || {};
            
            tbody.innerHTML = teams.map(team => {
                const rankClass = team.position_rank === 1 ? 'rank1' : 
                                 team.position_rank === 2 ? 'rank2' : 
                                 team.position_rank === 3 ? 'rank3' : '';
                
                const remainingGames = TOTAL_GAMES - team.games_played;
                const maxWins = team.wins + remainingGames;
                let magic = '-';
                let clinch = '-';
                let csConfirmed = '-';  // í”Œë ˆì´ì˜¤í”„ìš© CSí™•ì • ë³€ìˆ˜
                let eliminate = '-';
                let condition = '-';
                
                if (isRegular) {
                    // æ­£è¦ã‚·ãƒ¼ã‚ºãƒ³å„ªå‹ãƒã‚¸ãƒƒã‚¯ãƒŠãƒ³ãƒãƒ¼è¨ˆç®—
                    if (team.position_rank === 1) {
                        const secondPlace = teams[1];
                        if (secondPlace && remainingGames > 0) {
                            // ãƒã‚¸ãƒƒã‚¯ãƒŠãƒ³ãƒãƒ¼ = ï¼ˆ2ä½ãƒãƒ¼ãƒ ã®æœ€å¤§å¯èƒ½å‹æ•°ï¼‰ - ï¼ˆ1ä½ãƒãƒ¼ãƒ ã®ç¾åœ¨å‹æ•°ï¼‰ + 1
                            const secondPlaceRemaining = TOTAL_GAMES - secondPlace.games_played;
                            const secondPlaceMaxWins = secondPlace.wins + secondPlaceRemaining;
                            const magicNumber = secondPlaceMaxWins - team.wins + 1;
                            
                            if (magicNumber <= 0) {
                                magic = 'âœ“'; // å„ªå‹ç¢ºå®šæ¸ˆ
                                clinch = 'å„ªå‹';
                                condition = 'ç¢ºå®š';
                            } else {
                                magic = magicNumber;
                                condition = `${magicNumber}å‹å¿…è¦`;
                            }
                        } else if (remainingGames === 0) {
                            magic = 'âœ“'; // ã‚·ãƒ¼ã‚ºãƒ³çµ‚äº†
                            clinch = 'ç¢ºå®š';
                            condition = 'ç¢ºå®š';
                        }
                    } else {
                        // 2ä½ä»¥ä¸‹ãƒãƒ¼ãƒ ã®å„ªå‹æ¡ä»¶: 1ä½ãƒãƒ¼ãƒ ãŒä½•å‹ä»¥ä¸‹ã§çµ‚ã‚ã‚‹å¿…è¦ãŒã‚ã‚‹ã‹
                        const teamMaxWins = team.wins + remainingGames;
                        const leaderCurrentWins = leader.wins;
                        const leaderRemaining = TOTAL_GAMES - leader.games_played;
                        
                        if (teamMaxWins <= leaderCurrentWins) {
                            condition = 'ä¸å¯èƒ½';
                        } else {
                            // ã“ã®ãƒãƒ¼ãƒ ãŒ1ä½ã«ãªã‚‹ãŸã‚ã«1ä½ãƒãƒ¼ãƒ ãŒæœ€å¤§ä½•å‹ã¾ã§ã«æŠ‘ãˆã‚‹å¿…è¦ãŒã‚ã‚‹ã‹
                            const leaderMaxAllowed = teamMaxWins - 1;
                            if (leaderMaxAllowed < leaderCurrentWins) {
                                condition = 'ä¸å¯èƒ½';
                            } else {
                                condition = `1ä½${leaderMaxAllowed}å‹ä»¥ä¸‹`;
                            }
                        }
                    }
                    
                    // å„ªå‹ã‚¨ãƒªãƒŸãƒãƒ¼ãƒˆè¨ˆç®—ï¼ˆ1ä½ã«å¯¾ã™ã‚‹çµ„ã¿åˆã‚ã›ç•ªå·ï¼‰
                    if (team.position_rank > 1) {
                        const teamMaxWins = team.wins + (TOTAL_GAMES - team.games_played); // = TOTAL_GAMES - losses - draws
                        const alreadyEliminated = leader.wins > teamMaxWins;
                        if (alreadyEliminated) {
                            eliminate = 'E';
                        } else {
                            // MLBã®å®šç¾©ã«æº–æ‹ ã—ãŸçµ„ã¿åˆã‚ã›å¼: G+1 - 1ä½å‹ - å½“è©²ãƒãƒ¼ãƒ æ•—
                            const combo = (TOTAL_GAMES + 1) - leader.wins - team.losses;
                            eliminate = combo <= 0 ? 'E' : combo;
                        }
                    }
                } else {
                    // å…¨ãƒãƒ¼ãƒ ã®æœ€å¤§å¯èƒ½å‹æ•°ã‚’è¨ˆç®—ãƒ»ã‚½ãƒ¼ãƒˆ
                    const allMaxWins = teams.map(t => ({
                        team: t.team_abbreviation,
                        maxWins: t.wins + (TOTAL_GAMES - t.games_played)
                    })).sort((a, b) => b.maxWins - a.maxWins);
                    
                    // 3ä½ã‚«ãƒƒãƒˆãƒ©ã‚¤ãƒ³ï¼ˆ3ç•ªç›®ã®æœ€å¤§å¯èƒ½å‹æ•°ï¼‰ã¨4ä½ã®æœ€å¤§å¯èƒ½å‹æ•°
                    const thirdHighestMaxWins = allMaxWins[2] ? allMaxWins[2].maxWins : 0;
                    const fourthHighestMaxWins = allMaxWins[3] ? allMaxWins[3].maxWins : 0;
                    
                    // ãƒ—ãƒ¬ãƒ¼ã‚ªãƒ•ãƒã‚¸ãƒƒã‚¯ï¼ˆ4ä½ã®æœ€å¤§å¯èƒ½å‹æ•°åŸºæº–ï¼‰
                    if (team.playoff_magic !== undefined) {
                        clinch = team.playoff_magic === 0 ? 'âœ“' : team.playoff_magic;
                    } else if (remainingGames > 0) {
                        if (fourthHighestMaxWins > 0) {
                            const need = fourthHighestMaxWins - team.wins + 1;
                            clinch = need <= 0 ? 'âœ“' : need;
                        } else {
                            clinch = 'âœ“';
                        }
                    }
                    
                    // CSé€²å‡ºç¢ºå®šåˆ¤å®š: ç¾åœ¨ã®å‹æ•°ãŒ4ä½ã®æœ€å¤§å¯èƒ½å‹æ•°ã‚’ä¸Šå›ã‚‹ã‹
                    const teamMaxWins = team.wins + remainingGames;
                    if (team.wins > fourthHighestMaxWins) {
                        csConfirmed = 'CSç¢ºå®š';
                        condition = 'ç¢ºå®š';
                    } else if (team.wins === fourthHighestMaxWins) {
                        condition = 'åŒç‡ã®å¯èƒ½æ€§';
                    } else if (teamMaxWins < thirdHighestMaxWins) {
                        // 3ä½ãƒ©ã‚¤ãƒ³ã«æœ€å¤§ã§ã‚‚å±Šã‹ãªã„å ´åˆã¯å³ã—ã„
                        condition = `3ä½${thirdHighestMaxWins}å‹è¶…å¿…è¦`;
                    } else {
                        condition = `4ä½æœ€å¤§${fourthHighestMaxWins}å‹`; // ç›®å®‰æƒ…å ±
                    }
                    
                    // ã‚¨ãƒªãƒŸãƒãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆ3ä½ã®ç¾åœ¨å‹æ•°åŸºæº–ã®çµ„ã¿åˆã‚ã›å¼ï¼‰
                    if (team.playoff_elimination !== undefined) {
                        eliminate = team.playoff_elimination;
                    } else if (thirdPlace && thirdPlace.wins !== undefined) {
                        const teamMaxWinsPlayoff = team.wins + (TOTAL_GAMES - team.games_played);
                        const alreadyEliminated = teamMaxWinsPlayoff < thirdPlace.wins;
                        if (alreadyEliminated) {
                            eliminate = 'E';
                        } else {
                            // 3ä½ã«å¯¾ã™ã‚‹çµ„ã¿åˆã‚ã›å¼: G+1 - 3ä½å‹ - å½“è©²ãƒãƒ¼ãƒ æ•—
                            const combo = (TOTAL_GAMES + 1) - thirdPlace.wins - team.losses;
                            eliminate = combo <= 0 ? 'E' : combo;
                        }
                    }
                }
                
                if (isRegular) {
                    // ì •ê·œì‹œì¦Œ: é †ä½ ãƒãƒ¼ãƒ  å‹ æ•— åˆ† å‹ç‡ ã‚²ãƒ¼ãƒ å·® æ®‹ã‚Šè©¦åˆ æœ€å¤§å‹ 1ä½æ¡ä»¶ ãƒã‚¸ãƒƒã‚¯ ã‚¨ãƒªãƒŸãƒãƒ¼ãƒˆ é€²å‡ºçŠ¶æ³
                    return `
                        <tr class="${rankClass}">
                            <td class="center">${team.position_rank}</td>
                            <td>${renderTeamLabel(team.team_abbreviation, team.team_name)}</td>
                            <td class="center">${team.games_played}</td>
                            <td class="center win">${team.wins}</td>
                            <td class="center loss">${team.losses}</td>
                            <td class="center">${team.draws || 0}</td>
                            <td class="center pct">${team.win_percentage.toFixed(3)}</td>
                            <td class="center">${team.games_behind > 0 ? team.games_behind.toFixed(1) : '-'}</td>
                            <td class="center">${remainingGames}</td>
                            <td class="center">${maxWins}</td>
                            <td class="center" style="font-size: 11px;">${condition}</td>
                            <td class="center ${magic === 'âœ“' ? 'clinched' : 'magic-number'}">${magic}</td>
                            <td class="center ${eliminate === 'E' ? 'eliminated' : ''}">${eliminate}</td>
                            <td class="center ${clinch !== '-' ? 'clinched' : ''}" style="font-size: 11px;">${clinch}</td>
                        </tr>
                    `;
                } else {
                    // í”Œë ˆì´ì˜¤í”„: é †ä½ ãƒãƒ¼ãƒ  å‹ æ•— åˆ† å‹ç‡ ã‚²ãƒ¼ãƒ å·® æ®‹ã‚Šè©¦åˆ æœ€å¤§å‹ 3ä½æ¡ä»¶ ãƒã‚¸ãƒƒã‚¯ ã‚¨ãƒªãƒŸãƒãƒ¼ãƒˆ é€²å‡ºçŠ¶æ³
                    return `
                        <tr class="${rankClass}">
                            <td class="center">${team.position_rank}</td>
                            <td>${renderTeamLabel(team.team_abbreviation, team.team_name)}</td>
                            <td class="center">${team.games_played}</td>
                            <td class="center win">${team.wins}</td>
                            <td class="center loss">${team.losses}</td>
                            <td class="center">${team.draws || 0}</td>
                            <td class="center pct">${team.win_percentage.toFixed(3)}</td>
                            <td class="center">${team.games_behind > 0 ? team.games_behind.toFixed(1) : '-'}</td>
                            <td class="center">${remainingGames}</td>
                            <td class="center">${maxWins}</td>
                            <td class="center" style="font-size: 11px;">${condition}</td>
                            <td class="center ${clinch === 'âœ“' ? 'clinched' : 'magic-number'}">${clinch}</td>
                            <td class="center ${eliminate === 'E' ? 'eliminated' : ''}">${eliminate}</td>
                            <td class="center ${csConfirmed !== '-' ? 'clinched' : ''}" style="font-size: 11px;">${csConfirmed}</td>
                        </tr>
                    `;
                }
            }).join('');
        }

        // ===== è©³ç´°é †ä½è¡¨æ›´æ–° =====
        function updateDetailedStandings() {
            updateDetailedTable('central-detailed', standingsData.central_league?.standings || []);
            updateDetailedTable('pacific-detailed', standingsData.pacific_league?.standings || []);
        }

        // ===== è©³ç´°é †ä½ãƒ†ãƒ¼ãƒ–ãƒ«æ›´æ–°ï¼ˆå…±é€šé–¢æ•°ï¼‰ =====
        function updateDetailedTable(id, teams) {
            const tbody = document.getElementById(id);
            if (!teams.length) {
                tbody.innerHTML = '<tr><td colspan="15" class="loading">ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“</td></tr>';
                return;
            }

            tbody.innerHTML = teams.map(team => {
                const rankClass = team.position_rank === 1 ? 'rank1' : 
                                 team.position_rank === 2 ? 'rank2' : 
                                 team.position_rank === 3 ? 'rank3' : '';
                
                const remainingGames = TOTAL_GAMES - team.games_played;
                
                // ãƒ›ãƒ¼ãƒ /ã‚¢ã‚¦ã‚§ã‚¤åˆ†å‰²ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆï¼ˆå®Ÿãƒ‡ãƒ¼ã‚¿ãªã—ã®å ´åˆã®ä»®è¨ˆç®—ï¼‰
                const homeAdvantage = seasonConfig?.display_config?.home_advantage || 0.55;
                const homeGames = Math.floor(team.games_played / 2);
                const awayGames = team.games_played - homeGames;
                const homeWins = Math.floor(team.wins * homeAdvantage); // ãƒ›ãƒ¼ãƒ ã‚¢ãƒ‰ãƒãƒ³ãƒ†ãƒ¼ã‚¸è¨ˆç®—
                const awayWins = team.wins - homeWins;
                const homeLosses = homeGames - homeWins;
                const awayLosses = awayGames - awayWins;
                const homeWinPct = homeGames > 0 ? (homeWins / homeGames).toFixed(3) : '0.000';
                const awayWinPct = awayGames > 0 ? (awayWins / awayGames).toFixed(3) : '0.000';
                
                // æœ€é«˜/æœ€ä½é †ä½å¯èƒ½æ€§è¨ˆç®—
                const maxWins = team.wins + remainingGames;  // ã“ã®ãƒãƒ¼ãƒ ã®æœ€å¤§å¯èƒ½å‹æ•°
                const minWins = team.wins;                   // ã“ã®ãƒãƒ¼ãƒ ã®æœ€å°å¯èƒ½å‹æ•°ï¼ˆç¾åœ¨å‹æ•°ï¼‰
                
                // æœ€é«˜é †ä½è¨ˆç®—: ä»–ãƒãƒ¼ãƒ ãŒæœ€æ‚ªæˆç¸¾ã§çµ‚ã‚ã£ãŸå ´åˆ
                let bestRank = 1;
                teams.forEach(other => {
                    if (other.team_id !== team.team_id) {
                        const otherMinWins = other.wins; // ä»–ãƒãƒ¼ãƒ ã®æœ€å°å‹æ•°ï¼ˆç¾åœ¨å‹æ•°ï¼‰
                        if (otherMinWins > maxWins) {
                            bestRank++; // ã“ã®ãƒãƒ¼ãƒ ã‚ˆã‚Šä¸Šä½ç¢ºå®š
                        }
                    }
                });
                
                // æœ€ä½é †ä½è¨ˆç®—: ä»–ãƒãƒ¼ãƒ ãŒæœ€é«˜æˆç¸¾ã§çµ‚ã‚ã£ãŸå ´åˆ  
                let worstRank = 1;
                teams.forEach(other => {
                    if (other.team_id !== team.team_id) {
                        const otherMaxWins = other.wins + (TOTAL_GAMES - other.games_played);
                        if (otherMaxWins > minWins) {
                            worstRank++; // ã“ã®ãƒãƒ¼ãƒ ã‚ˆã‚Šä¸Šä½å¯èƒ½
                        }
                    }
                });
                
                // CSé€²å‡º/è„±è½çŠ¶æ³ã‚’ç”¨ã„ãŸç¾å®Ÿçš„ãªç¯„å›²è£œæ­£ï¼ˆç°¡æ˜“ï¼‰
                // 4ä½ã®æœ€å¤§å¯èƒ½å‹æ•°ï¼ˆå…¨ãƒãƒ¼ãƒ ã®æœ€å¤§å¯èƒ½å‹æ•°ã®4ç•ªç›®ï¼‰
                const allMaxWins = teams
                    .map(t => t.wins + (TOTAL_GAMES - t.games_played))
                    .sort((a, b) => b - a);
                const fourthHighestMaxWins = allMaxWins[3] ?? 0;
                const thirdPlace = teams[2];
                
                // CSç¢ºå®šãªã‚‰æœ€ä½é †ä½ã¯3ä½ä»¥å†…
                if (team.wins > fourthHighestMaxWins) {
                    worstRank = Math.min(worstRank, 3);
                }
                // 3ä½ã®ç¾åœ¨å‹æ•°ã«æœ€å¤§ã§ã‚‚å±Šã‹ãªã„ãªã‚‰æœ€é«˜é †ä½ã¯4ä½ä»¥ä¸‹
                if (thirdPlace && (team.wins + remainingGames) < thirdPlace.wins) {
                    bestRank = Math.max(bestRank, 4);
                }

                // é †ä½ã¯1-6ä½ã«åˆ¶é™
                bestRank = Math.min(bestRank, 6);
                worstRank = Math.min(worstRank, 6);
                
                return `
                    <tr class="${rankClass}">
                        <td class="center">${team.position_rank}</td>
                        <td>${renderTeamLabel(team.team_abbreviation, team.team_name)}</td>
                        <td class="center">${team.games_played}</td>
                        <td class="center win">${team.wins}</td>
                        <td class="center loss">${team.losses}</td>
                        <td class="center">${team.draws || 0}</td>
                        <td class="center pct">${team.win_percentage.toFixed(3)}</td>
                        <td class="center">${remainingGames}</td>
                        <td class="center">${team.games_behind > 0 ? team.games_behind.toFixed(1) : '-'}</td>
                        <td class="center">${homeWins}-${homeLosses}</td>
                        <td class="center">${homeWinPct}</td>
                        <td class="center">${awayWins}-${awayLosses}</td>
                        <td class="center">${awayWinPct}</td>
                        <td class="center">${bestRank}</td>
                        <td class="center">${worstRank}</td>
                    </tr>
                `;
            }).join('');
        }

        // ===== å‹ç‡ã‚·ãƒŠãƒªã‚ªåˆ†ææ›´æ–° =====
        function updateScenarios() {
            updateScenariosTable('central-scenarios', standingsData.central_league?.standings || []);
            updateScenariosTable('pacific-scenarios', standingsData.pacific_league?.standings || []);
        }

        // ===== å‹ç‡ã‚·ãƒŠãƒªã‚ªãƒ†ãƒ¼ãƒ–ãƒ«æ›´æ–°ï¼ˆå…±é€šé–¢æ•°ï¼‰ =====
        function updateScenariosTable(id, teams) {
            const tbody = document.getElementById(id);
            const headerId = id.replace('-scenarios', '-scenarios-header');
            const header = document.getElementById(headerId);
            const league = id.includes('central') ? 'central' : 'pacific';
            
            if (!teams.length) {
                tbody.innerHTML = '<tr><td colspan="20" class="loading">ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“</td></tr>';
                return;
            }

            // Create NPB-style 4-row header
            if (header) {
                let headerHTML = `
                    <tr>
                        <td rowspan="4" style="background: #f8f9fa; font-weight: bold; vertical-align: middle; width: 60px;">ìµœì¢…ìŠ¹ë¥ </td>`;
                
                // Row 1: Team rankings
                teams.forEach(team => {
                    headerHTML += `<td class="center" style="background: #f0f0f0; font-weight: bold; padding: 4px;">${team.position_rank}ìœ„</td>`;
                });
                headerHTML += `</tr><tr>`;
                
                // Row 2: Team names with logos
                teams.forEach(team => {
                    headerHTML += `<td class="center" style="background: #f8f9fa; font-weight: bold; padding: 4px;">${renderTeamLabel(team.team_abbreviation, team.team_name)}</td>`;
                });
                headerHTML += `</tr><tr>`;
                
                // Row 3: Current records + games played
                teams.forEach(team => {
                    headerHTML += `<td class="center" style="background: #f0f0f0; font-size: 11px; padding: 4px;">${team.wins}-${team.losses}-${team.draws || 0} (è©¦åˆ${team.games_played})</td>`;
                });
                headerHTML += `</tr><tr>`;
                
                // Row 4: Remaining games
                teams.forEach(team => {
                    const remaining = TOTAL_GAMES - team.games_played;
                    headerHTML += `<td class="center" style="background: #f8f9fa; font-size: 11px; padding: 4px;">ì”ì—¬${remaining}</td>`;
                });
                headerHTML += `</tr>`;
                
                header.innerHTML = headerHTML;
            }

            // è¡¨ç¤ºã™ã‚‹å‹ç‡ã‚¿ãƒ¼ã‚²ãƒƒãƒˆï¼ˆé«˜ã„é †ã‹ã‚‰ï¼‰ - å‹•çš„è¨­å®š
            const winRateTargets = seasonConfig?.scenario_config?.win_rate_targets || [0.700, 0.650, 0.600, 0.550, 0.500, 0.450, 0.400, 0.350, 0.300];
            
            tbody.innerHTML = winRateTargets.map(targetRate => {
                let row = `<td class="center" style="background: #f8f9fa; font-weight: bold; padding: 4px; font-size: 12px;">${(targetRate * 100).toFixed(0)}%</td>`;
                
                teams.forEach(team => {
                    const remainingGames = TOTAL_GAMES - team.games_played;
                    const currentWins = team.wins;
                    const currentLosses = team.losses;
                    const currentDraws = team.draws || 0;
                    
                    // ç›®æ¨™å‹ç‡é”æˆã«å¿…è¦ãªæ®‹ã‚Šæˆç¸¾è¨ˆç®—
                    const totalGamesMinusDraws = TOTAL_GAMES - currentDraws;
                    const requiredTotalWins = Math.ceil(targetRate * totalGamesMinusDraws);
                    const requiredWins = Math.max(0, requiredTotalWins - currentWins);
                    const requiredLosses = remainingGames - requiredWins;
                    
                    let cellContent = '';
                    let cellStyle = 'text-align: center; padding: 4px; font-size: 10px; min-width: 40px;';
                    
                    if (requiredWins > remainingGames) {
                        // é”æˆä¸å¯èƒ½
                        cellContent = '-';
                        cellStyle += 'background: #ffebee; color: #c62828;';
                    } else if (requiredWins <= 0) {
                        // æ—¢ã«é”æˆã¾ãŸã¯å®¹æ˜“
                        const finalRate = (currentWins / (TOTAL_GAMES - currentDraws)) * 100;
                        if (finalRate >= targetRate * 100) {
                            cellContent = 'âœ“';
                            cellStyle += 'background: #e8f5e8; color: #2e7d32; font-weight: bold;';
                        } else {
                            cellContent = `${requiredWins}-${requiredLosses}`;
                            cellStyle += 'background: #e8f5e8; color: #2e7d32;';
                        }
                    } else {
                        // å¿…è¦æˆç¸¾è¡¨ç¤º: å‹-æ•—
                        cellContent = `${requiredWins}-${requiredLosses}`;
                        
                        // æœ€çµ‚å‹ç‡ã‚’0.500ã¨æ¯”è¼ƒã—ã¦è‰²åˆ†ã‘
                        const finalRate = (currentWins + requiredWins) / (TOTAL_GAMES - currentDraws);
                        if (finalRate > 0.500) {
                            cellStyle += 'background: #e8f5e8; color: #2e7d32;'; // Green - above .500
                        } else if (finalRate === 0.500) {
                            cellStyle += 'background: #fff3e0; color: #f57c00;'; // Yellow - exactly .500
                        } else {
                            cellStyle += 'background: #ffebee; color: #c62828;'; // Red - below .500
                        }
                    }
                    
                    row += `<td style="${cellStyle}">${cellContent}</td>`;
                });
                
                return `<tr>${row}</tr>`;
            }).join('');
        }

        // ===== æ®‹ã‚Šè©¦åˆæ•°æ›´æ–° =====
        function updateRemainingGames() {
            updateRemainingTable('central-remaining', standingsData.central_league?.standings || []);
            updateRemainingTable('pacific-remaining', standingsData.pacific_league?.standings || []);
        }

        // ===== æ®‹ã‚Šè©¦åˆãƒ†ãƒ¼ãƒ–ãƒ«æ›´æ–°ï¼ˆå…±é€šé–¢æ•°ï¼‰ =====
        function updateRemainingTable(id, teams) {
            const tbody = document.getElementById(id);
            if (!teams.length) {
                tbody.innerHTML = '<tr><td colspan="6" class="loading">ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“</td></tr>';
                return;
            }

            tbody.innerHTML = teams.map(team => {
                const remainingGames = TOTAL_GAMES - team.games_played;
                const fallbackHome = Math.floor(remainingGames / 2);
                const calc = homeAwayRemainingByTeam[team.team_id] || { home: fallbackHome, away: remainingGames - fallbackHome, opponents: {} };
                const homeRemaining = calc.home;
                const awayRemaining = calc.away;
                
                // ì‹¤ì œ ëŒ€ì „ ìƒëŒ€ ë°ì´í„° ì‚¬ìš©
                let opponentsStr = '';
                if (calc.opponents && Object.keys(calc.opponents).length > 0) {
                    // ì‹¤ì œ ìŠ¤ì¼€ì¤„ ë°ì´í„°ì—ì„œ ìƒëŒ€íŒ€ ì •ë³´ í‘œì‹œ
                    const opponentList = Object.entries(calc.opponents)
                        .sort((a, b) => b[1] - a[1]) // ê²½ê¸° ìˆ˜ ë§ì€ ìˆœìœ¼ë¡œ ì •ë ¬
                        .slice(0, 4) // ìƒìœ„ 4íŒ€ë§Œ í‘œì‹œ
                        .map(([abbr, count]) => `${abbr}(${count})`)
                        .join(', ');
                    opponentsStr = opponentList;
                } else {
                    // í´ë°±: ë¦¬ê·¸ ë‚´ ë‹¤ë¥¸ íŒ€ë“¤ í‘œì‹œ
                    const fallbackOpponents = teams
                        .filter(t => t.team_id !== team.team_id)
                        .slice(0, 3)
                        .map(t => `${t.team_abbreviation}(?)`)
                        .join(', ');
                    opponentsStr = fallbackOpponents;
                }
                
                return `
                    <tr>
                        <td>${renderTeamLabel(team.team_abbreviation, team.team_name)}</td>
                        <td class="center">${team.games_played}</td>
                        <td class="center">${remainingGames}</td>
                        <td class="center">${homeRemaining}</td>
                        <td class="center">${awayRemaining}</td>
                        <td style="font-size: 11px;">${opponentsStr}</td>
                    </tr>
                `;
            }).join('');
        }

        // ===== ã‚¨ãƒ©ãƒ¼è¡¨ç¤ºæ©Ÿèƒ½ =====
        function showError(errorMsg = 'ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ') {
            const errorHtml = `<tr><td colspan="15" class="loading">âŒ ${errorMsg}</td></tr>`;
            document.querySelectorAll('tbody').forEach(tbody => {
                tbody.innerHTML = errorHtml;
            });
            
            // ì—ëŸ¬ ìƒì„¸ ì •ë³´ í‘œì‹œ
            const errorDetail = document.createElement('div');
            errorDetail.style.cssText = 'position: fixed; top: 10px; right: 10px; background: #ffebee; color: #c62828; padding: 10px; border: 1px solid #e57373; border-radius: 4px; z-index: 1000; max-width: 300px;';
            errorDetail.innerHTML = `
                <strong>ã‚¨ãƒ©ãƒ¼è©³ç´°:</strong><br>
                ${errorMsg}<br>
                <small>ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚³ãƒ³ã‚½ãƒ¼ãƒ«(F12)ã§è©³ç´°ã‚’ç¢ºèªã—ã¦ãã ã•ã„</small>
                <button onclick="this.parentNode.remove()" style="float: right; margin-left: 10px;">Ã—</button>
            `;
            document.body.appendChild(errorDetail);
            
            // 5ç§’ í›„ ìë™ ì œê±°
            setTimeout(() => {
                if (errorDetail.parentNode) {
                    errorDetail.remove();
                }
            }, 5000); // 5ç§’å¾Œã«è‡ªå‹•é™¤å»
        }
        
        // ===== ãƒ‡ãƒ¼ã‚¿ãƒ‘ã‚¹å–å¾—ï¼ˆGitHub Pageså¯¾å¿œï¼‰ =====
        function getDataPath() {
            const hostname = window.location.hostname;
            const isGitHubPages = hostname.endsWith('.github.io') || hostname.includes('github');
            
            if (isGitHubPages) {
                // GitHub Pages: ì ˆëŒ€ ê²½ë¡œ ì‚¬ìš©
                const basePath = window.location.pathname.replace('/index.html', '').replace('/', '');
                return basePath ? `/${basePath}/data/standings.json` : '/data/standings.json';
            } else {
                // ë¡œì»¬: ìƒëŒ€ ê²½ë¡œ ì‚¬ìš©  
                return './data/standings.json';
            }
        }
        
        // ===== ãƒ‡ãƒ¼ã‚¿å‹æ­£è¦åŒ–å‡¦ç† =====
        function normalizeStandingsData(data) {
            if (!data) return data;
            
            // ê° ë¦¬ê·¸ì˜ íŒ€ ë°ì´í„° ì •ê·œí™”
            ['central_league', 'pacific_league'].forEach(league => {
                if (data[league]?.standings) {
                    data[league].standings = data[league].standings.map(team => ({
                        ...team,
                        // ë¬¸ìì—´ì„ ìˆ«ìë¡œ ë³€í™˜
                        win_percentage: parseFloat(team.win_percentage) || 0,
                        games_behind: parseFloat(team.games_behind) || 0,
                        wins: parseInt(team.wins) || 0,
                        losses: parseInt(team.losses) || 0,
                        draws: parseInt(team.draws) || 0,
                        games_played: parseInt(team.games_played) || 0,
                        runs_scored: parseInt(team.runs_scored) || 0,
                        runs_allowed: parseInt(team.runs_allowed) || 0,
                        run_differential: parseInt(team.run_differential) || 0
                    }));
                }
            });
            
            return data;
        }
        
        // ===== Home/Away ì”ì—¬ ê³„ì‚° (ì‹¤ì œ ìŠ¤ì¼€ì¤„ ë°ì´í„° ì‚¬ìš©) =====
        function computeHomeAwayRemaining() {
            homeAwayRemainingByTeam = {};
            if (!standingsData) return;

            const allTeams = [...(standingsData.central_league?.standings || []), ...(standingsData.pacific_league?.standings || [])];
            const teamIds = allTeams.map(t => t.team_id);

            // ê¸°ë³¸ê°’: 0ìœ¼ë¡œ ì´ˆê¸°í™”
            teamIds.forEach(id => { homeAwayRemainingByTeam[id] = { home: 0, away: 0, opponents: {} }; });

            // ì‹¤ì œ ìŠ¤ì¼€ì¤„ ë°ì´í„°ê°€ ìˆìœ¼ë©´ ì‚¬ìš©
            if (upcomingGamesData && Array.isArray(upcomingGamesData)) {
                upcomingGamesData.forEach(game => {
                    if (game.game_status !== 'scheduled') return;
                    
                    const homeId = game.home_team_id;
                    const awayId = game.away_team_id;
                    
                    // í™ˆíŒ€ ì”ì—¬ í™ˆ ê²Œì„ ì¦ê°€
                    if (homeAwayRemainingByTeam[homeId]) {
                        homeAwayRemainingByTeam[homeId].home++;
                        // ìƒëŒ€íŒ€ ì •ë³´ ì¶”ê°€
                        const opponentAbbr = game.away_team_abbr;
                        homeAwayRemainingByTeam[homeId].opponents[opponentAbbr] = (homeAwayRemainingByTeam[homeId].opponents[opponentAbbr] || 0) + 1;
                    }
                    
                    // ì›ì •íŒ€ ì”ì—¬ ì›ì • ê²Œì„ ì¦ê°€
                    if (homeAwayRemainingByTeam[awayId]) {
                        homeAwayRemainingByTeam[awayId].away++;
                        // ìƒëŒ€íŒ€ ì •ë³´ ì¶”ê°€
                        const opponentAbbr = game.home_team_abbr;
                        homeAwayRemainingByTeam[awayId].opponents[opponentAbbr] = (homeAwayRemainingByTeam[awayId].opponents[opponentAbbr] || 0) + 1;
                    }
                });
            } else {
                // ìŠ¤ì¼€ì¤„ ë°ì´í„°ê°€ ì—†ìœ¼ë©´ ê· ë“± ë¶„ë°°ë¡œ í´ë°±
                allTeams.forEach(t => {
                    const remaining = Math.max(0, TOTAL_GAMES - t.games_played);
                    const home = Math.floor(remaining / 2);
                    const away = remaining - home;
                    homeAwayRemainingByTeam[t.team_id] = { home, away, opponents: {} };
                });
            }
        }

        // ===== ãƒ¡ã‚¤ãƒ³ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿å‡¦ç† =====
        async function loadDataEnhanced() {
            try {
                
                // ìˆœìœ„ ë°ì´í„° ë¡œë”© (cache-busting)
                const basePath = getDataPath();
                const cacheBust = `v=${Date.now()}`;
                const dataUrl = basePath + (basePath.includes('?') ? '&' : '?') + cacheBust;
                const response = await fetch(dataUrl);
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${dataPath}`);
                }
                
                const rawData = await response.json();
                
                // ì‹œì¦Œ ì„¤ì • ë°ì´í„° ë¡œë”© (dashboard.json, cache-busting ë™ì¼ ì ìš©)
                try {
                    const dashboardBase = basePath.replace('standings.json', 'dashboard.json');
                    const dashboardUrl = dashboardBase + (dashboardBase.includes('?') ? '&' : '?') + cacheBust;
                    const dashboardResponse = await fetch(dashboardUrl);
                    if (dashboardResponse.ok) {
                        seasonConfig = await dashboardResponse.json();
                        // NPB ì •ê·œì‹œì¦Œì€ íŒ€ë‹¹ 143è©¦åˆ. ëŒ€ì‹œë³´ë“œê°€ ìˆë”ë¼ë„ TOTAL_GAMESëŠ” 143ìœ¼ë¡œ ê³ ì •.
                        if (seasonConfig.season_stats) {
                            const allTeams = [...(rawData.central_league?.standings || []), ...(rawData.pacific_league?.standings || [])];
                            const maxGamesPlayed = Math.max(...allTeams.map(t => t.games_played));
                            TOTAL_GAMES = 143;
                        }
                    }
                } catch (dashboardError) {
                    // ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ãƒ‡ãƒ¼ã‚¿ãªã—ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ä½¿ç”¨
                }
                
                // ê²½ê¸° ë°ì´í„° ë¡œë”© (home/away ì”ì—¬ ê³„ì‚°ìš©)
                try {
                    const gamesBase = basePath.replace('standings.json', 'games.json');
                    const gamesUrl = gamesBase + (gamesBase.includes('?') ? '&' : '?') + cacheBust;
                    const gamesResp = await fetch(gamesUrl);
                    if (gamesResp.ok) {
                        gamesData = await gamesResp.json();
                    }
                } catch (gamesError) {}

                // ì”ì—¬ ê²½ê¸° ë°ì´í„° ë¡œë”©
                try {
                    const upcomingBase = basePath.replace('standings.json', 'upcoming.json');
                    const upcomingUrl = upcomingBase + (upcomingBase.includes('?') ? '&' : '?') + cacheBust;
                    const upcomingResp = await fetch(upcomingUrl);
                    if (upcomingResp.ok) {
                        upcomingGamesData = await upcomingResp.json();
                    }
                } catch (upcomingError) {}

                // ë°ì´í„° íƒ€ì… ì •ê·œí™”
                standingsData = normalizeStandingsData(rawData);

                if (standingsData.updated_at) {
                    document.getElementById('last-update').textContent = 
                        new Date(standingsData.updated_at).toLocaleString('ja-JP');
                }

                // Initialize schedule view with Today
                initScheduleToggle();

                // ì‹¤ì œ í†µê³„ ë°ì´í„° í‘œì‹œ
                if (seasonConfig && seasonConfig.season_stats) {
                    const stats = seasonConfig.season_stats;
                    if (typeof stats.total_games === 'number') {
                        document.getElementById('total-games').textContent = `${stats.total_games}è©¦åˆ`;
                    }
                    // today_gamesëŠ” upcoming ê¸°ì¤€ ê³„ì‚°ê°’ì´ ìˆì„ ìˆ˜ ìˆìœ¼ë¯€ë¡œ, 0ë³´ë‹¤ í´ ë•Œë§Œ ë®ì–´ì”€
                    if (typeof stats.today_games === 'number' && stats.today_games > 0) {
                        document.getElementById('today-games').textContent = `${stats.today_games}è©¦åˆ`;
                    }
                }
                
                computeHomeAwayRemaining();
                updateMagicRegular();
                updateMagicPlayoff();
                updateScenarios();
                updateDetailedStandings();
                updateRemainingGames();
                
            } catch (error) {
                showError(`ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼: ${error.message}`);
            }
        }
        
        document.addEventListener('DOMContentLoaded', loadDataEnhanced);
        window.reloadData = loadDataEnhanced;

        // ===== ä»Šæ—¥/æ˜æ—¥ã®è©¦åˆæç”» =====
        function formatJSTDateISO(date = new Date()) {
            // Returns YYYY-MM-DD in Asia/Tokyo
            return new Intl.DateTimeFormat('en-CA', {
                timeZone: 'Asia/Tokyo', year: 'numeric', month: '2-digit', day: '2-digit'
            }).format(date);
        }

        // (Removed) JS-driven footer logic. Footer is now static HTML-only.
        function getJSTDate(offsetDays = 0) {
            // Compute date in JST adding offset days
            const now = new Date();
            const ts = now.getTime() + offsetDays * 24 * 60 * 60 * 1000;
            return new Date(ts);
        }

        let currentScheduleMode = 'today';
        function initScheduleToggle() {
            const btnToday = document.getElementById('btn-today');
            const btnTomorrow = document.getElementById('btn-tomorrow');

            btnToday?.addEventListener('click', () => setScheduleDate('today'));
            btnTomorrow?.addEventListener('click', () => setScheduleDate('tomorrow'));

            // Pick smart default: if no games today (or late night), show tomorrow when available
            const defaultMode = getDefaultScheduleMode();
            setScheduleDate(defaultMode);

            // Enable swipe/keyboard/scroll gestures to flip day
            enableScheduleGestures();

            // Auto-refresh upcoming schedule every 5 minutes
            startScheduleAutoRefresh();
        }

        function getDefaultScheduleMode() {
            try {
                const todayIso = formatJSTDateISO(getJSTDate(0));
                const tomorrowIso = formatJSTDateISO(getJSTDate(1));
                const todayGames = (upcomingGamesData || []).filter(g => (g.game_status === 'scheduled' || g.game_status === 'in_progress') && g.game_date === todayIso);
                const tomorrowGames = (upcomingGamesData || []).filter(g => (g.game_status === 'scheduled' || g.game_status === 'in_progress') && g.game_date === tomorrowIso);
                const hourJST = parseInt(new Date().toLocaleString('ja-JP', { timeZone: 'Asia/Tokyo', hour12: false, hour: '2-digit' }), 10);
                if ((!todayGames.length && tomorrowGames.length) || hourJST >= 23) return 'tomorrow';
            } catch (_) {}
            return 'today';
        }

        function enableScheduleGestures() {
            const section = document.getElementById('today-section');
            if (!section) return;

            // Touch swipe left/right
            let touchStartX = null;
            section.addEventListener('touchstart', (e) => {
                touchStartX = e.touches?.[0]?.clientX ?? null;
            }, { passive: true });
            section.addEventListener('touchend', (e) => {
                if (touchStartX == null) return;
                const endX = e.changedTouches?.[0]?.clientX ?? touchStartX;
                const dx = endX - touchStartX;
                if (dx < -40) setScheduleDate('tomorrow');
                else if (dx > 40) setScheduleDate('today');
                touchStartX = null;
            });

            // Keyboard arrows
            document.addEventListener('keydown', (e) => {
                if (e.key === 'ArrowRight') setScheduleDate('tomorrow');
                else if (e.key === 'ArrowLeft') setScheduleDate('today');
            });

            // Mouse/trackpad horizontal scroll flips day
            section.addEventListener('wheel', (e) => {
                if (Math.abs(e.deltaX) > Math.abs(e.deltaY) && Math.abs(e.deltaX) > 20) {
                    if (e.deltaX > 0) setScheduleDate('tomorrow');
                    else setScheduleDate('today');
                }
            }, { passive: true });
        }

        function startScheduleAutoRefresh() {
            // Refresh data periodically to reflect game status changes
            setInterval(async () => {
                try {
                    const basePath = getDataPath();
                    const upcomingBase = basePath.replace('standings.json', 'upcoming.json');
                    const cacheBust = `v=${Date.now()}`;
                    const upcomingUrl = upcomingBase + (upcomingBase.includes('?') ? '&' : '?') + cacheBust;
                    const resp = await fetch(upcomingUrl);
                    if (resp.ok) {
                        upcomingGamesData = await resp.json();
                        setScheduleDate(currentScheduleMode); // re-render current mode
                    }
                } catch (_) {}
            }, 5 * 60 * 1000);
        }

        function setScheduleDate(mode) {
            const btnToday = document.getElementById('btn-today');
            const btnTomorrow = document.getElementById('btn-tomorrow');

            btnToday?.classList.toggle('active', mode === 'today');
            btnTomorrow?.classList.toggle('active', mode === 'tomorrow');

            const offset = mode === 'tomorrow' ? 1 : 0;
            const targetDate = formatJSTDateISO(getJSTDate(offset));
            currentScheduleMode = mode;
            updateScheduleForDate(targetDate, mode === 'today');
        }

        function tryFormatStartTime(g) {
            const rawKeys = [
                'start_time', 'scheduled_time', 'start_time_local', 'first_pitch_time', 'game_time', 'scheduled_start_time'
            ];
            let val = undefined;
            for (const k of rawKeys) {
                if (g && g[k]) { val = g[k]; break; }
            }
            if (!val) return null;
            try {
                if (typeof val === 'string' && val.includes('T')) {
                    const d = new Date(val);
                    if (!isNaN(d.getTime())) {
                        return d.toLocaleTimeString('ja-JP', { timeZone: 'Asia/Tokyo', hour12: false, hour: '2-digit', minute: '2-digit' });
                    }
                }
                // HH:MM or other plain time strings
                if (typeof val === 'string') return val;
            } catch (_) {}
            return null;
        }

        const DEFAULT_STADIUM_BY_HOME = {
            YOG: 'æ±äº¬ãƒ‰ãƒ¼ãƒ ',
            HAN: 'é˜ªç¥ç”²å­åœ’çƒå ´',
            CHU: 'ãƒãƒ³ãƒ†ãƒªãƒ³ãƒ‰ãƒ¼ãƒ  ãƒŠã‚´ãƒ¤',
            YDB: 'æ¨ªæµœã‚¹ã‚¿ã‚¸ã‚¢ãƒ ',
            HIR: 'MAZDA Zoom-Zoom ã‚¹ã‚¿ã‚¸ã‚¢ãƒ åºƒå³¶',
            YAK: 'æ˜æ²»ç¥å®®é‡çƒå ´',
            SOF: 'ç¦å²¡PayPayãƒ‰ãƒ¼ãƒ ',
            LOT: 'ZOZOãƒãƒªãƒ³ã‚¹ã‚¿ã‚¸ã‚¢ãƒ ',
            SEI: 'ãƒ™ãƒ«ãƒ¼ãƒŠãƒ‰ãƒ¼ãƒ ',
            ORI: 'äº¬ã‚»ãƒ©ãƒ‰ãƒ¼ãƒ å¤§é˜ª',
            NIP: 'ã‚¨ã‚¹ã‚³ãƒ³ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰HOKKAIDO',
            RAK: 'æ¥½å¤©ãƒ¢ãƒã‚¤ãƒ«ãƒ‘ãƒ¼ã‚¯å®®åŸ'
        };

        function tryGetVenue(g) {
            const keys = ['venue', 'stadium', 'ballpark', 'stadium_name', 'venue_name'];
            for (const k of keys) {
                if (g && g[k]) return g[k];
            }
            // fallback by home team abbreviation
            if (g?.home_team_abbr && DEFAULT_STADIUM_BY_HOME[g.home_team_abbr]) {
                return `${DEFAULT_STADIUM_BY_HOME[g.home_team_abbr]} (æ¨å®š)`;
            }
            return null;
        }

        function inferStartTimeJST(dateIso) {
            // Basic heuristic: Weekday 18:00, Weekend 14:00 (JST)
            const d = new Date(`${dateIso}T00:00:00+09:00`);
            const dow = d.getUTCDay(); // 0 Sun .. 6 Sat (for +09:00 anchor)
            return (dow === 0 || dow === 6) ? '14:00' : '18:00';
        }

        function updateScheduleForDate(dateIso, updateInfoCount = false) {
            const container = document.getElementById('today-games-container');
            const dateLabel = document.getElementById('today-date');
            dateLabel.textContent = `(${dateIso})`;

            if (!upcomingGamesData || !Array.isArray(upcomingGamesData)) {
                container.innerHTML = '<div class="game-card"><div class="game-row">æœ¬æ—¥ã®è©¦åˆãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“</div></div>';
                if (updateInfoCount) document.getElementById('today-games').textContent = '0è©¦åˆ';
                return;
            }

            const todayGames = upcomingGamesData.filter(g =>
                (g.game_status === 'scheduled' || g.game_status === 'in_progress') && g.game_date === dateIso
            );

            if (!todayGames.length) {
                container.innerHTML = '<div class="game-card"><div class="game-row">æœ¬æ—¥ã®è©¦åˆã¯ã‚ã‚Šã¾ã›ã‚“</div></div>';
                if (updateInfoCount) document.getElementById('today-games').textContent = '0è©¦åˆ';
                return;
            }

            todayGames.sort((a, b) => {
                if (a.league === b.league) {
                    return (a.home_team_abbr + a.away_team_abbr).localeCompare(b.home_team_abbr + b.away_team_abbr);
                }
                return a.league.localeCompare(b.league);
            });

            if (updateInfoCount) {
                document.getElementById('today-games').textContent = `${todayGames.length}è©¦åˆ`;
            }

            container.innerHTML = todayGames.map(g => {
                const leagueClass = g.league === 'Central' ? 'league-central' : 'league-pacific';
                const status = g.game_status === 'in_progress' ? 'LIVE' : 'äºˆå®š';
                const timeRaw = tryFormatStartTime(g);
                const timeStr = timeRaw || `${inferStartTimeJST(dateIso)}(æ¨å®š)`;
                const venue = tryGetVenue(g);
                const meta = [timeStr, venue].filter(Boolean).join(' / ');
                return `
                    <div class="game-card">
                        <div class="game-row">
                            <span class="league-tag ${leagueClass}">${g.league}</span>
                            <span style="margin-left:auto; font-size:12px; color:#666;">${status}</span>
                        </div>
                        <div class="game-row" style="margin-top:4px;">
                            <span>${renderTeamLabel(g.away_team_abbr, g.away_team_name)}</span>
                            <span style="color:#888;">@</span>
                            <span>${renderTeamLabel(g.home_team_abbr, g.home_team_name)}</span>
                        </div>
                        ${meta ? `<div class="game-sub" style="color:#777;">${meta}</div>` : ''}
                    </div>
                `;
            }).join('');
        }

        // No JS footer init required; footer is static in HTML.
    </script>

    <!-- Site footer (static) -->
    <footer class="site-footer" role="contentinfo">
        <div class="footer-content">
            <span>Â© 2025 NPB Statistics</span>
            <span>|</span>
            <a href="https://npb-dashboard.com" target="_blank" rel="noopener noreferrer">npb-dashboard.com</a>
        </div>
    </footer>
</body>
</html>
